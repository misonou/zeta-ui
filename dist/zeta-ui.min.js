/*! zeta UI v1.0.0-beta | https://github.com/misonou/zeta-ui | The MIT License (MIT) */

!function(a,b){"function"==typeof define&&define.amd?define("zeta-ui",["jquery","waterpipe"],b):"object"==typeof module&&module.exports?module.exports=b(require("jquery"),require("waterpipe")):a.zeta=b(a.jQuery,a.waterpipe)}("undefined"!=typeof self?self:this,function(a,b,c){return function(d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){"use strict";!function(){function b(){}function j(a){return new Na(B(a))}function p(a){return h.isArray(a)&&a}function q(a){return"function"==typeof a&&a}function t(a){var b="object"==typeof a&&null!==a&&f.getPrototypeOf(a);return(b===f.prototype||null===b)&&a}function u(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||q(g)||(g={});h<i;h++)if(null!==(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(t(d)||(e=p(d)))?(e?(e=!1,f=c&&p(c)?c:[]):f=c&&t(c)?c:{},g[b]=u(j,f,d)):void 0!==d&&(g[b]=d));return g}function v(a){if(q(a)||a===d)return!1;var b=!!a&&"length"in a&&a.length;return p(a)||0===b||"number"==typeof b&&b>0&&b-1 in a}function w(a,b){if(a){var c,d=0;if("string"==typeof a?a=a.split(" "):a instanceof s.Set&&(a=q(a.values)?a.values():function(a,b){return a.forEach(function(a){b[b.length]=a}),b}(a,[])),v(a))for(var e=a.length;d<e&&!1!==b(d,a[d++]););else if(q(a.entries))for(a=a.entries();!(c=a.next()).done&&!1!==b(c.value[0],c.value[1]););else if(q(a.forEach)){var f;a.forEach(function(a,c){f=!1===f||b(c,a)})}else if(q(a.next))for(;!(c=a.next()).done&&!1!==b(d++,c.value););else if(q(a.nextNode))for(;(c=a.nextNode())&&!1!==b(d++,c););else for(d in a)if(!1===b(d,a[d]))return}}function x(a,b){var c=[];return w(a,function(a,d){var e=b.call(this,d,a);null!==e&&void 0!==e&&(p(e)?c.push.apply(c,e):c[c.length]=e)}),c}function y(a,b){var c;return w(a,function(a,d){return!(c=b.call(this,d,a)&&d)}),c}function z(a,b){var c;return w(a,function(a,d){return!(c=b.call(this,d,a))}),c}function A(a,b){var c={};return c[a]=b,c}function B(a){if(p(a))return a.slice(0);if("string"==typeof a)return[a];if(a&&(v(a)||q(a.forEach))){var b=[];return w(a,function(a,c){b[b.length]=c}),b}return null!==a&&void 0!==a?[a]:[]}function C(b){if(!b[0])return Va();var c,d=a.Deferred(),e=b.length;return w(b,function(a,b){E(b,function(a){c|=!a,0==--e&&d[c?"reject":"resolve"]()})}),d.promise()}function D(b){return a.Deferred().reject(b).promise()}function E(a,b){a.then(function(a){b(!0,a)},function(a){b(!1,a)})}function F(a,b){return b=b||a.currentNode,b&&a.whatToShow&(Y(b,k)?1<<b.nodeType-1:b.nodeType)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b):1:3}function G(a,c,d,e){var f=0;switch(a.currentNode=d=d||a.currentNode,c=c||b,F(a)){case 2:return;case 1:c(d,f++)}for(var g;(g=a.nextNode())&&(!e||(q(e)?e(g):g!==e||void c(g,f++)));c(g,f++));}function H(a,b,c,d){var e=[];return G(a,function(a){e[e.length]=a},c,d),b?x(e,b):e}function I(){var a=new s.WeakMap;return function(b,c){return c&&a.set(b,c),c||a.get(b)}}function J(a,b,c){return a.get(b)||c&&(a.set(b,new c),a.get(b))}function K(a){var b={};return w(f.getOwnPropertyNames(a||{}),function(c,d){b[d]=f.getOwnPropertyDescriptor(a,d)}),b}function L(a,b,c,d){Ta(a,b,{configurable:!0,enumerable:!0,get:c,set:d})}function M(a,b,c){Ta(a,b,{configurable:!0,enumerable:!1,writable:!0,value:c})}function N(a,b){w(K(b),function(b,c){c.enumerable=!q(c.value),Ta(a.prototype,b,c)})}function O(a,b){var c=f.create(q(a)?a.prototype:a||f.prototype);return w(K(b),function(a,b){Ta(c,a,b)}),c}function P(){return i.random().toString(36).substr(2,8)}function Q(a,b){return new h(b+1).join(a)}function R(a){return g(a).replace(/-([a-z])/g,function(a,b){return b.toUpperCase()})}function S(a){return g(a).replace(/[A-Z](?![A-Z])|[A-Z]{2,}(?=[A-Z])/g,function(a,b){return(b?"-":"")+a.toLowerCase()})}function T(a){return a=g(a||""),a.charAt(0).toUpperCase()+a.slice(1)}function U(a){return a=g(a||""),a.charAt(0).toLowerCase()+a.slice(1)}function V(a){return g(a||"").replace(/^(?:\u200b|[^\S\u00a0])+|(?:\u200b|[^\S\u00a0])+$/g,"")}function W(a,b){return(Ya[b]||(Ya[b]=new n("(?:^|\\s)("+b.replace(/\s+/g,"|")+")(?=$|\\s)"))).test(g(a||""))&&n.$1}function X(a){return a&&a.tagName&&a.tagName.toLowerCase()}function Y(b,c){return!(!b||!c)&&(c.prototype?b instanceof c&&b:c.toFixed?b.nodeType&c&&b:("*"===c||X(b)===c||a(b).is(c))&&b)}function Z(a,b){if(X(a)!==X(b))return!1;var c=a.attributes,d=b.attributes;return c.length===d.length&&!y(c,function(a){return!d[a.nodeName]||a.value!==d[a.nodeName].value})}function $(a,b,c){if(a===b)return 0;var d=a&&b&&Ra.call(a,b);return 2&d?c&&8&d||1&d?NaN:1:4&d?c&&16&d||1&d?NaN:-1:NaN}function _(a,b){return a&&b&&!(1&Ra.call(a.commonAncestorContainer||a,b.commonAncestorContainer||b))}function aa(b,c){return b=(b||"").element||b,c=(c||"").element||c,b===c||a.contains(b,c)}function ba(a,b){for(b=b||a;a&&a!==b&&20!==Ra.call(a,b);a=a.parentNode);return a}function ca(a,b){var c=a.length||a.childNodes.length;return 1/b<0?i.max(0,c+b):i.min(c,b)}function da(a,b,c,d){if(a&&q(a.getRange))return a.getRange();var f;if(Y(a,k)?(f=e.createRange(),+b!==b?(f["contents"!==b&&a.parentNode?"selectNode":"selectNodeContents"](a),"boolean"==typeof b&&f.collapse(b)):f.setStart(a,ca(a,b)),Y(c,k)&&_(a,c)&&f.setEnd(c,ca(c,d))):Y(a,l)&&(f=a.cloneRange(),f.collapsed||"boolean"!=typeof b||f.collapse(b)),Y(b,l)&&_(f,b)){var g=f.collapsed&&b.collapsed?-1:1;Sa.call(f,0,b)*g<0&&f.setStart(b.startContainer,b.startOffset),Sa.call(f,2,b)*g>0&&f.setEnd(b.endContainer,b.endOffset)}return f}function ea(a,b){return a=Y(a,l)||da(a),b=Y(b,l)||da(b),_(a,b)&&Sa.call(a,3,b)<=0&&Sa.call(a,1,b)>=0}function fa(a,b){return a=Y(a,l)||da(a),b=Y(b,l)||da(b),_(a,b)&&Sa.call(a,0,b)<=0&&Sa.call(a,2,b)>=0}function ga(a,b){return a=Y(a,l)||da(a),b=Y(b,l)||da(b),_(a,b)&&0===Sa.call(a,0,b)&&0===Sa.call(a,2,b)}function ha(a,b,c){a=Y(a,l)||da(a),b=Y(b,l)||da(b);var d=_(a,b)?Sa.call(a,0,b)+Sa.call(a,2,b):NaN;return c&&(0!==d&&ea(a,b)||0===d&&!ga(a,b))?NaN:d&&d/i.abs(d)}function ia(a,b){if(Xa.setBaseAndExtent&&Y(b,l))return void Xa.setBaseAndExtent(a.startContainer,a.startOffset,b.startContainer,b.startOffset);var c=da(a,b);try{Xa.removeAllRanges()}catch(b){var d=e.body.createTextRange();d.collapse(),d.select(),Xa.removeAllRanges()}try{Xa.addRange(c)}catch(b){Xa.rangeCount||(Xa.addRange(da(e.body)),Xa.removeAllRanges(),Xa.addRange(c))}}function ja(a,b){var c;if(a=a||Wa,a.getRect)return a.getRect();if((a=a.element||a)===Wa||a===d){aa(e.body,Za)||e.body.appendChild(Za);var f=ja(Za);c=la(0,0,Wa.offsetWidth,Wa.offsetHeight).translate(f.left,f.top)}else if(aa(Wa,a)){if(c=la(a.getBoundingClientRect()),b){var g=r(a);c.top-=i.max(0,o(g.marginTop)),c.left-=i.max(0,o(g.marginLeft)),c.right+=i.max(0,o(g.marginRight)),c.bottom+=i.max(0,o(g.marginBottom))}}else c=la(0,0,0,0);return c}function ka(a){return x((Y(a,l)||da(a,"contents")).getClientRects(),la)}function la(a,b,c,d){function e(a){return i.round(1e3*a)/1e3}return void 0!==a.top?new Ma(e(a.left),e(a.top),e(a.right),e(a.bottom)):void 0===c?new Ma(a,b,a,b):new Ma(a,b,c,d)}function ma(a,b){function c(c){return i.abs(a[c]-b[c])<1}return c("left")&&c("top")&&c("bottom")&&c("right")}function na(a,b){return b.left>=a.left&&b.right<=a.right&&b.top>=a.top&&b.bottom<=a.bottom}function oa(a,b,c,d){return d=d||0,c.width&&c.height&&a-c.left>=-d&&a-c.right<=d&&b-c.top>=-d&&b-c.bottom<=d}function pa(a,b){return la(i.min(a.left,b.left),i.min(a.top,b.top),i.max(a.right,b.right),i.max(a.bottom,b.bottom))}function qa(b,c,d){if(d=d||e.body,Qa)return y(Qa.call(e,b,c),function(a){return aa(d,a)&&"none"!==r(a).pointerEvents})||null;var f=e.elementFromPoint(b,c);if(!aa(d,f)&&oa(b,c,ja(d))){var g=[];try{for(;$(d,f,!0);){var h=a(f).parentsUntil(ba(d,f)).slice(-1)[0]||f;if(h===g[g.length-1])return null;h.style.pointerEvents="none",g[g.length]=h,f=e.elementFromPoint(b,c)}}finally{a(g).css("pointer-events","")}}return aa(d,f)?f:null}function ra(b){return Y(b,m)||a(e.createDocumentFragment()).append(b)[0]}function sa(a){return e.createTextNode(a||"​")}function ta(a){return e.createElement(a)}function ua(a,b,c){return e.createNodeIterator(a,b,q(c)||null,!1)}function va(a,b,c,d,e){t(c)?w(c,function(c,e){b[a](c,e,d)}):w(c.split(" "),function(c,f){b[a](f,d,e)})}function wa(a,b,c,d){return va("addEventListener",a,b,c,d),function(){xa(a,b,c)}}function xa(a,b,c){va("removeEventListener",a,b,c)}function ya(a){a.parentNode&&a.parentNode.removeChild(a)}function za(a,b){var c=new n("(?:^|\\s+)"+b+"(?:-(\\S+)|\\b)","ig"),d=[!1];return(a.className||"").replace(c,function(a,b){d[b?d.length:0]=b||!0}),d[1]?d.slice(1):d[0]}function Aa(a,b,c){var d=a.className||"";w(t(b)||A(b,c),function(a,b){var c=new n("(^|\\s)\\s*"+a+"(?:-(\\S+)|\\b)|\\s*$","ig"),e=0;t(b)&&(b=x(b,function(a,b){return a?b:null})),d=d.replace(c,function(){return e++||!b||0===b.length?"":" "+a+(b[0]?[""].concat(b).join(" "+a+"-"):"")})}),a.className=d}function Ba(a){if(!_(Wa,a))return!1;var b=ja(a);if(!(b.top||b.left||b.width||b.height))for(var c=a;c;c=c.parentNode)if("none"===r(c).display)return!1;return!0}function Ca(a,b){var c=r(a,b||null);return W(c.position,"absolute fixed relative")&&"auto"!==c.zIndex?parseInt(c.zIndex):-1}function Da(a){var b=-1;return G(e.createTreeWalker(e.body,1,function(c){if($(c,a,!0))return 2;var d=Ca(c);return d>=0?(b=i.max(b,d),2):(b=i.max(b,Ca(c,"::before"),Ca(c,"::after")),1)},!1)),b+1}function Ea(a,b){a.style.zIndex=Da(b),"static"===r(a).position&&(a.style.position="relative")}function Fa(a,b,c,e){var f=ja(Y(e||c,k)||d),g=W(c||b,"left right")||"left",h=W(c||b,"top bottom")||"top",i={};return b=(0|(a.top||a.clientY||a.y||b))-f.top,a=(0|(a.left||a.clientX||a.x||a))-f.left,i[g]=("left"===g?a:f.width-a)+"px",i[h]=("top"===h?b:f.height-b)+"px",i[Oa[g]]="auto",i[Oa[h]]="auto",i}function Ga(a,b){var c=Fa(a,null,b);return c.width=(0|a.width)+"px",c.height=(0|a.height)+"px",c}function Ha(b,c,d,f){aa(Wa,b)||e.body.appendChild(b),a(b).css({position:"fixed",maxWidth:"",maxHeight:""});var g=t(c)||!c?{}:ja(c);"left"in g||(g.left=g.right=0|(c.left||c.clientX||c.x),g.top=g.bottom=0|(c.right||c.clientY||c.y));var h=W(d,"inset-x inset-y inset")||"inset-x",j="inset"===h?g:ja(f),k=ja(b,!0),l={},m={},n={transform:""},o=function(a,b,c,d,e,f){if(n[e]=j[d]+l[c]-l[Oa[c]],!Oa[a]){var h=(g[Oa[c]]+g[c])/2;return a=h-j[c]<k[d]/2?c:j[Oa[c]]-h<k[d]/2?Oa[c]:"",a||(n.transform+=" "+f),m[c]=a?j[a]:h+l[c],a}var o=b?Oa[a]:a;if(g[a]*Pa[o]+k[d]<=j[o]*Pa[o])m[c]=g[a]+l[Oa[o]];else{if(!(g[Oa[a]]*Pa[o]-k[d]>j[Oa[o]]*Pa[o]))return m[c]=j[a],n[e]=b?n[e]:i.abs(g[a]-m[c])-Pa[a]*l[a],a;a=Oa[a],m[c]=g[a]+l[o]}return b||(a=Oa[a]),n[e]=i.abs(j[Oa[a]]-m[c]),a},p=ja(b);Ua(Oa).forEach(function(a){l[a]=k[a]-p[a]});var q=W(d,"left right center")||"left",r=W(d,"top bottom center")||"bottom",s=o(q,Oa[r]&&"inset-x"===h,"left","width","maxWidth","translateX(-50%)"),v=o(r,Oa[q]&&"inset-y"===h,"top","height","maxHeight","translateY(-50%)");a(b).css(u(n,Fa(m,s+" "+v)))}function Ia(a){var b={};return w(a,function(c,d){b[d]=a[d]}),b}function Ja(a,b){return/\b(?:[+-]?(\d+(?:\.\d+)?)(px|%)?|#[0-9a-f]{3,}|(rgba?|hsla?|matrix|calc)\(.+\))\b/.test(a)&&(b||!n.$1||n.$2)}function Ka(a){return a.replace(/^-(webkit|moz|ms|o)-/,"")}function La(c,d,e){if(za(c,d))return D();e=e||b,!0===e&&(e=Aa.bind(null,c,d,!1)),Aa(c,d,!0);var f=H(ua(c,1,function(a){var b=r(a);return"0s"!==b.transitionDuration||"none"!=b.animationName}));if(!f[0])return e(),Va();Aa(c,d,!1),a(f).css("transition","none"),Aa(c,d,!0);var g=f.map(function(a){return Ia(r(a))});Aa(c,d,!1);var h=new s.Map;if(w(f,function(a,b){var c=r(b),d={};w(c,function(b,e){var f=c[e],h=g[a][e];if(f!==h){var i=Ka(e),j=W(e,"opacity line-height");if("animation-name"===i){var k=f.replace(/,/g,"");w(h.split(/,\s*/),function(a,b){"none"===b||W(k,b)||(d["@"+b]=!0)})}else Ja(f,j)&&Ja(h,j)&&!/^scroll-limit/.test(i)&&(d[i]=!0)}}),Ua(d)[0]&&h.set(b,d)}),a(f).css("transition",""),Aa(c,d,!0),!h.size)return e(),Va();var i=a.Deferred(),j=wa(c,"animationend transitionend",function(a){var b=h.get(a.target)||{};if(delete b[a.propertyName?Ka(a.propertyName):"@"+a.animationName],!Ua(b)[0]&&h.delete(a.target)&&!h.size){var f=za(c,d);j(),f&&e(),i[f?"resolve":"reject"](c)}});return i.promise()}function Ma(a,b,c,d){var e=this;e.left=a,e.top=b,e.right=c,e.bottom=d}function Na(a){this.value=null,this.args=a,this.done=!a.length}var Oa={top:"bottom",left:"right",right:"left",bottom:"top"},Pa={top:-1,left:-1,right:1,bottom:1},Qa=e.msElementsFromPoint||e.elementsFromPoint,Ra=e.compareDocumentPosition,Sa=l.prototype.compareBoundaryPoints,Ta=f.defineProperty,Ua=f.keys,Va=a.when,Wa=e.documentElement,Xa=d.getSelection(),Ya={},Za=a('<div style="position:fixed; top:0; left:0;">')[0];N(Ma,{get width(){return this.right-this.left},get height(){return this.bottom-this.top},get centerX(){return(this.left+this.right)/2},get centerY(){return(this.top+this.bottom)/2},collapse:function(a,b){var c=this,d=c[a]+(b||0);return"left"===a||"right"===a?la(d,c.top,d,c.bottom):la(c.left,d,c.right,d)},translate:function(a,b){var c=this;return la(c.left+a,c.top+b,c.right+a,c.bottom+b)}}),N(Na,{next:function(a){var b=this.args;if("object"===a?t(b[0]):"string"==typeof a?typeof b[0]===a:Y(b[0],a))return this.value=b.shift(),this.done=!b.length,!0},nextAll:function(a){for(var b=[];this.next(a)&&b.push(this.value););return b},fn:function(){return this.next("function")&&this.value},string:function(){return this.next("string")&&this.value}}),c={IS_IOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!d.MSStream,IS_IE10:!!d.ActiveXObject,IS_IE:!!d.ActiveXObject||void 0!==Wa.style.msTouchAction||void 0!==Wa.style.msUserSelect,IS_MAC:navigator.userAgent.indexOf("Macintosh")>=0,IS_TOUCH:"ontouchstart"in d,shim:s},c.helper={extend:u,noop:b,readArgs:j,isArray:p,isFunction:q,isPlainObject:t,each:w,map:x,any:y,single:z,kv:A,makeArray:B,iterate:G,iterateToArray:H,mapGet:J,createPrivateStore:I,getOwnPropertyDescriptors:K,defineGetterProperty:L,defineHiddenProperty:M,definePrototype:N,inherit:O,randomId:P,repeat:Q,camel:R,hyphenate:S,ucfirst:T,lcfirst:U,trim:V,matchWord:W,tagName:X,is:Y,isVisible:Ba,sameElementSpec:Z,comparePosition:$,connected:_,containsOrEquals:aa,getCommonAncestor:ba,createRange:da,rangeCovers:fa,rangeEquals:ga,rangeIntersects:ea,compareRangePosition:ha,makeSelection:ia,getRect:ja,getRects:ka,toPlainRect:la,rectEquals:ma,rectCovers:na,pointInRect:oa,mergeRect:pa,elementFromPoint:qa,createDocumentFragment:ra,createTextNode:sa,createElement:ta,createNodeIterator:ua,getState:za,setState:Aa,getZIndex:Ca,getZIndexOver:Da,setZIndexOver:Ea,cssFromPoint:Fa,cssFromRect:Ga,runCSSTransition:La,position:Ha,removeNode:ya,bind:wa,unbind:xa,when:Va,waitAll:C,reject:D,always:E}}(),function(){function b(a,b){return i.abs(i.round(a/b)-a/b)<.2}function j(a){return a.isContentEditable||va(a,"input,textarea,select")}function l(a){if(!qa(e,a))return!1;for(;a!==e&&"none"!==r(a).display;a=a.parentNode);return a===e}function m(a){for(var b=[];a&&a!==e&&b.push(a);a=a.parentNode||a.parent);return b}function n(){var a=(da||d.event||"").type||"";return"k"===a[0]||"com"===a.substr(0,3)?"keyboard":"t"===a[0]?"touch":"m"===a[0]||Da(a,"wheel click dblclick contextmenu")?"mouse":Da(a,"drop cut copy paste")||"script"}function o(a){var b=ba||new K(Ka[0]),c=function(a){return function(){var c=ba;try{return ba=b,a.apply(this,arguments)}finally{ba=c}}};return{then:function(b,d){return a.then(b&&c(b),d&&c(d))},catch:function(b){return a.catch(b&&c(b))}}}function t(a){for(var b=a;b&&!Ia.has(b);b=b.parentNode);return Ca(Ia,b)||_}function u(a,b){return a===d?!ca:La.has(a)&&(!b||qa(a,e.activeElement))}function v(a){var b=Ba(m(a),function(a){return Ja.get(a)});return oa(Ka,function(c){return qa(c,a)||b.indexOf(c)>=0})}function w(b){return Fa(Ma,function(c,d){return a(c).find(b)[0]&&d})}function x(a,b,c,d,e,f){var g=new N(a,_,c,d,b,e,f);return g.emit($,"tap",t(c).element,!1)||g.emit()}function y(a,b,c,d,e){var f=null;return oa(Aa(c),function(c){var g=t(c);if(f!==g){if(f=g,x(a,b,c,d,e))return!0;if(d.char&&j(c))return x("textInput",b,c,d.char,!0)}})}function z(a,b,c,d){sa(b,function(b,e){Ia.has(e)&&x(a,null,e,{relatedTarget:c},!1,d)})}function A(b,c,d,f){if(c&&!va(b,ga)&&(b=a(ga,b).filter(":visible:not(:disabled,.disabled)")[0]||b),f=f||Ka,f[0]){var g=f!==Ka?b:v(b);if(!g){var h=w(b);b=u(h)?f[0]:h,g=v(b)}if(!g)return!1;var i=f.splice(0,f.indexOf(g));sa(i,function(a,b){La.delete(b)}),z("focusout",i,b,d)}if(qa(Ha,b)){var j=m(b).filter(function(a){return!La.has(a)}),k=Ba(j,function(a){return Ja.get(a)})[0];if(k&&!u(k)){var l=A(k);if(void 0!==l)return l&&A(b)}j[0]&&(f.unshift.apply(f,j),sa(j,function(a,b){La.add(b)}),z("focusin",j,null,d||new K(j[0],f)));var n=e.activeElement;return f[0]!==n&&(new G(f[0]).focus(),e.activeElement===n&&n.blur()),!0}}function B(a){for(var b;a!==Ha&&(b=r(a))&&"visible"===b.overflow&&Da(b.position,"static relative");a=a.parentNode);return a}function C(a,b){var c=B(a),d=new G(c),e=d.getUnobscuredRect(a);b=b||ua(a);var f=i.max(0,b.right-e.right)||i.min(b.left-e.left,0),g=i.max(0,b.bottom-e.bottom)||i.min(b.top-e.top,0),h=f||g?d.scrollBy(f,g):ia;if(c!==Ha){var j=C(c.parentNode,b.translate(h.x,h.y));j&&(h={x:h.x+j.x,y:h.y+j.y})}return!(!h.x&&!h.y)&&h}function D(a,b){if(ya(a)&&(b.to===d||ya(b.to))){var c=b.dir;if("auto"===c)if(b.to===d)c="center inset";else{var e=ua(),f=ua(B(b.to)),g=[e.height*(f.left-e.left),e.height*(e.right-f.right),e.width*(f.top-e.top),e.width*(e.bottom-f.bottom)];c="left right top bottom".split(" ")[g.indexOf(i.max.apply(null,g))]+" center"}na.position(a,b.to,c)}}function E(a,b){var c=a.clientX-b.clientX,d=a.clientY-b.clientY;return{dx:c,dy:d,deg:i.atan2(d,c)/i.PI*180,length:i.sqrt(c*c+d*d)}}function F(b,c,e){function f(a){clearInterval(g),h(),i(),j[a?"resolve":"reject"]()}var g,h,i,j=a.Deferred(),l=b.touches||[b],m=l[0].clientX,n=l[0].clientY,p=l[1]&&E(l[0],l[1]),q=wa(e||c)||na.noop,r=B(va(c,k)||b.target),s={mouseup:f,touchend:f,keydown:function(a){27===a.which&&f(!1)},mousemove:function(a){a.preventDefault(),a.which||b.touches?a.clientX===m&&a.clientY===n||(m=a.clientX,n=a.clientY,q(m,n)):f(!0)},touchmove:function(a){var b=a.touches;if(p){var c=E(b[0],b[1]);q((c.deg-p.deg+540)%360-180,c.length/p.length,b[0].clientX-m+(p.dx-c.dx)/2,b[0].clientY-n+(p.dy-c.dy)/2)}else q(b[0].clientX,b[0].clientY)}},t={mouseout:function(a){g||qa(r,a.relatedTarget)&&(r!==Ha||a.relatedTarget!==Ha)||(g=setInterval(function(){C(r,na.toPlainRect(m-50,n-50,m+50,n+50))?q(m,n):(clearInterval(g),g=null)},20))},mouseover:function(a){a.target!==Ha&&(clearInterval(g),g=null)}};return h=pa(d,s),i=pa(r,t),o(j)}function G(a){this.element=a}function H(a){(new G)[a]||(G.prototype[a]=function(){var b=this.support(a);return b?b.apply(null,arguments):console.warn("Method "+a+" not handled",this.element)})}function I(a){Pa.push(a),sa(a,function(a,b){wa(b)&&"canHandle"!==a&&"support"!==a&&H(a)})}function J(a,b){var c=(Ca(Ia,a)||"").context,d=c&&(wa(c[b])||wa(c.support)&&wa(c.support(b)));return d?d.bind(c):!!(d=Ca(Qa,a,function(){var b={};return sa(Pa,function(c,d){d.element&&!va(a,d.element)||d.canHandle&&!d.canHandle(a)||ta(b,d)}),b})[b])&&d.bind(a,a)}function K(a,b){var c=this;b=b||(ba?ba.path:Ka.slice(0)),c.path=b,c.source="script",(qa(b[0]||Ha,a)||b.indexOf(a)>=0)&&(c.source=ba?ba.source:n()),c.sourceKeyName="keyboard"!==c.source?null:(ba||aa||"").sourceKeyName}function L(a,b,c,d){var e=ta(this,a.properties);e.eventName=b,e.type=b,e.context=c.context,e.target=qa(a.target,c.element)?c.element:a.target,e.data=null,e.context.typer&&(e.typer=e.context.typer,e.widget=e.context),xa(d)?ta(e,d):void 0!==d&&(e.data=d),Ua(e,a)}function M(a,b,c){var d=this,e={};sa(c,function(a,b){wa(b)&&(e[a]=b)}),d.element=a,d.context=b,d.handlers=e}function N(a,b,c,d,e,f,g){c=c||b.element,g=g||new K(c);var h={source:g.source,sourceKeyName:g.sourceKeyName,timestamp:performance.now(),originalEvent:e||null};ta(this,{container:b,eventName:a,target:c,data:d,bubbles:f,properties:h,sourceObj:g},h)}function O(){this.states={}}function P(a,b){var c=this;a&&Ia.set(a,c),c.element=a||Ha,c.context=b||null,c.components=new la,c.asyncEvents=new la,c.autoDestroy=qa(Ha,a),a&&Ia.set(a,c)}function Q(a){for(a.timeout=null;a.asyncEvents.size;){var b=a.asyncEvents;a.asyncEvents=new la,sa(b,function(a,b){sa(b,function(b,c){xa(a)&&!a.handlers[b]||c.emit(null,null,a)})}),sa(b,function(b,c){var d=Ca(a.components,b.element||b);d&&!d.attached&&a.components.delete(b.element||b)})}}function R(a,b,c){var d=Ca(a.asyncEvents,c);if(d&&d[b]){var e=d[b].data;return delete d[b],e||{data:e}}}function S(a,b,c,d,e,g){var h=Ca(a.asyncEvents,c,f);h[b]=new N(b,a,c.element||c,g&&h[b]?g(h[b].data,d):d,null,e),a.timeout=a.timeout||p(Q,null,a)}function T(a,b,c){var d=["destroy","init"];b.attached^c&&!R(a,d[+!c],b)&&S(a,d[+c],b),b.attached=c}function U(a,b){return a===$||(Ia.get(b)||a)===a}function V(a,b,c){function d(d){var e=[],f=new la;sa(d,function(b,c){("id"!==c.attributeName||"sizzle"!==(c.oldValue||"").slice(0,6)&&c.target.id!==(c.oldValue||""))&&(qa(a.element,c.target)?U(a,c.target)&&(sa(c.removedNodes,function(a,b){f.has(b)&&e.push.apply(e,f.get(b))}),e.push(c)):Ca(f,c.target,h).push(c))}),e=e.filter(function(a){return c[a.type]}),e[0]&&b(e)}var e=ta({},c);e.subtree=!0,e.childList=!0,e.attributeOldValue|=c.attributes;var f=new ja(d);return f.observe(a.element,e),function(){d(f.takeRecords())}}function W(a,b){for(var c,d=b;d&&!c;d=d.parentNode)c=a.components.get(d);return c||null}function X(a,b,c){var d=Ca(a.components,b,O);if((d.context||c)!==c)throw new Error("Element has already been set to another context");return d.element=b,d.context=c,d}function Y(a){this.element=a,Na.set(a,this),Ua(this,{promises:new la})}function Z(a,b){var c;return function(){return c||(c=Ga(a()).then(b,function(){return c=null,Ea("user_cancelled")}))}}var $,_,aa,ba,ca,da,ea,fa=JSON.parse('{"8":"backspace","9":"tab","13":"enter","16":"shift","17":"ctrl","18":"alt","19":"pause","20":"capsLock","27":"escape","32":"space","33":"pageUp","34":"pageDown","35":"end","36":"home","37":"leftArrow","38":"upArrow","39":"rightArrow","40":"downArrow","45":"insert","46":"delete","48":"0","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","55":"7","56":"8","57":"9","65":"a","66":"b","67":"c","68":"d","69":"e","70":"f","71":"g","72":"h","73":"i","74":"j","75":"k","76":"l","77":"m","78":"n","79":"o","80":"p","81":"q","82":"r","83":"s","84":"t","85":"u","86":"v","87":"w","88":"x","89":"y","90":"z","91":"leftWindow","92":"rightWindowKey","93":"select","96":"numpad0","97":"numpad1","98":"numpad2","99":"numpad3","100":"numpad4","101":"numpad5","102":"numpad6","103":"numpad7","104":"numpad8","105":"numpad9","106":"multiply","107":"add","109":"subtract","110":"decimalPoint","111":"divide","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numLock","145":"scrollLock","186":"semiColon","187":"equalSign","188":"comma","189":"dash","190":"period","191":"forwardSlash","192":"backtick","219":"openBracket","220":"backSlash","221":"closeBracket","222":"singleQuote"}'),ga=":input, [contenteditable], a[href], area[href], iframe",ha=[16,17,18,91,93],ia={x:0,y:0},ja=s.MutationObserver,ka=s.WeakMap,la=s.Map,ma=s.Set,na=c.helper,oa=na.any,pa=na.bind,qa=na.containsOrEquals,ra=na.definePrototype,sa=na.each,ta=na.extend,ua=na.getRect,va=na.is,wa=na.isFunction,xa=na.isPlainObject,ya=na.isVisible,za=na.kv,Aa=na.makeArray,Ba=na.map,Ca=na.mapGet,Da=na.matchWord,Ea=na.reject,Fa=na.single,Ga=na.when,Ha=e.documentElement,Ia=new ka,Ja=new ka,Ka=[],La=new ma,Ma=new la,Na=new ka,Oa=new la,Pa=[],Qa=new ka,Ra=new ka,Sa={},Ta={},Ua=na.createPrivateStore();ra(G,{support:function(a){return J(this.element,a)}}),ra(L,{handled:function(a){var b=Ua(this);b.handled||(b.handled=Ga(a))},isHandled:function(){return!!Ua(this).handled},preventDefault:function(){var a=this.originalEvent;a?a.preventDefault():Ua(this).defaultPrevented=!0},isDefaultPrevented:function(){return!!(this.originalEvent||Ua(this)).defaultPrevented}}),ra(N,{emit:function(a,b,c,d){var e=this;a=a||e.container,d=void 0===d?e.bubbles:d;var f=function(b,c,d,g){if("init"===c||"destroy"===c){if(b.lastEvent===c)return!1;b.lastEvent=c}if(Da(c||d,"keystroke gesture")&&f(b,null,g.data,null))return e.handled;var h=b.handlers[c||d];if(!h)return!1;var i=va(b.context,P)||a,j=new L(e,d,b,void 0===g?R(a,d,b):g),k=ba,l=i.event;i.event=j,ba=e.sourceObj;try{var m=h.call(j.context,j,j.context);void 0!==m&&(e.handled=Ga(m))}catch(a){console.error(a),e.handled=Ea(a)}return ba=k,i.event=l,e.handled};if(va(c,M))return f(c,b,e.eventName,e.data);var g=a.getContext(c||e.target);return Fa((d?m:Aa)(g),function(c){var d=a.components.get(c.element||c);return d&&Fa(d.states,function(a){return f(a,b,e.eventName,e.data)})})}}),ra(P,{event:null,tap:function(a){$.setContext(this.element,this),$.add(this.element,{tap:a})},getContext:function(a){return(W(this,a)||"").context},setContext:function(a,b){X(this,a,b),this!==$&&va(a,k)&&Ia.set(a,this)},add:function(a,b,c){"string"!=typeof b&&(c=b,b=na.randomId());var d=this,e=va(a,k)||a.element||a,f=va(e,k)?W(d,e):X(d,a,a);if(f){var g=f.states[b]||new M(e,va(a,k)?f.context:a,c);f.attached=!0,f.states[b]=g,T(d,g,!0)}},delete:function(a,b){var c=this,d=Ca(c.components,a);if(d)if(b){var e=d.states[b];e&&(delete d.states[b],T(c,e,!1))}else d.attached=!1,sa(d.states,function(a,b){T(c,b,!1)})},observe:function(a,b){return V(this,a,b)},emit:function(a,b,c,d){return(va(a,L)?Ua(a):new N(a,this,b,c,null,d)).emit(this,null,b,d)},emitAsync:function(a,b,c,d,e){S(this,a,b||this.element,c,d,e)},flushEvents:function(){Q(this)},destroy:function(){var a=this;$.delete(a.element),Ia.delete(a.element),sa(a.components,function(b,c){Ia.delete(b),a.emit("destroy",b)})}}),ra(Y,{get locked(){return Ua(this).promises.size>0},cancel:function(a){var b=this,c=Ua(b),d=c.promises;return a||!d.size?(d.size&&x("cancelled",null,b.element),d.clear(),c.handler=null,c.deferred&&c.deferred.resolve(),Ga()):(c.handler||(c.handler=Z(function(){return Aa(d).reduce(function(a,b){return a.then(b)},Ga()).then(function(){b.cancel(!0)})})))()},wait:function(b,c){var d=this,e=Ua(d),f=e.promises,g=function(){f.delete(b)&&!f.size&&(x("asyncEnd",null,d.element),d.cancel(!0))};if(f.set(b,Z(!0===c?Ga:c||Ea,g)),1===f.size){e.deferred=a.Deferred();for(var h=d.element.parentNode;h&&!Na.has(h);h=h.parentNode);h&&Na.get(h).wait(e.deferred,d.cancel.bind(d)),x("asyncStart",null,d.element)}return b.catch(function(a){a&&!Ra.has(a)&&(x("error",null,d.element,{error:a},!0),"object"==typeof a&&Ra.set(a,!0)),g()}),b.then(function(a){var c=!f.has(b);return g(),c?Ea("user_cancelled"):a})}}),$=new P,_=new P;var Va={drag:F,prepEventSource:o,scrollIntoView:C,focused:u,get event(){return da},get activeElement(){return Ka[0]},get eventSource(){return n()},getEventSource:function(a){return new K(a).source},getContext:function(a){return t(a||Ka[0]).context},focus:function(a){A(a,!0)},setModal:function(a,b){var c=va(b,k)||Ha;u(c)||A(c),Ma.set(a,Ka.splice(0,c===Ha||e.body?Ka.length:Ka.indexOf(c))),A(a)},lock:function(a,b,c){var d=Na.get(a)||new Y(a);return b?d.wait(b,c):Ga()},locked:function(a,b){return!!oa(b?m(a):[a],function(a){return(Na.get(a)||"").locked})},cancel:function(a,b){var c=Na.get(a);return c?c.cancel(b):Ga()},emit:function(a,b,c,d){return x(a,null,b,c,d)},on:function(a,b,c){va(a,k)||(c=b,b=a,a=Ha),_.setContext(a,a),_.add(a,xa(b)||za(b,c))},retainFocus:function(a,b){Ja.set(b,a)},releaseFocus:function(a,b){Ja.delete(b)},mixin:function(a){return va(a,k)?new G(a):I(a)},support:function(a,b){var c=t(Ka[0]);return Fa(Ka,function(d){return(!b||t(d)!==c)&&J(d,a)})},snap:function(a,b,c){b=b||Ha;var f={to:b,dir:c||"left bottom"};Oa.set(a,f),qa(Ha,a)||e.body.appendChild(a),na.setZIndexOver(a,b===d?e.body:b),D(a,f)},unsnap:function(a){Oa.delete(a)},getShortcut:function(a){return Ta[a]?Ta[a].slice(0):[]},setShortcut:function(a,b){if(xa(a))return void sa(a,Va.setShortcut);var c=Ta[a]||(Ta[a]=[]),d=c.slice(0);sa(b,function(b,e){var f=d.indexOf(e);f>=0?d.splice(f,1):(c[c.length]=e,(Sa[e]||(Sa[e]={}))[a]=!0)}),sa(d,function(b,d){c.splice(c.indexOf(d),1),delete Sa[d][a]})}};c.Container=P,c.dom=Va,Va.setShortcut({undo:"ctrlZ",redo:"ctrlY ctrlShiftZ",selectAll:"ctrlA"}),Va.on("keystroke",function(a){var b=Fa(Sa[a.data],function(a,b){return Va.support(b)});return b&&a.handled(b())}),Va.on("escape",function(a){A(e.body)}),Va.lock(e),d.onbeforeunload=function(a){Va.locked(e)&&(a.returnValue="",a.preventDefault())},a(function(){function f(a,b){var c=(a.ctrlKey||a.metaKey?"Ctrl":"")+(a.altKey?"Alt":"")+(a.shiftKey?"Shift":"");return c?na.lcfirst(c+na.ucfirst(b)):b}function h(){var a=e.activeElement;if("selectionEnd"in a)H=a,I=a.selectionEnd;else if(H=L.anchorNode,I=L.anchorOffset,1===H.nodeType){var b=H.childNodes[I-1];b&&3===b.nodeType?(H=b,I=b.length):(H=H.childNodes[I],I=0)}}function k(a,b,c){var d={data:a,char:b};if(aa.sourceKeyName=a,y("keystroke",c,Ka,d,!0))return c.preventDefault(),!0}function m(a,b){var c=C||b;return x(a,b,b.target,{target:b.target,clientX:c.clientX,clientY:c.clientY,metakey:f(b)})}function n(a,b){return C=null,y("gesture",b,Ka.slice(-1),a)}function o(a,b,c){var d=e.createEvent("MouseEvent");return d.initMouseEvent(a,c.bubbles,c.cancelable,c.view,c.detail,b.screenX,b.screenY,b.clientX,b.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget),na.elementFromPoint(b.clientX,b.clientY).dispatchEvent(d)}function s(a){var b=function(a,b){var c=a.get(b);return a.delete(b),c};sa(a,function(a,c){sa(c.removedNodes,function(a,c){if(1===c.nodeType&&!qa(Ha,c)){var d=Ia.get(c);d&&d.autoDestroy&&d.element===c&&d.destroy();var e=b(Na,c);e&&e.cancel(!0);var f=b(Ma,c);if(f&&u(c)){var g=oa(Ma,function(a){return a.indexOf(c)>=0})||Ka;g.push.apply(g,f),A(f[0],!1,null,g)}var h=Ka.indexOf(c);h>=0&&A(Ka[h+1]||M),sa(Oa,function(a,b){(qa(c,a)||qa(c,b.to))&&Oa.delete(a)})}})}),w()}function w(){O=O||p(function(){O=null,sa(Oa,D)})}var z,B,C,F,G,H,I,J,L=d.getSelection(),M=e.body;c.IS_IE10&&pa(M,"mousedown mouseup mousemove mouseenter mouseleave click dblclick contextmenu wheel",function(a){"none"===r(a.target).pointerEvents&&(a.stopPropagation(),a.stopImmediatePropagation(),a.bubbles&&o(a.type,a,a)||a.preventDefault())},!0),pa(d,"mousedown mouseup wheel compositionstart compositionend beforeinput textInput keydown keyup keypress touchstart touchend cut copy paste drop click dblclick contextmenu",function(a){da=a,p(function(){da=null}),aa=null,v(a.target)||(a.stopImmediatePropagation(),a.preventDefault(),Da(a.type,"touchstart mousedown keydown")&&x("focusreturn",null,Ka.slice(-1)[0])),aa=new K(a.target)},!0),pa(Ha,{compositionstart:function(a){h(),J=""},compositionupdate:function(a){J=a.data},compositionend:function(a){var b="selectionEnd"in H,c=J,d=I;h();var e=H.value||H.data||"";(J=a.data)&&!/^\u3000+$/.test(J)||(J=e.slice(d,I));var f=I-J.length,g=I-c.length,i=I;e.slice(f,I)===J?i=f:e.slice(g,I)===c?i=g:e.substr(I,J.length)===J&&(I+=J.length);var j=e.substr(0,i)+e.slice(I);b?(H.value=j,H.setSelectionRange(i,i)):(H.data=j,na.makeSelection(H,i)),y("textInput",a,Ka[0],J)||(b?(H.value=e,H.setSelectionRange(I,I)):(H.data=e,na.makeSelection(H,I))),H=null,p(function(){J=null})},textInput:function(a){H||a.data!==J&&!y("textInput",a,Ka[0],a.data)||a.preventDefault()},keydown:function(a){if(!H){var b=a.keyCode,c=ha.indexOf(b)>=0;c&&b!==B&&y("metakeychange",a,Ka,f(a),!0);var d=!c&&(fa[b]||"").length>1&&!(b>=186||b>=96&&b<=111);z=a.ctrlKey+a.shiftKey+a.altKey+a.metaKey+!c,z*=d||(z>2||z>1&&!a.shiftKey)&&!c,B=b,z&&k(f(a,fa[b]||a.key),32===b?" ":"",a)}},keyup:function(a){var b=ha.indexOf(a.keyCode)>=0;H||!b&&B!==a.keyCode||(B=null,z--,b&&y("metakeychange",a,Ka,f(a)||"",!0))},keypress:function(a){var b=a.char||a.key||g.fromCharCode(a.charCode);H||z||!a.synthetic&&"onbeforeinput"in a.target||k(f(a,fa[B]||b),b,a)},beforeinput:function(a){if(!H&&a.cancelable)switch(a.inputType){case"insertText":return y("textInput",a,Ka[0],a.data);case"deleteContent":case"deleteContentBackward":return k("backspace","",a)
;case"deleteContentForward":return k("delete","",a)}},touchstart:function(a){C=ta({},a.touches[0]),a.touches[1]||(u(t(a.target).element)&&m("mousedown",a),G=p(function(){C&&(m("longPress",a),C=null)},1e3))},touchmove:function(a){if(q(G),G=null,C)if(a.touches[1])a.touches[2]||n("pinchZoom",a);else{var c=E(a.touches[0],C);c.length>50&&b(c.deg,90)&&n("swipe"+(b(c.deg,180)?c.dx>0?"Right":"Left":c.dy>0?"Bottom":"Top"),a)}},touchend:function(a){q(G),C&&G&&(A(a.target),m("click",a),o("click",C,a),a.preventDefault())},mousedown:function(a){A(a.target),1===(a.buttons||a.which)&&m("mousedown",a),C=a,F=e.activeElement},mousemove:function(a){C&&E(a,C).length>5&&(C=null)},mouseup:function(a){F&&e.activeElement!==F&&F.focus()},wheel:function(a){if(qa(a.target,Ka[0])||!j(a.target)){var b=a.deltaY||a.detail;b&&y("mousewheel",a,a.target,b/i.abs(b)*(c.IS_MAC?-1:1),!0)&&a.preventDefault()}},click:function(a){!c.IS_TOUCH&&C&&m("click",a)},contextmenu:function(a){m("rightClick",a)},dblclick:function(a){m("dblclick",a)},focusin:function(a){ca=!1,v(a.target)?A(a.target,!1,aa):a.target.blur()},focusout:function(a){if(!a.relatedTarget&&!l(a.target)){var b=oa(Ka.slice(Ka.indexOf(a.target)+1),l);b&&A(b,!1,aa)}}},!0),pa(d,{wheel:function(a){for(var b=-a.deltaX,c=-a.deltaY,d=a.target;d!==M;d=d.parentNode){var e=r(d);if(d.scrollWidth>d.offsetWidth&&Da(e.overflowX,"auto scroll")&&(b>0&&d.scrollLeft>0||b<0&&d.scrollLeft+d.offsetWidth<d.scrollWidth))break;if(d.scrollHeight>d.offsetHeight&&Da(e.overflowY,"auto scroll")&&(c>0&&d.scrollTop>0||c<0&&d.scrollTop+d.offsetHeight<d.scrollHeight))break}v(d)||a.preventDefault()},blur:function(a){a.target===d&&(ca=!0)}}),new ja(s).observe(Ha,{subtree:!0,childList:!0}),A(e.activeElement);var N=a('<div style="overflow:scroll;height:80px"><div style="height:100px"></div></div>').appendTo(M);ea=N.outerWidth()-N.children().width(),N.remove();var O;pa(d,"resize scroll orientationchange mousemove wheel keyup touchend transitionend",w,{passive:!0})}),"undo redo canUndo canRedo enable disable enabled".split(" ").forEach(H),I({focus:function(a){a.focus()},scrollBy:function(b,c,f){var g=b===Ha||b===e.body?d:b,h=a(g).scrollLeft(),i=a(g).scrollTop();return g.scrollBy?g.scrollBy(c,f):(g.scrollLeft=h+c,g.scrollTop=i+f),{x:a(g).scrollLeft()-h,y:a(g).scrollTop()-i}},getUnobscuredRect:function(a){var b=r(a),c=a.offsetWidth<a.scrollWidth,d=a.offsetHeight<a.scrollHeight,f=ua(a===e.body?Ha:a);return"visible"===b.overflow&&a!==e.body||!c&&!d||(("scroll"===b.overflowY||("hidden"!==b.overflowY||a===e.body)&&d)&&(f.right-=ea),("scroll"===b.overflowX||("hidden"!==b.overflowX||a===e.body)&&c)&&(f.bottom-=ea)),f}}),I({element:":input",getValue:function(a){return a.value},setValue:function(a,b){a.value=b}})}(),function(){function b(a,b){var c=this;vb(c,{}),c.typer=a,c.baseCaret=new v(a,c),c.extendCaret=new v(a,c),b&&c.select(b)}function h(a,b,c,d){var e=this;e.id=b,e.typer=a,e.element=c||a.element,e.options=d}function l(a,b,c,d){var e=this;e.typer=a,e.childNodes=[],e.nodeType=b,e.element=c,e.widget=d}function t(a,b,c){var d=this;d.whatToShow=b,d.filter=c||null,d.currentNode=a,d.root=a}function u(a,b,c){var d=this;d.whatToShow=b,d.filter=c||null,Z(d,a)}function v(a,b){this.typer=a,this.selection=b||null}function w(a,b,c){this.typer=a,this.selection=a.getSelection(),this.widget=b||null,this.commandName=c||null}function x(a,b){return b=b||a.currentNode,b&&a.whatToShow&(Ta(a,t)?b.nodeType:1<<b.nodeType-1)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b):1:3}function y(a,b){return a[b<0?"previousNode":"nextNode"]()}function z(a){return g(a||"").replace(/[^\S\u00a0]+/g," ").replace(/\u200b/g,"")}function A(a){return a&&1===a.nodeType&&a}function B(a){return a&&3===a.nodeType&&a}function C(a){return"br"===bb(a)&&a}function D(a){return/^inline-?/.test(r(a).display)&&a}function E(a,b){if(/[\S\u00a0]/.test(a.data))return!0;var c=function(a,b){for(;!a[b];)if(!(a=a.parentNode)||!D(a))return!1;return B(a[b])?E(a[b],b):D(a[b])};return c(a,b||"previousSibling")&&!b&&c(a,"nextSibling")}function F(a,b,c){var d=a.data;return!E(a)||(c>=0&&(b===a.length||d.slice(b)===la)?1:c<=0&&(!b||d.slice(0,b)===la)?-1:0)}function G(a,b){return!!ib.test(a)||!/[^\s!-\/:-@\[\]^_`{|}~]/.test(a)&&b}function H(a){var b=r(A(a)||a.parentNode);return fb[b.getPropertyValue("writing-mode")]^("rtl"===b.direction?2:0)}function I(a,b){for(;a&&!Ta(a,b);a=a.parentNode);return Ta(a,pa)?a.typer.getNode(a.widget.element):a}function J(a,b){var c=a.length||a.childNodes.length;return 1/b<0?i.max(0,c+b):i.min(c,b)}function K(a,b){for(var c,d=new u(new t(a,Aa),5),e=0;(c=d.nextNode())&&c!==b;e+=c.length||0);return e}function L(a,b){var c=b/i.abs(b);b/=c;var d=2&b?-1:1,e=4&b?-1:1;c>0&&1&b&&(d^=e,e^=d,d^=e);var f=d<0?"right":"left",g=e<0?"bottom":"top";return a=1&b?cb(a[g]*e,a[f]*d,a[eb[g]]*e,a[eb[f]]*d):cb(a[f]*d,a[g]*e,a[eb[f]]*d,a[eb[g]]*e)}function M(a,b){b=+b===b?b:H(b),a=+a===a?a:hb.indexOf(a);var c=a>>1&1^1&b?"left":"top";return!!(gb[a>>1]&1<<b)^1&a?eb[c]:c}function N(a){if(nb.rangeCount){var b=nb.getRangeAt(0);return Ha(a,b.commonAncestorContainer)&&b}}function O(a,b){switch(b){case"uppercase":return a.toUpperCase();case"lowercase":return a.toLowerCase();case"capitalize":return a.replace(/\b(.)/g,function(a){return a.toUpperCase()})}return a}function P(a,b){a.data!==b&&(a.data=b)}function Q(b,c){return Pa(c,function(c,d){b=a(d.cloneNode(!1)).append(b)[0]}),Ta(b,k)||Ia(b)}function R(b){var c=r(A(b)||b.parentNode),d=[c.fontFamily,c.fontWeight,c.fontStyle].join("|");if(!rb[d]){var f=a('<div style="position:fixed;font-size:1000px;"><span style="display:inline-block;width:0;height:0;"></span>&nbsp;</div>').css({fontFamily:c.fontFamily,fontWeight:c.fontWeight,fontStyle:c.fontStyle}).appendTo(e.body),g=f.children(),h=Ra(f[0]).top;rb[d]={baseline:(Ra(g.css("vertical-align","baseline")[0]).top-h)/1e3,height:(Ra(g.css("vertical-align","text-bottom")[0]).top-h)/1e3,middle:(Ra(g.css("vertical-align","middle")[0]).top-h)/1e3,wsWidth:f.width()/1e3},f.remove()}var i=o(c.fontSize);return{fontSize:i,baseline:rb[d].baseline*i,height:rb[d].height*i,middle:rb[d].middle*i,wsWidth:rb[d].wsWidth*i}}function S(){var b=a.grep(arguments,Ua);return function(a){for(var c=1,d=0,e=b.length;d<e;d++){var f=b[d](a);if(2===f)return 2;c|=f}return c}}function T(n,o){function r(){Y.emit("stateChange",T.focusNode.widget.element,null,!0)}function s(a,b,c){var d=Z[a];return!(b in d)||"*"===d[b]||(" "+d[b]+" ").indexOf(" "+c+" ")>=0}function x(a,b){return b=I(b,xa),Z[a]&&Z[a].element&&(Z[a].inline||!Ta(b,ra))&&s(a,"allowedIn",b.widget.id)&&s(b.widget.id,"allow",a)}function D(a){var b=T.getWidgets().reverse().concat($);return Fa(b,function(b){return Z[b.id]&&Ua((Z[b.id].commands||{})[a])})}function F(b,d){function g(){u=null,ca&&H(),_.snapshot()}function i(a,b){var c=new h(w,b,a,Qa({},Z[b].options));return a!==n&&Y.getContext(a)&&Y.delete(a),d&&(Y.setContext(a,c),Y.add(a,c.id,Z[c.id])),c}function j(a,b){for(var c=a.childNodes,d=c.length;d&&Ga(b.element,c[d-1].element)<=0;d--);if(c[d]!==b)return b.parentNode?k(b):Va(new t(b,-1),function(a){var b=a.widget;tb.delete(a.element),b.element===a.element&&Y.add(a.element,b.id,Z[b.id])}),c.splice(d,0,b),b.parentNode=a,b.previousSibling=c[d-1]||null,b.nextSibling=c[d+1]||null,(b.previousSibling||{}).nextSibling=b,(b.nextSibling||{}).previousSibling=b,!0}function k(a,b){var c=a.parentNode,d=a.previousSibling,e=a.nextSibling;c.childNodes.splice(c.childNodes.indexOf(a),1),(d||{}).nextSibling=e,(e||{}).previousSibling=d,a.parentNode=null,a.nextSibling=null,a.previousSibling=null,b&&Va(new t(a,-1),function(a){tb.set(a.element,{node:(d||e||c).element,offset:!d&&(!!e||0)}),a.widget.element===a.element&&Y.delete(a.element)})}function o(a){var b=a.widget,c=a.parentNode,d=function(b){return Ta(a.element,Z[b].element)&&b};if(a.widget=(b||"").element!==a.element?c.widget:b,!Ta(c,pa|ua)){var e=Fa(f.keys(Z),d)||d(oa);!e||a.widget!==c.widget&&a.widget.id===e||(a.widget=i(a.element,e))}b&&b!==a.widget&&Y.delete(a.element,b.id);var g=Z[a.widget.id];a.widget!==c.widget||Ta(c,pa|ua)?Ta(a.element,g.editable)||g.inline&&!g.editable?a.nodeType=g.inline?va:Ta(a.element,ka)?ra:qa:a.nodeType=g.inline&&a.widget!==c.widget&&Ta(c,Aa)?ua:pa:a.nodeType=Ta(a.element,ka)?sa:ta}function q(b,c){Pa(b.childNodes.slice(0),function(a,c){Ha(b,c)||k(c,!0)}),a(b.element).children().not("br").each(function(a,d){var e=x.get(d)||new l(w,0,d);x.set(d,e),(j(b,e)||c)&&(o(e),q(e,!0))})}function r(a){var c=T&&!aa,d=new Ca;Pa(a,function(a,e){var f=x.get(A(e.target)||e.target.parentNode);if(f){var g=Ha(b,e.target);!e.addedNodes[0]&&!e.removedNodes[0]||d.has(f)||(d.add(f),g&&q(f)),!c||!g||"style"===e.attributeName||e.attributeName&&e.target===b||(f.widget.id!==na&&Y.emitAsync("contentChange",f.widget.element),Y.emitAsync("contentChange",n),ca=!0)}}),d.size&&T&&ba(function(){var a,b=T.getRange();d.forEach(function(c){a|=Za(b,c.element)}),a&&T.select(T)}),ca&&!aa&&(u=u||p(g))}function s(a){if(c.IS_IE10&&!Ha(e,b)?q(y,!0):U(),(B(a)||C(a))&&(a=a.parentNode||a),Ha(b,a)){var d=x.get(a);return Ta(d,pa)?x.get(d.widget.element):d}}var u,v={},w=Ha(n,b)?W:v,x=new Ba;d&&(U=Y.observe(r,{childList:!0,attributes:!0,characterData:!0})),b.parentNode||(b=Ta(b,m)||Ia(b));var y=new l(w,X,b,i(b,na));return x.set(b,y),q(y),Qa(v,{rootNode:y,getNode:s})}function G(a){for(var b=Wa(Ka(a,4));b[0];){for(var c="",d=[],e=0;++e<b.length&&b[e].previousSibling===b[e-1];);Pa(b.slice(0,e),function(a,b){E(b)&&(c+=b.data),d[a]=c.length}),c=c.replace(/(\s+)(\S?)/g,function(a,b,c,d){var e=c?b[2]?"  ":"":" ";return Da.repeat(d?"  ":"  ",b.length).slice(0,b.length-e.length)+e+c}),Pa(b.splice(0,e),function(a,b){P(b,c.slice(d[a-1]||0,d[a]))})}}function H(){U(),ca&&(aa=!0,Va(new t(W.rootNode,Aa|qa|wa),function(b){var c=b.element;if(Ta(b,qa))return b.firstChild?void a(c).contents().each(function(b,d){if(d.parentNode===c){for(var e=[];d&&(B(d)||C(d)||Ta(W.getNode(d),za));d=d.nextSibling)(e.length||A(d)||db(d.data))&&e.push(d);e.length&&a(e).wrap("<p>")}}):void a(c).html("<p>"+(db(c.textContent)||ma)+"</p>");if(Ta(b,sa|ra)){if(!c.firstChild)return void a(Ma()).appendTo(c);var d=a(">br:last-child",c)[0];d&&!d.nextSibling&&(a(Ma()).insertBefore(d),_a(d));var e=a(">br:first-child",c)[0];e&&!e.previousSibling&&_a(e),(!T||T.startNode!==b&&T.endNode!==b)&&Pa(Wa(Ka(c,4)),function(a,b){P(b,z(b.data)||la),B(b.nextSibling)&&(b.nextSibling.data=z(b.data+b.nextSibling.data),_a(b))})}!Ta(b,ta)||T&&(T.startElement===c||T.endElement===c)||db(c.textContent)||_a(c),a(">br",c).each(function(b,c){B(c.nextSibling)||a(Ma()).insertAfter(c)})}),a('br[type="_moz"]',n).remove(),U(),aa=!1,ca=!1,T&&T.select(T))}function J(c,d,e){var f="cut"===d?"extractContents":"paste"===d?"deleteContents":"cloneContents",g="paste"!==d,h="copy"!==d,i=Ia(),j=Ta(c,b)?c.clone():new b(W,c),k=T.timestamp;if(c=j.getRange(),!j.isCaret){var l=[[n,i]],o=function(){var a=l.shift();a[2]&&a[2].element===a[0]&&Y.emit("extract",a[2].element,{extractedNode:a[1]})};for(Va(j.createTreeWalker(-1,function(b){var d=b.element,e=Ta(b,pa|qa|ra)&&Z[b.widget.id].extract,i=b.widget.element===d;if((!e||b===j.focusNode)&&!i&&Ta(b,qa))return 3;for(;!Ha(l[0][0],d);)o();if(!e||i&&Ya(c,d)||(i?a(d):a(d).parentsUntil(l[0][0]).addBack()).each(function(a,c){l.unshift([c,c.cloneNode(!1),b.widget]),l[1][1].appendChild(l[0][1])}),Ya(c,d)){var k=d===l[0][0],n=h?d:d.cloneNode(!0);return h&&!k&&Ta(b,ra)&&(n=a(d.cloneNode(!1)).append(d.childNodes[0])),a(l[0][1]).append(k?n.childNodes:n),2}if(Ta(b,Aa)){var p=La(d,c)[f](),q=Ta(p,m)?p.firstChild:p,r=Ta(q,bb(d)),s=!e;return g&&q&&(!r&&s?p=Q(p,[Ta(b,ra)?Ja("p"):d]):r&&!s&&(p=Ia(q.childNodes)),a(l[0][1]).append(p)),2}return 1}));l[0];o());}if(h){if(T.timestamp!==k?j=T:j.direction>0?j.select(c):(j.select(La(c,!1)),j.extendCaret.moveTo(La(c,!0))),!j.isSingleEditable){var p=j.createTreeWalker(xa,function(a){return Z[a.widget.id].textFlow?1:3}),q=I(j.baseCaret.node,xa),r=I(j.extendCaret.node,xa);for(p.currentNode=q;y(p,j.direction););p.currentNode!==r&&(p.currentNode!==q?j.extendCaret.moveTo(p.currentNode.element,0*-j.direction):j.collapse())}T.select(j)}return Ua(e)&&e(j),a(i).find("[style]").removeAttr("style"),H(),i}function K(b,c){var d;Ta(c,k)?(Ha(n,c)&&_a(c),c=Da.makeArray(Ia(c).childNodes),d=1===c.length&&!!Ta(c[0],"p:not([class])")):(c=a(g(c||"").replace(/\u000d/g,"").replace(/</g,"&lt;").replace(/\n{2,}/g,"</p><p>").replace(/\n/g,"<br>").replace(/.*/,"<p>$&</p>").replace(/\s/g," ")).get(),d=!0),J(b,"paste",function(b){var e,f=b.startNode,g=b.endNode,h=b.getCaret("start").clone(),i=La(I(f,xa).element,0),j=!!Ta(f,ra),k=!!Ta(f,Aa),m=!0,n=[],o=W.getNode(b.startElement);if(Ta(o,za)){for(;o!==f;o=o.parentNode)Ta(o,ta)&&n.push(o.element);n.push(f.element)}else Ta(o,sa)?n[0]=f.element:Ta(o,ra)||(n[0]=Ja("p"));if(Pa(c,function(b,g){var o,p=W.getNode(h.element),q=new l(W,d?sa:ta,g),r=!!C(g),s=!1,t=!1;if(!r&&A(g)&&(i.insertNode(g),q=W.getNode(g),_a(g),q.widget!==p.widget))for(var u=p;Ta(u,za|sa)||Ta(u,ra)&&u===p;u=u.parentNode){if(1===c.length&&q.widget.id===u.widget.id){var v={receivedNode:g,caret:h.clone()};if(Y.emit("receive",u.widget.element,v))return h=T.clone(),void(e=!0)}if(!x(q.widget.id,u)){var w=q.widget.id===oa?z(db(g.textContent)):L(g);if(!w)return;g=Ma(w),q=new l(W,ta,g);break}}if(!Ta(p,xa)){if(r){for(s=!Ta(p,sa);Ta(p.parentNode,za);p=p.parentNode);o=La(p.element,!1)}else Ta(q,za)||(p=I(p,sa)||p,o=La(p.element,!1),Ta(q,sa)?(t=!d&&!j&&Ta(p,sa)&&!ab(q.element,p.element)&&!!db(g.textContent),s=!m||t&&!!db(La(La(p.element,!0),La(h))),m=!t,k=k&&m):db(La(La(p.element,!0),La(h)))&&((s=db(La(o,La(h))))||(p=p.nextSibling||p.parentNode,h.moveTo(o))));if(s){var y=La(La(h),o).extractContents();db(y.textContent)||(y=Ia(Q(Ma(),n)));var B=y.firstChild;o.insertNode(y);for(var D=W.getNode(B);D&&!db(D.element.textContent);D=D.firstChild)if(Ta(D,ua|va)){a(D.element.childNodes).insertBefore(D.element),_a(D.element);break}if(Ta(p,Aa)&&!(p.element.firstChild||"").length&&a(Ma()).appendTo(p.element),db(p.element.textContent)&&" "===p.element.textContent.slice(-1)&&G(p.element),db(B.textContent)&&" "===B.textContent.charAt(0)&&G(B),r)return La(B,!0).insertNode(g),void h.moveTo(B,0);p=W.getNode(B),h.moveTo(B,0),e=!0}}if(k=k&&!!Ta(q,Aa|za)){var E=Da.makeArray(m&&!Ta(q,za)?g.childNodes:g);E[0]&&(h.getRange().insertNode(Ia(E)),G(p.element),h.moveTo(E[E.length-1],-0)),m=j}else Ta(q,za)&&(g=Q(g,n)),(e||!Ta(f,pa)||db(g.textContent))&&(Ta(p,xa)&&!Ta(p.parentNode,xa)?a(g).appendTo(p.element):a(g).insertBefore(p.element),k=!!Ta(q,Aa|za),m=t||!k,h.moveTo(g,!m&&-0)),e=!0}),!e&&f!==g)if(L(f.element)){if(Ta(f,sa)&&Ta(g,sa)){var p=Ia(La(g.element,"contents").extractContents()),q=p.firstChild;for(h.moveTo(f.element,-0),La(f.element,-0).insertNode(p),_a(g.element);A(q)&&ab(q,q.previousSibling);){var r=q;q=a(q.childNodes).appendTo(q.previousSibling)[0],_a(r)}G(f.element)}}else h.moveTo(g.element,!Ta(g,Aa)||0),_a(f.element);T.select(h)})}function L(c){var d,e,f=La(c||n,"contents");Ta(c,k)&&!Da.connected(n,c)?(e=F(c),d=new u(new t(e.rootNode,-1),5)):d=new u((Ta(c,b)||new b(W,f)).createTreeWalker(-1),5,function(a){return Za(f,La(a,"contents"))?1:2});var g,h,i,j="",l="";return Va(d,function(b){var c=(e||W).getNode(b);if(i=Z[c.widget.id].text,c!==g&&(g&&(j+=O(l,h),l="",Ta(g,ya)&&Ta(c,ya)&&"\n\n"!==j.slice(-2)&&(j+="\n\n"),c.widget!==g.widget&&i&&(j+=i(c.widget))),g=c,h=a.css(c.element,"text-transform")),Ta(c,Aa)&&!i)if(B(b)){var d=b.data;b===f.endContainer&&(d=d.slice(0,f.endOffset)),b===f.startContainer&&(d=d.slice(f.startOffset)),l+=d.replace(/\u200b/g,"").replace(" "," ")}else C(b)&&(l+="\n")}),j+=i?i(g.widget):O(l,h),db(j).replace(/\u00a0/g," ")}function M(a){V=a,da.attr("contenteditable",a?"true":null),!a&&N(n)&&n.blur()}function R(a,b,c){Z[a]=Qa({},b),Z[a].options=!c||Da.isPlainObject(c)?Qa({},b.options,c):c}function S(a){var b=new h(W,a,n,Z[a].options);Y.add(b,a,Z[a]),$.push(b)}Ta(n,k)||(o=n,n=n.element),o=Qa(!0,{},(!o||!1!==o.defaultOptions)&&pb,o);var T,U,V,W=this,X=o.inline||Ta(n,ka)?ra:qa,Y=new c.Container(n,W),Z={},$=[],_={},aa=!0,ca=!0,da=a(n);!function(){function a(a){for(var b=[],c=a.node;c.parentNode;c=c.parentNode)b.unshift(c.parentNode.childNodes.indexOf(c));return b[b.length]=a.textNode?a.wholeTextOffset:a.offset,b.join(" ")}function b(a,b){var c=b.split(" "),d=n,e=c.splice(-1)[0];c.forEach(function(a){d=d.children[+a]}),isNaN(e)?a.moveTo(d,"true"===e):a.moveToText(d,+e)}function c(){var b=W.getValue();f[0]&&b===f[g].value||(f.splice(0,g,{value:b}),f.splice(W.historyLevel),g=0),f[g].basePos=a(T.baseCaret),f[g].extendPos=a(T.extendCaret),f[g].html=n.innerHTML,r(),q(e)}function d(a){da.html(a.html),b(T,a.basePos),b(T.extendCaret,a.extendPos),r(),q(e)}var e,f=[],g=0,h=0;Qa(_,{canUndo:function(){return g<f.length-1},canRedo:function(){return g>0},undo:function(){_.canUndo()&&d(f[++g])},redo:function(){_.canRedo()&&d(f[--g])},snapshot:function(a){var b=+new j;q(e),!0===a?c():(h=i.max(h,b+(a||0)),e=p(c,h-b))}})}(),function(){Pa(o.widgets,function(a,b){R(a,b,o[a])}),Pa(qb,function(a,b){o[a]&&R(a,b,o[a])}),Na(Z,na,o),Na(Z,oa,{element:o.disallowedElement||":not("+ka+",br,b,em,i,u,strike,small,strong,sub,sup,ins,del,mark,span)",allowedIn:""}),o.textFlow=!0,Qa(_,F(n,!0)),Pa(Z,function(a,b){b.element&&b.element!==n?Ua(b.setup)&&Y.add(new h(W,a,n),a,{init:b.setup}):S(a)})}(),function(){function b(a){return T.isCaret?T.extendCaret.moveByCharacter("backspace"===a.data?-1:1)?(K(T,""),!0):void 0:(K(T,""),!0)}function e(a){if(T.startTextNode&&T.isCaret){if(a){var b=T.startTextNode,c=T.startOffset;b.data=b.data.substr(0,c)+a+b.data.slice(c),G(T.startNode.element),T.moveToText(b,c+a.length),_.snapshot(200)}}else K(T,a)}function f(b){var d=T.focusNode.widget,e="*"!==Z[d.id].disallowedElement,f=b.getData(c.IS_IE?"Text":i);if(e&&a.inArray(h,b.types)>=0){var g=Ia(a(b.getData(j)).filter("#Typer").contents());K(T,g)}else e&&f===ob.textContent?K(T,ob.htmlContent.cloneNode(!0)):Ea.emit("textInput",d.element,f,!1)}function g(b){var e=b.clipboardData||d.clipboardData,f=L(T),g=J(T,b.type);c.IS_IE?e.setData("Text",f):(e.setData(i,f),e.setData(j,a('<div id="Typer">').append(g.cloneNode(!0))[0].outerHTML),e.setData(h,"true")),ob.textContent=f,ob.htmlContent=g,b.preventDefault()}var h="application/x-typer",i="text/plain",j="text/html",k={compositionstart:function(){aa=!0,sb=W,Y.emitAsync("stateChange")},compositionend:function(){aa=!1,sb=!1,T.focus(),Y.emitAsync("stateChange")},cut:g,copy:g,paste:function(a){if(f(a.clipboardData||d.clipboardData),a.preventDefault(),c.IS_IE){var b=T.clone();p(function(){T.select(b)})}},drop:function(a){T.moveToPoint(a.clientX,a.clientY)&&f(a.dataTransfer),T.focus(),a.preventDefault()},dragstart:function(a){a.preventDefault()}};Y.add(n,{destroy:Da.bind(n,k)});var l={backspace:b,delete:b,enter:function(){return Ta(T.startNode,ra)?W.invoke("insertLineBreak"):(W.invoke("insertLine")||K(T,"\n\n"),!0)},upArrow:function(){return W.invoke("stepUp")},downArrow:function(){return W.invoke("stepDown")},mousewheel:function(a){return W.invoke(a.data<0?"stepUp":"stepDown")},textInput:function(a){return e(a.data),!0}};Pa({moveByLine:"upArrow downArrow shiftUpArrow shiftDownArrow",moveByWord:"ctrlLeftArrow ctrlRightArrow ctrlShiftLeftArrow ctrlShiftRightArrow",moveToLineEnd:"home end shiftHome shiftEnd",moveByCharacter:"leftArrow rightArrow shiftLeftArrow shiftRightArrow"},function(a,b){Pa(b,function(b,c){var d=1&b?1:-1,e=!!(2&b),f=l[c];l[c]=function(){if(f&&f())return!0;e||T.isCaret?(e?T.extendCaret:T)[a](d):T.collapse(d<0?"start":"end")}})});var m={keystroke:function(a){/ctrl(?=[acfnprstvwx]|f5|shift[nt]$)|^((shift)?tab|f5|f12)$/i.test(a.data)||a.preventDefault()},textInput:function(a){aa=!1},mousedown:function(a){("shift"===a.metakey?T.extendCaret:T).moveToPoint(a.clientX,a.clientY),T.focus(),Ea.drag(a,function(a,b){_.snapshot(200),T.extendCaret.moveToPoint(a,b)}),p(function(){T.focus()})},click:function(a){var b=W.getNode(a.target);Ta(b,pa|ua)&&T.select(b.widget.element),T.focus()},dblclick:function(a){T.select("word")},rightClick:function(a){var b=new v(W);b.moveToPoint(a.clientX,a.clientY),!T.isCaret&&Za(T,b)||T.select(b)}};Y.tap(function(a){var b=a.eventName,c=T.focusNode.element;if(V){if(Da.matchWord(b,"focusin focusout focusreturn")){if(a.target!==n)return;c=n}else"rightClick"===b?c=n:"click"===b&&(c=a.target);(m[b]||Xa)(a),(Y.emit(a,c)||(l["keystroke"===b?a.data:b]||Xa)(a))&&a.handled(),a.originalEvent&&a.isHandled()&&a.preventDefault()}})}(),M(!0),c.IS_IOS&&da.css("-webkit-user-modify","read-write-plaintext-only"),vb(W,Qa(_,{on:function(a,b){Y.add(n,Da.isPlainObject(a)||Da.kv(a,b))},enabled:function(){return V},enable:function(a,b){a?Z[a]||!qb[a]||qb[a].element||(R(a,qb[a],b),S(a)):(M(!0),Y.emitAsync("stateChange"))},disable:function(){M(!1),Y.emitAsync("stateChange")},destroy:function(){M(!1),Y.destroy()},hasCommand:function(a){return!!D(a)},widgetEnabled:function(a){return!!Z[a]},widgetAllowed:function(a,b){return b=Ta(b,l)||W.getNode(b||n),!!x(a,b)},getWidgetOption:function(a,b){return Z[a]&&Z[a][b]},getStaticWidget:function(a){return Fa($,function(b){return b.id===a})},getStaticWidgets:function(){return $.slice(0)},getSelection:function(){return T},extractText:function(a){return L(a)},invoke:function(a,b){var c,d;if("string"==typeof a&&(d=D(a),c=a,a=d&&Z[d.id].commands[a]),!Ua(a))return!1;var e=new w(W,d,c);return a.call(W,e,b),H(),_.snapshot(),W.focused(!0)&&T.focus(),!0},insertText:function(a){K(T,a)},insertHtml:function(a){K(T,Ta(a,k)||Ia(a))},insertWidget:function(a,b){var c=(Z[a]||"").create;Ua(c)&&c.call(W,this,b)},removeWidget:function(a){var b=Z[a.id].remove;if(Ua(b))b.call(W,new w(W,a));else if("keepText"===b){var c=L(a.element);K(La(a.element,!0),c),_a(a.element)}else K(La(a.element),"")}})),W.element=n,W.rootNode=_.rootNode,H(),T=new b(W,La(n,0)),Y.emit("init")}function U(a,b){return b&&(a.whatToShow&wa||b.element.offsetWidth>0||b.element.offsetHeight>0)&&b}function V(a,b,c){return c&&b!==a.root&&!U(a,b)?2:Ta(b,pa)&&Ta(b.parentNode,pa)?3:x(a,b)}function W(a,b,c){if(V.$1=V(a,b,c),1===V.$1)return a.currentNode=b,!0}function X(a,b,c){for(var d=a.currentNode[b];d;){if(W(a,d,!0))return d;if(3===V.$1&&d[b])d=d[b];else{for(;!d[c];)if(!(d=U(a,d.parentNode))||d===a.root||d===a.currentNode)return null;d=d[c]}}}function Y(a,b,c){for(var d=a.currentNode;d&&d!==a.root;){for(var e=d[c];e;){if(W(a,e))return e;e=2!==V.$1&&e[b]?e[b]:e[c]}if(!(d=U(a,d.parentNode))||d===a.root||1===V(a,d,!0))return null}}function Z(a,b){var c=b.currentNode.typer,d=e.createTreeWalker(b.root.element,1|a.whatToShow,function(d){var e=c.getNode(d);return e.element===d||Ta(e,Aa)?W(b,e,!0)?1|x(a,d):V.$1:3},!1);Na(a,"iterator",d)}function $(a,b,c){var d=La(a),e=vb(a).proxy,f=function(a){return Za(a.element,d)?1:2};return new t(a.focusNode,b&~wa,S(f,e&&e.acceptNode&&e.acceptNode.bind(e),c))}function _(a){var b=new u($(a,Aa),4);return b.currentNode=a.startTextNode||a.startElement,a.startOffset===(a.startTextNode||"").length&&b.nextNode(),Wa(b,null,null,function(b){return Ga(b,a.endTextNode||a.endElement)<=(0!==a.endOffset?0:-1)})}function aa(a){var b=a.getCaret("start"),c=a.getCaret("end");c.textNode&&!F(c.textNode,c.offset,1)&&c.textNode.splitText(c.offset),b.textNode&&!F(b.textNode,b.offset,-1)&&ga(b,b.node,b.element,b.textNode.splitText(b.offset),0)}function ba(a,b,c){return ba.executing=!0,ba.run(a,b,c)}function ca(a){if(ba.executing)return void ub.add(a);var b=vb(a);b.m=0,b.proxy=null,a.timestamp=performance.now(),a.direction=Da.compareRangePosition(a.extendCaret,a.baseCaret)||0,a.isCaret=!a.direction;for(var c=0,d=a.getCaret("start"),e=a.getCaret("end");c<4;c++)a[ca.NAMES[c+4]]=d[ca.NAMES[c]],a[ca.NAMES[c+8]]=e[ca.NAMES[c]];var f=a.typer.getNode(Da.getCommonAncestor(a.baseCaret.element,a.extendCaret.element));a.focusNode=I(f,pa|ua|xa|va),a===a.typer.getSelection()&&(a.typer.focused(!0)&&a.focus(),a.typer.snapshot())}function da(a,b,c){var d=new u(new t(b||a.typer.rootNode,Aa|pa|ua),4|c);return d.currentNode=a.textNode||a.element,d}function ea(a,b){return a.selection?ba(b,null,a):b.call(a)}function fa(a){var b=a.typer.element,c=a.element,d=a.textNode;if(!Ha(b,d||c)||d&&(d.parentNode!==c||a.offset>d.length)){var e;if(d&&Ha(b,d)&&a.offset<=d.length)e=a.moveTo(d,a.offset);else if(Ha(b,a.node.element))e=a.moveToText(a.node.element,a.wholeTextOffset)||a.moveTo(a.node.element,0);else{var f={node:c};for(a.typer.getNode(c);!Ha(b,f.node)&&tb.has(f.node);f=tb.get(f.node));e=a.moveTo(f.node,f.offset)}e||a.moveTo(b,0)}return a}function ga(a,b,c,d,e,f){var g=[a.node,a.element,a.textNode,a.offset],h=g[0]!==b||g[1]!==c||g[2]!==d||g[3]!==e;return a.node=b,a.element=c,a.textNode=d||null,a.offset=e,a.wholeTextOffset=(d?a.offset:0)+K(b,d||c),a.beforeSoftBreak=!!f,h&&a.selection&&ca(a.selection),h}function ha(b,c,d,e){for(var f,g;A(c)&&c.lastChild;)g=d===c.childNodes.length,c=c.childNodes[d-g],d=g?(c.data||c.childNodes).length||0:0;var h=b.typer.getNode(c);if(Ta(h,pa|ua))c=h.widget.element,c!==h.element&&(h=b.typer.getNode(c)),Ta(h.parentNode,Aa)?(f=B(g?c.nextSibling:c.previousSibling)||a(Ma())[g?"insertAfter":"insertBefore"](c)[0],c=f.parentNode,d=g?0:f.length,h=h.parentNode):f=null;else if(Ta(h,Aa))f=C(c)?B(c.nextSibling)||a(Ma()).insertAfter(c)[0]:B(c);else{var i=Fa(h.childNodes,function(a){return Ga(c,a.element)<0});h=i||h.lastChild||h,f=null,g=!i}if(b.selection&&b===b.selection.extendCaret&&Ta(h.previousSibling,pa)===b.selection.baseCaret.node&&(h=h.previousSibling,f=null,g=!0),!f&&Ta(h,Aa)){for(var j=new u(new t(h,Aa),4);j.nextNode()&&g;);f=B(j.currentNode)||a(Ma())[g?"appendTo":"prependTo"](h.element)[0],d=f&&g?f.length:0}if(f&&!e){for(var k=function(c,e,g,h){var i=F(f,d,c)&&A(f[e]);if(i&&!C(i)&&Ta(b.typer.getNode(i),Aa))return f=B(i[g])||a(Ma())[h](i)[0],d=J(f,0*c),!0};k(-1,"previousSibling","lastChild","appendTo")||k(1,"nextSibling","firstChild","prependTo"););f.length||(f.data=la,d=1)}return ga(b,I(h,ya),f?f.parentNode:h.element,f,f?d:!g,e)}function ia(b,c,d,f){var g=H(b),h=c===b.length||!!d&&c>0,i=!!(2&g),j=b.data.charAt(c-h);if(G(j)!==i&&"override"!==a.css(b.parentNode,"unicode-bidi").slice(-8)){for(var k=b.parentNode;"inline"===a.css(k,"display")&&"isolate"!==a.css(k,"unicode-bidi").slice(0,7);k=k.parentNode);if((i?jb:ib).test(k.textContent)){var l=function(b,c,d){var f=e.createTreeWalker(k,5,function(b){if(A(b)&&!C(b)){if("inline"!==a.css(b,"display")||Ta(b,"audio,canvas,embed,iframe,img,input,object,video"))return 2;switch(a.css(b,"unicode-bidi")){case"normal":case"plaintext":return 3;case"isolate":case"isolate-override":return 2}}return 1},!1);for(f.currentNode=b;B(b);){for(;c!==J(b,0*-d);)if(c+=d,/(\S)/.test(b.data.charAt(c)))return G(n.$1,i);b=y(f,d),c=d>0?-1:(b||"").length}return!b||C(b)?i:"rtl"===a.css(b,"direction")},m=l(b,c-h,-1),o=l(b,c-h,1),p=m===o&&/\s/.test(j)?m:G(j,i);h||p===i||m!==i||(h=!0,p=m),g=-3&g|(p?2:0)}}var q=Sa(La(b,c-h,b,c+!h))[0]||cb(0,0);return f&&h&&/\s/.test(b.data.charAt(c-h))&&!L(q,g).width&&(q[M(3,g)]+=R(b).wsWidth),q.collapse(M(2|h,g))}function ja(b,c,d,e,f){function g(b){var c=q.indexOf(b);if(c>=0)return s[c];for(var d=r(b),e=b;"inline"===a.css(e,"display");e=e.parentNode);var f=s[q.push(b)-1]=R(b);return f.lineHeight="px"===d.lineHeight.slice(-2)?o(d.lineHeight):("normal"===d.lineHeight?1.15:d.lineHeight)*f.fontSize,f.verticalAlign=d.verticalAlign,f.baselineOffset=f.baseline-f.height+h(b,e),f}function h(a,b){if(a===b)return 0;if(a.parentNode!==b)return h(a,a.parentNode)+h(a.parentNode,b);var c=g(a);switch(c.verticalAlign){case"baseline":return 0;case"middle":var d=g(a.parentNode);return-c.height/2+(d.baseline-d.middle);case"top":case"bottom":return NaN;case"text-top":return(c.lineHeight-c.height)/2;case"text-bottom":return(c.lineHeight+c.height)/2-g(a.parentNode).height;case"sub":return-.21*c.fontSize;case"super":return.34*c.fontSize}return isNaN(c.verticalAlign)?o(c.verticalAlign)/100*c.lineHeight:+c.verticalAlign||0}function j(a){var b,f;e?(f=e>0?a.right:a.left,b=(f-d.left)*e):(b=i.min(0,a.right-d.left)||i.max(0,a.left-d.left),f=d.left+b),(e?b>v:i.abs(b)<i.abs(v))&&(v=b,c=a.node,l=L(cb(f,a.centerY),-p))}function k(a,b,c,e,f){var h,k=new u(new t(a,Aa),4),l=c>0?"bottom":"top",m=d,n=[];if(B(b))k.currentNode=b;else{for(;k.nextNode()&&c<0;);if(b=k.currentNode,!B(b))return m[l]}do{var o=g(b.parentNode),q=Sa(b);c<0&&q.reverse();for(var r=0,s=q.length;r<s;r++){var v=L(q[r],p),w=o.lineHeight-v.height>>1,x=cb(v.left,v.top-w,v.right,v.bottom+w),z=v.bottom+o.baselineOffset,A=!1;if(x.node=b,!(void 0===h&&x[l]*c<m[eb[l]]*c)){if(isNaN(h)||i.abs(z-h)<1||x.top<m.bottom&&x.bottom>m.top)A=!0;else if(isNaN(z))if(o.verticalAlign===eb[l])A=x[eb[l]]*c<=m[l]*c;else{if(!n[0]||x[l]===n[0][l]){n.push(x);continue}var C=n.splice(0,n.length,x);C[0][l]===m[l]&&C.forEach(j)}if(void 0!==h&&isNaN(z)||(h=z),!A&&!--e||h*c>f*c)return m[l];m=Da.mergeRect(m,x),1===e&&(n.splice(0).forEach(j),j(x))}}}while(b=y(k,c));return m[l]}var l,m=I(b.typer.getNode(c),ya),p=H(c),q=[],s=[],v=-1/0;if(d=L(cb(d.centerX,d.centerY),p),b.softPoint&&(d.left=d.right=L(b.softPoint,p).left),f){var w=k(b.typer.rootNode,c,f,2),x=f>0?"bottom":"top",z=new t(b.typer.rootNode,ya);for(z.currentNode=m;m=y(z,f);){var A=L(Ra(m.element),p);if(!(Ha(m.element,c)||A[eb[x]]*f<=d[x]*f)&&(!l||A[x]*f<w*f))return ha(b,m.element,0)}}else{var C=!e&&d.top>L(Ra(m.element),p).bottom;k(m,c,(e||1)*(2&p?-1:1)*(C?-1:1),1)}if(l){var D=e>0||v<0,E=function(b,c,d,e){function f(a){var f=L(ia(b,a,e),d);return(f.centerY-c.centerY|0)*(1/0)||f.left-c.left|0}var g=0,h=b.length;if("override"!==a.css(b.parentNode,"unicode-bidi").slice(-8)&&(2&d?jb:ib).test(b.data)){var j,k=2&d?[jb,kb]:[ib,lb],l=0;for(h=-1;!j&&k[1&++l].test(b.data.slice(h+1));)g=i.max(0,h),h=b.data.indexOf(n.$1,h+1),j=Fa(Sa(La(b,g,b,h)),function(a){return a.top<=c.top&&a.bottom>=c.top&&a.left<=c.left&&a.right>=c.left});d^=1&l?2:0,j||(h=b.length)}for(c=L(c,d);h-g>1;){var m=h+g>>1,o=f(m)<=0;g=o?m:g,h=o?h:m}return i.abs(f(g))<i.abs(f(h))?g:h}(c,l,p,D);return b.softPoint=f?L(cb(d.left,L(l,p).centerY),-p):null,ha(b,c,E,D)}return!1}var ka="h1,h2,h3,h4,h5,h6,p,q,blockquote,pre,code,li,caption,figcaption,summary,dt,th",la="​",ma="&#8203;",na="__root__",oa="__unknown__",pa=1,qa=2,ra=32,sa=4,ta=16,ua=64,va=128,wa=8192,xa=qa|ra,ya=pa|sa|xa,za=ta|ua|va,Aa=sa|ra|ta|va,Ba=s.WeakMap,Ca=s.Set,Da=c.helper,Ea=c.dom,Fa=Da.any,Ga=Da.comparePosition,Ha=Da.containsOrEquals,Ia=Da.createDocumentFragment,Ja=Da.createElement,Ka=Da.createNodeIterator,La=Da.createRange,Ma=Da.createTextNode,Na=Da.defineHiddenProperty,Oa=Da.definePrototype,Pa=Da.each,Qa=Da.extend,Ra=Da.getRect,Sa=Da.getRects,Ta=Da.is,Ua=Da.isFunction,Va=Da.iterate,Wa=Da.iterateToArray,Xa=Da.noop,Ya=Da.rangeCovers,Za=Da.rangeIntersects,$a=Da.rectEquals,_a=Da.removeNode,ab=Da.sameElementSpec,bb=Da.tagName,cb=Da.toPlainRect,db=Da.trim,eb={top:"bottom",left:"right",right:"left",bottom:"top"},fb={"horizontal-tb":0,"vertical-rl":5,"vertical-lr":1,"sideways-rl":5,"sideways-lr":11,lr:0,rl:0,tb:5,"lr-tb":0,"lr-bt":4,"rl-tb":0,"rl-bt":4,"tb-rl":5,"bt-rl":5,"tb-lr":1,"bt-lr":1},gb=[240,3276,1450,3840],hb="block-start block-end inline-start inline-end over under line-left line-right".split(" "),ib=new n("([֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),jb=new n("([^\\s֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),kb=new n("(\\s|[֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),lb=new n("(\\s|[^֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),mb=/[\u200b\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f\udc00-\udcff\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u08d4-\u08e1\u08e3-\u08ff\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u3099\u309a]/,nb=d.getSelection(),ob={},pb={},qb={},rb={},sb=null,tb=new Ba,ub=new Ca,vb=Da.createPrivateStore();if(Qa(T,{NODE_WIDGET:pa,NODE_PARAGRAPH:sa,NODE_EDITABLE:qa,NODE_EDITABLE_PARAGRAPH:ra,NODE_INLINE:ta,NODE_INLINE_WIDGET:ua,NODE_INLINE_EDITABLE:va,NODE_ANY_ALLOWTEXT:Aa,NODE_ANY_BLOCK_EDITABLE:xa,NODE_ANY_INLINE:za,ZWSP:la,ZWSP_ENTITIY:ma,defaultOptions:pb,widgets:qb}),c.Editor=T,Oa(T,{historyLevel:100,closest:I,getAbstractSide:M,createCaret:function(a,b){var c=new v(this)
;return a&&c.moveTo(a,b),c},createSelection:function(a,c,d,e){return new b(this,La(a,c,d,e))},createTreeWalker:function(a,b,c){return new t(a||this.rootNode,b,c)},nodeFromPoint:function(a,b,c){var d=Da.elementFromPoint(a,b,this.element);if(d){var e=this.getNode(d);if(Ta(e,qa)){var f=H(d),g=L(cb(a,b),f);e=Fa(e.childNodes,function(a){var b=L(Ra(a.element,!0),f);return b.top<=g.top&&b.bottom>=g.top})||e}return I(e,c||-1)}},hasContent:function(){return this===sb||(!!db(this.element.textContent).length||!!new t(this.rootNode,~(sa|ta)).nextNode())},getValue:function(){return db(this.element.innerHTML.replace(/\s+style(?:="[^"]*")?|\u200b+(?!<\/)|(^|[^>])\u200b+/g,"$1"))},setValue:function(a){this.invoke(function(b){Ia(b.typer.element.childNodes),b.insertHtml(a)})},validate:function(){return!0},select:function(a,b,c,d){return this.getSelection().select(a,b,c,d)},selectAll:function(){return this.getSelection().selectAll()},focus:function(){this.getSelection().focus()},focused:function(a){return Ea.focused(this.element,a)},retainFocus:function(a){Ea.retainFocus(this.element,a)},releaseFocus:function(a){Ea.releaseFocus(this.element,a)},support:function(a){return this.hasCommand(a)&&this.invoke.bind(this,a)}}),Pa("on enabled enable disable destroy hasCommand widgetEnabled widgetAllowed getNode getWidgetOption getStaticWidget getStaticWidgets getSelection extractText invoke canUndo canRedo undo redo snapshot",function(a,b){Na(T.prototype,b,function(){return vb(this)[b].apply(null,arguments)})}),Pa("insertText insertHtml insertWidget removeWidget",function(a,b){Na(w.prototype,b,function(){return vb(this.typer)[b].apply(null,arguments)})}),Oa(h,{get parent(){var a=this.element&&this.typer.getNode(this.element.parentNode);return a&&a.widget}}),Oa(l,{get firstChild(){return this.childNodes[0]||null},get lastChild(){var a=this.childNodes;return a[a.length-1]||null}}),V.$1=0,Oa(t,{previousSibling:function(){return Y(this,"lastChild","previousSibling")},nextSibling:function(){return Y(this,"firstChild","nextSibling")},firstChild:function(){return X(this,"firstChild","nextSibling")},lastChild:function(){return X(this,"lastChild","previousSibling")},parentNode:function(){for(var a=this.currentNode;a&&a!==this.root;a=a.parentNode)if(W(this,a.parentNode,!0))return a.parentNode},previousNode:function(){for(var a=this,b=a.currentNode;b&&b!==a.root;){for(var c=b.previousSibling;c;c=b.previousSibling){b=c;for(var d=V(a,c);2!==d&&U(a,b.firstChild);)b=b.lastChild,d=V(a,b,!0);if(1===d)return a.currentNode=b,b}if(!(b=U(a,b.parentNode))||b===a.root)return null;if(W(a,b,!0))return b}},nextNode:function(){for(var a=this,b=1,c=a.currentNode;c;){for(;2!==b&&c.firstChild;){if(c=c.firstChild,W(a,c,!0))return c;b=V.$1}for(;c&&c!==a.root&&!c.nextSibling;)c=U(a,c.parentNode);if(!c||c===a.root)return null;if(c=c.nextSibling,W(a,c,!0))return c;b=V.$1}}}),Oa(u,{get currentNode(){return this.iterator.currentNode},set currentNode(a){this.iterator.currentNode=a},previousNode:function(){return this.iterator.previousNode()},nextNode:function(){return this.iterator.nextNode()}}),ba.executing=!1,ba.run=function(a){var b=0;return function(c,d,e){try{return b++,c.apply(e||this,d)}finally{0==--b&&a()}}}(function(){ba.executing=!1,ub.forEach(ca),ub.clear()}),ca.NAMES="node element textNode offset startNode startElement startTextNode startOffset endNode endElement endTextNode endOffset".split(" "),Oa(b,{get isSingleEditable(){return this.isCaret||!$(this,xa).nextNode()},getCaret:function(a){var b=this.baseCaret,c=this.extendCaret;switch(a){case"extend":return c;case"start":return this.direction<0?c:b;case"end":return this.direction<0?b:c;default:return b}},getRange:function(a){var b=this.baseCaret,c=this.extendCaret;return void 0!==a||this.isCaret?(!1!==a?b:c).getRange():La(b.getRange(),c.getRange())},getRects:function(){var a=this,b=vb(a).proxy;if(b&&b.getRects)return b.getRects();if(a.isCaret)return[Ra(a.baseCaret)];if(Ta(a.startNode,pa)===a.focusNode)return[Ra(a.startNode)];var c=a.getRange(),d=[];return Va($(a,-1,function(a){if(Ya(c,a.element))return d[d.length]=Ra(a),2;if(Ta(a,Aa)){var b=M("inline-start",a.element),e=[];return Pa(Sa(La(c,La(a.element,"contents"))),function(a,c){i.abs(c[b]-c[eb[b]])<=1&&(c[eb[b]]+=5),Pa(e,function(a,b){i.abs(c.left-b.right)<=1&&(b.right=c.left),i.abs(c.top-b.bottom)<=1&&(b.bottom=c.top)}),e[e.length]=c}),d.push.apply(d,e),2}return 1})),d},getWidget:function(a){return Fa(this.getWidgets(),function(b){return b.id===a})},getWidgets:function(){for(var a=[],b=this.focusNode;b.widget.id!==na;b=b.parentNode)a.unshift(b.widget),b=this.typer.getNode(b.widget.element);return a},getParagraphElements:function(){var a=this;return a.startNode===a.endNode?Ta(a.startNode,sa)?[a.startNode.element]:[]:Wa($(a,sa),function(a){return a.element})},getSelectedElements:function(){var b=this;return b.isCaret?[b.startElement]:a(_(b)).parent().get()},getSelectedText:function(){return this.typer.extractText(this)},getSelectedTextNodes:function(){var a=this;return a.isCaret?[]:(aa(a),_(a))},createTreeWalker:function(a,b){return $(this,a,b)},collapse:function(a){return a=this.getCaret(a),(a===this.baseCaret?this.extendCaret:this.baseCaret).moveTo(a)},select:function(a,b,c,d){var e,f=this;return ba(function(){if("word"===a)e=f.getCaret("start").moveByWord(-1)+f.getCaret("end").moveByWord(1)>0;else{var g=La(a,b,c,d);e=f.baseCaret.moveTo(g,!0)+f.extendCaret.moveTo(g,!1)>0}}),a.acceptNode&&(vb(f).proxy=a),e},selectAll:function(){return this.select(this.typer.element,"contents")},focus:function(){var a=this,b=a.typer.element;c.IS_TOUCH&&e.activeElement!==b&&!(Ea.event||"").isTrusted||Ha(e,b)&&a.typer.enabled()&&sb!==a.typer&&(Da.makeSelection(a.baseCaret.getRange(),a.extendCaret.getRange()),e.activeElement!==b&&b.focus(),Ea.scrollIntoView(b,a.extendCaret.getRect()))},clone:function(){var a=this,c=new b(a.typer);return ba(function(){c.baseCaret.moveTo(a.baseCaret),c.extendCaret.moveTo(a.extendCaret)}),vb(c).proxy=vb(a).proxy,c},widgetAllowed:function(a){return this.typer.widgetAllowed(a,this.focusNode)}}),Pa("moveTo moveToPoint moveToText moveByLine moveToLineEnd moveByWord moveByCharacter",function(a,c){Na(b.prototype,c,function(){var a=this;return ba(function(){return v.prototype[c].apply(a.baseCaret,arguments)+a.collapse("base")>0},arguments)})}),Pa("getWidgets getParagraphElements getSelectedElements getSelectedText getSelectedTextNodes",function(a,c){var d=b.prototype[c];b.prototype[c]=function(){var b=vb(this);return b.m&1<<a||(b[c]=d.apply(this),b.m|=1<<a),Da.isArray(b[c])?b[c].slice(0):b[c]}}),Oa(v,{getRect:function(){var a=fa(this);if(!a.textNode){return Ra(a.element).collapse(M(2|!a.offset,H(a.element)))}return ia(a.textNode,a.offset,a.beforeSoftBreak,!0)},getRange:function(){var a=fa(this),b=a.textNode||a.element,c=a.offset;return b===a.typer.element?La(b,c?0:-0):La(b,c)},clone:function(){var a=fa(this);return Qa(new v(a.typer),a)},moveTo:function(a,b){if(Ta(a,v))return fa(a),ga(this,a.node,a.element,a.textNode,a.offset,a.beforeSoftBreak);var c=La(a,b);return!(!c||!Ha(this.typer.element,c.startContainer))&&ha(this,c.startContainer,c.startOffset)},moveToPoint:function(a,b){var c=this;return ja(c,(c.typer.nodeFromPoint(a,b)||c.typer.rootNode).element,cb(a,b))},moveToText:function(a,b){if(3!==a.nodeType){var c=new u(new t(this.typer.getNode(a),Aa),4);if(1/b>0)for(;b>=0&&c.nextNode();b-=c.currentNode.length);else for(;c.nextNode(););a=c.currentNode,b=a&&i.min(b+a.length,a.length)}return!!B(a)&&ha(this,a,J(a,b))},moveToLineEnd:function(a){var b=fa(this);return ja(b,b.textNode||b.element,b.getRect(),a,0)},moveByLine:function(a){var b=this;return ja(b,b.textNode||b.element,b.getRect(),0,a)||b.moveToLineEnd(a)},moveByWord:function(a){var b,c=this,d=c.textNode,e=a<0?/\b(\S*\s+|\S+)$/:/^(\s+\S*|\S+)\b/,f="";if(d&&(f=a<0?d.data.substr(0,c.offset):d.data.slice(c.offset),(b=e.test(f))&&n.$1.length!==f.length))return c.moveToText(d,c.offset+a*n.$1.length);for(var g=da(c,c.node),h=g.currentNode,i=b&&n.$1.length;d=y(g,a);){if(f=a<0?d.data+f:f+d.data,(b=e.test(f))&&n.$1.length!==f.length)return n.$1.length===i?c.moveToText(h,0*-a):c.moveToText(d,a*(n.$1.length-(f.length-d.length)));h=d,i=n.$1.length}return!(!b||!d&&!i)&&c.moveToText(d||h,0*-a)},moveByCharacter:function(a){for(var b=this,c=H(b.element),d=L(Ra(b),c),e=da(b,null,5),f=B(e.currentNode),g=b.offset,h=!1;;){if(!f||g===J(f,0*-a)){for(;!(f=y(e,a))||!f.length||!E(f);){if(!f)return!1;if(Ta(b.typer.getNode(f),pa|ua)&&!Ha(f,b.element))return b.moveToText(f,0*a)||b.moveTo(f,a<0);h|=!!C(f)}g=(a<0?f.length:0)+((h||!Ha(b.node.element,f))&&-a)}if(g+=a,!mb.test(f.data.charAt(g))){var i=L(ia(f,g),c);if(!$a(d,i))return ha(b,f,g,a>0&&d.centerY!==i.centerY)}}}}),Pa("moveByLine moveByWord moveByCharacter",function(a,b){var c=v.prototype[b];v.prototype[b]=function(a){var b=fa(this);return ea(b,function(){for(var d=a;d&&c.call(b,a/i.abs(a));d+=d>0?-1:1);return!a||d!==a})}}),!c.IS_IE){try{e.designMode="on",e.execCommand("enableObjectResizing",!1,"false"),e.execCommand("enableInlineTableEditing",!1,"false")}catch(a){}e.designMode="off"}setInterval(function(){var a=Ta(Ea.getContext(),T);if(a&&!sb&&Ea.focused(d)){var b=a.getSelection(),c=N(a.element);c&&!Da.rangeEquals(c,La(b))&&(b.select(c),b.focus())}},100)}(),function(){function i(a,b){return Wa(b,function(b,c){a[b]=c}),a}function j(a){return b.eval('"'+a+'"')}function l(a,b){Wa(a.attributes,function(a,c){b(c.nodeName,c.value,c)})}function m(a,b,c){return a[b]||(a[b]=new c)}function o(a,b,c,d){if(_a(c))return Wa(c,o.bind(null,a,b));m(a,c,f)[b||"default"]=d}function q(a,b){return a=a.templates||ub,b=b.templates,b&&b!==ub?Ya(a,b):a}function r(a,c,d,e){var f=ab("globals",d);return e?b.eval(a.slice(2,-2),c,f):b(a,c,f)}function t(a,b){for(;a;a=a.parent){var c=wb(a).values;if(b in c)return c[b]}return vb[b]}function u(a,b,c){c&&!M(a)||(b(a),Wa(a.controls,function(a,d){u(d,b,c)}))}function v(a,b,c,d){return wb(a).container.emit(b,a.element||a,c,d)}function w(a,b,c,d,e){return wb(a).container.emitAsync(b,a.element||a,c,d,e)}function x(a,b){if(w(a,"stateChange"),b)for(var c=a.parent;c&&c.requireChildControls;c=c.parent)J(c),w(c,"stateChange")}function y(a,b,c,d){w(a,"propertyChange",{oldValues:ab(b,c),newValues:ab(b,d)},!1,function(a,b){return b.oldValues=i(b.oldValues,a.oldValues),b.newValues=i(a.newValues,b.newValues),b}),Wa(wb(a).values,function(c,d){c!==b&&Za(d,A)&&d.needEvaluate&&d.getValue(a,c,!0)}),J(a),x(a,!0)}function z(a,b){var c=Ka(a),d={};if(b){var e=function(b){d[b]=a[b]},f=wb(a);La(a).forEach(e),La(f.options).forEach(e),Xa(d,f.values),d.value=f.value}else Xa(d,a);return Wa(d,function(b,e){b in c||db(b,Da)||Ta(d,b,function(){return D(c,b),a[b]})}),d}function A(a,b,c,d,e,f){var g=this;g.rawValue=c,g.displayValue=d,g.lastValue=d,g.needEvaluate=e,g.getValue(a,b,f)}function B(a,b){var c=a.toolset.labels;if(b in c)return B.value=g(c[b][xb.language]||c[b].default||""),!0}function C(a,b,c,d){if("string"==typeof c){var e=wb(a),f="icon"!==b&&(B(e.container,c)||B(e,c))?B.value:c,g=Fa.test(f);if(f!==c||g)return new A(a,b,c,f,g,d)}return c}function D(a,b){b in a||db(b,Da)||(Ta(a,b,function(){var a=this,c=Ja.call(vb,b)?t(a,b):wb(a).values[b];return Za(c,A)?c.lastValue:c},function(a){var c=this,d=wb(c).values,e=Za(d[b],A);if(a!==d[b]&&(!e||a!==e.rawValue)){var f=Ja.call(vb,b),g=e?e.lastValue:d[b];!f||null!==a&&void 0!==a?d[b]=C(c,b,a):delete d[b];var h=c[b];if(wb(c).inited&&(y(c,b,g,h),f)){var i=function(a){Wa(a.controls,function(a,c){b in wb(c).values||(y(c,b,g,h),i(c))})};i(c)}}}),Wa(cb(ob,a),function(a,c){wb(c).values[b]=C(c,b,c[b]),delete c[b];var d=wb(c).initialValues;d[b]=b in d?C(c,b,d[b],!1):void 0}))}function E(a,b,c){var d=wb(a);if(!d.inited)return d.value=b,!0;var e=d.value;if(e===b)return!1;var f=d.container.event;return f&&"setValue"===f.type&&f.context===a||!v(a,"setValue",{oldValue:e,newValue:b})?(d.value=b,c||(y(a,"value",e,b),(a.errors||a.validateOnSetValue)&&F(a)),!0):d.value!==e}function F(a){var b;if(M(a)&&(b=a.required&&!a.value?ib("required"):v(a,"validate")),b)return b.then(function(){a.errors=null},function(b){if(_a(b))a.errors=b;else{var c={};Wa(bb(b),function(a,b){c[b]=b}),a.errors=c}}),b;a.errors=null}function G(a){var b=!Aa&&!db(Na.getEventSource(a.element),"script touch"),c=Aa||b&&(Aa=[]),d=[];if(wb(a).container.flushEvents(),u(a,function(a){var b=F(a);b&&(b.catch(function(){c&&!Oa(c,function(b){return Ra(a.element,b)})&&c.push(a.element)}),d.push(b))},!0),b&&(Aa=null),d[0]){var e=Ma.waitAll(d);return e.catch(function(){b&&!Oa(c,function(a){return Na.focused(a)})&&(c.sort(Ma.comparePosition),Na.focus(c[0]))}),e}}function H(a){var b=wb(a),c=b.initialValues;Wa(La(a),function(b,d){db(d,Da)||(c[d]=a[d])}),i(c,b.values),Ua(c,"value",b.value)}function I(a){var b=wb(a),c=b.initialValues;a.errors=null,b.flag=1,c&&(Wa(c,function(c,d){(c in b.values?b.values:a)[c]=d}),E(a,c.value,!0)),v(a,"reset"),x(a)}function J(a,b){wb(a).flag&=255,b&&[M,N,O].forEach(function(c,d){return b&1<<d&&c(a)})}function K(a,b,c){var d=wb(a),e=d.flag,f=(e&b)>0;return(d.flag|=b<<8)!==e&&f^!!c(d)?(d.flag^=b,x(a,!0),!f):f}function L(a,b,c){wb(a)[Ea[b>>1]]=c,J(a,b)}function M(a){return K(a,1,function(b){return!(P(a)||b.position&&!b.position.enabled)&&(!(a.requireChildControls&&(!a.controls.some(M)||a.controls.every(O)))&&(!1!==b.enabled&&!1!==(b.options.enabled||eb).call(a,a)))})}function N(a){return K(a,2,function(b){return b.active||(b.options.active||eb).call(a,a)})}function O(a){return K(a,4,function(b){var c=a.hiddenWhenDisabled;return P(a)||!M(a)&&(c||!1!==c&&a.parent&&a.parent.hideDisabledChild)||!1===b.visible||!1===(b.options.visible||eb).call(a,a)})}function P(a){return K(a,8,function(b){return b.toolsetState&&(!1===M(b.toolsetState)||a.realm&&!b.toolsetState[a.realm])})}function Q(c,d,g,i){function k(a,b,c,d){m(t,a,h).push({type:d||"text",name:c||"",expression:b})}function o(a){var b;return a.value=a.value.replace(/([\w-]+)\:(\{\{(?:[^\}]|\}(?!\}))+\}\})/g,function(c,d,e){return b=!0,k(s,e,d,a.nodeName),""}),b}function p(a,b){return Ma.single(b,function(b,c){return Ja.call(a,c)&&c})}function q(b,c){var e=i===b?Ka(d):d,g=e[b]||"<div><children controls/></div>",h=a.parseHTML(g)[0];a("children",h).each(function(b,d){var e=Sa(d.attributes.controls&&!c.childNodes[0]?[Ma.createElement("controls")]:c.cloneNode(!0).childNodes),f=a("controls",e);l(d,function(a,b){f.attr(a,b)}),a(d).replaceWith(e)}),g=h.outerHTML;for(var k=d,m=d;m;m=Ka(m)){var q=cb(pb,m,f)[g];if(q){k=p(d,q.roles)?d:m;break}}var r=Q(g,d,k,W.prototype[b]?b:i),v=r.dom.cloneNode(!0),w=a("controls",v),x={};return l(c,function(b,c,d){if("class"===b)o(d),a(v).addClass(d.value);else{var e=Fa.test(c)&&n.$1;x[Qa(b)]=e?{expression:c,evalAsObject:e.length===c.length-4}:j(c),e||w.attr(b,c)}}),Wa(r.binds,function(a,b){var c=+a+s;t[c]=b.concat(t[c]||[]),t[c].context=Xa({},b.context,x)}),u[b]=s,Wa(r.roles,function(a,b){u[a]=+b+s}),s+=r.nodeCount,v}var r=cb(pb,g||d,f)[c];if(r)return r;var s=0,t={},u={};t[0]=[];var v={dom:function(b){var c=new Ha,d=e.createTreeWalker(b,5,function(a){return/z\:([\w-]+)/.test(mb(a))?(c.set(a,q(Qa(n.$1),a)),2):1},!1);return Ma.iterate(d,function(b){1===b.nodeType?("controls"!==mb(b)||a(b).attr("layout")||b.setAttribute("layout",i),l(b,function(a,c,d){!Fa.test(c)||db(a,"class style")&&o(d)||(k(s,c,a,db(a,Ca)&&a in b?"prop":"attr"),d.value="")}),s++):Fa.test(b.data)&&(b.previousSibling||b.nextSibling?(k(s,b.data),c.set(b,e.createElement("span")),s++):k(s-1,b.data),b.data="")}),c.forEach(function(b,c){a(c).replaceWith(b)}),b.childNodes[0]}(Sa(a.parseHTML(c)[0])),roles:b.eval("sortby [ . ]",u),binds:t,nodeCount:s};g=g||d;do{cb(pb,g,f)[c]=v}while(g!==ub&&!p(g,u)&&(g=Ka(g)));return v}function R(b){var c=b.element,d=wb(b).position;1===d.count?d.start=d.end=a(d.placeholder).insertBefore(c)[0]:d.start===c?d.start=c.nextSibling:d.end===c&&(d.end=c.previousSibling),d.count--,jb(c)}function S(c,d,e){var f,g=wb(c),h=wb(d).dom.positions,i=g.position,j=g.dom;if(h[0]){var k=z(c);f=Oa(h,function(a){return!a.condition||b.eval(a.condition,k)}),J(c)}else f=new ba(d),f.layoutType=d.type,a(f.placeholder).appendTo(d.element),h[0]=f;if(i!==f){var l=j;if(j&&R(c),!j||f&&(j||"").layoutType!==f.layoutType){var m=f.layoutType,n=g.allDOM||(g.allDOM={});l=n[m]||(n[m]=new ca(c,m)),c.element=l.element}var o=c.element;f.count?(a(o).insertAfter(f.end),f.end=o):(a(f.start).replaceWith(o),f.start=f.end=o),f.count++,g.position=f,g.dom=l,d&&!e&&l!==j&&l.update()}}function T(a,b,c,d,e){if(Wa(c,function(c,f){var g=wb(f);if("import"===g.type)T(a,b,tb[g.name]||[],!0,g.options);else{var h=new g.ctor(a,f,b,d,e);S(h,b||a,!0),T(a,h,bb(g.options.controls)),v(h,"init"),H(h),x(h),b||(a.control=h)}}),b&&c[0]){if(b.controls[1]){var f=new Ha;Wa(b.controls,function(a,b){f.set(b,a)}),b.controls.sort(function(a,b){function c(a,b,c,d){return a[c]?"*"===a[c]||db(b.name,a[c])?d:-d:0}var d=c(a,b,"after",1),e=c(a,b,"before",-1),g=c(b,a,"after",-1),h=c(b,a,"before",1);return(!d&&!e)^(!g&&!h)?d||e||g||h:d+e+g+h||f.get(a)-f.get(b)})}x(b)}}function U(a,b,d){var e=Na.getContext(),f=null,g=Oa(qb,function(a){return Na.focused(a.element)});if(g)e=g.context,f=g.element;else if(Za(e,V)){var h=wb(e).container;f=h.event&&h.event.context.element}var i=new c.Container(a);return i.context=new V(i,d),i.toolset=wb(b).toolset,i.parentContext=e,i.parentElement=f,wb(i,{dom:{positions:[]}}),i.tap(function(b){var c=i.getContext(b.target)||i.control;M(c)&&(i.emit(b,b.target===a?c.element:b.target),db(b.type,"focusin focusout")?(c.focusBy=b.source,x(c)):db(b.type,"asyncStart asyncEnd")&&u(c,function(a){x(a)}))}),T(i,null,[b],!0),i.flushEvents(),i}function V(a,b){var c=Xa(this,b);wb(c,{container:a,toolsets:new Ha})}function W(a,b){var c=this;c.name=a||"",c.labels=a?m(sb,a,f):{},c.options=b||{}}function X(a,b,c){var d=this;d.name=b.name,d.context=c,d.all={},wb(d,{container:a,options:b.options,control:d,flag:1}),a.add(d,b.options),a.emit("contextChange",d)}function Y(a,b){for(var c=0;a[b+(c||"")];c++);return b+(c||"")}function Z(a){var b=wb(a);if(!Za(b.childContext,V)){var c=new V(b.container);"value"in b.options||(b.value=c,Ta(a.context,a.name,function(){return c},function(b){var d=Xa({},c);y(a,"value",d,Xa(c,b))})),b.childContext=c}return b.childContext}function $(a,b,c,d){var e=a.name+(d?"":Ma.ucfirst(c));$a(a[c])?Ua(b,e,a[c].bind(a)):(Ja.call(b,e)&&(a[c]=b[e]),Ta(b,e,function(){return a[c]},function(b){a[c]=b})),wb(a).exports.push(e)}function _(a,b,c,d,e){var f=this,g=wb(b),h=!d&&c&&wb(c).toolset!==g.toolset,i=h?Z(c):c&&wb(c).childContext||(c||a).context,j=cb(wb(i).toolsets,g.toolset,function(){return new X(a,g.toolset,i)}),k=gb(),l=Y(j.all,g.name),m={control:f,species:b,container:a,toolset:g.toolset,options:g.options,templates:q(wb(c)||{},g),flag:1,values:{},initialValues:{},exports:[],toolsetState:j,toolsetEventHandle:k};wb(f,m),cb(ob,Ka(f),Ia).add(f),a.add(j,k,{stateChange:function(){J(f,5)}}),f.name=l,f.type=g.type,f.required=!1,Wa(g.options,function(a,b){$a(b)||$a(f[a])||(f[a]=b)}),Wa(e,function(a,b){$a(b)||$a(f[a])||(f[a]=b)}),void 0===f.label&&(f.label=g.name),"string"==typeof g.options.execute&&(f.shortcut=Na.getShortcut(g.options.execute)[0]),f.icon=f.icon||"",f.parent=c||null,f.state=j,f.context=i,f.parentContext=a.parentContext||null,f.parentElement=a.parentElement||null,f.controls=[],f.errors=null,f.id=gb(),f.all=j.all,f.all[l]=f,c&&(c.controls.push(f),d&&c.all!==f.all&&(c.all[l]=f)),g.defaultExport&&$(f,i,g.defaultExport,!0),Wa(g.options.exports,function(a,b){$(f,i,b)}),m.inited=!0}function aa(a,b,c,d){function e(){_.apply(this,arguments)}e.prototype=Ya(_);var f=this;f.name=c,f.type=b,wb(f,{toolset:a,type:b,name:c||d.name||b,options:d,defaultExport:d.defaultExport||"value"in d&&"value",templates:q(rb[b]||{},d),ctor:e})}function ba(a,b){b=b||e.createElement("controls"),b.style.display="none!important";var c={};l(b,function(a,b){c[Qa(a)]=j(b)});var d=this;d.control=a,d.context=c,d.placeholder=b,d.condition=c.of||"",d.layoutType=c.layout||a.type||"default",d.start=b,d.end=b,d.count=0}function ca(c,d){var e=this,f=wb(c),g=f.container,h=Q(f.options.template||"<z:"+Ma.hyphenate(c.type)+"/>",(rb[d]||"").templates||ub),i=h.dom.cloneNode(!0),j=Ma.iterateToArray(Ma.createNodeIterator(i,1)),k=j.filter(function(a,b){return h.binds[b]}),l=b.eval("sortby [ ! condition ]",a("controls",i).map(function(a,b){return new ba(c,b)}).get());g.setContext(i,c),Wa(rb[c.type].handlers,function(a,b){g.add(i,b)}),g.add(i,f.options),Wa(h.roles,function(a,b){rb[a]&&a!==c.type&&g.add(j[b],a,rb[a])}),g.add(i,{stateChange:function(){e.update()}}),Xa(e,{control:c,element:i,roles:h.roles,binds:h.binds,bindedNode:k,positions:l,layoutType:d}),c.cssClass&&a(i).addClass(c.cssClass)}function da(a,b,c){b=Xa({},b),b.templates=q({},b),b.handlers=[b],ub[a]=b.template||"",rb[a]=b;var d={};Wa(b,function(a,c){$a(c)||db(a,"templates template handlers")||(d[a]=c,delete b[a])}),b.defaultOptions=d,c||Va(W,ab(a,function(){for(var c=0,e=arguments.length,f=new h(e);c<e;c++)f[c]=arguments[c];var g=hb(f),i=g.string(),j={};return b.parseOptions&&b.parseOptions(j,g),Xa(j,g.next("object")&&g.value),new aa(this,a,i,Xa({},d,j))}))}function ea(a,b){a.execute=b.fn()}function fa(a,b){a.controls=b.nextAll(aa),ea(a,b)}function ga(a,b){a.icon=b.string(),ea(a,b)}function ha(a,b){var c=wb(a.context).dom,d=c.bindedNode[f.keys(c.binds).indexOf(g(c.roles[b]))];return d&&Ra(d,a.target)}function ia(a,b){if("click"!==a.type||ha(a,"button"))return b.execute()}function ja(a,b){if("click"!==a.type||ha(a,"checkbox"))return b.value=!b.value,"checkbox"===b.type?b.execute():a.handled()}function ka(a,b,c){var d,e=wb(a).ddToolset.all(a),f=Oa(e,function(a){return d=d||a,a.value===b});f||a.allowEmpty||(f=d),(a.setValue(f?f.value:"")||c)&&(a.hintValue=b,a.selectedText=(f&&a.valueAsLabel?f:a).label,Wa(a.controls,function(a,b){b.selected=b===f}))}function la(a,b){var c=Ma.isArray(b),d=[];Wa(b,function(a,b){d[d.length]=c&&_a(b)?b:{value:c?b:j(a),label:b}});for(var e=wb(a).ddToolset,g=[],h=0,i=d.length-f.keys(e.all(a)).length;h<i;h++)g[h]=e.choiceButton;a.append(g),Wa(e.all(a),function(a,b){b.enabled=b.visible=!!d[0],Xa(b,d.shift())}),ka(a,a.hintValue,!0)}function ma(b){var c=a(":file",b.target)[0],d=c.parentNode,f=e.createElement("form");f.appendChild(c),f.reset(),a(c).prependTo(d)}function na(a,b){var c={},d=(b||"").init;return b=Xa({inline:!0,defaultOptions:!1,disallowedElement:"*"},ab(Bb,Xa({},b))),Wa(a,function(a,d){($a(d)||"options"===a||"commands"===a?c:b)[a]=d}),Wa(b[Bb],function(a,d){c.options&&a in c.options||(b[a]=d,delete b[Bb][a])}),b.widgets=Xa(b.widgets,ab(Bb,c)),b.init=function(c){var e=c.typer.getStaticWidget(Bb);Wa(a.overrides,function(a,b){c.typer[a]=function(a){return b.call(this,e,a)}}),$a(d)&&d.call(b,c)},b}function oa(a,b){var c=a.editor;c.focused(!0)||b===c.getValue()||c.setValue(b),a.setValue(c.getValue())}function pa(a){var b=qa(a,"deferred");Ua(a.context,a.name,b.promise()),ra(a,"guard",!0)}function qa(b,c){return b[c]||(b[c]=a.Deferred())}function ra(a,b,c,d){a[b]&&(a[b][c?"resolve":"reject"](d),delete a[b])}function sa(a){a.value=a.optional?!!a.value:void 0,a.enableChildren=!a.optional||a.value}function ta(a,b,c){var d=[];!function a(b){Wa(b.controls,function(b,c){c.hasRole("buttonlist")&&!c.hasRole("menu")?a(c):c.hasRole("button")&&c.enabled&&c.visible&&(d[d.length]=c)})}(a);var e=d.indexOf(b);return d[e<0?0:e+c]}function ua(a,b,c,d){var e=a.callout;a.parent&&Ra(a.element,e)?(lb(e,"hidden",!1),fb(e,a.element,"right top inset-y")):(a.calloutParent?Na.snap(e,a.calloutParent):Za(b,k)?Na.snap(e,b,c):b&&fb(e,b,c,d),Na.focus(e),Ma.getState(e,"closing")&&(lb(e,"open",!1),lb(e,"closing",!1)),kb(e,"open"))}function va(a){var b=a.callout;a.parent&&Ra(a.element,b)?lb(b,"hidden",!0):kb(b,"closing",function(){jb(b)}),a.activeButton=null}function wa(a,b){b.destroy()}function xa(a,b,c,d,e){return a.import("dialog.prompt").render({value:c,valueEnabled:"prompt"===b,valueLabel:d,cancelVisible:"alert"!==b,action:e.string(),dialogTitle:e.string(),dialogDescription:"prompt"===b?e.string():d,dialogData:e.next("object")&&e.value,callback:e.fn()}).dialog}function ya(a){return b.string(a).replace(/ctrl|alt|shift/gi,function(a){return Ma.ucfirst(a)+"+"})}function za(a){var c={},d=b.string(a).replace(/ctrl|alt|shift/gi,function(a){return a=Ma.lcfirst(a),c[a]=Ba[a],""});return(c.alt||"")+(c.shift||"")+(c.ctrl||"")+(Ba[Ma.lcfirst(d)]||d)}var Aa,Ba=JSON.parse('{"ctrl":"⌘","alt":"⌥","shift":"⇧","enter":"↩","tab":"ℵ","pageUp":"⇞","pageDown":"⇟","backspace":"⌫","escape":"⎋","leftArrow":"⭠","upArrow":"⭡","rightArrow":"⭢","downArrow":"⭣","home":"⭦","end":"⭨"}'),Ca="checked selected disabled readonly multiple ismap",Da="element name type parent all controls context previousSibling nextSibling",Ea="enabled active visible".split(" "),Fa=/\{\{((?:[^\}]|\}(?!\}))+)\}\}/,Ga=s.WeakMap,Ha=s.Map,Ia=s.Set,Ja=f.hasOwnProperty,Ka=f.getPrototypeOf,La=f.getOwnPropertyNames,Ma=c.helper,Na=c.dom,Oa=Ma.any,Pa=Ma.bind,Qa=Ma.camel,Ra=Ma.containsOrEquals,Sa=Ma.createDocumentFragment,Ta=Ma.defineGetterProperty,Ua=Ma.defineHiddenProperty,Va=Ma.definePrototype,Wa=Ma.each,Xa=Ma.extend,Ya=Ma.inherit,Za=Ma.is,$a=Ma.isFunction,_a=Ma.isPlainObject,ab=Ma.kv,bb=Ma.makeArray,cb=Ma.mapGet,db=Ma.matchWord,eb=Ma.noop,fb=Ma.position,gb=Ma.randomId,hb=Ma.readArgs,ib=Ma.reject,jb=Ma.removeNode,kb=Ma.runCSSTransition,lb=Ma.setState,mb=Ma.tagName,nb=Ma.when,ob=new Ga,pb=new Ga,qb=new Ia,rb={},sb={},tb={},ub={},vb={},wb=Ma.createPrivateStore(),xb={language:"en"};Va(A,{getValue:function(a,c,d){var e=this;if(e.needEvaluate){var f=b(e.displayValue,z(a,!0));return!1!==d&&f!==e.lastValue&&y(a,c,e.lastValue,f),e.lastValue=f,f}return e.displayValue}}),Va(V,{toJSON:function(){return Xa({},this)},update:function(a){var b=wb(this),c=b.container;Xa(this,a),Wa(c.components,function(a,b){Za(b.context,X)&&v(b.context,"contextChange"),J(b.context,1)}),Wa(c.components,function(a,b){var c=Za(b.context,_);c&&(J(c,7),P(c)||v(c,"contextChange"))}),c.flushEvents()},validate:function(){return wb(this).container.control.validate()},reset:function(){Wa(wb(this).container.components,function(a,b){I(b.context)})}}),Va(W,{i18n:function(a,b,c){o(this.labels,a,b,c)},alert:function(a,b,c,d,e){return xa(this,"alert",!0,a,hb([b,c,d,e]))},confirm:function(a,b,c,d,e){return xa(this,"confirm",!0,a,hb([b,c,d,e]))},prompt:function(a,b,c,d,e,f,g){return xa(this,"prompt",b,a,hb([c,d,e,f,g]))},notify:function(a,b,c,d,e){var f=hb([b,c,d,e]);return this.import("dialog.notify").render({label:a,kind:f.string()||!0,timeout:f.next("number")&&f.value,within:f.next(k)&&f.value,data:f.next("object")&&f.value}).dialog},import:function(a,b){return new aa(this,"import",a,b||{})},export:function(a){for(var b=m(tb,a,h),c=1,d=arguments.length;c<d;c++)b[b.length]=arguments[c]},all:function(a){if(Za(a,k))a=Za(Na.getContext(a),V);else if(Za(a,_)){if(wb(a).toolset===this)return a.all;a=wb(a).childContext}var b=a&&wb(a).toolsets.get(this);return b?b.all:{}}}),Va(X,{get enabled(){return M(this)},set enabled(a){L(this,1,a)}}),Va(_,{get previousSibling(){var a=Za(wb(this).position,ba);return a&&a.start!==this?wb(this).container.getContext(this.element.previousSibling):null},get nextSibling(){var a=Za(wb(this).position,ba);return a&&a.end!==this?wb(this).container.getContext(this.element.nextSibling):null},get focused(){return Na.focused(this.element)},get pending(){return Na.locked(this.element)},get enabled(){return M(this)},set enabled(a){L(this,1,a)},get active(){return N(this)},set active(a){L(this,2,a)},get visible(){return!O(this)},set visible(a){L(this,4,a)},get value(){return wb(this).value},set value(a){E(this,a)},setValue:function(a){return E(this,a)},contains:function(a){for(var b=a;b&&b!==this;b=b.parent);return!!b},hasRole:function(a){var b=wb(this).dom.roles;return Oa(a,function(a){return a in b})},on:function(a,b){wb(this).container.add(this.element,_a(a)||ab(a,b))},watch:function(a,b,c){var d=this;D(Ka(d),a),$a(b)&&(d.on("propertyChange",function(c){a in c.oldValues&&b.call(d,c.newValues[a],c.oldValues[a],a,d)}),c&&b.call(d,d[a],null,a,d))},focus:function(){M(this)&&Na.focus(this.element)},validate:function(){return nb(G(this))},execute:function(a){var b=this;if(!M(b)||O(b)||qb.has(b))return ib();void 0!==a&&(b.value=a);var c=function(a,c){qb.delete(b),a&&(v(b,"executed",{data:c}),b.parent&&v(b.parent,"childExecuted",{control:b},!0)),v(b,"afterExecute",a)},d=function(){var a;v(b,"beforeExecute"),qb.add(b);try{var d=wb(b).options.execute;"string"==typeof d?a=(Na.support(d,b.focused)||eb)(b.value):$a(d)&&(a=d.call(b,b))}catch(b){console.error(b),a=ib(b)}return b.waitForExecution&&a&&$a(a.then)?(a=Na.lock(b.element,a,function(){return v(b,"cancel")||ib()}),Ma.always(Na.prepEventSource(a),c),a):(c(!0),nb())},e=G(b);return e?Na.prepEventSource(e).then(d):d()},reset:function(){u(this,I)},append:function(a,b){var c=this;b&&Wa(c.controls.slice(0),function(a,b){b.destroy()}),T(wb(c).container,c,bb(a))},destroy:function(){var a=this;a.pending&&Na.cancel(a.element,!0),nb(v(a,"beforeDestroy")).then(function(){var b=wb(a).container;if(u(a,function(a){var c=wb(a);Wa(c.allDOM,function(a,c){b.delete(c.element)}),b.delete(a.state,c.toolsetEventHandle),cb(ob,Ka(a)).delete(a),delete a.all[a.name],a.parent&&a.parent.all[a.name]===a&&delete a.parent.all[a.name],Wa(c.exports,function(b,c){delete a.context[c]})}),a.parent){var c=a.parent.controls;c.splice(c.indexOf(a),1),R(a),J(a.parent),x(a.parent)}else p(function(){b.destroy()}),Ma.removeNode(b.autoDestroy?b.element:a.element)})}}),Wa("icon label errors placeholder description",function(a,b){D(_.prototype,b)}),function(a,b){Wa(_a(a)||ab(a,b),function(a,b){vb[a]=b,D(_.prototype,a)})}({showIcon:"auto",showText:!0,hideDisabledChild:!1,hideCalloutOnBlur:!0,hideCalloutOnExecute:!0,waitForExecution:!0,enableChildren:!0}),Va(aa,{clone:function(a){var b=Ya(aa,this),c=Xa({},wb(this));return c.options=Xa({},c.options,a),wb(b,c),b},render:function(b,c){Za(b,k)||(c=b,b=e.createElement("div"));var d=U(b,this,c);return a(b).addClass("zeta-ui"),d.context}}),Va(ba,{get enabled(){return!1!==this.control.enableChildren}}),Va(ca,{update:function(){var b=this,c=b.control,d=c.element;c.parent&&S(c,c.parent);var e=wb(c).position;if(e){var f=/\*\*(([^*]|\*(?!\*))+)\*\*/g,g=/\*([^*]+)\*/g,h=z(c),i=0;if(Wa(b.binds,function(c,d){var j=b.bindedNode[i++],k=Xa({},e.context);Wa(d.context,function(a,b){k[a]=b.expression?r(b.expression,h,null,b.evalAsObject):b}),Wa(d,function(b,c){var d=r(c.expression,h,k,"class"===c.type||"prop"===c.type);switch(c.type){case"class":return lb(j,c.name,d);case"style":return a(j).css(c.name,d);case"prop":return void(j[c.name]=!!d);case"attr":return d=d.replace(f,"$1").replace(g,"$1"),a(j).attr(c.name,d||null)}(d=d.replace(f,"<b>$1</b>").replace(g,"<i>$1</i>").replace(/\n/g,"<br>"))!==j.innerHTML&&(j.innerHTML=d)})}),lb(d,{active:h.active,loading:h.pending,error:h.errors,disabled:!h.enabled,hidden:!h.visible,focused:h.focused&&h.focusBy}),d.disabled=!h.enabled,c.controls[1]){var j=new Ha;Wa(c.controls,function(a,b){j.set(b.element,a)}),Wa(b.positions,function(b,c){for(var d=c.count-1;d>0;d--)for(var e=0,f=c.start;e<d;e++,f=f.nextSibling)j.get(f)>j.get(f.nextSibling)&&(a(f.nextSibling).insertBefore(f),f=f.previousSibling,0===e?c.start=f:e===c.count-1&&(c.end=f.nextSibling))})}Wa(c.controls,function(a,b){S(b,c)})}}}),Xa(W,{define:da,on:function(a,b,c){rb[a].handlers.push(_a(b)||ab(b,c))},i18n:function(a,b,c,d){o(m(sb,a,f),b,c,d)},hasRole:function(a,b){var c=Za(Na.getContext(a),V);return c&&wb(c).container.getContext(a).hasRole(b)}}),c.UI=W,da("button",{template:'<button class="danger:{{danger}}"><z:label/><children/></button>',danger:!1,defaultExport:"execute",parseOptions:ga,enter:ia,click:ia}),da("submit",{template:'<z:button class="zeta-submit"/>',defaultExport:"execute",parseOptions:function(a,b){a.icon=b.string(),a.execute=function(a){for(var b=a;b&&!b.hasRole("form");b=b.parent);return b&&b.execute()}},enter:ia,click:ia})
;var yb="[ @global.showIcon ?? showIcon ]",zb="[ @global.showText ?? showText ]",Ab="[ @global.icon ?? icon ]";da("label",{template:'<span class="zeta-label hidden:{{[ ! '+yb+" || ! "+Ab+" ] && ! "+zb+'}}" title="{{tooltip || label}}"><i class="material-icons hidden:{{[ ! '+Ab+" && "+yb+" != true ] || ! "+yb+'}}">{{'+Ab+"}}</i>{{? "+zb+' [ @global.label ?? label ] ""}}</span>',showIcon:"auto",showText:!0,defaultExport:"label"}),da("checkbox",{template:'<z:button class="zeta-checkbox checked:{{value}}" show-icon="false" show-text="true"/>',value:!1,preventLeave:!0,parseOptions:ea,click:ja,enter:ja,space:ja}),da("dropdown",{template:'<label class="zeta-dropdown"><z:button label="{{selectedText}}" show-text="true"/><z:menu/></label>',requireChildControls:!0,hideCalloutOnBlur:!0,hideCalloutOnExecute:!0,preventLeave:!0,allowEmpty:!0,valueAsLabel:!0,value:"",parseOptions:function(a,b){a.icon=b.string(),(b.next(h)||b.next(Ha))&&(a.choices=b.value,a.value=b.next("string")||b.next("number")?b.value:""),fa(a,b)},init:function(a,b){var c=new W(wb(b).toolset.name);c.choiceButton=c.button({template:'<z:button class="selected:{{selected}}" show-icon="true" show-text="true"/>',execute:function(a){ka(b,a.value),b.execute()}}),wb(b).ddToolset=c,b.hintValue=b.value,b.selectedText=b.label,b.watch("choices",function(a){la(b,a)},!0)},click:function(a,b){ua(b),a.handled()},setValue:function(a,b){la(b,b.choices),ka(b,a.newValue),a.handled()}}),da("callout",{template:'<label class="zeta-callout"><controls of="not parent.alwaysShowCallout && parent.controls where enabled as _enabled && _enabled.length == 1 && _enabled.0.id == id"/><z:button class="hidden:{{[ not alwaysShowCallout ] && controls where enabled length == 1}}"/><z:menu/></label>',requireChildControls:!0,hideCalloutOnExecute:!0,hideCalloutOnBlur:!0,alwaysShowCallout:!0,parseOptions:function(a,b){a.icon=b.string(),a.controls=b.nextAll(aa)},click:function(a,b){ua(b),a.handled()}}),da("buttonlike",{template:'<label class="has-clickeffect"><children/></label>'},!0),da("link",{template:'<z:buttonlike><a href="{{value}}" target="{{target}}"><z:label show-icon="auto"/></a></z:buttonlike>',parseOptions:function(a,b){a.icon=b.string(),a.value=b.string(),a.target=b.string()}}),da("file",{template:'<z:buttonlike><z:label show-icon="auto"/><input type="file" multiple="{{multiple}}"/></z:buttonlike>',autoReset:!0,multiple:!1,parseOptions:ga,init:function(b,c){a(":file",b.target).change(function(a){c.execute(bb(a.target.files))})},afterExecute:function(a,b){b.autoReset&&ma(a)},reset:function(a,b){ma(a)}});var Bb="__preset__",Cb={overrides:{getValue:function(){return this.extractText()}}};da("textbox",{template:'<z:textboxlike><z:contenteditable spellcheck="false"/></z:textboxlike>',hideCalloutOnExecute:!1,preventLeave:!0,value:"",placeholder:"",parseOptions:ea,init:function(a,b){b.editorOptions=na(b.preset||Cb,b.options),b.watch("editor",function(a){b.options=a.getStaticWidget(Bb).options,b.editorOptions.options=Xa({},b.options)})},reset:function(a,b){b.options=b.editor.getStaticWidget(Bb).options,Xa(b.options,b.editorOptions.options)}}),da("textboxlike",{template:'<label class="zeta-textbox keep-placeholder:{{showPlaceholder == always && ! $placeholder}}"><z:label show-text="false" show-icon="auto"/><div class="zeta-textbox-wrapper" data-label="{{? $placeholder label}}"><div class="zeta-textbox-inner"><children/><div class="zeta-textbox-placeholder">{{placeholder || label}}</div></div><div class="zeta-textbox-error"></div><div class="zeta-textbox-clear"></div></div></label>',click:function(a,b){Za(a.target,".zeta-textbox-clear")&&(b.execute(""),b.editor.focus())}},!0),da("richtext",{template:'<div class="zeta-richtext"><div class="zeta-richtext-toolbar"></div><label class="zeta-textbox"><z:contenteditable/><div class="zeta-textbox-placeholder"><p>{{label}}</p></div></label></div>',hideCalloutOnExecute:!1,preventLeave:!0,value:"",parseOptions:ea,init:function(b,c){c.editorOptions=c.options||{},c.editorOptions.toolbar={container:a(".zeta-richtext-toolbar",b.target)[0]}},validate:function(a,b){if(b.required&&!b.editor.extractText())return ib("required")}}),da("contenteditable",{template:'<div class="zeta-editable" contenteditable spellcheck="{{spellcheck}}"></div>',init:function(a,b){b.editor=new c.Editor(a.target,b.editorOptions),b.editor.enable("stateclass",{target:b.element,focused:""}),b.editor.on("contentChange",function(){b.setValue(b.editor.getValue())&&b.execute()}),oa(b,b.value)},stateChange:function(a,b){b.editor.enabled()^b.enabled&&b.editor[b.enabled?"enable":"disable"]()},focusin:function(a,b){b.editor.focused()||b.editor.focus()},setValue:function(a,b){oa(b,a.newValue),a.handled()},validate:function(a,b){return b.editor.validate()}},!0),da("form",{template:'<div class="zeta-form"><children controls/></div>',templates:{buttonset:'<z:buttonset><children controls show-text="true"/></z:buttonset>',textbox:'<z:textbox show-placeholder="always"/>'},parseOptions:fa,preventLeave:!0,init:function(a,b){pa(b)},childExecuted:function(a,b){"script"!==a.source&&a.control.preventLeave&&!b.guard&&Na.lock(b.element,qa(b,"guard"),function(){return b.preventLeave?wb(b).toolset.confirm("leaveForm"):nb()})},beforeExecute:function(a,b){ra(b,"guard",!0)},executed:function(a,b){ra(b,"deferred",!0,null!==a.data?a.data:void 0!==b.value?b.value:b.context.toJSON()),b.reset()},cancelled:function(a,b){ra(b,"deferred",!1)},destroy:function(a,b){ra(b,"deferred",!1)},reset:function(a,b){b.deferred||pa(b)}}),da("fieldset",{template:'<div class="zeta-fieldset optional:{{optional && [ ? value checked [ ! value ] ]}}"><div class="zeta-fieldset-title"><z:checkbox/><p>{{description}}</p></div><div class="zeta-form hidden:{{not enableChildren}}"><children controls/></div></div>',templates:{textbox:'<z:textbox show-placeholder="always"/>'},value:!1,optional:!1,parseOptions:fa,init:function(a,b){sa(b)},propertyChange:function(a,b){("optional"in a.newValues||"value"in a.newValues)&&sa(b)}}),da("buttonset",{template:'<div class="zeta-buttonset"><children controls/></div>',templates:{textbox:'<z:textbox show-placeholder="auto"/>'},requireChildControls:!0,hiddenWhenDisabled:!0,parseOptions:fa}),da("buttonlist",{template:'<div class="zeta-buttonlist"><children show-text="true" show-icon="true" controls/></div>',templates:{button:'<z:button><span class="zeta-label zeta-label-description">{{description ?? [ shortcut :zeta-shortcut ]}}</span></z:button>'},showIcon:!0,showText:!0,requireChildControls:!0,hiddenWhenDisabled:!0,parseOptions:fa,stateChange:function(a,b){Wa(b.controls,function(a,b){if("buttonlist"===b.type){var c=function(a){for(var c=b[a];c&&!c.visible;c=c[a]);return c},d=c("previousSibling"),e=c("nextSibling");lb(b.element,"sep",{before:d,after:e&&"buttonlist"!==e.type})}})}}),da("menu",{template:'<div class="zeta-ui zeta-menu zeta-float"><z:buttonlist/></div>',waitForExecution:!1,parseOptions:fa,init:function(a,b){for(var c=a.target,d=b.parent;d&&d.hasRole("buttonlist")&&!d.hasRole("menu");d=d.parent);!b.parent||d&&!d.hasRole("menu")?b.parent||c!==b.element?(b.calloutParent=c.parentNode,Na.retainFocus(b.element,c),jb(c)):(Ua(b.context,"showMenu",ua.bind(null,b)),Ua(b.context,"hideMenu",va.bind(null,b)),Ua(b.context,"element",c)):(Pa(b.element,"mouseenter",ua.bind(null,b)),Pa(b.element,"mouseleave",va.bind(null,b))),Pa(b.element,"mousemove",function(){b.activeButton=null}),lb(a.target,"is-"+b.type,!0),b.callout=c,b.activeButton=null,b.watch("activeButton",function(a,c){(c||{}).active=!1,(a||{}).active=!0,(a||b).focus()}),va(b)},focusin:function(a,b){"keyboard"!==a.source||b.parent||(ua(b),b.activeButton=ta(b,b,1))},focusout:function(a,b){b.activeButton=null,b.hideCalloutOnBlur&&va(b)},keystroke:function(a,b){var c=b.activeButton,d=/^(up|down|left|right)Arrow$/.test(a.data)&&n.$1[0];"l"===d?b.parent?c&&(va(b),a.handled()):a.handled():"r"===d?(ua(b),b.activeButton=c||ta(b,b,1),a.handled()):d&&(c||!b.parent||b.calloutParent)&&(b.activeButton=ta(b,c,"u"===d?-1:1)||c,a.handled())},childExecuted:function(a,b){b.activeButton=null;for(var c=a.control;c&&c!==b.parent;c=c.parent)if(!c.hideCalloutOnExecute)return;va(b)},beforeDestroy:function(a,b){va(b)}}),da("dialog",{template:'<div class="zeta-ui zeta-dialog"><z:anim class="zeta-float zeta-dialog-inner"><div class="zeta-dialog-content"><h2>{{title}}</h2><z:form><p>{{description}}</p><controls/></z:form></div><div class="zeta-dialog-error error hidden:{{not errorMessage}}">{{errorMessage}}</div><controls of="type == buttonset"/></z:anim></div>',templates:{buttonset:'<z:buttonset class="zeta-dialog-buttonset"><controls of="danger" show-text="true"/><div class="zeta-buttonset-pad"></div><controls show-text="true"/></z:buttonset>'},pinnable:!0,modal:!0,title:"",description:"",errorMessage:"",parseOptions:fa,init:function(b,c){var f=c.element,g=c.parentElement,h=g&&c.pinnable&&screen.availWidth>=600&&screen.availHeight>=600&&W.hasRole(g,"button buttonlike")?g:d;a(f).appendTo(e.body),g&&Na.retainFocus(g,f),c.modal&&Na.setModal(f),Na.snap(f,h,"auto"),Ma.setZIndexOver(f,g||e.activeElement),p(function(){Na.focus(f)})},error:function(a,b){b.errorMessage=(a.error||"").message||a.error||"",a.handled()},focusout:wa,escape:wa,afterExecute:function(a,b){a.data&&wa(a,b)},enter:function(a,b){return b.execute()}}),da("anim",{template:"<div><children controls/></div>",init:function(a,b){kb(a.target,"open")},focusreturn:function(a,b){kb(a.target,"pop",!0)},beforeDestroy:function(a,b){return kb(a.target,"closing")}},!0),da("generic",{parseOptions:fa});var Db=new W("dialog");Db.i18n("en",{action:"OK",cancel:"Cancel",leaveForm:"There are unsubmitted information on the page. Are you sure to leave?"}),Db.export("dialog.prompt",Db.dialog({preventLeave:!1,data:null,exports:"title description errorMessage data",controls:[Db.textbox("value",{hiddenWhenDisabled:!0,exports:"enabled label"}),Db.buttonset(Db.submit("action","done",{defaultExport:"label",exports:"icon"}),Db.button("cancel","close",{exports:"visible",execute:function(a){return a.all.dialog.destroy()}}))],execute:function(a){return($a(a.context.callback)||nb)(a.context.value)}}));var Eb;Db.export("dialog.notify",Db.generic({template:'<z:anim class="zeta-ui zeta-snackbar notify:{{kind}}"><div class="zeta-float"><z:buttonset><z:label/><z:button icon="close" show-text="false" show-icon="true"/></z:buttonset></div></z:anim>',data:null,init:function(a,b){Eb&&Eb.destroy(),Xa(b,b.context),Na.snap(a.target,b.within||e.body,"top center inset"),b.timeout&&p(function(){b.destroy()},b.timeout),Eb=b},click:function(a,b){b.destroy()}})),Wa("alert confirm prompt notify",function(a,b){W[b]=Db[b].bind(Db)}),b.pipes[":zeta-shortcut"]=c.IS_MAC?za:ya}(),function(){function b(){L.timestamp=n.getSelection().timestamp,L.rect=C(n).translate(H.scrollLeft,H.scrollTop),B(this,{typer:n,pointerX:L.x||0,pointerY:L.y||0,mousedown:N,hoverNode:t||null,activeHandle:r||null,editorReflow:!M.rect||!y.rectEquals(M.rect,L.rect),pointerMoved:M.x!=L.x||M.y!=L.y,selectionChanged:M.timestamp!==L.timestamp}),B(M,L)}function f(a,b){this.cursor=a||"pointer",this.done=b,this.active=!1}function g(){var b={N:"typer-visualizer",G:"background",S:"selection",X:"transparent"};a(e.body).append("<style>.has-N{caret-color:X;}.has-N:focus{outline:none;}.has-N::S,.has-N ::S{G:X;}.has-N::-moz-S,.has-N ::-moz-S{G:X;}@keyframes caret{0%{opacity:1;}100%{opacity:0;}}</style>".replace(/\b[A-Z]/g,function(a){return b[a]||a})).append(G),z(G,"mousedown",function(a){1&a.buttons&&((r||{}).active=!1,r=I.get(a.target),r.active=!0,y.always(c.dom.drag(a,n.element),function(){(r.done||y.noop).call(r),r.active=!1,r=null,n.focus(),k(!0)}),a.preventDefault())}),z(d,"mousedown mousemove mouseup",function(a){L.x=a.clientX,L.y=a.clientY,t=n&&n.nodeFromPoint(L.x,L.y),q(w),"mousemove"===a.type?w=p(k,0):(N=1&a.buttons,w=p(k,0,!0))}),z(d,"scroll resize orientationchange focus",k)}function h(a,b){J[a]=[b,[],{},!0]}function j(a,b,c,d,e){for(var f=0,g=u.length;f<g;f++)if(u[f].state===b&&u[f].kind===a)return void(v[v.length]=u.splice(f,1)[0]);v[v.length]={kind:a,state:b,rect:c||("top"in b?b:C),css:d,handle:e}}function k(c){if(c=!0===c,q(w),n&&(c||n.focused())){var d=new b;(c||d.editorReflow||d.selectionChanged||d.pointerMoved)&&A(J,function(b,f){v=f[1],u=v.splice(0),!1!==f[3]&&f[0].call(null,d,f[2]),u.forEach(function(b){K[K.length]=a(b.dom).detach().removeAttr("style")[0],I.delete(b.dom)}),v.forEach(function(b){if(c||!b.dom||d.editorReflow||D(b.rect)){var f=b.dom||(b.dom=a(K.pop()||e.createElement("div"))[0]);a(f).appendTo(G).css(B({position:"absolute",cursor:(b.handle||"").cursor,pointerEvents:b.handle?"all":"none"},b.css,y.cssFromRect("top"in b.rect?b.rect:b.rect(b.state),G))),I.set(f,b.handle)}})})}}function l(b){n=b,b?(y.setZIndexOver(G,b.element),b.retainFocus(G),k(!0)):a(G).children().detach()}var m,n,r,t,u,v,w,x=c.Editor,y=c.helper,z=y.bind,A=y.each,B=y.extend,C=y.getRect,D=y.isFunction,E=y.matchWord,F=y.toPlainRect,G=a('<div style="position:absolute;top:0;left:0;">')[0],H=e.documentElement,I=new s.WeakMap,J={},K=[],L={},M={},N=!1;y.definePrototype(b,{refresh:function(){p(k,0,!0)},toggleLayer:function(a,b){var c=!1;a.split(" ").forEach(function(a){c|=b^(J[a]||"")[3],(J[a]||{})[3]=b}),c&&p(k,0,!0)},fill:function(a,b,c){var d={};d.background=b||"rgba(0,31,81,0.2)",A(y.makeArray(a),function(a,b){j("f",b,null,d,c)})},drawCaret:function(a){j("k",a,null,{animation:"caret 0.5s infinite alternate ease-in",outline:"1px solid rgba(0,31,81,0.8)"})},drawBorder:function(a,b,c,d,e){var f={};f.border=o(b)+"px "+(d||"solid")+" "+(c||"black"),f.margin=e?"0px":-o(b)+"px",f.boxSizing=e?"border-box":"auto",j("b",a,null,f)},drawLine:function(a,b,c,d,e,f,g,h){if(void 0!==a.left)return a=a.collapse(b),this.drawLine(a.left,a.top,a.right,a.bottom,c,d,e,f);var k=c-a,l=d-b,m={};m.borderTop=o(e)+"px "+(g||"solid")+" "+(f||"black"),m.transformOrigin="0% 50%",m.transform="translateY(-50%) rotate("+i.atan2(l,k)+"rad)",j("l",F(a,b,a+i.sqrt(l*l+k*k),b),null,m,h)},drawHandle:function(a,b,c,d,e){var f={};f.border="1px solid #999",f.background="white"+(d?' url("'+d+'")':""),c=c||8,j("c",a,function(){var d=C(a),e=E(b,"left right")||"centerX",f=E(b,"top bottom")||"centerY";return d.left-=c,d.top-=c,F(d[e],d[f],d[e]+c,d[f]+c)},f,e)}}),h("selection",function(a){var b=a.typer.getSelection();b.isCaret?"caretColor"in H.style&&a.drawCaret(b.baseCaret):a.fill(b.getRects())}),x.widgets.visualizer={init:function(b){a(b.typer.element).addClass("has-typer-visualizer"),m||(g(),m=!0)},focusin:function(a){l(a.typer)},focusout:function(a){l(null)},contentChange:function(a){k(!0)},stateChange:function(a){a.typer.enabled()?n===a.typer?k():a.typer.focused()&&l(a.typer):l(null)}},x.defaultOptions.visualizer=!0,B(x,{addLayer:h,handle:function(a,b){return new f(a,b)}})}(),function(){var a,b,d=c.Editor,e=c.helper,f=e.getRect,g=e.containsOrEquals,h=d.prototype.closest,i=d.handle("move",function(){a&&b&&a.typer.invoke(function(c){c.selection.select(b),c.insertHtml(a.element)})});d.addLayer("dragWidget",function(c){var j=c.hoverNode;if(i.active){var k=h(j,d.NODE_PARAGRAPH|d.NODE_WIDGET);if(b=null,k&&!g(a,k)){var l=f(k),m=f(h(k,d.NODE_EDITABLE)),n=c.pointerY<l.centerY,o=n?k.previousSibling:k.nextSibling;if(o!==a&&c.typer.widgetAllowed(a.widget.id,k)){var p;if(o){var q=f(o);p=(l.bottom<=q.top?l.bottom+q.top:q.bottom+l.top)/2}else p=f(k,!0)[n?"top":"bottom"];c.drawLine(m.left,p,m.right,p,1,"red","dashed"),b=c.typer.createCaret(k.element,n)}}c.fill(a.element)}else!j||a&&!g(a,j)&&e.pointInRect(c.pointerX,c.pointerY,f(a),10)||(a=h(j,d.NODE_WIDGET));a&&c.drawHandle(a,"left top",11,"data:image/gif;base64,R0lGODlhCwALAKEBAE1PUP///////////yH5BAEKAAIALAAAAAALAAsAAAIUjI8ZoAffDFOzuoexk5zGBUXTlxQAOw==",i)})}(),function(){function b(a){return a.filter(function(b){return!a.some(function(a){return a!==b&&a.contains(b)})})}function d(b){var c=a(b).css("text-align"),d=a(b).css("direction");switch(c){case"-webkit-left":case"-webkit-right":case"-webkit-center":return c.slice(8);case"start":return"ltr"===d?"left":"right";case"end":return"ltr"===d?"right":"left";default:return c}}function e(b,c){var e;return a(b).each(function(b,f){var g;g="textAlign"===c?d(f):"inlineClass"===c?a(f).attr("class")||"":a(f).css(c),e=""===e||e&&e!==g?"":g}),e||""}function f(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),a===b||K.test(a)&&K.test(b)}function g(a,b){var c=D.createElement(a);return b&&(c.className=b),c}function h(b,c){return c=H(c,k)||g(c),a(c).append(b.childNodes).replaceAll(b)[0]}function i(b,c,d,e,f){var g=b.selection,h=g.getParagraphElements(),i=g.getSelectedTextNodes();g.isCaret&&!e?(b.insertHtml(c),c.appendChild(D.createTextNode()),g.moveToText(c,-0)):i[0]&&(h.forEach(function(b){if(!f||!D.matchWord(r(b)[f[0]],f[1]))if(e){var g=a(i,b).parentsUntil(b).filter(d),h=g.contents().filter(function(a,b){return i.every(function(a){return!D.containsOrEquals(b,a)})});g.contents().unwrap(),h.wrap(c)}else a(b).find(i).wrap(c)}),g.select(i[0],0,i[i.length-1],-0)),a(h).find(d).filter(":has("+d+")").each(function(b,c){a(c).contents().unwrap().filter(function(a,b){return 3===b.nodeType}).wrap(c)}),a(h).find('span[class=""],span:not([class])').contents().unwrap(),a(h).find(d).each(function(b,c){D.sameElementSpec(c.previousSibling,c)&&(a(c.childNodes).appendTo(c.previousSibling),I(c))})}function j(b){a(b.selection.getParagraphElements()).attr("align",y[b.commandName])}function l(a){var b=a.commandName;i(a,g(z[b].split(",")[0]),z[b],a.widget[b],A[b])}function m(b,c){var d="insertOrderedList"===b.commandName||c?"ol":"ul",e="<"+d+(c||"").replace(/^.+/,' type="$&"')+">",f=function(b,e){return H(e,d)&&(a(e).attr("type")||"")===(c||"")},g=[];G(b.selection.getParagraphElements(),function(c,d){if(a(d).is("ol>li,ul>li"))a(d.parentNode).filter(f)[0]?a(d).is("li")&&a.inArray(d.parentNode,g)<0&&p(b,[d]):(h(d.parentNode,a(e)[0]),g.push(d.parentNode));else{var i=a(d).prev().filter(f)[0]||a(d).next().filter(f)[0]||a(e).insertAfter(d)[0];a(d)[D.comparePosition(d,i)<0?"prependTo":"appendTo"](i),h(d,"li"),g.push(i)}})}function o(c,d){d=a.makeArray(d||b(c.selection.getParagraphElements())),G(d,function(b,c){var d=a(c).parent("ul,ol")[0]||a(c).prev("ul,ol")[0]||a("<ul>").insertBefore(c)[0],e=d;if(e===c.parentNode){var f=a(c).prev("li")[0]||a("<li>").insertBefore(c)[0];e=a(f).children("ul,ol")[0]||a(d.cloneNode(!1)).appendTo(f)[0]}a(h(c,"li")).appendTo(e),a(e).parent("li")[0]&&a(D.createTextNode(" ")).insertBefore(e),d.children[0]||I(d)})}function p(c,d){d=a.makeArray(d||b(c.selection.getParagraphElements())),G(d,function(b,d){var e=a(d).parent("ul,ol")[0],f=a(e).parent("li")[0];a(d).next("li")[0]&&(f?a(e.cloneNode(!1)).append(a(d).nextAll()).appendTo(d):(a(e.cloneNode(!1)).append(a(d).nextAll()).insertAfter(e),a(d).children("ul,ol").insertAfter(e))),f?(a(d).insertAfter(f),D.trim(c.typer.extractText(f))||I(f)):a(h(d,"p")).insertAfter(e),e.children[0]||I(e)})}function q(b){var c=b.typer.getSelection().getSelectedElements();b.widget.inlineClass=e(a(c).filter("span"),"inlineClass"),G(A,function(a,d){b.widget[a]=!!D.matchWord(e(c,d[0]),d[1])})}function s(b){var c=b.typer.getSelection(),d=c.getParagraphElements().slice(-1)[0];a(d).is("li")&&(d=a(d).closest("ol, ul")[0]||d);var f=d&&d.tagName.toLowerCase(),g=f+(a(d).attr("class")||"").replace(/^(.)/,".$1"),h=e(c.getSelectedElements(),"textAlign");F(b.widget,{justifyLeft:"left"===h,justifyCenter:"center"===h,justifyRight:"right"===h,justifyFull:"justify"===h,formatting:f,formattingWithClassName:g})}function t(a){return a.context.typer.getSelection()}function u(a){return!!t(a).getParagraphElements()[0]}function v(a){var b=t(a);return!!H(b.startNode,C.NODE_PARAGRAPH|C.NODE_EDITABLE_PARAGRAPH|C.NODE_INLINE)}function w(a,b){return L.button(a,M[a],{realm:b,execute:a,enabled:"inlineStyle"===b?v:u,active:function(c){var d=c.context.typer.getStaticWidget(b);return d&&d[a]}})}function x(b,c){return L.button(D.camel(B[b]),{description:c,execute:function(a){a.context.typer.invoke(function(a){a.insertWidget("list",b)})},active:function(c){var d=t(c).getWidget("list");return d&&a(d.element).attr("type")===b}})}var y={justifyLeft:"left",justifyRight:"right",justifyCenter:"center",justifyFull:"justify"},z={bold:"b,strong",italic:"i,em",underline:"u",strikeThrough:"strike"},A={bold:["fontWeight","bold 700"],italic:["fontStyle","italic"],underline:["textDecoration","underline"],strikeThrough:["textDecoration","line-through"]},B={1:"decimal",A:"upper-alpha",a:"lower-alpha",I:"upper-roman",i:"lower-roman"},C=c.Editor,D=c.helper,E=c.dom,F=D.extend,G=D.each,H=D.is,I=D.removeNode,J=/^([a-z\d]*)(?:\.(.+))?/i,K=/^(p|h[1-6])(?:\.(.+))?$/i;C.widgets.inlineStyle={stateChange:q,contentChange:q,commands:{bold:l,italic:l,underline:l,strikeThrough:l,superscript:l,subscript:l,applyClass:function(a,b){i(a,g("span",b),"span")}}},C.widgets.formatting={stateChange:s,contentChange:s,commands:{justifyCenter:j,justifyFull:j,justifyLeft:j,justifyRight:j,formatting:function(b,c){var d=/^([a-z\d]*)(?:\.(.+))?/i.exec(c)||[];"ol"===d[1]||"ul"===d[1]?b.insertWidget("list","ol"===d[1]&&"1"):a(b.selection.getParagraphElements()).not("li").each(function(a,b){d[1]&&!H(b,d[1])&&f(d[1],b.tagName)?h(b,g(d[1]||"p",d[2])):b.className=d[2]||""})},insertLine:function(a){a.insertText("\n\n")},insertLineBefore:function(a){var b=a.selection.focusNode.widget;"__root__"!==b.id&&(a.selection.select(b.element,!0),a.insertText("\n\n"))}}},C.widgets.lineBreak={shiftEnter:function(a){a.typer.invoke("insertLineBreak"),a.handled()},commands:{insertLineBreak:function(a){a.insertHtml("<br>")}}},C.widgets.list={element:"ul,ol",editable:"ul,ol",textFlow:!0,create:m,remove:function(a){p(a,a.widget.element.children)},extract:function(a){},receive:function(a){D.sameElementSpec(a.widget.element,a.receivedNode)&&(a.handled(),a.typer.invoke(function(b){b.insertHtml(a.receivedNode.childNodes)}))},tab:function(a){a.typer.invoke("indent"),a.handled()},shiftTab:function(a){a.typer.invoke("outdent"),a.handled()},init:function(b){a(b.widget.element).filter("ol").attr("type-css-value",B[a(b.widget.element).attr("type")]||"decimal"),a(b.widget.element).parent("li")[0]&&!b.widget.element.previousSibling&&a(D.createTextNode()).insertBefore(b.widget.element)},contentChange:function(b){a(b.widget.element).children("li")[0]||b.typer.invoke(function(a){I(b.widget.element)})},setup:function(a){a.typer.on("tab",function(a){a.typer.invoke(o),a.handled()})},commands:{indent:o,outdent:p}},F(C.defaultOptions,{lineBreak:!0,formatting:!0,inlineStyle:!0,list:!0}),E.setShortcut({bold:"ctrlB",italic:"ctrlI",underline:"ctrlU",justifyLeft:"ctrlShiftL",justifyCenter:"ctrlShiftE",justifyRight:"ctrlShiftR",insertLineBefore:"ctrlEnter"});var L=new c.UI("zeta.editor.formatting",{contextChange:function(a,b){G("formatting inlineStyle list",function(a,c){b[c]=b.context.typer.widgetEnabled(c)})}}),M={bold:"",italic:"",underline:"",strikeThrough:"",unorderedList:"",orderedList:"",indent:"",outdent:"",justifyLeft:"",justifyCenter:"",justifyRight:"",justifyFull:""},N=L.buttonlist(L.button("inlineStyleClear",function(a){a.context.typer.invoke("applyClass","")}),{after:"*"});L.export("zeta.editor.toolbar",L.buttonset(L.dropdown("paragraph",{realm:"formatting",execute:"formatting",visible:function(a){return u(a)&&a.controls.length>0},contextChange:function(a,b){var c=t(b),d=c.typer.getStaticWidget("formatting"),e=(c.startNode===c.endNode?c.startNode:c.focusNode).element,g=D.any(b.controls,function(a){return a.value===d.formattingWithClassName});b.choices=D.map(b.context.options.formattings,function(a,b){return!J.test(b)||f(e.tagName,n.$1)?{value:b,label:a}:null}),b.value=g?g.value:d.formatting}}),L.dropdown("inlineStyle",{realm:"inlineStyle",execute:"applyClass",init:function(a,b){b.choices=b.context.options.inlineClass,b.append(N)},visible:function(a){return v(a)&&a.controls.length>1},contextChange:function(a,b){var c=b.context.typer.getStaticWidget("inlineStyle");b.value=c.inlineClass}}),w("bold","inlineStyle"),w("italic","inlineStyle"),w("underline","inlineStyle"),w("strikeThrough","inlineStyle"),L.button("unorderedList",M.unorderedList,{realm:"list",execute:function(a){a.context.typer.invoke(function(a){a.insertWidget("list")})},active:function(a){var b=t(a).getWidget("list");return b&&H(b.element,"ul")},enabled:function(a){return u(a)&&t(a).widgetAllowed("list")}}),L.callout("orderedList",M.orderedList,L.buttonlist(x("1","1, 2, 3, 4"),x("a","a, b, c, d"),x("A","A, B, C, D"),x("i","i, ii, iii, iv"),x("I","I, II, III, IV")),L.button("clearOrderedList",{execute:"outdent",visible:function(a){return a.parent.active}}),{realm:"list",active:function(a){var b=t(a).getWidget("list");return b&&H(b.element,"ol")},enabled:function(a){return u(a)&&t(a).widgetAllowed("list")}}),w("indent","list"),w("outdent","list"),w("justifyLeft","formatting"),w("justifyCenter","formatting"),w("justifyRight","formatting"),w("justifyFull","formatting"),{visible:v})),L.i18n("en",{bold:"Bold",italic:"Italic",underline:"Underlined",strikeThrough:"Strikethrough",unorderedList:"Bullet list",orderedList:"Numbered list",indent:"Indent",outdent:"Outdent",justifyLeft:"Align left",justifyCenter:"Align center",justifyRight:"Align right",justifyFull:"Align justified",paragraph:"Formatting",inlineStyle:"Text style",inlineStyleClear:"Clear style",decimal:"Decimal numbers",lowerAlpha:"Alphabetically ordered list, lowercase",upperAlpha:"Alphabetically ordered list, uppercase",lowerRoman:"Roman numbers, lowercase",upperRoman:"Roman numbers, uppercase",clearOrderedList:"Remove numbered list",format_p:"Paragraph",format_h1:"Header 1",format_h2:"Header 2",format_h3:"Header 3",format_h4:"Header 4",format_h5:"Header 5",format_h6:"Header 6",format_table:"Table",format_td:"Table cell",format_th:"Table header",format_ul:"Unordered list",format_ol:"Ordered list",format_li:"List item",format_blockquote:"Blockquote"})}(),function(){function b(a){var b=e.createElement("a");return b.href=a||"",location.protocol===b.protocol&&location.hostname===b.hostname&&(location.port===b.port||""===location.port&&b.port===("https:"===location.protocol?"443":"80"))?b.pathname.replace(/^(?!\/)/,"/")+b.search+b.hash:a}function f(b){var c,d=b.context.typer,e=(b.state.widget||"").element;if(e)c={href:e.getAttribute("href"),text:e.textContent,blank:"_blank"===e.getAttribute("target")};else{var f=d.getSelection().getSelectedText();c={href:/^[a-z]+:\/\//g.test(f)?f:"",text:f,blank:!1}}var g,i=b.context.options.selectLink;return g="function"==typeof i?i(c):h.render(c).dialog,g.then(function(b){if(!b)return null;var c=b.href||b,f=b.text||c;d.invoke(function(g){e||(e=a('<a href="">').text(f)[0],g.insertHtml(e),g.selection.select(e,"contents")),a(e).text(f),a(e).attr("target",b.blank?"_blank":null),d.invoke("setURL",c)})})}c.Editor.widgets.link={element:"a[href]",inline:!0,create:function(c,d){d=b(d),"link"===c.selection.focusNode.widget.id?c.invoke("setURL",d):c.insertHtml(a("<a>").text(c.selection.getSelectedText()||d).attr("href",d)[0])},remove:"keepText",setup:function(a){a.typer.on("contentChange",function(a){var b=a.sourceKeyName;if("enter"===b||"space"===b){var c=a.typer.getSelection().clone();if(c.moveByCharacter(-1),c.getCaret("start").moveByWord(-1)&&"link"!==c.focusNode.widget.id&&/^([a-z]+:\/\/\S+)|(\S+@\S+\.\S+)/g.test(c.getSelectedText())){var d=n.$1||"mailto:"+n.$2;a.typer.invoke(function(b){var e=b.selection.clone();a.typer.snapshot(!0),a.typer.select(c),b.insertWidget("link",d),a.typer.select(e)})}}})},init:function(a){a.widget.element.style.cursor="text"},ctrlClick:function(a){d.open(a.widget.element.href)},commands:{setURL:function(a,c){a.widget.element.href=b(c)},unlink:function(a){a.removeWidget(a.widget)}}},c.Editor.defaultOptions.link=!0;var g=new c.UI("zeta.editor.link",{contextChange:function(a,b){var c=b.context.typer;if(c){var d=c.getSelection();b.widget=d.getWidget("link"),b.widgetAllowed=d.widgetAllowed("link")}}}),h=g.dialog(g.textbox("text",!0),g.textbox("href",!0),g.checkbox("blank"),g.buttonset(g.button("remove","delete",{danger:!0,execute:function(a){return a.parentContext.typer.invoke("unlink"),a.all.dialog.destroy()},visible:function(a){return a.parentContext.typer.hasCommand("unlink")}}),g.submit("ok","done"),g.button("cancel","close",function(a){return a.all.dialog.destroy()})));g.export("zeta.editor.toolbar",g.button("insertLink","insert_link",{realm:"widgetAllowed",after:"insertWidgets",execute:f,active:function(a){return a.state.widget},contextChange:function(a,b){b.label=b.state.widget?"editLink":"insertLink"}})),g.export("zeta.editor.contextmenu",g.buttonlist(g.button("open",{realm:"widget",shortcut:"ctrlClick",execute:function(a){d.open(a.state.widget.element.href)}}),g.button("editLink",{realm:"widget",execute:f}),g.button("removeLink",{realm:"widget",execute:"unlink"}))),g.i18n("en",{insertLink:"Insert hyperlink",editLink:"Edit hyperlink",removeLink:"Remove hyperlink",remove:"Remove",text:"Text",href:"Link URL",blank:"Open in new window",open:"Open hyperlink",cancel:"Cancel",ok:"OK"})}(),function(){function b(a,b){var c,d=a.context.options.selectMedia;if(f.isFunction(d)){c=d(e.exec(a.label)&&(n.$1?"image":n.$2?"video":"audio"),a.value)}else c=g.prompt("imageURL",a.value);return c.then(b)}function d(a,c){return g.button(a,c,{realm:"widgetAllowed",execute:function(a){return b(a,function(){a.context.typer.invoke(function(b){b.insertWidget("media",a.value)})})}})}var e=/\.(?:(jpg|jpeg|png|gif|webp)|(mp4|ogg|webm)|(mp3))(?:\?.*)?$/i,f=c.helper;c.Editor.widgets.media={element:"img,audio,video,a:has(>img)",text:function(a){return a.element.src},create:function(b,c){var d=f.createElement(e.test(c.src||c)?n.$2?"video":n.$3?"audio":"img":"img");d.src=c.src||c,f.is(d,"video")&&a(d).attr("controls",""),b.insertHtml(d)}},c.Editor.defaultOptions.media=!0;var g=new c.UI("zeta.editor.media",{contextChange:function(a,b){var c=b.context.typer.getSelection();b.widget=c.getWidget("media"),b.widgetAllowed=c.widgetAllowed("media")}});g.export("zeta.editor.insertMenu",d("image","insert_photo"),d("video","videocam")),g.export("zeta.editor.toolbar",g.buttonset(g.button("filePicker",{realm:"widget",showText:!0,showIcon:!1,contextChange:function(b,c){c.value=a(c.state.widget.element).attr("src"),c.label=(/(?:^|\/)([^\/?#]+)(?:\?.+)?$/.exec(c.value)||[])[1]||""},execute:function(c){return b(c,function(b){a(c.state.widget.element).attr("src",b.src||b)})}}),g.textbox("altText",{realm:"widget",icon:"comment",contextChange:function(b,c){c.value=a(c.state.widget.element).attr("alt")},execute:function(b){a(b.state.widget.element).attr("alt",b.value).attr("title",b.value)}}))),g.i18n("en",{insertImage:"Image",insertVideo:"Video",altText:"Alternate text",imageURL:"Image URL"})}(),function(){function b(b,c,e){var f=b.options;f[c]&&d.setState(d.is(f.target,k)||a(b.typer.element).parents(f.target).addBack()[0],f[c],e)}var d=c.helper;c.Editor.widgets.stateclass={options:{target:null,disabled:"disabled",focused:"focused",empty:"empty"},focusin:function(a){b(a.widget,"focused",!0)},focusout:function(a){b(a.widget,"focused",!1)},stateChange:function(a){b(a.widget,"disabled",!a.typer.enabled()),b(a.widget,"empty",!a.typer.hasContent())},contentChange:function(a){b(a.widget,"empty",!a.typer.hasContent())},init:function(a){b(a.widget,"empty",!a.typer.hasContent())}}}(),function(){function b(a,b,c,d,e){var f=this;f.widget=a,f.element=a.element,f.minCol=c,f.minRow=b,f.maxCol=e,f.maxRow=d}function d(c){var d=c.typer.getSelection(),e=d.focusNode.widget;if("table"===e.id){var f=a(d.startElement).parentsUntil(e.element).addBack(),g=a(d.endElement).parentsUntil(e.element).addBack();return new b(e,f.eq(1).index(),f.eq(2).index(),g.eq(1).index(),g.eq(2).index())}}function e(b,c){return a(w,b.element||b)[c]}function f(a,b,c){return"string"==typeof b?f(a,i.min(a[b+"Row"],g(a)-1),i.min(a[b+"Col"],h(a)-1)):e(a,b).children[c]}function g(b){return a(w,b.element||b).length}function h(a){return e(a,0).childElementCount}function j(a){return!!y.is(f(a,0,0),"th")}
function k(b,c,d){if(b.isSingleEditable){var e=a(b.focusNode.element)[c]()[0]||a(b.focusNode.element).parent()[c]().children(d)[0];e&&b.moveToText(e,-0)}}function l(b){a("td,th",b.element||b).css({outline:"1px dotted rgba(0,0,0,0.3)",minWidth:"3em"})}function m(a,c,d,e,f){a.typer.select(new b(a,c,d,c+e-1,d+f-1))}function n(b,c,d,e){var f="string"==typeof c?c+"-child":"nth-child("+(c+1)+")",g=e?"before":"after";a(b.element||b).find(w+">th:"+f)[g](B(u,d)),a(b.element||b).find(w+">td:"+f)[g](B(t,d)),l(b)}function o(b,c,d,f,i){a(e(b,"last"===c?g(b)-1:c))[f?"before":"after"](B(v.replace("%",B(i||t,h(b))),d)),l(b)}function p(b,c){var d=j(b);d&&!c?(a(">th",e(b,0)).wrapInner("<p>").each(function(b,c){a(c).replaceWith(a(t).append(c.childNodes))}),l(b)):d||!c&&void 0!==c||o(b,0,1,!0,u)}function q(b,c,d){for(var e=a(c?w+":first>*":w,b.element),f=e.length-1;f>=0;f--){var g=z(e[f])[c?"right":"bottom"];if(i.abs(g-d)<5)return{widget:b,isColumn:c,index:f,pos:g}}}function r(c,d,e){for(var f=a(d?w+":first>*":w,c.element),i=f.length-1;i>=1&&z(f[i])[d?"left":"top"]>e;i--);E||(s=new b(c,0,0,g(c)-1,h(c)-1),s[d?"minCol":"minRow"]=i),s[d?"maxCol":"maxRow"]=i,E=!0}var s,t="<td></td>",u="<th></th>",v="<tr>%</tr>",w=">tbody>tr",x=c.Editor,y=c.helper,z=y.getRect,A=y.removeNode,B=y.repeat;b.prototype={get numCol(){return i.abs(this.maxCol-this.minCol)+1},get numRow(){return i.abs(this.maxRow-this.minRow)+1},get mode(){return(this.numCol===h(this))+2*(this.numRow===g(this))},rows:function(b){a(w,this.element).splice(this.minRow,this.numRow).forEach(b)},cells:function(b){var c=this;c.rows(function(d,e){a(d.children).splice(c.minCol,c.numCol).forEach(function(a,c){b(a,e,c)})})},getRange:function(){return y.createRange(f(this,"min"),0,f(this,"max"),-0)},getRects:function(){var a=f(this,"min"),b=f(this,"max");return[y.mergeRect(z(a),z(b))]},acceptNode:function(a){var b=!1;return a.element===this.element?1:(this.cells(function(c){b|=y.containsOrEquals(c,a.element)}),b||2)},remove:function(a){var b=this;1===a?b.rows(A):2===a&&b.cells(A),b.widget.typer.select(f(b,"min"),-0)}},x.widgets.table={element:"table",editable:"th,td",create:function(a,b){b=b||{},a.insertHtml("<table>"+B(v.replace("%",B(t,b.columns||2)),b.rows||2)+"</table>")},init:function(b){a(b.widget.element).removeAttr("x-table-copymode"),l(b.widget)},extract:function(b){var c=b.widget.element,d=b.extractedNode;if(s&&s.widget===b.widget){var e=s.mode;1!==e&&2!==e||(a(d).attr("x-table-copymode",e),"paste"!==b.source&&"cut"!==b.source||s.remove(e))}else if(g(d)>1){var f=h(c);a(w,d).each(function(b,c){c.childElementCount<f&&a(B(a(">th",c)[0]?u:t,f-c.childElementCount))[b?"appendTo":"prependTo"](c)})}},receive:function(b){var c=+a(b.receivedNode).attr("x-table-copymode");if(c||"paste"===b.source){var k=b.typer.getSelection(),q=s&&s.widget===b.widget?s:d(k),r=b.widget.element,t=b.receivedNode,u=j(r);p(t,1!==c&&(2===c?u:0===q.minRow&&u));var v=g(t),x=h(t),y=g(r),z=h(r),A=1===c?q.minRow===y:q.minCol===z;2===c?(o(v>y?r:t,"last",i.abs(v-y),!1),a(w,t).each(function(b,c){a(c.children)[A?"insertAfter":"insertBefore"](f(r,b,q.minCol-A))}),m(b.widget,0,q.minCol,g(r),x)):1===c?(0===q.minRow&&u&&q.minRow++,n(x>z?r:t,"last",i.abs(x-z),!1),a(w,t)[A?"insertAfter":"insertBefore"](e(r,q.minRow-A)),m(b.widget,q.minRow,0,v,h(r))):(1===q.numRow&&1===q.numCol&&(q.maxCol=q.minCol+x-1,q.maxRow=q.minRow+v-1,q.maxRow>y-1&&o(r,"last",q.maxRow-y+1,!1),q.maxCol>z-1&&n(r,"last",q.maxCol-z+1,!1)),q.cells(function(b,c,d){a(b).replaceWith(f(t,c%v,d%x).cloneNode(!0))}),k.select(q)),l(r),b.handled()}},tab:function(a){k(a.typer.getSelection(),"next",":first-child"),a.handled()},shiftTab:function(a){k(a.typer.getSelection(),"prev",":last-child"),a.handled()},keystroke:function(a){if(s&&s.widget===a.widget&&("backspace"===a.data||"delete"===a.data)){var b=s.mode;1!==b&&2!==b||(s.remove(b),a.handled())}},commands:{addColumnBefore:function(a){var b=d(a);n(a.widget,b.minCol,b.numCol,!0)},addColumnAfter:function(a){var b=d(a);n(a.widget,b.maxCol,b.numCol,!1)},addRowAbove:function(a){var b=d(a);o(a.widget,b.minRow,b.numRow,!0)},addRowBelow:function(a){var b=d(a);o(a.widget,b.maxRow,b.numRow,!1)},removeColumn:function(a){d(a).remove(2)},removeRow:function(a){d(a).remove(1)},toggleTableHeader:function(b){p(b.widget),a(">th",e(b.widget,0)).text(function(a,b){return b||"Column "+(a+1)})}}},c.UI.define("tableGrid",{template:'<div class="zeta-grid"><div class="zeta-grid-wrapper">'+B('<div class="zeta-grid-row">'+B('<div class="zeta-grid-cell"></div>',7)+"</div>",7)+'</div><z:label show-icon="false"/></div>',label:"{{rows or 0}} × {{columns or 0}}",rows:0,columns:0,init:function(b,c){var d=a(".zeta-grid-cell",c.element);d.mouseover(function(){var b=d.index(this),e=b%7+1,f=(b-e+1)/7+1;d.each(function(b,c){a(c).toggleClass("active",b%7<e&&b/7<f)}),c.rows=f,c.columns=e})},click:function(a,b){return b.execute()}});var C=new c.UI("zeta.editor.table",{contextChange:function(a,b){var c=b.context.typer.getSelection();b.widget=c.getWidget("table"),b.widgetAllowed=c.widgetAllowed("table")}});C.export("zeta.editor.insertMenu",C.callout("insertTable","table_chart",C.tableGrid({realm:"widgetAllowed",execute:function(a){a.context.typer.invoke(function(b){b.insertWidget("table",a)})}}))),C.export("zeta.editor.contextmenu",C.callout("modifyTable",C.checkbox("showHeader",{realm:"widget",execute:"toggleTableHeader",contextChange:function(a,b){b.value=j(b.state.widget)}}),C.dropdown("style",{realm:"widget",valueAsLabel:!1,init:function(a,b){b.choices=b.context.options.tableStyles,b.append(C.button("styleDefault",{after:"*"}))},execute:function(a){a.state.widget.element.className=a.value||""},contextChange:function(a,b){b.value=b.state.widget.element.className||""}}),C.dropdown("tableWidth",{realm:"widget",valueAsLabel:!1,choices:{"":"fitContent","100%":"fullWidth"},execute:function(b){a(b.state.widget.element).attr("width",b.value||null)},contextChange:function(b,c){c.value=a(c.state.widget.element).attr("width")||""}}),C.buttonlist("addRemoveCell",C.button("addColumnBefore",{realm:"widget",execute:"addColumnBefore"}),C.button("addColumnAfter",{realm:"widget",execute:"addColumnAfter"}),C.button("addRowAbove",{realm:"widget",execute:"addRowAbove",enabled:function(a){return!j(a.state.widget)||d(a.context).minRow>0}}),C.button("addRowBelow",{realm:"widget",execute:"addRowBelow"}),C.button("removeColumn",{realm:"widget",execute:"removeColumn"}),C.button("removeRow",{realm:"widget",execute:"removeRow"})),{hiddenWhenDisabled:!0})),C.i18n("en",{insertTable:"Table",modifyTable:"Modify table",showHeader:"Show header",style:"Table style",styleDefault:"Default",addColumnBefore:"Add column before",addColumnAfter:"Add column after",addRowAbove:"Add row above",addRowBelow:"Add row below",removeColumn:"Remove column",removeRow:"Remove row",tableWidth:"Table width",fitContent:"Fit to content",fullWidth:"Full width"});var D,E,F=x.handle("cell"),G=x.handle("cell"),H=x.handle("pointer",function(){(D.isColumn?n:o)(D.widget,D.index,1,!1)});x.addLayer("table",function(a){var b=a.hoverNode&&a.hoverNode.widget;if(b&&"table"===b.id){var c=z(b);if((!a.mousedown||H.active)&&(D=q(b,!0,a.pointerX)||q(b,!1,a.pointerY))){var e=D.isColumn?"left":"top";a.drawLine(c.collapse(e,D.pos-c[e]),e,5,"transparent","solid",H)}a.drawLine(c,"top",10,"transparent","solid",F),a.drawLine(c,"left",10,"transparent","solid",G)}F.active?r(E?s:b,!0,a.pointerX):G.active?r(E?s:b,!1,a.pointerY):a.selectionChanged&&(s=d(a),!s||1===s.numRow&&1===s.numCol?(s=null,E=!1):E=!0),E&&!a.mousedown&&(E=!1,3===s.mode?(a.typer.select(s.element),s=null):m(s.widget,i.min(s.minRow,s.maxRow),i.min(s.minCol,s.maxCol),s.numRow,s.numCol)),a.toggleLayer("selection",!E),E&&a.fill(s.getRects())})}(),function(){function b(a){if(!1===o)a();else if(!o){var b=q.bind(e,"paste",function(){o=!0});p(function(){b(),o||(o=!1,a())})}}function f(b){var c=a(b.element).height(),d=q.getRect(b.widget||b.typer);if(0!==d.left||0!==d.top||0!==d.width||0!==d.height){var e={position:"fixed",left:d.left,top:i.max(0,d.top-c-10)},f=b.typer.getSelection().extendCaret.getRect();f.top>=e.top&&f.top<=e.top+c&&(e.top=f.bottom+10),a(b.element).css(e)}}function g(b){n!==b&&(h(),n=b,a(b.element).appendTo(e.body),q.setZIndexOver(b.element,b.typer.element)),f(b)}function h(b){n&&(b||n)===n&&(a(n.element).detach(),n.position="",n=null)}function j(b,c,d){var f=e.createElement("div"),g=d.render(f,{typer:b,options:c});return g.element||(g.element=f),b.retainFocus(g.element),c.container&&d!==m?a(f).appendTo(c.container):a(f).addClass("zeta-float"),g}function k(a,b){"mouse"===a.source&&b.context.typer.focus()}var l,m,n,o,q=c.helper;c.Editor.widgets.toolbar={options:{container:"",formattings:{p:"Paragraph",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4"},inlineClasses:{}},init:function(a){a.widget.toolbar=j(a.typer,a.widget.options,l)},focusin:function(a){var b=a.widget.toolbar;b.update(),b.options.container||g(b)},focusout:function(a){h(a.widget.toolbar)},rightClick:function(a){var b=a.widget.contextmenu||(a.widget.contextmenu=j(a.typer,a.widget.options,m));p(function(){c.dom.focus(b.element),b.update(),b.showMenu({x:a.clientX,y:a.clientY})}),a.preventDefault()},stateChange:function(a){var b=a.widget.toolbar;p(function(){b.update()}),n===b&&(a.typer.enabled()?f(b):h(b))}},q.bind(d,"scroll",function(){n&&f(n)});var r=new c.UI("zeta.editor");l=r.buttonset(r.callout("insertWidgets","widgets",r.import("zeta.editor.insertMenu")),r.import("zeta.editor.toolbar"),{showText:!1,childExecuted:k}),m=r.menu(r.buttonlist(r.button("undo","",{execute:"undo",enabled:function(a){return a.context.typer.canUndo()}}),r.button("redo","",{execute:"redo",enabled:function(a){return a.context.typer.canRedo()}}),{hiddenWhenDisabled:!1}),r.buttonlist(r.button("selectAll","select_all",{execute:"selectAll"}),r.button("selectParagraph",{hiddenWhenDisabled:!0,execute:function(a){var b=a.context.typer.getSelection();b.select(b.startNode.element,"contents"),b.focus()},enabled:function(a){return a.context.typer.getSelection().isCaret}})),r.buttonlist(r.button("cut","content_cut",{shortcut:"ctrlX",execute:function(a){a.context.typer.focus(),e.execCommand("cut")}}),r.button("copy","content_copy",{shortcut:"ctrlC",execute:function(a){a.context.typer.focus(),e.execCommand("copy")}}),r.button("paste","content_paste",{shortcut:"ctrlV",execute:function(a){a.context.typer.focus(),e.execCommand("paste"),b(function(){r.alert("clipboardError")})}})),r.import("zeta.editor.contextmenu"),{childExecuted:k}),r.i18n("en",{undo:"Undo",redo:"Redo",cut:"Cut",copy:"Copy",paste:"Paste",selectAll:"Select all",selectParagraph:"Select paragraph",insertWidgets:"Insert",clipboardError:"Unable to access clipboard due to browser security. Please use Ctrl+V or [Paste] from browser's menu."})}(),function(){function a(a,b,c){return b.invalidCharsRegex&&(a=a.replace(b.invalidCharsRegex,"")),b.maxlength&&(a=a.substr(0,b.maxlength-c)),a}c.Editor.widgets.validation={options:{invalidChars:"",allowChars:"",maxlength:0},init:function(a){var b=a.widget.options;b.invalidChars&&(b.invalidCharsRegex=new n("["+b.invalidChars.replace(/[\[\]\\^]/g,"\\$&")+"]","g")),b.allowChars&&(b.invalidCharsRegex=new n("[^"+b.allowChars.replace(/[\[\]\\^]/g,"\\$&")+"]","g"))},contentChange:function(b){if("script"===b.source){var c=b.typer.extractText(),d=a(c,b.widget.options,0);d!==c&&b.typer.setValue(d)}},textInput:function(b){var c=a(b.data,b.widget.options,b.typer.extractText().length-b.typer.getSelection().getSelectedText().length);c!==b.data&&(b.handled(),c&&b.typer.invoke(function(a){a.insertText(c)}))}}}(),function(){function b(b,c,d,f){var g=e.getRect(b),h=i.pow(d-g.top,2)+i.pow(c-g.left,2),j=i.pow(d-g.top,2)+i.pow(c-g.right,2),k=i.pow(d-g.bottom,2)+i.pow(c-g.left,2),l=i.pow(d-g.bottom,2)+i.pow(c-g.right,2),m=.5+2*i.sqrt(i.max(h,j,k,l))/o(a.css(b,"font-size")),n=a('<div class="zeta-clickeffect"><i></i></div>').appendTo(b),q=n.children().css({top:d-g.top,left:c-g.left});p(function(){q.css("transform",q.css("transform")+" scale("+m+")").addClass("animate-in")}),n.css("border-radius",a.css(b,"border-radius")),e.always(f,function(){e.runCSSTransition(n.children()[0],"animate-out",function(){n.remove()})})}var e=c.helper;e.bind(d,c.IS_TOUCH?"touchstart":"mousedown",function(a){for(var d=(a.touches||[a])[0],f=a.target;f;f=f.parentNode)if(e.is(f,".zeta-ui button, .zeta-ui .has-clickeffect"))return void b(f,d.clientX,d.clientY,c.dom.drag(a))})}(),function(){function b(a,b){for(var c=[],d=0;d<a;d++)c[d]=b(d);return c}function d(a){return a.getFullYear()}function f(a){return a.getMonth()}function g(a){return a.getDate()}function h(a){return a.getHours()}function k(a){return a.getMinutes()}function l(a,b){return d(a)===d(b)&&f(a)===f(b)}function m(a){return"string"==typeof a&&/^today|([+-]\d+)(day|week|month|year)?$/g.test(a)?n.$1?u(n.$2||"day",new j,+n.$1):new j:(a=null===a?void 0:a instanceof j?a:new j(a),isNaN(a)?void 0:a)}function o(a,b){var c=new j;return c.setHours(a,b,0,0),c}function q(a,b){switch(a){case"datetime":return+b-G;case"month":return 12*(d(b)-1970)+f(b)}return+b+G}function r(a,b){switch(a){case"datetime":return new j(b+G);case"month":return new j(1970,b)}return new j(b-G)}function t(a,b){var c=m(a.min),d=m(a.max);switch(b=new j(+(b<c?c:b>d?d:b)),a.mode||a){case"week":b.setDate(g(b)-b.getDay());break;case"month":b.setDate(1)}return"datetime"!==(a.mode||a)?b.setHours(0,0,0,0):b.setSeconds(0,0),b}function u(a,b,c,e){switch(a){case"minute":var h=c/i.abs(c);return new j(+b+6e4*(((h>0?e:0)-k(b)%e||e*h)+e*(c-h)));case"day":return new j(+b+F*c);case"week":return new j(+b+7*F*c);case"month":return new j(d(b),f(b)+c,g(b));case"year":return new j(d(b)+c,f(b),g(b))}}function v(a,b){switch(a){case"month":return D[f(b)]+" "+d(b);case"week":var c=u("day",b,6);return D[f(b)]+" "+g(b)+" - "+(f(c)!==f(b)?D[f(c)]+" ":"")+g(c)+", "+d(b)}var e=D[f(b)]+" "+g(b)+", "+d(b);return"datetime"===a?e+" "+(h(b)||12)+":"+("0"+k(b)).slice(-2)+" "+(h(b)>=12?"PM":"AM"):e}function w(c,e){if(!isNaN(+e)){"number"==typeof e&&(e=u("month",c.currentMonth,e));var h=m(c.min),i=m(c.max),k=t({mode:"month",min:h,max:i},e),n=d(k),o=f(k),p=L.all(c),q=k.getDay(),r=a("td",c.element).removeClass("selected disabled");if(!c.currentMonth||!l(k,c.currentMonth)){var s=new j(n,o+1,0).getDate(),v=new j(n,o,0).getDate();r.removeClass("prev cur next today"),r.each(function(b,c){b<q?a(c).children().text(b+1-q+v).end().addClass("prev"):b>=s+q?a(c).children().text(b+1-q-s).end().addClass("next"):a(c).children().text(b+1-q).end().addClass("cur")});var w=new j;l(k,w)&&r.eq(g(w)+q-1).addClass("today"),a("tr:last",c.element).toggle(q+s>35),p.year.choices=b(11,function(a){return n+a-5}),c.currentMonth=k}p.year.value=n,p.month.value=o;var x=h&&l(k,h),y=i&&l(k,i);p.prevMonth.enabled=!x,p.nextMonth.enabled=!y,x&&r.slice(0,g(h)+q-1).addClass("disabled"),y&&r.slice(g(i)+q).addClass("disabled");var z=l(k,c.value);if(z||"week"===c.mode&&l(k,u("day",c.value,6)))switch(c.mode){case"day":r.eq(g(c.value)+q-1).addClass("selected");break;case"week":r.slice(z?g(c.value)+q-1:0).slice(0,7).addClass("selected");break;case"month":r.filter("td.cur").addClass("selected")}a(c.element).toggleClass("select-range","day"!==c.mode)}}function x(){var a={template:'<z:callout label="{{selectedText}}" show-text="true"/>'},c=new s.Map;b(12,function(a){c.set(a,D[a].toLowerCase())}),A={year:L.dropdown("year",function(a){return w(a.parent,new j(a.value,f(a.parent.currentMonth)))},a),month:L.dropdown("month",c,function(a){return w(a.parent,new j(d(a.parent.currentMonth),a.value))},a),prev:L.button("prevMonth","",function(a){return w(a.parent,-1)}),setToday:L.button("setToday","",function(a){return a.parent.execute(new j)}),next:L.button("nextMonth","",function(a){return w(a.parent,1)}),hour:L.number("hour",{options:{min:0,max:23,loop:!0},execute:function(a){a.parent.execute(o(a.value,a.all.minute.value))}}),timeSeperator:L.label("timeSeperator"),minute:L.number("minute",{options:{min:0,max:59,digits:"fixed",loop:!0},execute:function(a){a.parent.execute(o(a.all.hour.value,a.value))}}),meridiem:L.button("meridiem",{value:!1,label:"am",showText:!0,propertyChange:function(a,b){b.label=b.value?"pm":"am"},execute:function(a){a.value=!a.value,a.parent.execute(o(a.all.hour.value%12+(a.value?12:0),a.all.minute.value))}})}}function y(){var a=function(a,b){var c=new j(+b.all.calendar.value);c.setHours(h(b.all.clock.value),k(b.all.clock.value)),B.setValue(c)},b=L.calendar({executed:a,contextChange:function(a,b){b.min=C.min,b.max=C.max,b.mode="datetime"===C.mode?"day":C.mode}}),c=L.clock({hiddenWhenDisabled:!0,executed:a,contextChange:function(a,b){b.step=C.minuteStep,b.enabled="datetime"===C.mode}}),d=L.submit("done","done",{execute:function(a){C.hideMenu()}});C=L.menu(L.buttonset(b,c),L.generic({controls:[L.buttonset(d)],template:'<z:generic><controls layout="dialog"/></z:generic>'}),{hideCalloutOnBlur:!1}).render()}function z(a){var b=a.widget.options,c=u("datetime"===b.mode?"minute":b.mode,a.typer.getValue()||new j,"stepUp"===a.commandName?-1:1,b.minuteStep);a.typer.setValue(c)}var A,B,C,D="January February March April May June July August September October November December".split(" "),E="Su Mo Tu We Th Fr Sa".split(" "),F=864e5,G=6e4*(new j).getTimezoneOffset(),H={datetime:"datetime-local",day:"date",week:"week",month:"month"},I=c.helper,J=c.dom,K=I.repeat,L=new c.UI("zeta.ui.datepicker");c.UI.define("calendar",{template:'<div class="zeta-calendar"><div class="zeta-calendar-header"><z:buttonset show-text="false"/></div><div class="zeta-calendar-body"><table></table></div></div>',hideCalloutOnExecute:!1,value:null,mode:"day",min:null,max:null,setValue:function(a,b){var c=t(this,a.newValue);b.selectedDate=c,b.value=c,w(b,c)},init:function(b,c){A||x(),c.append([A.year,A.month,A.prev,A.setToday,A.next]);var e=function(){c.value=t(c,c.selectedDate)};c.watch("mode",e),c.watch("min",e),c.watch("max",e);var g=a("table",c.element);a(K("<tr></tr>",7)).appendTo(g),a(K("<th></th>",7)).appendTo(g.find("tr:first")),a(K("<td></td>",7)).appendTo(g.find("tr+tr")),a("<button>").appendTo(g.find("td")),g.find("th").text(function(a){return E[a]}),g.find("td").click(function(){var b=a(this).hasClass("prev")?-1:a(this).hasClass("next")?1:0;c.execute(new j(d(c.currentMonth),f(c.currentMonth)+b,+this.textContent))}),c.value?w(c,0):c.value=new j},mousewheel:function(a,b){b.context===C&&(w(b,a.data),a.handled())},contextChange:function(a,b){w(b,b.currentMonth||b.value||new j)}}),c.UI.define("clock",{template:'<div class="zeta-clock"><div class="zeta-clock-face"><s hand="h"></s><s hand="m"></s><i></i><i></i></div><z:buttonset/></div>',hideCalloutOnExecute:!1,step:1,value:null,init:function(a,b){A||x(),b.append([A.hour,A.timeSeperator,A.minute,A.meridiem]),b.watch("step",function(a){60%a&&(b.step=1),L.all(b).minute.options.step=a},!0),b.setValue(new j)},mousedown:function(a,b){if(I.is(a.target,"s")){var c=I.getRect(a.target.parentNode);J.drag(a,function(d,e){var f=i.atan2(e-c.centerY,d-c.centerX)/i.PI,g=k(b.value),j=h(b.value);if("m"===a.target.getAttribute("hand")){var l=i.round((30*f+75)/b.step)*b.step%60;if(l!==g){var m=i.floor(i.abs(g-l)/30)*(l>g?-1:1);b.setValue(o(j+m,l))}}else{var n=i.round(6*f+15)%12+(L.all(b).meridiem.value?12:0);n!==j&&b.setValue(o(n,g))}}).then(function(){b.execute()})}},setValue:function(b,c){var d=b.newValue,e=L.all(c);e.hour.value=h(d)||12,e.minute.value=k(d),e.meridiem.value=h(d)>=12,a('s[hand="h"]',c.element).css("transform","rotate("+(30*h(d)+.5*k(d)-90)+"deg)"),a('s[hand="m"]',c.element).css("transform","rotate("+(6*k(d)-90)+"deg)")},mousewheel:function(a,b){b.setValue(u("minute",b.value,a.data,b.step)),b.mousewheelTimeout=b.mousewheelTimeout||p(function(){b.mousewheelTimeout=null,b.execute()}),a.preventDefault(),a.handled()}});var M={options:{mode:"day",minuteStep:1,min:null,max:null,required:!1,formatDate:null},overrides:{getValue:function(a){return a.selectedDate?t(a.options,a.selectedDate):null},setValue:function(a,b){b=b?t(a.options,b):null,a.selectedDate=b,a.softSelectedDate=null;var c="";if(b&&!isNaN(+b)){var d=function(c){return I.isFunction(c)&&c(a.options.mode,b)};c=d(a.options.formatDate)||d(v)}c!==this.extractText()&&(this.invoke(function(a){a.selection.selectAll(),a.insertText(c)}),this===B&&(C.calendar=C.clock=a.selectedDate||new j))},validate:function(a){if(a.options.required&&a.selectedDate)return I.reject("required")}},commands:{stepUp:z,stepDown:z},contentChange:function(a){if(a.typer===B&&"script"!==a.source){var b=new j(a.typer.extractText());isNaN(+b)||(C.calendar=C.clock=t(a.widget.options,b)),a.widget.softSelectedDate=b}},click:function(a){a.typer===B&&C.showMenu(a.typer.element)},escape:function(a){I.containsOrEquals(e,C.element)&&(C.hideMenu(),a.handled())},focusin:function(a){C||y(),a.typer.retainFocus(C.element),B=a.typer;var b=a.widget.options,c=a.typer.getValue()||new j;I.extend(C,{mode:b.mode,minuteStep:b.minuteStep,min:b.min,max:b.max,calendar:c,clock:c}),C.update(),"script"!==a.source&&C.showMenu(a.typer.element)},focusout:function(a){if(a.typer===B){var b=a.widget.softSelectedDate;a.typer.setValue(!b||isNaN(+b)?a.widget.selectedDate:b),B=null,C.hideMenu()}}};c.UI.define("datepicker",{template:"<z:textbox/>",preventLeave:!0,value:"",preset:M,options:{},init:function(b,d){if(c.IS_TOUCH){var e=d.options.mode||d.preset.options.mode;d.nativeInput=a('<input type="'+H[e]+'">').appendTo(d.element)[0],I.bind(d.nativeInput,"change",function(a){d.setValue(r(e,d.nativeInput.valueAsNumber))})}},focusin:function(a,b){if(c.IS_TOUCH){var d=b.options.mode||b.preset.options.mode;b.value||(b.value=new j),b.nativeInput.valueAsNumber=q(d,b.value),b.nativeInput.focus(),a.handled()}}});var N={setToday:"Today",prevMonth:"Previous month",nextMonth:"Next month",timeSeperator:":",am:"AM",pm:"PM",done:"Done"};b(12,function(a){N[D[a].toLowerCase()]=D[a]}),L.i18n("en",N)}(),function(){function b(){u=y.menu(y.dropdown({template:"<z:buttonlist/>",execute:function(a){r(u.preset,a.value),u.preset.typer.focus()},contextChange:function(a,b){b.choices=b.context.suggestions}}),{hideCalloutOnBlur:!1,hideCalloutOnExecute:!1}).render()}function d(a,b){var c=e.createTextNode(b?a:a.replace(/\s/g," ")),d=e.createElement("div");return d.appendChild(c),d.innerHTML}function f(a){return a.value}function h(a){return"object"!=typeof a?{value:a,label:a}:a}function j(a,b){return a.value.localeCompare(b.value)}function k(a,b){return a.length!==b.length||a.some(function(a){return b.indexOf(a)<0})}function l(a,b){a=g(a||"");for(var c=[],d=a.toLowerCase(),e=0,f=-1,h=0;h<b.length;h++){var i=b.charAt(h).toLowerCase();if(" "!=i){if(-1==(e=d.indexOf(i,e)))return{firstIndex:1/0,consecutiveMatches:-1,formattedText:a};c[c.length]=e-f-1,f=e++}}var j=c[0],k=/^(0+)/.test(c.slice(0).sort().join(""))&&n.$1.length,l="";for(e=0,h=0;h<c.length;h++)l+=a.substr(e,c[h])+"**"+a[e+c[h]]+"**",e+=c[h]+1;return l+=a.slice(e),{firstIndex:j,consecutiveMatches:k,formattedText:l.replace(/\*\*(\ *)\*\*/g,"$1")}}function m(a,b,c){var d=a.options.suggestions||a.options.allowedValues||[];return w.isFunction(d)&&(d=d(b)),w.when(d).then(function(b){return b=b.map(h),b.forEach(function(b){a.knownValues[b.value]=b.label}),c&&(b=b.filter(function(a){return c.indexOf(a.value)<0})),b})}function o(a,b,c){return a=a.filter(function(a){return w.extend(a,l(a.label,b)),[a.value].concat(a.matches||[]).forEach(function(c){var d=l(c,b);a.firstIndex=i.min(a.firstIndex,d.firstIndex),a.consecutiveMatches=i.max(a.consecutiveMatches,d.consecutiveMatches)}),a.firstIndex!==1/0}),a.sort(function(a,b){return b.consecutiveMatches-a.consecutiveMatches+(a.firstIndex-b.firstIndex)||j(a,b)}),a.slice(0,c)}function p(a){var c=a.typer.extractText();m(a,c,a.typer.getValue()).then(function(d){a.typer.focused()&&(d=o(d,c,a.options.suggestionCount),c&&a.options.allowFreeInput&&!d.some(function(a){return a.label===c})&&d.push({value:c,label:c,formattedText:"*"+c+"*"}),u||b(),u.preset=a,u.suggestions=d.map(function(a){return{value:a.value,label:a.formattedText,icon:a.icon||""}}),u.update(),x.retainFocus(a.typer.element,u.element),u.showMenu(a.typer.element),a.typer.focus())})}function q(a,b){var c=m(a);t=!0,y.dialog({title:b.label,description:b.placeholder,controls:[y.textbox("newValue",{enter:function(a,b){return b.all.list.append(y.checkbox({label:b.value,entry:b.value,value:!0,description:"new value",before:"*"})),b.execute()},visible:function(){return a.options.allowFreeInput}}),y.buttonlist("list",{templates:{checkbox:'<z:checkbox show-icon="true"/>'}}),y.buttonset(y.submit("done","done"),y.button("cancel","close",function(a){a.all.dialog.destroy()}))],childExecuted:function(a,b){b.value=b.all.list.controls.filter(function(a){return a.value}).map(function(a){return a.entry})},init:function(b,d){var e=a.typer.getValue();d.all.dialog.value=e.slice(0),c.then(function(a){var b=a.map(f);a=a.concat(e.filter(function(a){return b.indexOf(a)<0}).map(h)),a.sort(j),d.all.list.append(a.map(function(a){var b=e.indexOf(a.value)>=0;return y.checkbox({label:a.label,icon:a.icon,entry:a.value,value:b,before:b?"*":""})}))})},destroy:function(a,b){t=!1}}).render().dialog.then(function(b){a.typer.setValue(b)})}function r(b,c){if(c&&!(b.typer.getValue().indexOf(c.value||c)>=0)){"object"!=typeof c&&(c={value:c,label:b.knownValues[c]||c});var e=a('<span class="zeta-keyword" data-value="'+d(c.value,!0)+'">'+d(c.label)+"<i>delete</i></span>")[0],f=b.typer.rootNode.lastChild;b.typer.invoke(function(a){a.selection.selectAll(),f&&a.selection.baseCaret.moveTo(f.element,!1),a.insertHtml(e)}),b.options.allowFreeInput||m(b,c.value).then(function(){b.knownValues[c.value]||a(e).addClass("invalid")})}}var s,t,u,v=c.IS_TOUCH,w=c.helper,x=c.dom,y=new c.UI("zeta.ui.keyword"),z={options:{required:!1,allowFreeInput:!0,allowedValues:null,suggestionCount:5,suggestions:!1},overrides:{getValue:function(b){return a("span",this.element).map(function(b,c){return g(a(c).data("value"))}).get()},setValue:function(a,b){b=(w.isArray(b)||g(b).split(/\s+/)).filter(function(a){return a}),k(b,this.getValue())&&this.invoke(function(c){c.selection.selectAll(),c.insertText(""),b.forEach(function(b){r(a,b)})})},validate:function(b){return b.options.required&&!this.getValue().length?w.reject("required"):a(".invalid",this.element)[0]?w.reject("invalid-value"):void 0}},widgets:{tag:{element:"span",inline:!0,editable:"none",click:function(b){b.target!==b.widget.element&&a(b.widget.element).detach()}}},init:function(a){a.typer.select(a.typer.element,-0),a.widget.knownValues={}},focusin:function(a){v?q(a.widget,s):p(a.widget)},focusout:function(a){r(a.widget,a.typer.extractText()),v||u.hideMenu()},click:function(a){v&&!t&&q(a.widget,s)},upArrow:function(a){x.focus(u.element),a.handled()},downArrow:function(a){x.focus(u.element),a.handled()},textInput:function(a){var b=a.typer.rootNode.lastChild;b&&w.compareRangePosition(a.typer.getSelection(),b.element)<0&&a.typer.select(a.typer.element,-0)},enter:function(a){var b=u.suggestions;r(a.widget,1===b.length||b[0]&&b[0].label==="**"+a.widget.knownValues[b[0].value]+"**"?b[0].value:a.typer.extractText()),a.handled()},escape:function(a){w.containsOrEquals(e,u.element)&&(u.hideMenu(),a.handled())},contentChange:function(a){v||"script"===a.source||p(a.widget)}};c.UI.define("keyword",{template:"<z:textbox/>",preventLeave:!0,options:{},value:[],preset:z,init:function(a,b){b.watch("required",function(a){b.options.required=a},!0)},focusin:function(a,b){s=b},setValue:function(a,b){var c=a.newValue||[];k(a.oldValue,c)&&(b.setValue(c),b.editor.setValue(c)),a.handled()}}),y.i18n("en",{newValue:"Enter new value",done:"Done",cancel:"Cancel"})}(),function(){function a(a,b){if(null===b||""===b||isNaN(b))b=b?"0":"";else{var c=a.options.min,d=a.options.max,e=a.options.loop&&null!==c&&null!==d;e&&b<c||!e&&null!==d&&b>d?b=d:(e&&b>d||!e&&null!==c&&b<c)&&(b=c),b=g(0|+b)}if("fixed"===a.options.digits){var f=g(+a.options.max||0).length;b=(new h(f+1).join("0")+b).substr(-f)}b!==a.typer.extractText()&&a.typer.invoke(function(a){a.selection.selectAll(),a.insertText(b)})}function b(b){a(b.widget,(b.typer.getValue()||0)+("stepUp"===b.commandName?1:-1)*b.widget.options.step)}var d={validation:{allowChars:"0-9"},options:{max:null,min:null,digits:"auto",step:1,loop:!1},overrides:{getValue:function(a){var b=parseInt(this.extractText());return isNaN(b)?null:b},setValue:function(b,c){a(b,c)}},commands:{stepUp:b,stepDown:b},contentChange:function(b){"keyboard"!==b.source&&a(b.widget,b.typer.getValue())}};c.UI.define("number",{template:"<z:textbox/>",preventLeave:!0,value:null,preset:d})}()}(window,document,Object,String,Array,Math,Date,Node,Range,DocumentFragment,RegExp,parseFloat,setTimeout,clearTimeout,getComputedStyle,new function(){this.Map=window.Map||function(a){function b(a,b){return a.items.indexOf(b)}function c(){var b=this;b.items=[],b._values=[],b._keys=a.Set.prototype._keys}return c.prototype={get size(){return this.items.length},has:function(a){return b(this,a)>=0},get:function(a){var c=b(this,a);return c>=0?this._values[c]:void 0},set:function(a,c){var d=this,e=b(d,a);return d._values[e>=0?e:d.items.push(a)-1]=c,d},delete:function(a){var c=this,d=b(c,a);return d>=0&&(c.items.splice(d,1),c._values.splice(d,1)),d>=0},keys:function(){return this._keys()},values:function(){var a=this;return a._keys(function(b){return a.get(b)})},entries:function(){var a=this;return a._keys(function(b){return[b,a.get(b)]})},forEach:function(a,b){var c=this;c.items.forEach(function(d,e){a.call(b,c._values[e],d,c)})},clear:function(){this.items.splice(0),this._values.splice(0)}},c}(this),this.MutationObserver=window.MutationObserver||function(){function a(a){this.records=[],this.handler=a}return a.prototype={observe:function(a,b){var d=c.helper,e=this;d.bind(a,"DOMNodeInserted DOMNodeRemoved DOMAttrModified DOMCharacterDataModified",function(c){var f=c.type.charAt(7),g=c.prevValue,h={};h.addedNodes=[],h.removedNodes=[],"M"===f?(h.type="attributes",h.target=c.target,h.attributeName=c.attrName,b.attributeOldValue&&(h.oldValue=g)):"a"===f?(h.type="characterData",h.target=c.target,b.characterDataOldValue&&(h.oldValue=g)):(h.type="childList",h.target=c.target.parentNode,h["I"===f?"addedNodes":"removedNodes"][0]=c.target);var i=!1;d.each(e.records,function(a,b){return!(i|="childList"===b.type&&b.addedNodes.some(function(a){return d.containsOrEquals(a,h.target)}))}),i||!b[h.type]||!b.subtree&&h.target!==a||(e.records[e.records.length]=h,clearTimeout(e.timeout),e.timeout=setTimeout(function(){e.handler(e.takeRecords(),e)}))})},takeRecords:function(){return this.records.splice(0)}},a}(),this.Set=window.Set||function(){function a(a,b){var c=this;c.items=a,c.index=-1,c.callback=b||function(a){return a}}function b(){this.items=[]}return a.prototype={next:function(){var a=this;return++a.index<a.items.length?{value:a.callback(a.items[a.index],a.index),done:!1}:{value:void 0,done:!0}}},b.prototype={get size(){return this.items.length},has:function(a){return this.items.indexOf(a)>=0},add:function(a){var b=this.items;return b.indexOf(a)<0&&b.push(a),this},delete:function(a){var b=this.items.indexOf(a);return b>=0&&this.items.splice(b,1),b>=0},keys:function(){return this._keys()},values:function(){return this._keys()},entries:function(){return this._keys(function(a){return[a,a]})},forEach:function(a,b){var c=this;c.items.forEach(function(d){a.call(b,d,d,c)})},clear:function(){this.items.splice(0)},_keys:function(b){return new a(this.items,b)}},b}(),this.WeakMap=window.WeakMap||function(){function a(){this.key="__WeakMap"+ ++c}var b,c=0,d=0;return a.prototype={get:function(a){if(this.has(a))try{if(d=1,a[this.key](),2!==d)throw new Error("Invalid operation");var c=b;return b=null,c}finally{d=0}},set:function(a,c){return Object.defineProperty(a,this.key,{configurable:!0,value:function(){1===d&&(b=c,d=2)}}),this},has:function(a){return a&&Object.hasOwnProperty.call(a,this.key)},delete:function(a){var b=this.has(a);return b&&delete a[this.key],b}},a}()}),c});
//# sourceMappingURL=zeta-ui.min.js.map