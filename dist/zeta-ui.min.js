/*! zeta UI v1.0.0-pre | https://github.com/misonou/zeta-ui | The MIT License (MIT) */

!function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";!function(){function m(){}function n(a){return f.isArray(a)&&a}function p(a){return"function"==typeof a&&a}function q(a){var b="object"==typeof a&&null!==a&&d.getPrototypeOf(a);return(b===d.prototype||null===b)&&a}function r(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||p(g)||(g={});h<i;h++)if(null!==(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(q(d)||(e=n(d)))?(e?(e=!1,f=c&&n(c)?c:[]):f=c&&q(c)?c:{},g[b]=r(j,f,d)):void 0!==d&&(g[b]=d));return g}function s(a){if(p(a)||a===b)return!1;var c=!!a&&"length"in a&&a.length;return n(a)||0===c||"number"==typeof c&&c>0&&c-1 in a}function t(a,b){if(a){var c,d=0;if("string"==typeof a?a=a.split(" "):a instanceof o.Set&&(a=p(a.values)?a.values():function(a,b){return a.forEach(function(a){b[b.length]=a}),b}(a,[])),s(a))for(var e=a.length;d<e&&!1!==b(d,a[d++]););else if(p(a.entries))for(a=a.entries();!(c=a.next()).done&&!1!==b(c.value[0],c.value[1]););else if(p(a.forEach)){var f;a.forEach(function(a,c){f=!1===f||b(c,a)})}else if(p(a.next))for(;!(c=a.next()).done&&!1!==b(d++,c.value););else if(p(a.nextNode))for(;(c=a.nextNode())&&!1!==b(d++,c););else for(d in a)if(!1===b(d,a[d]))return}}function u(a,b){var c=[];return t(a,function(a,d){var e=b.call(this,d,a);null!==e&&void 0!==e&&(n(e)?c.push.apply(c,e):c[c.length]=e)}),c}function v(a,b){var c;return t(a,function(a,d){return!(c=b.call(this,d,a)&&d)}),c}function w(a,b){var c;return t(a,function(a,d){return!(c=b.call(this,d,a))}),c}function x(a,b){var c={};return c[a]=b,c}function y(a){if(n(a))return a.slice(0);if("string"==typeof a)return[a];if(a&&(s(a)||p(a.forEach))){var b=[];return t(a,function(a,c){b[b.length]=c}),b}return null!==a&&void 0!==a?[a]:[]}function z(a){if(!a[0])return Ta();var b,c=$.Deferred(),d=a.length;return t(a,function(a,e){B(e,function(a){b|=!a,0==--d&&c[b?"reject":"resolve"]()})}),c.promise()}function A(a){return $.Deferred().reject(a).promise()}function B(a,b){a.then(function(a){b(!0,a)},function(a){b(!1,a)})}function C(a,b){return b=b||a.currentNode,b&&a.whatToShow&(V(b,h)?1<<b.nodeType-1:b.nodeType)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b):1:3}function D(a,b,c,d){var e=0;switch(a.currentNode=c=c||a.currentNode,b=b||m,C(a)){case 2:return;case 1:b(c,e++)}for(var f;(f=a.nextNode())&&(!d||(p(d)?d(f):f!==d||void b(f,e++)));b(f,e++));}function E(a,b,c,d){var e=[];return D(a,function(a){e[e.length]=a},c,d),b?u(e,b):e}function F(){var a=new o.WeakMap;return function(b,c){return c&&a.set(b,c),c||a.get(b)}}function G(a,b,c){return a.get(b)||c&&(a.set(b,new c),a.get(b))}function H(a){var b={};return t(d.getOwnPropertyNames(a||{}),function(c,e){b[e]=d.getOwnPropertyDescriptor(a,e)}),b}function I(a,b,c,d){Qa(a,b,{configurable:!0,enumerable:!0,get:c,set:d})}function J(a,b,c){Qa(a,b,{configurable:!0,enumerable:!1,writable:!0,value:c})}function K(a,b){t(H(b),function(b,c){c.enumerable=!p(c.value),Qa(a.prototype,b,c)})}function L(a,b){var c=d.create(p(a)?a.prototype:a||d.prototype);return t(H(b),function(a,b){Qa(c,a,b)}),c}function M(){return g.random().toString(36).substr(2,8)}function N(a,b){return new f(b+1).join(a)}function O(a){return e(a).replace(/-([a-z])/g,function(a,b){return b.toUpperCase()})}function P(a){return e(a).replace(/[A-Z](?![A-Z])|[A-Z]{2,}(?=[A-Z])/g,function(a,b){return(b?"-":"")+a.toLowerCase()})}function Q(a){return a=e(a||""),a.charAt(0).toUpperCase()+a.slice(1)}function R(a){return a=e(a||""),a.charAt(0).toLowerCase()+a.slice(1)}function S(a){return e(a||"").replace(/^(?:\u200b|[^\S\u00a0])+|(?:\u200b|[^\S\u00a0])+$/g,"")}function T(a,b){return(Wa[b]||(Wa[b]=new k("(?:^|\\s)("+b.replace(/\s+/g,"|")+")(?=$|\\s)"))).test(e(a||""))&&k.$1}function U(a){return a&&a.tagName&&a.tagName.toLowerCase()}function V(a,b){return!(!a||!b)&&(b.prototype?a instanceof b&&a:b.toFixed?a.nodeType&b&&a:("*"===b||U(a)===b||$(a).is(b))&&a)}function W(a,b){if(U(a)!==U(b))return!1;var c=a.attributes,d=b.attributes;return c.length===d.length&&!v(c,function(a){return!d[a.nodeName]||a.value!==d[a.nodeName].value})}function X(a,b,c){if(a===b)return 0;var d=a&&b&&Oa.call(a,b);return 2&d?c&&8&d||1&d?NaN:1:4&d?c&&16&d||1&d?NaN:-1:NaN}function Y(a,b){return a&&b&&!(1&Oa.call(a.commonAncestorContainer||a,b.commonAncestorContainer||b))}function Z(a,b){return a=(a||"").element||a,b=(b||"").element||b,a===b||$.contains(a,b)}function _(a,b){for(b=b||a;a&&a!==b&&20!==Oa.call(a,b);a=a.parentNode);return a}function aa(a,b){var c=a.length||a.childNodes.length;return 1/b<0?g.max(0,c+b):g.min(c,b)}function ba(a,b,d,e){if(a&&p(a.getRange))return a.getRange();var f;if(V(a,h)?(f=c.createRange(),+b!==b?(f["contents"!==b&&a.parentNode?"selectNode":"selectNodeContents"](a),"boolean"==typeof b&&f.collapse(b)):f.setStart(a,aa(a,b)),V(d,h)&&Y(a,d)&&f.setEnd(d,aa(d,e))):V(a,i)&&(f=a.cloneRange(),f.collapsed||"boolean"!=typeof b||f.collapse(b)),V(b,i)&&Y(f,b)){var g=f.collapsed&&b.collapsed?-1:1;Pa.call(f,0,b)*g<0&&f.setStart(b.startContainer,b.startOffset),Pa.call(f,2,b)*g>0&&f.setEnd(b.endContainer,b.endOffset)}return f}function ca(a,b){return a=V(a,i)||ba(a),b=V(b,i)||ba(b),Y(a,b)&&Pa.call(a,3,b)<=0&&Pa.call(a,1,b)>=0}function da(a,b){return a=V(a,i)||ba(a),b=V(b,i)||ba(b),Y(a,b)&&Pa.call(a,0,b)<=0&&Pa.call(a,2,b)>=0}function ea(a,b){return a=V(a,i)||ba(a),b=V(b,i)||ba(b),Y(a,b)&&0===Pa.call(a,0,b)&&0===Pa.call(a,2,b)}function fa(a,b,c){a=V(a,i)||ba(a),b=V(b,i)||ba(b);var d=Y(a,b)?Pa.call(a,0,b)+Pa.call(a,2,b):NaN;return c&&(0!==d&&ca(a,b)||0===d&&!ea(a,b))?NaN:d&&d/g.abs(d)}function ga(a,b){if(Va.setBaseAndExtent&&V(b,i))return void Va.setBaseAndExtent(a.startContainer,a.startOffset,b.startContainer,b.startOffset);var d=ba(a,b);try{Va.removeAllRanges()}catch(b){var e=c.body.createTextRange();e.collapse(),e.select(),Va.removeAllRanges()}try{Va.addRange(d)}catch(b){Va.rangeCount||(Va.addRange(ba(c.body)),Va.removeAllRanges(),Va.addRange(d))}}function ha(a,d){var e;if(a=a||Ua,a.getRect)return a.getRect();if((a=a.element||a)===Ua||a===b){Z(c.body,Xa)||c.body.appendChild(Xa);var f=ha(Xa);e=ja(0,0,Ua.offsetWidth,Ua.offsetHeight).translate(f.left,f.top)}else if(Z(Ua,a)){if(e=ja(a.getBoundingClientRect()),d){var h=Sa(a);e.top-=g.max(0,l(h.marginTop)),e.left-=g.max(0,l(h.marginLeft)),e.right+=g.max(0,l(h.marginRight)),e.bottom+=g.max(0,l(h.marginBottom))}}else e=ja(0,0,0,0);return e}function ia(a){return u((V(a,i)||ba(a,"contents")).getClientRects(),ja)}function ja(a,b,c,d){function e(a){return g.round(1e3*a)/1e3}return void 0!==a.top?new Ka(e(a.left),e(a.top),e(a.right),e(a.bottom)):void 0===c?new Ka(a,b,a,b):new Ka(a,b,c,d)}function ka(a,b){function c(c){return g.abs(a[c]-b[c])<1}return c("left")&&c("top")&&c("bottom")&&c("right")}function la(a,b){return b.left>=a.left&&b.right<=a.right&&b.top>=a.top&&b.bottom<=a.bottom}function ma(a,b,c,d){return d=d||0,c.width&&c.height&&a-c.left>=-d&&a-c.right<=d&&b-c.top>=-d&&b-c.bottom<=d}function na(a,b){return ja(g.min(a.left,b.left),g.min(a.top,b.top),g.max(a.right,b.right),g.max(a.bottom,b.bottom))}function oa(a,b,d){if(d=d||c.body,Na)return v(Na.call(c,a,b),function(a){return Z(d,a)&&"none"!==Sa(a).pointerEvents})||null;var e=c.elementFromPoint(a,b);if(!Z(d,e)&&ma(a,b,ha(d))){var f=[];try{for(;X(d,e,!0);){var g=$(e).parentsUntil(_(d,e)).slice(-1)[0]||e;if(g===f[f.length-1])return null;g.style.pointerEvents="none",f[f.length]=g,e=c.elementFromPoint(a,b)}}finally{$(f).css("pointer-events","")}}return Z(d,e)?e:null}function pa(a){return V(a,j)||$(c.createDocumentFragment()).append(a)[0]}function qa(a){return c.createTextNode(a||"​")}function ra(a){return c.createElement(a)}function sa(a,b,d){return c.createNodeIterator(a,b,p(d)||null,!1)}function ta(a,b,c,d,e){q(c)?t(c,function(c,e){b[a](c,e,d)}):t(c.split(" "),function(c,f){b[a](f,d,e)})}function ua(a,b,c,d){return ta("addEventListener",a,b,c,d),function(){va(a,b,c)}}function va(a,b,c){ta("removeEventListener",a,b,c)}function wa(a){a.parentNode&&a.parentNode.removeChild(a)}function xa(a,b){var c=new k("(?:^|\\s)\\s*"+b+"(?:-(\\S+)|\\b)$","ig"),d=[!1];return(a.className||"").replace(c,function(a,b){d[b?d.length:0]=b||!0}),d[1]?d.slice(1):d[0]}function ya(a,b,c){var d=a.className||"";t(q(b)||x(b,c),function(a,b){var c=new k("(^|\\s)\\s*"+a+"(?:-(\\S+)|\\b)|\\s*$","ig"),e=0;q(b)&&(b=u(b,function(a,b){return a?b:null})),d=d.replace(c,function(){return e++||!b||0===b.length?"":" "+a+(b[0]?[""].concat(b).join(" "+a+"-"):"")})}),a.className=d}function za(a){if(!Y(Ua,a))return!1;var b=ha(a);if(!(b.top||b.left||b.width||b.height))for(var c=a;c;c=c.parentNode)if("none"===Sa(c).display)return!1;return!0}function Aa(a,b){var c=Sa(a,b||null);return T(c.position,"absolute fixed relative")&&"auto"!==c.zIndex?parseInt(c.zIndex):-1}function Ba(a){var b=-1;return D(c.createTreeWalker(c.body,1,function(c){if(X(c,a,!0))return 2;var d=Aa(c);return d>=0?(b=g.max(b,d),2):(b=g.max(b,Aa(c,"::before"),Aa(c,"::after")),1)},!1)),b+1}function Ca(a,b){a.style.zIndex=Ba(b),"static"===Sa(a).position&&(a.style.position="relative")}function Da(a,c,d,e){var f=ha(V(e||d,h)||b),g=T(d||c,"left right")||"left",i=T(d||c,"top bottom")||"top",j={};return c=(0|(a.top||a.clientY||a.y||c))-f.top,a=(0|(a.left||a.clientX||a.x||a))-f.left,j[g]=("left"===g?a:f.width-a)+"px",j[i]=("top"===i?c:f.height-c)+"px",j[La[g]]="auto",j[La[i]]="auto",j}function Ea(a,b){var c=Da(a,null,b);return c.width=(0|a.width)+"px",c.height=(0|a.height)+"px",c}function Fa(a,b,d,e){Z(Ua,a)||c.body.appendChild(a),$(a).css({position:"fixed",maxWidth:"",maxHeight:""});var f=q(b)||!b?{}:ha(b);"left"in f||(f.left=f.right=0|(b.left||b.clientX||b.x),f.top=f.bottom=0|(b.right||b.clientY||b.y));var h=T(d,"inset-x inset-y inset")||"inset-x",i="inset"===h?f:ha(e),j=ha(a,!0),k={},l={},m={transform:""},n=function(a,b,c,d,e,h){if(m[e]=i[d]+k[c]-k[La[c]],!La[a]){var n=(f[La[c]]+f[c])/2;return a=n-i[c]<j[d]/2?c:i[La[c]]-n<j[d]/2?La[c]:"",a||(m.transform+=" "+h),l[c]=a?i[a]:n+k[c],a}var o=b?La[a]:a;if(f[a]*Ma[o]+j[d]<=i[o]*Ma[o])l[c]=f[a]+k[La[o]];else{if(!(f[La[a]]*Ma[o]-j[d]>i[La[o]]*Ma[o]))return l[c]=i[a],m[e]=b?m[e]:g.abs(f[a]-l[c])-Ma[a]*k[a],a;a=La[a],l[c]=f[a]+k[o]}return b||(a=La[a]),m[e]=g.abs(i[La[a]]-l[c]),a},o=ha(a);Ra(La).forEach(function(a){k[a]=j[a]-o[a]});var p=T(d,"left right center")||"left",s=T(d,"top bottom center")||"bottom",t=n(p,La[s]&&"inset-x"===h,"left","width","maxWidth","translateX(-50%)"),u=n(s,La[p]&&"inset-y"===h,"top","height","maxHeight","translateY(-50%)");$(a).css(r(m,Da(l,t+" "+u)))}function Ga(a){var b={};return t(a,function(c,d){b[d]=a[d]}),b}function Ha(a,b){return/\b(?:[+-]?(\d+(?:\.\d+)?)(px|%)?|#[0-9a-f]{3,}|(rgba?|hsla?|matrix|calc)\(.+\))\b/.test(a)&&(b||!k.$1||k.$2)}function Ia(a){return a.replace(/^-(webkit|moz|ms|o)-/,"")}function Ja(a,b){ya(a,b,!0);var c=E(sa(a,1,function(a){var b=Sa(a);return"0s"!==b.transitionDuration||"none"!=b.animationName}));if(!c[0])return Ta();ya(a,b,!1),$(c).css("transition","none"),ya(a,b,!0);var d=c.map(function(a){return Ga(Sa(a))});ya(a,b,!1);var e=new o.Map;if(t(c,function(a,b){var c=Sa(b),f={};t(c,function(b,e){var g=c[e],h=d[a][e];if(g!==h){var i=Ia(e),j=T(e,"opacity line-height");if("animation-name"===i){var k=g.replace(/,/g,"");t(h.split(/,\s*/),function(a,b){"none"===b||T(k,b)||(f["@"+b]=!0)})}else Ha(g,j)&&Ha(h,j)&&!/^scroll-limit/.test(i)&&(f[i]=!0)}}),Ra(f)[0]&&e.set(b,f)}),$(c).css("transition",""),ya(a,b,!0),!e.size)return Ta();var f=$.Deferred(),g=ua(a,"animationend transitionend",function(c){var d=e.get(c.target)||{};delete d[c.propertyName?Ia(c.propertyName):"@"+c.animationName],Ra(d)[0]||!e.delete(c.target)||e.size||(g(),f[xa(a,b)?"resolve":"reject"](a))});return f.promise()}function Ka(a,b,c,d){var e=this;e.left=a,e.top=b,e.right=c,e.bottom=d}var La={top:"bottom",left:"right",right:"left",bottom:"top"},Ma={top:-1,left:-1,right:1,bottom:1},Na=c.msElementsFromPoint||c.elementsFromPoint,Oa=c.compareDocumentPosition,Pa=i.prototype.compareBoundaryPoints,Qa=d.defineProperty,Ra=d.keys,Sa=b.getComputedStyle,Ta=a.when,Ua=c.documentElement,Va=b.getSelection(),Wa={},Xa=$('<div style="position:fixed; top:0; left:0;">')[0];K(Ka,{get width(){return this.right-this.left},get height(){return this.bottom-this.top},get centerX(){return(this.left+this.right)/2},get centerY(){return(this.top+this.bottom)/2},collapse:function(a){var b=this;return"left"===a||"right"===a?ja(b[a],b.top,b[a],b.bottom):ja(b.left,b[a],b.right,b[a])},translate:function(a,b){var c=this;return ja(c.left+a,c.top+b,c.right+a,c.bottom+b)}});var Ya={IS_IOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!b.MSStream,IS_IE10:!!b.ActiveXObject,IS_IE:!!b.ActiveXObject||void 0!==Ua.style.msTouchAction||void 0!==Ua.style.msUserSelect,IS_MAC:navigator.userAgent.indexOf("Macintosh")>=0,IS_TOUCH:"ontouchstart"in b};Ya.shim={MutationObserver:o.MutationObserver,WeakMap:o.WeakMap,Map:o.Map,Set:o.Set},Ya.helper={extend:r,noop:m,isArray:n,isFunction:p,isPlainObject:q,each:t,map:u,any:v,single:w,kv:x,makeArray:y,iterate:D,iterateToArray:E,mapGet:G,createPrivateStore:F,getOwnPropertyDescriptors:H,defineGetterProperty:I,defineHiddenProperty:J,definePrototype:K,inherit:L,randomId:M,repeat:N,camel:O,hyphenate:P,ucfirst:Q,lcfirst:R,trim:S,matchWord:T,tagName:U,is:V,isVisible:za,sameElementSpec:W,comparePosition:X,connected:Y,containsOrEquals:Z,getCommonAncestor:_,createRange:ba,rangeCovers:da,rangeEquals:ea,rangeIntersects:ca,compareRangePosition:fa,makeSelection:ga,getRect:ha,getRects:ia,toPlainRect:ja,rectEquals:ka,rectCovers:la,pointInRect:ma,mergeRect:na,elementFromPoint:oa,createDocumentFragment:pa,createTextNode:qa,createElement:ra,createNodeIterator:sa,getState:xa,setState:ya,getZIndex:Aa,getZIndexOver:Ba,setZIndexOver:Ca,cssFromPoint:Da,cssFromRect:Ea,runCSSTransition:Ja,position:Fa,removeNode:wa,bind:ua,unbind:va,when:Ta,waitAll:z,reject:A,always:B},b.zeta=Ya}(),function(a,i){function j(a){return a.isContentEditable||sa(a,"input,textarea,select")}function k(a){if(!na(c,a))return!1;for(;a!==c&&"none"!==ka(a).display;a=a.parentNode);return a===c}function l(a){for(var b=[];a&&a!==c&&b.push(a);a=a.parentNode||a.parent);return b}function n(){var a=b.event&&b.event.type;return a&&Aa("k"===a[0]?"keyboard":"t"===a[0]?"touch":"m"===a[0]||Aa(a,"wheel click dblclick contextmenu")?"mouse":a,ba)||"script"}function p(a){var b=Z||new G(Ha[0]),c=function(a){return function(){var c=Z;try{return Z=b,a.apply(this,arguments)}finally{Z=c}}};return{then:function(b,d){return a.then(b&&c(b),d&&c(d))},catch:function(b){return a.catch(b&&c(b))}}}function q(a){for(var b=a;b&&!Fa.has(b);b=b.parentNode);return za(Fa,b)||X}function r(a,d){return a===b?!$:Ia.has(a)&&(!d||na(a,c.activeElement))}function s(a){var b=ya(l(a),function(a){return Ga.get(a)});return la(Ha,function(c){return na(c,a)||b.indexOf(c)>=0})}function t(b){return Ca(Ja,function(c,d){return a(c).find(b)[0]&&d})}function u(a,b,c,d,e,f){var g=new J(a,X,c,d,b,e,f);return g.emit(W,"tap",q(c).element,!1)||g.emit()}function v(a,b,c,d,e){var f=null;return la(xa(c),function(c){var g=q(c);if(f!==g){if(f=g,u(a,b,c,d,e))return!0;if("keystroke"===a)return u(d,b,c,null,!0)||"space"===d&&j(c)&&u("textInput",b,c," ",!0)}})}function w(a,b,c,d){pa(b,function(b,e){Fa.has(e)&&u(a,null,e,{relatedTarget:c},!1,d)})}function x(b,d,e,f){if(d&&!sa(b,ca)&&(b=a(ca,b).filter(":visible:not(:disabled,.disabled)")[0]||b),f=f||Ha,f[0]){var g=f!==Ha?b:s(b);if(!g){var h=t(b);b=r(h)?f[0]:h,g=s(b)}if(!g)return!1;var i=f.splice(0,f.indexOf(g));pa(i,function(a,b){Ia.delete(b)}),w("focusout",i,b,e)}if(na(Ea,b)){var j=l(b).filter(function(a){return!Ia.has(a)}),k=ya(j,function(a){return Ga.get(a)})[0];if(k&&!r(k)){var m=x(k);if(void 0!==m)return m&&x(b)}j[0]&&(f.unshift.apply(f,j),pa(j,function(a,b){Ia.add(b)}),w("focusin",j,null,e||new G(j[0],f)));var n=c.activeElement;return f[0]!==n&&(new C(f[0]).focus(),c.activeElement===n&&n.blur()),!0}}function y(a){for(;a!==Ea&&"visible"===ka(a).overflow;a=a.parentNode);return a}function z(a,b){var c=y(a),d=new C(c),e=d.getUnobscuredRect(a);b=b||ra(a);var f=g.max(0,b.right-e.right)||g.min(b.left-e.left,0),h=g.max(0,b.bottom-e.bottom)||g.min(b.top-e.top,0),i=f||h?d.scrollBy(f,h):ea;if(c!==Ea){var j=z(c.parentNode,b.translate(i.x,i.y));j&&(i={x:i.x+j.x,y:i.y+j.y})}return!(!i.x&&!i.y)&&i}function A(a,c){if(va(a)&&(c.to===b||va(c.to))){var d=c.dir;if("auto"===d)if(c.to===b)d="center inset";else{var e=ra(),f=ra(y(c.to)),h=[e.height*(f.left-e.left),e.height*(e.right-f.right),e.width*(f.top-e.top),e.width*(e.bottom-f.bottom)];d="left right top bottom".split(" ")[h.indexOf(g.max.apply(null,h))]+" center"}ja.position(a,c.to,d)}}function B(c,d,e){function f(a){clearInterval(g),i(),j(),k[a?"resolve":"reject"]()}var g,i,j,k=a.Deferred(),l=c,m=ta(e||d)||ja.noop,n=y(sa(d,h)||c.target),o={keydown:function(a){27===a.which&&f(!1)},mousemove:function(a){a.preventDefault(),a.which?a.clientX===l.clientX&&a.clientY===l.clientY||(l=a,m(a.clientX,a.clientY)):f(!0)},mouseup:function(a){f(!0)},touchend:function(a){f(!0)}},q={mouseout:function(a){g||na(n,a.relatedTarget)&&(n!==Ea||a.relatedTarget!==Ea)||(g=setInterval(function(){z(n,ja.toPlainRect(l.clientX-50,l.clientY-50,l.clientX+50,l.clientY+50))?m(l.clientX,l.clientY):(clearInterval(g),g=null)},20))},mouseover:function(a){a.target!==Ea&&(clearInterval(g),g=null)}};return i=ma(b,o),j=ma(n,q),p(k)}function C(a){this.element=a}function D(a){(new C)[a]||(C.prototype[a]=function(){var b=this.support(a);return b?b.apply(null,arguments):console.warn("Method "+a+" not handled",this.element)})}function E(a){Ma.push(a),pa(a,function(a,b){ta(b)&&"canHandle"!==a&&"support"!==a&&D(a)})}function F(a,b){var c=(za(Fa,a)||"").context,d=c&&(ta(c[b])||ta(c.support)&&ta(c.support(b)));return d?d.bind(c):!!(d=za(Na,a,function(){var b={};return pa(Ma,function(c,d){d.element&&!sa(a,d.element)||d.canHandle&&!d.canHandle(a)||qa(b,d)}),b})[b])&&d.bind(a,a)}function G(a,b){var c=this;b=b||(Z?Z.path:Ha.slice(0)),c.path=b,c.source="script",(na(b[0]||Ea,a)||b.indexOf(a)>=0)&&(c.source=Z?Z.source:n()),c.sourceKeyName="keyboard"!==c.source?null:(Z||Y||"").sourceKeyName}function H(a,b,c,d){var e=qa(this,a.properties);e.eventName=b,e.context=c.context,e.target=na(a.target,c.element)?c.element:a.target,e.data=null,e.context.typer&&(e.typer=e.context.typer,e.widget=e.context),ua(d)?qa(e,d):void 0!==d&&(e.data=d),Ra(e,a)}function I(a,b,c){var d=this,e={};pa(c,function(a,b){ta(b)&&(e[a]=b)}),d.element=a,d.context=b,d.handlers=e}function J(a,b,c,d,e,f,g){c=c||b.element,g=g||new G(c);var h={source:g.source,sourceKeyName:g.sourceKeyName,timestamp:performance.now(),originalEvent:e||null};qa(this,{container:b,eventName:a,target:c,data:d,bubbles:f,properties:h,sourceObj:g},h)}function K(){this.states={}}function L(a,b){var c=this;a&&Fa.set(a,c),c.element=a||Ea,c.context=b||null,c.components=new ha,c.asyncEvents=new ha,c.autoDestroy=na(Ea,a),a&&Fa.set(a,c)}function M(a){for(a.timeout=null;a.asyncEvents.size;){var b=a.asyncEvents;a.asyncEvents=new ha,pa(b,function(a,b){pa(b,function(b,c){ua(a)&&!a.handlers[b]||c.emit(null,null,a)})}),pa(b,function(b,c){var d=za(a.components,b.element||b);d&&!d.attached&&a.components.delete(b.element||b)})}}function N(a,b,c){var d=za(a.asyncEvents,c);if(d&&d[b]){var e=d[b].data;return delete d[b],e||{data:e}}}function O(a,b,c,e,f,g){var h=za(a.asyncEvents,c,d);h[b]=new J(b,a,c.element||c,g&&h[b]?g(h[b].data,e):e,null,f),a.timeout=a.timeout||m(M,null,a)}function P(a,b,c){var d=["destroy","init"];b.attached^c&&!N(a,d[+!c],b)&&O(a,d[+c],b),b.attached=c}function Q(a,b){return a===W||(Fa.get(b)||a)===a}function R(a,b,c){function d(d){var e=[],g=new ha;pa(d,function(b,c){("id"!==c.attributeName||"sizzle"!==(c.oldValue||"").slice(0,6)&&c.target.id!==(c.oldValue||""))&&(na(a.element,c.target)?Q(a,c.target)&&(pa(c.removedNodes,function(a,b){g.has(b)&&e.push.apply(e,g.get(b))}),e.push(c)):za(g,c.target,f).push(c))}),e=e.filter(function(a){return c[a.type]}),e[0]&&b(e)}var e=qa({},c);e.subtree=!0,e.childList=!0,e.attributeOldValue|=c.attributes;var g=new fa(d);return g.observe(a.element,e),function(){d(g.takeRecords())}}function S(a,b){for(var c,d=b;d&&!c;d=d.parentNode)c=a.components.get(d);return c||null}function T(a,b,c){var d=za(a.components,b,K);if((d.context||c)!==c)throw new Error("Element has already been set to another context");return d.element=b,d.context=c,d}function U(a){this.element=a,Ka.set(a,this),Ra(this,{promises:new ha})}function V(a,b){var c;return function(){return c||(c=Da(a()).then(b,function(){return c=null,Ba("user_cancelled")}))}}var W,X,Y,Z,$,_,aa=JSON.parse('{"8":"backspace","9":"tab","13":"enter","16":"shift","17":"ctrl","18":"alt","19":"pause","20":"capsLock","27":"escape","32":"space","33":"pageUp","34":"pageDown","35":"end","36":"home","37":"leftArrow","38":"upArrow","39":"rightArrow","40":"downArrow","45":"insert","46":"delete","48":"0","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","55":"7","56":"8","57":"9","65":"a","66":"b","67":"c","68":"d","69":"e","70":"f","71":"g","72":"h","73":"i","74":"j","75":"k","76":"l","77":"m","78":"n","79":"o","80":"p","81":"q","82":"r","83":"s","84":"t","85":"u","86":"v","87":"w","88":"x","89":"y","90":"z","91":"leftWindow","92":"rightWindowKey","93":"select","96":"numpad0","97":"numpad1","98":"numpad2","99":"numpad3","100":"numpad4","101":"numpad5","102":"numpad6","103":"numpad7","104":"numpad8","105":"numpad9","106":"multiply","107":"add","109":"subtract","110":"decimalPoint","111":"divide","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numLock","145":"scrollLock","186":"semiColon","187":"equalSign","188":"comma","189":"dash","190":"period","191":"forwardSlash","192":"backtick","219":"openBracket","220":"backSlash","221":"closeBracket","222":"singleQuote"}'),ba="script mouse touch keyboard input drop cut copy paste",ca=":input, [contenteditable], a[href], area[href], iframe",da=[16,17,18,91,93],ea={x:0,y:0},fa=o.MutationObserver,ga=o.WeakMap,ha=o.Map,ia=o.Set,ja=i.helper,ka=b.getComputedStyle,la=ja.any,ma=ja.bind,na=ja.containsOrEquals,oa=ja.definePrototype,pa=ja.each,qa=ja.extend,ra=ja.getRect,sa=ja.is,ta=ja.isFunction,ua=ja.isPlainObject,va=ja.isVisible,wa=ja.kv,xa=ja.makeArray,ya=ja.map,za=ja.mapGet,Aa=ja.matchWord,Ba=ja.reject,Ca=ja.single,Da=ja.when,Ea=c.documentElement,Fa=new ga,Ga=new ga,Ha=[],Ia=new ia,Ja=new ha,Ka=new ga,La=new ha,Ma=[],Na=new ga,Oa=new ga,Pa={},Qa={},Ra=ja.createPrivateStore();oa(C,{support:function(a){return F(this.element,a)}}),oa(H,{handled:function(a){var b=Ra(this);b.handled||(b.handled=Da(a))},isHandled:function(){return!!Ra(this).handled},preventDefault:function(){var a=this.originalEvent;a?a.preventDefault():Ra(this).defaultPrevented=!0},isDefaultPrevented:function(){return!!(this.originalEvent||Ra(this)).defaultPrevented}}),oa(J,{emit:function(a,b,c,d){var e=this;a=a||e.container,d=void 0===d?e.bubbles:d;var f=function(b,c,d,f){if("init"===c||"destroy"===c){if(b.lastEvent===c)return!1;b.lastEvent=c}var g=b.handlers[c||d];if(!g)return!1;var h=sa(b.context,L)||a,i=new H(e,d,b,void 0===f?N(a,d,b):f),j=Z,k=h.event;h.event=i,Z=e.sourceObj;try{var l=g.call(i.context,i,i.context);void 0!==l&&(e.handled=Da(l))}catch(a){console.error(a),e.handled=Ba(a)}return Z=j,h.event=k,e.handled};if(sa(c,I))return f(c,b,e.eventName,e.data);var g=a.getContext(c||e.target);return Ca((d?l:xa)(g),function(c){var d=a.components.get(c.element||c);return d&&Ca(d.states,function(a){return f(a,b,e.eventName,e.data)})})}}),oa(L,{event:null,tap:function(a){W.setContext(this.element,this),W.add(this.element,{tap:a})},getContext:function(a){return(S(this,a)||"").context},setContext:function(a,b){T(this,a,b),this!==W&&sa(a,h)&&Fa.set(a,this)},add:function(a,b,c){"string"!=typeof b&&(c=b,b=ja.randomId());var d=this,e=sa(a,h)||a.element||a,f=sa(e,h)?S(d,e):T(d,a,a);if(f){var g=f.states[b]||new I(e,sa(a,h)?f.context:a,c);f.attached=!0,f.states[b]=g,P(d,g,!0)}},delete:function(a,b){var c=this,d=za(c.components,a);if(d)if(b){var e=d.states[b];e&&(delete d.states[b],P(c,e,!1))}else d.attached=!1,pa(d.states,function(a,b){P(c,b,!1)})},observe:function(a,b){return R(this,a,b)},emit:function(a,b,c,d){return(sa(a,H)?Ra(a):new J(a,this,b,c,null,d)).emit(this,null,b,d)},emitAsync:function(a,b,c,d,e){O(this,a,b||this.element,c,d,e)},flushEvents:function(){M(this)},destroy:function(){var a=this;W.delete(a.element),Fa.delete(a.element),pa(a.components,function(b,c){Fa.delete(b),a.emit("destroy",b)})}}),oa(U,{get locked(){return Ra(this).promises.size>0},cancel:function(a){var b=this,c=Ra(b),d=c.promises;return a||!d.size?(d.size&&u("cancelled",null,b.element),d.clear(),c.handler=null,c.deferred&&c.deferred.resolve(),Da()):(c.handler||(c.handler=V(function(){return xa(d).reduce(function(a,b){return a.then(b)},Da()).then(function(){b.cancel(!0)})})))()},wait:function(b,c){var d=this,e=Ra(d),f=e.promises,g=function(){f.delete(b)&&!f.size&&(u("asyncEnd",null,d.element),d.cancel(!0))};if(f.set(b,V(!0===c?Da:c||Ba,g)),1===f.size){e.deferred=a.Deferred();for(var h=d.element.parentNode;h&&!Ka.has(h);h=h.parentNode);h&&Ka.get(h).wait(e.deferred,d.cancel.bind(d)),u("asyncStart",null,d.element)}return b.catch(function(a){a&&!Oa.has(a)&&(u("error",null,d.element,{error:a},!0),"object"==typeof a&&Oa.set(a,!0)),g()}),b.then(function(a){var c=!f.has(b);return g(),c?Ba("user_cancelled"):a})}}),W=new L,X=new L;var Sa={drag:B,prepEventSource:p,scrollIntoView:z,focused:r,get activeElement(){return Ha[0]},get eventSource(){return n()},getEventSource:function(a){return new G(a).source},getContext:function(a){return q(a||Ha[0]).context},focus:function(a){if(ja.isArray(a)){var b=1/0;a=la(a,function(a){var c=ra(a);return c.width&&c.height&&(b=g.min(b,c.top))===c.top})}x(a,!0)},setModal:function(a,b){var d=sa(b,h)||Ea;r(d)||x(d),Ja.set(a,Ha.splice(0,d===Ea||c.body?Ha.length:Ha.indexOf(d))),x(a)},lock:function(a,b,c){var d=Ka.get(a)||new U(a);return b?d.wait(b,c):Da()},locked:function(a,b){return!!la(b?l(a):[a],function(a){return(Ka.get(a)||"").locked})},cancel:function(a,b){var c=Ka.get(a);return c?c.cancel(b):Da()},emit:function(a,b,c,d){return u(a,null,b,c,d)},on:function(a,b,c){sa(a,h)||(c=b,b=a,a=Ea),X.setContext(a,a),X.add(a,ua(b)||wa(b,c))},retainFocus:function(a,b){Ga.set(b,a)},releaseFocus:function(a,b){Ga.delete(b)},mixin:function(a){return sa(a,h)?new C(a):E(a)},support:function(a,b){var c=q(Ha[0]);return Ca(Ha,function(d){return(!b||q(d)!==c)&&F(d,a)})},snap:function(a,d,e){d=d||Ea;var f={to:d,dir:e||"left bottom"};La.set(a,f),na(Ea,a)||c.body.appendChild(a),ja.setZIndexOver(a,d===b?c.body:d),A(a,f)},unsnap:function(a){La.delete(a)},getShortcut:function(a){return Qa[a]?Qa[a].slice(0):[]},setShortcut:function(a,b){if(ua(a))return void pa(a,Sa.setShortcut);var c=Qa[a]||(Qa[a]=[]),d=c.slice(0);pa(b,function(b,e){var f=d.indexOf(e);f>=0?d.splice(f,1):(c[c.length]=e,(Pa[e]||(Pa[e]={}))[a]=!0)}),pa(d,function(b,d){c.splice(c.indexOf(d),1),delete Pa[d][a]})}};i.Container=L,i.dom=Sa,Sa.setShortcut({undo:"ctrlZ",redo:"ctrlY ctrlShiftZ",selectAll:"ctrlA"}),Sa.on("keystroke",function(a){var b=Ca(Pa[a.data],function(a,b){return Sa.support(b)});return b&&a.handled(b())}),Sa.on("escape",function(a){x(c.body)}),Sa.lock(c),b.onbeforeunload=function(a){Sa.locked(c)&&(a.returnValue="",a.preventDefault())},a(function(){function d(a,b){var c=(a.ctrlKey||a.metaKey?"Ctrl":"")+(a.altKey?"Alt":"")+(a.shiftKey?"Shift":"");return c?ja.lcfirst(c+ja.ucfirst(b)):b}function f(){var a=c.activeElement;if("selectionEnd"in a)B=a,C=a.selectionEnd;else if(B=E.anchorNode,C=E.anchorOffset,1===B.nodeType){var b=B.childNodes[C-1];b&&3===b.nodeType?(B=b,C=b.length):(B=B.childNodes[C],C=0)}}function h(a,b){if(Y.sourceKeyName=a,v("keystroke",b,Ha,a,!0))return b.preventDefault(),!0}function l(a,b){var c=b.touches?b.touches[0]:b;return u(a,b,b.target,{target:b.target,clientX:c.clientX,clientY:c.clientY,metakey:d(b)})}function n(a){var b=function(a,b){var c=a.get(b);return a.delete(b),c};pa(a,function(a,c){pa(c.removedNodes,function(a,c){if(1===c.nodeType&&!na(Ea,c)){var d=Fa.get(c);d&&d.autoDestroy&&d.element===c&&d.destroy();var e=b(Ka,c);e&&e.cancel(!0);var f=b(Ja,c);if(f&&r(c)){var g=la(Ja,function(a){return a.indexOf(c)>=0})||Ha;g.push.apply(g,f),x(f[0],!1,null,g)}var h=Ha.indexOf(c);h>=0&&x(Ha[h+1]||F),pa(La,function(a,b){(na(c,a)||na(c,b.to))&&La.delete(a)})}})}),o()}function o(){I=I||m(function(){I=null,pa(La,A)})}var p,q,t,w,y,z,B,C,D,E=b.getSelection(),F=c.body;i.IS_IE10&&ma(F,"mousedown mouseup mousemove click",function(a){if("none"===ka(a.target).pointerEvents){a.stopPropagation(),a.stopImmediatePropagation();var b=c.createEvent("MouseEvent");b.initMouseEvent(a.type,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget),ja.elementFromPoint(a.clientX,a.clientY).dispatchEvent(b)}},!0),ma(F,"mousedown mouseup wheel keydown keyup keypress touchstart touchend cut copy paste drop click dblclick contextmenu",function(a){var b=Aa(a.type,"mousedown keydown");Y=null,s(a.target)?b&&x(a.target):(a.stopImmediatePropagation(),a.preventDefault(),b&&u("focusreturn",null,Ha.slice(-1)[0])),Y=new G(a.target)},!0),ma(b,"blur",function(a){a.target===b&&($=!0)},!0),ma(F,{compositionstart:function(a){f(),D=""},compositionupdate:function(a){D=a.data},compositionend:function(a){var b="selectionEnd"in B,c=D,d=C;f();var e=B.value||B.data||"";(D=a.data)&&!/^\u3000+$/.test(D)||(D=e.slice(d,C));var g=C-D.length,h=C-c.length,i=e.slice(g,C)===D?g:h,j=e.substr(0,i)+e.slice(C);b?(B.value=j,B.setSelectionRange(i,i)):(B.data=j,ja.makeSelection(B,i)),v("textInput",a,Ha[0],D)||(b?(B.value=e,B.setSelectionRange(C,C)):(B.data=e,ja.makeSelection(B,C))),B=null,m(function(){D=null})},textInput:function(a){B||a.data!==D&&!v("textInput",a,Ha[0],a.data)||a.preventDefault()},keydown:function(a){if(!B){var b=a.keyCode,c=da.indexOf(b)>=0;c&&b!==q&&v("metakeychange",a,Ha,d(a),!0);var e=!c&&(aa[b]||"").length>1&&!(b>=186||b>=96&&b<=111);p=a.ctrlKey+a.shiftKey+a.altKey+a.metaKey+!c,p*=e||(p>2||p>1&&!a.shiftKey)&&!c,q=b,p&&h(d(a,aa[b]||a.key),a)}},keyup:function(a){var b=da.indexOf(a.keyCode)>=0;B||!b&&q!==a.keyCode||(q=null,p--,b&&v("metakeychange",a,Ha,d(a)||"",!0))},keypress:function(a){var b=a.char||a.key||e.fromCharCode(a.charCode);B||p||!a.synthetic&&"onbeforeinput"in a.target||(j(a.target)?(Y.sourceKeyName=aa[q]||b,v("textInput",a,Ha[0],b)):h(b,a))},beforeinput:function(a){if(!B&&a.cancelable)switch(a.inputType){case"insertText":return v("textInput",a,Ha[0],a.data);case"deleteContent":case"deleteContentBackward":return h("backspace",a);case"deleteContentForward":return h("delete",a)}},mousedown:function(a){t=0,w=0,z=a,1===(a.buttons||a.which)&&l("mousedown",a),y=c.activeElement},mousemove:function(a){z&&(t=g.max(t,g.abs(z.clientX-a.clientX)),w=g.max(w,g.abs(z.clientY-a.clientY)))},mouseup:function(a){y&&c.activeElement!==y&&y.focus()},wheel:function(a){if(na(a.target,Ha[0])||!j(a.target)){var b=a.deltaY||a.detail;v("mousewheel",a,a.target,b/g.abs(b)*(i.IS_MAC?-1:1),!0)&&a.preventDefault()}},click:function(a){t<=5&&w<=5&&l("click",a)},contextmenu:function(a){l("rightClick",a)},dblclick:function(a){l("dblclick",a)},focusin:function(a){$=!1,s(a.target)?x(a.target,!1,Y):a.target.blur()},focusout:function(a){if(!a.relatedTarget&&!k(a.target)){var b=la(Ha.slice(Ha.indexOf(a.target)+1),k);b&&x(b,!1,Y)}}},!0),ma(F,"wheel",function(a){for(var b=-a.deltaX,c=-a.deltaY,d=a.target;d!==F;d=d.parentNode){var e=ka(d);if(d.scrollWidth>d.offsetWidth&&Aa(e.overflowX,"auto scroll")&&(b>0&&d.scrollLeft>0||b<0&&d.scrollLeft+d.offsetWidth<d.scrollWidth))break;if(d.scrollHeight>d.offsetHeight&&Aa(e.overflowY,"auto scroll")&&(c>0&&d.scrollTop>0||c<0&&d.scrollTop+d.offsetHeight<d.scrollHeight))break}s(d)||a.preventDefault()}),new fa(n).observe(Ea,{subtree:!0,childList:!0}),x(c.activeElement)
;var H=a('<div style="overflow:scroll;height:80px"><div style="height:100px"></div></div>').appendTo(F);_=H.outerWidth()-H.children().width(),H.remove();var I;ma(b,"resize scroll orientationchange mousemove wheel keyup touchend transitionend",o,{passive:!0})}),"undo redo canUndo canRedo enable disable enabled".split(" ").forEach(D),E({focus:function(a){a.focus()},scrollBy:function(d,e,f){var g=d===Ea||d===c.body?b:d,h=a(g).scrollLeft(),i=a(g).scrollTop();return g.scrollBy?g.scrollBy(e,f):(g.scrollLeft=h+e,g.scrollTop=i+f),{x:a(g).scrollLeft()-h,y:a(g).scrollTop()-i}},getUnobscuredRect:function(a){var b=ka(a),d=a.offsetWidth<a.scrollWidth,e=a.offsetHeight<a.scrollHeight,f=ra(a===c.body?Ea:a);return"visible"===b.overflow&&a!==c.body||!d&&!e||(("scroll"===b.overflowY||("hidden"!==b.overflowY||a===c.body)&&e)&&(f.right-=_),("scroll"===b.overflowX||("hidden"!==b.overflowX||a===c.body)&&d)&&(f.bottom-=_)),f}}),E({element:":input",getValue:function(a){return a.value},setValue:function(a,b){a.value=b}})}(a,zeta),function(a,f){function i(a,b){var c=this;lb.set(c,{}),c.typer=a,c.baseCaret=new t(a,c),c.extendCaret=new t(a,c),b&&c.select(b)}function p(a,b,c,d){var e=this;e.id=b,e.typer=a,e.element=c||a.element,e.options=d}function q(a,b,c,d){var e=this;e.typer=a,e.childNodes=[],e.nodeType=b,e.element=c,e.widget=d}function r(a,b,c){var d=this;d.whatToShow=b,d.filter=c||null,d.currentNode=a,d.root=a}function s(a,b,c){var d=this;d.whatToShow=b,d.filter=c||null,U(d,a)}function t(a,b){this.typer=a,this.selection=b||null}function u(a,b){return b=b||a.currentNode,b&&a.whatToShow&(Oa(a,r)?b.nodeType:1<<b.nodeType-1)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b):1:3}function v(a,b){return a[b<0?"previousNode":"nextNode"]()}function w(a){return e(a||"").replace(/[^\S\u00a0]+/g," ").replace(/\u200b/g,"")}function x(a){return a&&1===a.nodeType&&a}function y(a){return a&&3===a.nodeType&&a}function z(a){return"br"===Xa(a)&&a}function A(a,b,c){var d=a.data;return c>=0&&(b===a.length||d.slice(b)===ga)?1:c<=0&&(!b||d.slice(0,b)===ga)?-1:0}function B(a,b){return!!cb.test(a)||!/[^\s!-\/:-@\[\]^_`{|}~]/.test(a)&&b}function C(a){var b=ib(x(a)||a.parentNode);return _a[b.getPropertyValue("writing-mode")]^("rtl"===b.direction?2:0)}function D(a,b){for(;a&&!Oa(a,b);a=a.parentNode);return Oa(a,ka)?a.typer.getNode(a.widget.element):a}function E(a,b){var c=a.length||a.childNodes.length;return 1/b<0?g.max(0,c+b):g.min(c,b)}function F(a,b){for(var c,d=new s(new r(a,va),5),e=0;(c=d.nextNode())&&c!==b;e+=c.length||0);return e}function G(a,b){var c=b/g.abs(b);b/=c;var d=2&b?-1:1,e=4&b?-1:1;c>0&&1&b&&(d^=e,e^=d,d^=e);var f=d<0?"right":"left",h=e<0?"bottom":"top";return a=1&b?Ya(a[h]*e,a[f]*d,a[$a[h]]*e,a[$a[f]]*d):Ya(a[f]*d,a[h]*e,a[$a[f]]*d,a[$a[h]]*e)}function H(a,b){b=+b===b?b:C(b),a=+a===a?a:bb.indexOf(a);var c=a>>1&1^1&b?"left":"top";return!!(ab[a>>1]&1<<b)^1&a?$a[c]:c}function I(a){if(hb.rangeCount){var b=hb.getRangeAt(0);return Ca(a,b.commonAncestorContainer)&&b}}function J(a,b){switch(b){case"uppercase":return a.toUpperCase();case"lowercase":return a.toLowerCase();case"capitalize":return a.replace(/\b(.)/g,function(a){return a.toUpperCase()})}return a}function K(a,b){a.data!==b&&(a.data=b)}function L(b,c){return Ka(c,function(c,d){b=a(d.cloneNode(!1)).append(b)[0]}),Oa(b,h)||Da(b)}function M(b){var d=M.cache||(M.cache={}),e=ib(x(b)||b.parentNode),f=[e.fontFamily,e.fontWeight,e.fontStyle].join("|");if(!d[f]){var g=a('<div style="position:fixed;font-size:1000px;"><span style="display:inline-block;width:0;height:0;"></span>&nbsp;</div>').css({fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontStyle:e.fontStyle}).appendTo(c.body),h=g.children(),i=Ma(g[0]).top;d[f]={baseline:(Ma(h.css("vertical-align","baseline")[0]).top-i)/1e3,height:(Ma(h.css("vertical-align","text-bottom")[0]).top-i)/1e3,middle:(Ma(h.css("vertical-align","middle")[0]).top-i)/1e3,wsWidth:g.width()/1e3},g.remove()}var j=l(e.fontSize);return{fontSize:j,baseline:d[f].baseline*j,height:d[f].height*j,middle:d[f].middle*j,wsWidth:d[f].wsWidth*j}}function N(){var b=a.grep(arguments,Pa);return function(a){for(var c=1,d=0,e=b.length;d<e;d++){var f=b[d](a);if(2===f)return 2;c|=f}return c}}function O(k,l){function o(a){this.widget=a||null}function u(){_.emit("stateChange",U.focusNode.widget.element,null,!0)}function A(a,b,c){var d=aa[a];return!(b in d)||"*"===d[b]||(" "+d[b]+" ").indexOf(" "+c+" ")>=0}function B(a,b){return b=D(b,sa),aa[a]&&aa[a].element&&(aa[a].inline||!Oa(b,ma))&&A(a,"allowedIn",b.widget.id)&&A(b.widget.id,"allow",a)}function C(){return U.getWidgets().reverse().concat(ba)}function E(a){return Aa(C(),function(b){return aa[b.id]&&Pa((aa[b.id].commands||{})[a])})}function F(b,e){function g(){u=null,ea&&M(),ca.snapshot()}function h(a,b){var c=new p(w,b,a,La({},aa[b].options));return a!==k&&_.getContext(a)&&_.delete(a),e&&(_.setContext(a,c),_.add(a,c.id,aa[c.id])),c}function i(a,b){for(var c=a.childNodes,d=c.length;d&&Ba(b.element,c[d-1].element)<=0;d--);if(c[d]!==b)return b.parentNode?l(b):Qa(new r(b,-1),function(a){var b=a.widget;mb.delete(a.element),b.element===a.element&&_.add(a.element,b.id,aa[b.id])}),c.splice(d,0,b),b.parentNode=a,b.previousSibling=c[d-1]||null,b.nextSibling=c[d+1]||null,(b.previousSibling||{}).nextSibling=b,(b.nextSibling||{}).previousSibling=b,!0}function l(a,b){var c=a.parentNode,d=a.previousSibling,e=a.nextSibling;c.childNodes.splice(c.childNodes.indexOf(a),1),(d||{}).nextSibling=e,(e||{}).previousSibling=d,a.parentNode=null,a.nextSibling=null,a.previousSibling=null,b&&Qa(new r(a,-1),function(a){mb.set(a.element,{node:(d||e||c).element,offset:!d&&(!!e||0)}),a.widget.element===a.element&&_.delete(a.element)})}function n(a){var b=a.widget,c=a.parentNode,e=function(b){return Oa(a.element,aa[b].element)&&b};if(a.widget=(b||"").element!==a.element?c.widget:b,!Oa(c,ka|pa)){var f=Aa(d.keys(aa),e)||e(ja);!f||a.widget!==c.widget&&a.widget.id===f||(a.widget=h(a.element,f))}b&&b!==a.widget&&_.delete(a.element,b.id);var g=aa[a.widget.id];a.widget!==c.widget||Oa(c,ka|pa)?Oa(a.element,g.editable)||g.inline&&!g.editable?a.nodeType=g.inline?qa:Oa(a.element,fa)?ma:la:a.nodeType=g.inline&&a.widget!==c.widget&&Oa(c,va)?pa:ka:a.nodeType=Oa(a.element,fa)?na:oa}function o(b,c){Ka(b.childNodes.slice(0),function(a,c){Ca(b,c)||l(c,!0)}),a(b.element).children().not("br").each(function(a,d){var e=A.get(d)||new q(w,0,d);A.set(d,e),(i(b,e)||c)&&(n(e),o(e,!0))})}function s(a){var c=U&&!da,d=new xa;Ka(a,function(a,e){var f=A.get(x(e.target)||e.target.parentNode);if(f){var g=Ca(b,e.target);!e.addedNodes[0]&&!e.removedNodes[0]||d.has(f)||(d.add(f),g&&o(f)),!c||!g||"style"===e.attributeName||e.attributeName&&e.target===b||(f.widget.id!==ia&&_.emitAsync("contentChange",f.widget.element),_.emitAsync("contentChange",k),ea=!0)}}),d.size&&U&&Y(function(){var a,b=U.getRange();d.forEach(function(c){a|=Ta(b,c.element)}),a&&Z(U)}),ea&&!da&&(u=u||m(g))}function t(a){if(f.IS_IE10&&!Ca(c,b)?o(B,!0):V(),(y(a)||z(a))&&(a=a.parentNode||a),Ca(b,a)){var d=A.get(a);return Oa(d,ka)?A.get(d.widget.element):d}}var u,v={},w=Ca(k,b)?X:v,A=new wa;e&&(V=_.observe(s,{childList:!0,attributes:!0,characterData:!0})),b.parentNode||(b=Oa(b,j)||Da(b));var B=new q(w,$,b,h(b,ia));return A.set(b,B),o(B),La(v,{rootNode:B,getNode:t})}function G(a,b,c){var d=Ra(Fa(a,4)),e="",f=[];b=b||function(a,b){return a+b},Ka(d,function(a,c){e=b(e,c.data),f[a]=e.length}),e=c(e),Ka(d,function(a,b){K(b,e.slice(f[a-1]||0,f[a]))})}function H(a){G(a,function(a,b){return(a+b).replace(/\u00a0{2}(?!\u0020?$)/g,"  ").replace(/[^\S\u00a0]{2}/g,"  ").replace(/\u00a0[^\S\u00a0]\u00a0(\S)/g,"   $1").replace(/(\S)\u00a0(?!$)/g,"$1 ")},function(a){return a.replace(/[^\S\u00a0]$/," ")})}function M(){V(),ea&&(da=!0,Qa(new r(X.rootNode,va|la|ra),function(b){var c=b.element;if(Oa(b,la))return b.firstChild?void a(c).contents().each(function(b,d){if(d.parentNode===c){for(var e=[];d&&(y(d)||z(d)||Oa(X.getNode(d),ua));d=d.nextSibling)(e.length||x(d)||Za(d.data))&&e.push(d);e.length&&a(e).wrap("<p>")}}):void a(c).html("<p>"+(Za(c.textContent)||ha)+"</p>");if(Oa(b,na|ma)){if(!c.firstChild)return void a(Ha()).appendTo(c);var d=a(">br:last-child",c)[0];d&&!d.nextSibling&&(a(Ha()).insertBefore(d),Va(d));var e=a(">br:first-child",c)[0];e&&!e.previousSibling&&Va(e),(!U||U.startNode!==b&&U.endNode!==b)&&Ka(Ra(Fa(c,4)),function(a,b){K(b,w(b.data)||ga),y(b.nextSibling)&&(b.nextSibling.data=w(b.data+b.nextSibling.data),Va(b))})}!Oa(b,oa)||U&&(U.startElement===c||U.endElement===c)||Za(c.textContent)||Va(c),a(">br",c).each(function(b,c){y(c.nextSibling)||a(Ha()).insertAfter(c)})}),a('br[type="_moz"]',k).remove(),V(),da=!1,ea=!1)}function N(b,c,d){var e="cut"===c?"extractContents":"paste"===c?"deleteContents":"cloneContents",f="paste"!==c,g="copy"!==c,h=Da(),l=Oa(b,i)?b.clone():new i(X,b),m=U.timestamp;if(b=l.getRange(),!l.isCaret){var n=[[k,h]],o=function(){var a=n.shift();a[2]&&a[2].element===a[0]&&_.emit("extract",a[2].element,{extractedNode:a[1]})};for(Qa(l.createTreeWalker(-1,function(c){var d=c.element,h=Oa(c,ka|la|ma)&&aa[c.widget.id].extract,i=c.widget.element===d;if((!h||c===l.focusNode)&&!i&&Oa(c,la))return 3;for(;!Ca(n[0][0],d);)o();if(!h||i&&Sa(b,d)||(i?a(d):a(d).parentsUntil(n[0][0]).addBack()).each(function(a,b){n.unshift([b,b.cloneNode(!1),c.widget]),n[1][1].appendChild(n[0][1])}),Sa(b,d)){var k=d===n[0][0],m=g?d:d.cloneNode(!0);return g&&!k&&Oa(c,ma)&&(m=a(d.cloneNode(!1)).append(d.childNodes[0])),a(n[0][1]).append(k?m.childNodes:m),2}if(Oa(c,va)){var p=Ga(d,b)[e](),q=Oa(p,j)?p.firstChild:p,r=Oa(q,Xa(d)),s=!h;return f&&q&&(!r&&s?p=L(p,[Oa(c,ma)?Ea("p"):d]):r&&!s&&(p=Da(q.childNodes)),h||G(p,null,function(b){return J(b,a.css(d,"text-transform"))}),a(n[0][1]).append(p)),2}return 1}));n[0];o());}if(g){if(U.timestamp!==m?l=U:l.direction>0?l.select(b):(l.select(Ga(b,!1)),l.extendCaret.moveTo(Ga(b,!0))),!l.isSingleEditable){var p=l.createTreeWalker(sa,function(a){return aa[a.widget.id].textFlow?1:3}),q=D(l.baseCaret.node,sa),r=D(l.extendCaret.node,sa);for(p.currentNode=q;v(p,l.direction););p.currentNode!==r&&(p.currentNode!==q?l.extendCaret.moveTo(p.currentNode.element,0*-l.direction):l.collapse())}U.select(l)}return Pa(d)&&d(l),a(h).find("[style]").removeAttr("style"),M(),h}function P(b,c){var d;Oa(c,h)?(Ca(k,c)&&Va(c),c=ya.makeArray(Da(c).childNodes),d=1===c.length&&!!Oa(c[0],"p:not([class])")):(c=a(e(c||"").replace(/\u000d/g,"").replace(/</g,"&lt;").replace(/\n{2,}/g,"</p><p>").replace(/\n/g,"<br>").replace(/.*/,"<p>$&</p>").replace(/\s/g," ")).get(),d=!0),N(b,"paste",function(b){var e,f=b.startNode,g=b.endNode,h=b.getCaret("start").clone(),i=Ga(D(f,sa).element,0),j=!!Oa(f,ma),k=!!Oa(f,va),l=!0,m=[],n=X.getNode(b.startElement);if(Oa(n,ua)){for(;n!==f;n=n.parentNode)Oa(n,oa)&&m.push(n.element);m.push(f.element)}else Oa(n,na)?m[0]=f.element:Oa(n,ma)||(m[0]=Ea("p"));if(Ka(c,function(b,g){var n,o=X.getNode(h.element),p=new q(X,d?na:oa,g),r=!!z(g),s=!1,t=!1;if(!r&&x(g)&&(i.insertNode(g),p=X.getNode(g),Va(g),p.widget!==o.widget))for(var u=o;Oa(u,ua|na)||Oa(u,ma)&&u===o;u=u.parentNode){if(1===c.length&&p.widget.id===u.widget.id){var v={receivedNode:g,caret:h.clone()};if(_.emit("receive",u.widget.element,v))return h=U.clone(),void(e=!0)}if(!B(p.widget.id,u)){var y=p.widget.id===ja?w(Za(g.textContent)):Q(g);if(!y)return;g=Ha(y),p=new q(X,oa,g);break}}if(!Oa(o,sa)){if(r){for(s=!Oa(o,na);Oa(o.parentNode,ua);o=o.parentNode);n=Ga(o.element,!1)}else Oa(p,ua)||(o=D(o,na)||o,n=Ga(o.element,!1),Oa(p,na)?(t=!d&&!j&&Oa(o,na)&&!Wa(p.element,o.element)&&!!Za(g.textContent),s=!l||t&&!!Za(Ga(Ga(o.element,!0),Ga(h))),l=!t,k=k&&l):Za(Ga(Ga(o.element,!0),Ga(h)))&&((s=Za(Ga(n,Ga(h))))||(o=o.nextSibling||o.parentNode,h.moveTo(n))));if(s){var A=Ga(Ga(h),n).extractContents();Za(A.textContent)||(A=Da(L(Ha(),m)));var C=A.firstChild;n.insertNode(A);for(var E=X.getNode(C);E&&!Za(E.element.textContent);E=E.firstChild)if(Oa(E,pa|qa)){a(E.element.childNodes).insertBefore(E.element),Va(E.element);break}if(Oa(o,va)&&!(o.element.firstChild||"").length&&a(Ha()).appendTo(o.element),Za(o.element.textContent)&&" "===o.element.textContent.slice(-1)&&H(o.element),Za(C.textContent)&&" "===C.textContent.charAt(0)&&H(C),r)return Ga(C,!0).insertNode(g),void h.moveTo(C,0);o=X.getNode(C),h.moveTo(C,0),e=!0}}if(k=k&&!!Oa(p,va|ua)){var F=ya.makeArray(l&&!Oa(p,ua)?g.childNodes:g);F[0]&&(h.getRange().insertNode(Da(F)),H(o.element),h.moveTo(F[F.length-1],-0)),l=j}else Oa(p,ua)&&(g=L(g,m)),(e||!Oa(f,ka)||Za(g.textContent))&&(Oa(o,sa)&&!Oa(o.parentNode,sa)?a(g).appendTo(o.element):a(g).insertBefore(o.element),k=!!Oa(p,va|ua),l=t||!k,h.moveTo(g,!l&&-0)),e=!0}),!e&&f!==g)if(Q(f.element)){if(Oa(f,na)&&Oa(g,na)){var o=Da(Ga(g.element,"contents").extractContents()),p=o.firstChild;for(h.moveTo(f.element,-0),Ga(f.element,-0).insertNode(o),Va(g.element);x(p)&&Wa(p,p.previousSibling);){var r=p;p=a(p.childNodes).appendTo(p.previousSibling)[0],Va(r)}H(f.element)}}else h.moveTo(g.element,!Oa(g,va)||0),Va(f.element);U.select(h)})}function Q(b){var c,d,e=Ga(b||k,"contents");Oa(b,h)&&!ya.connected(k,b)?(d=F(b),c=new s(new r(d.rootNode,-1),5)):c=new s((Oa(b,i)||new i(X,e)).createTreeWalker(-1),5,function(a){return Ta(e,Ga(a,"contents"))?1:2});var f,g,j,l="",m="";return Qa(c,function(b){var c=(d||X).getNode(b);if(j=aa[c.widget.id].text,c!==f&&(f&&(l+=J(m,g),m="",Oa(f,ta)&&Oa(c,ta)&&"\n\n"!==l.slice(-2)&&(l+="\n\n"),c.widget!==f.widget&&j&&(l+=j(c.widget))),f=c,g=a.css(c.element,"text-transform")),Oa(c,va)&&!j)if(y(b)){var h=b.data;b===e.endContainer&&(h=h.slice(0,e.endOffset)),b===e.startContainer&&(h=h.slice(e.startOffset)),m+=h.replace(/\u200b/g,"").replace(" "," ")}else z(b)&&(m+="\n")}),l+=j?j(f.widget):J(m,g),Za(l).replace(/\u00a0/g," ")}function R(a){W=a,Ma.attr("contenteditable",a?"true":null),!a&&I(k)&&k.blur()}function S(a,b,c){aa[a]=La({},b),aa[a].options=!c||ya.isPlainObject(c)?La({},b.options,c):c}function T(a){var b=new p(X,a,k,aa[a].options);_.add(b,a,aa[a]),ba.push(b)}Oa(k,h)||(l=k,k=k.element),l=La(!0,{},(!l||!1!==l.defaultOptions)&&O.defaultOptions,l);var U,V,W,X=this,$=l.inline||Oa(k,fa)?ma:la,_=new f.Container(k,X),aa={},ba=[],ca={},da=!0,ea=!0,Ma=a(k);!function(){function a(a){for(var b=[],c=a.node;c.parentNode;c=c.parentNode)b.unshift(c.parentNode.childNodes.indexOf(c));return b[b.length]=a.textNode?a.wholeTextOffset:a.offset,b.join(" ")}function b(a,b){var c=b.split(" "),d=k,e=c.splice(-1)[0];c.forEach(function(a){d=d.children[+a]}),isNaN(e)?a.moveTo(d,"true"===e):a.moveToText(d,+e)}function c(){var b=ca.getValue();f[0]&&b===f[h].value||(f.splice(0,h,{value:b}),f.splice(X.historyLevel),h=0),f[h].basePos=a(U.baseCaret),f[h].extendPos=a(U.extendCaret),f[h].html=k.innerHTML,u(),n(e)}function d(a){Ma.html(a.html),b(U,a.basePos),b(U.extendCaret,a.extendPos),u(),n(e)}var e,f=[],h=0,i=0;La(ca,{getValue:function(){return Za(k.innerHTML.replace(/\s+style(?:="[^"]*")?|\u200b+(?!<\/)|(^|[^>])\u200b+/g,"$1"))},canUndo:function(){return h<f.length-1},canRedo:function(){return h>0},undo:function(){ca.canUndo()&&d(f[++h])},redo:function(){ca.canRedo()&&d(f[--h])},snapshot:function(a){var b=+new Date;n(e),!0===a?c():(i=g.max(i,b+(a||0)),e=m(c,i-b))}})}(),function(){Ka(l.widgets,function(a,b){S(a,b,l[a])}),Ka(O.widgets,function(a,b){l[a]&&S(a,b,l[a])}),Ia(aa,ia,l),Ia(aa,ja,{element:l.disallowedElement||":not("+fa+",br,b,em,i,u,strike,small,strong,sub,sup,ins,del,mark,span)",allowedIn:""}),l.textFlow=!0,La(X,F(k,!0)),Ka(aa,function(a,b){b.element&&b.element!==k?Pa(b.setup)&&_.add(new p(X,a,k),a,{init:b.setup}):T(a)})}(),function(){function c(a){return U.isCaret?U.extendCaret.moveByCharacter("backspace"===a.data?-1:1)?(P(U,""),!0):void 0:(P(U,""),!0)}function d(a){if(U.startTextNode&&U.isCaret){if(a){var b=U.startTextNode,c=U.startOffset;b.data=b.data.substr(0,c)+a+b.data.slice(c),H(U.startNode.element),U.moveToText(b,c+a.length),ca.snapshot(200)}}else P(U,a)}function e(b){var c=U.focusNode.widget,d="*"!==aa[c.id].disallowedElement,e=b.getData(f.IS_IE?"Text":i);if(d&&a.inArray(h,b.types)>=0){var g=Da(a(b.getData(j)).filter("#Typer").contents());P(U,g)}else d&&e===jb.textContent?P(U,jb.htmlContent.cloneNode(!0)):za.emit("textInput",c.element,e,!1)}function g(c){var d=c.clipboardData||b.clipboardData,e=Q(U),g=N(U,c.type);f.IS_IE?d.setData("Text",e):(d.setData(i,e),d.setData(j,a('<div id="Typer">').append(g.cloneNode(!0))[0].outerHTML),d.setData(h,"true")),jb.textContent=e,jb.htmlContent=g,c.preventDefault()}var h="application/x-typer",i="text/plain",j="text/html";_.add(k,"destroy",ya.bind(k,{compositionstart:function(){da=!0,kb=X},compositionend:function(){da=!1,kb=!1,U.focus(),_.emitAsync("stateChange")},cut:g,copy:g,paste:function(a){if(e(a.clipboardData||b.clipboardData),a.preventDefault(),f.IS_IE){var c=U.clone();m(function(){U.select(c)})}},drop:function(a){U.moveToPoint(a.clientX,a.clientY)&&e(a.dataTransfer),U.focus(),a.preventDefault()},dragstart:function(a){a.preventDefault()}}));var l={backspace:c,delete:c};Ka({moveByLine:"upArrow downArrow shiftUpArrow shiftDownArrow",moveByWord:"ctrlLeftArrow ctrlRightArrow ctrlShiftLeftArrow ctrlShiftRightArrow",moveToLineEnd:"home end shiftHome shiftEnd",moveByCharacter:"leftArrow rightArrow shiftLeftArrow shiftRightArrow"},function(a,b){Ka(b,function(b,c){var d=1&b?1:-1,e=!!(2&b);l[c]=function(){e||U.isCaret?(e?U.extendCaret:U)[a](d):U.collapse(d<0?"start":"end")}})});var n={keystroke:function(a){/ctrl(?=[acfnprstvwx]|f5|shift[nt]$)|^((shift)?tab|f5|f12)$/i.test(a.data)||a.preventDefault()},mousedown:function(a){("shift"===a.metakey?U.extendCaret:U).moveToPoint(a.clientX,a.clientY),U.focus(),za.drag(a,function(a,b){ca.snapshot(200),U.extendCaret.moveToPoint(a,b)}),m(function(){U.focus()})},click:function(a){var b=X.getNode(a.target);Oa(b,ka|pa)&&U.select(b.widget.element),U.focus()},dblclick:function(a){U.select("word")},rightClick:function(a){var b=new t(X);b.moveToPoint(a.clientX,a.clientY),!U.isCaret&&Ta(U,b)||U.select(b)}},o={keystroke:function(a){a.data in l&&l[a.data](a)&&a.handled()},textInput:function(a){d(a.data),a.handled()}};_.tap(function(a){var b,c=a.eventName;if(W){if((n[c]||ya.noop)(a),ya.matchWord(c,"focusin focusout focusreturn")){if(a.target!==k)return;b=k}else"rightClick"===c?b=k:"click"===c&&(b=a.target);_.emit(a,b||U.focusNode.element)||(o[c]||ya.noop)(a),a.originalEvent&&a.isHandled()&&a.preventDefault()}})}(),R(!0),f.IS_IOS&&Ma.css("-webkit-user-modify","read-write-plaintext-only"),La(X,ca,{element:k,on:function(a,b){_.add(k,ya.isPlainObject(a)||ya.kv(a,b))},enabled:function(){return W},enable:function(a,b){a?aa[a]||!O.widgets[a]||O.widgets[a].element||(S(a,O.widgets[a],b),T(a)):(R(!0),_.emitAsync("stateChange"))},disable:function(){R(!1),_.emitAsync("stateChange")},destroy:function(){R(!1),_.destroy()},hasCommand:function(a){return!!E(a)},widgetEnabled:function(a){return!!aa[a]},widgetAllowed:function(a,b){return b=Oa(b,q)||X.getNode(b||k),!!B(a,b)},getWidgetOption:function(a,b){return aa[a]&&aa[a][b]},getStaticWidget:function(a){return Aa(ba,function(b){return b.id===a})},getStaticWidgets:function(){return ba.slice(0)},getSelection:function(){return U},extractText:function(a){return Q(a)},invoke:function(a,b){var c=new o;"string"==typeof a&&(c.commandName=a,c.widget=E(a),a=c.widget&&aa[c.widget.id].commands[a]),Pa(a)&&(a.call(X,c,b),M(),ca.snapshot(),X.focused(!0)&&U.focus())}}),Ja(o,{typer:X,get selection(){return U},insertText:function(a){P(U,a)},insertHtml:function(a){P(U,Oa(a,h)||Da(a))},insertWidget:function(a,b){var c=(aa[a]||"").create;Pa(c)&&c.call(X,this,b)},removeWidget:function(a){var b=aa[a.id].remove;if(Pa(b))b.call(X,new o(a));else if("keepText"===b){var c=Q(a.element);P(Ga(a.element,!0),c),Va(a.element)}else P(Ga(a.element),"")}}),M(),U=new i(X,Ga(k,0)),_.emit("init")}function P(a,b){return b&&(a.whatToShow&ra||b.element.offsetWidth>0||b.element.offsetHeight>0)&&b}function Q(a,b,c){return c&&b!==a.root&&!P(a,b)?2:Oa(b,ka)&&Oa(b.parentNode,ka)?3:u(a,b)}function R(a,b,c){if(Q.returnValue=Q(a,b,c),1===Q.returnValue)return a.currentNode=b,!0}function S(a,b,c){for(var d=a.currentNode[b];d;){if(R(a,d,!0))return d;if(3===Q.returnValue&&d[b])d=d[b];else{for(;!d[c];)if(!(d=P(a,d.parentNode))||d===a.root||d===a.currentNode)return null;d=d[c]}}}function T(a,b,c){for(var d=a.currentNode;d&&d!==a.root;){for(var e=d[c];e;){if(R(a,e))return e;e=2!==Q.returnValue&&e[b]?e[b]:e[c]}if(!(d=P(a,d.parentNode))||d===a.root||1===Q(a,d,!0))return null}}function U(a,b){var d=b.currentNode.typer,e=c.createTreeWalker(b.root.element,1|a.whatToShow,function(c){var e=d.getNode(c);return R(b,e,!0)?!y(c)&&!z(c)||Oa(e,va)?1|u(a,c):2:Q.returnValue},!1);Ia(a,"iterator",e)}function V(a,b,c){var d=Ga(a),e=lb.get(a).d,f=function(a){return Ta(a.element,d)?1:2};return new r(a.focusNode,b&~ra,N(f,e&&e.acceptNode&&e.acceptNode.bind(e),c))}function W(a){var b=new s(V(a,va),4);return b.currentNode=a.startTextNode||a.startElement,a.startOffset===(a.startTextNode||"").length&&b.nextNode(),Ra(b,null,null,function(b){return Ba(b,a.endTextNode||a.endElement)<=(0!==a.endOffset?0:-1)})}function X(a){var b=a.getCaret("start"),c=a.getCaret("end");c.textNode&&!A(c.textNode,c.offset,1)&&c.textNode.splitText(c.offset),b.textNode&&!A(b.textNode,b.offset,-1)&&ba(b,b.node,b.element,b.textNode.splitText(b.offset),0)}function Y(a,b,c){return Y.executing=!0,Y.run(a,b,c)}function Z(a){if(Y.executing)return void nb.add(a);var b=lb.get(a);b.d=null,b.m=0,a.timestamp=performance.now(),a.direction=ya.compareRangePosition(a.extendCaret.getRange(),a.baseCaret.getRange())||0,a.isCaret=!a.direction;for(var c=0,d=a.getCaret("start"),e=a.getCaret("end");c<4;c++)a[Z.NAMES[c+4]]=d[Z.NAMES[c]],a[Z.NAMES[c+8]]=e[Z.NAMES[c]];var f=a.typer.getNode(ya.getCommonAncestor(a.baseCaret.element,a.extendCaret.element));a.focusNode=D(f,ka|pa|sa|qa),a===a.typer.getSelection()&&(a.typer.focused(!0)&&a.focus(),a.typer.snapshot())}function $(a,b,c){var d=new s(new r(b||a.typer.rootNode,va|ka|pa),4|c);return d.currentNode=a.textNode||a.element,d}function _(a,b){return a.selection?Y(b,null,a):b.call(a)}function aa(a){var b=a.typer.element,c=a.element,d=a.textNode;if(!Ca(b,d||c)||d&&(d.parentNode!==c||a.offset>d.length))if(a.node)if(d&&Ca(b,d)&&a.offset<=d.length)a.moveTo(d,a.offset);else if(Ca(b,a.node.element))a.moveToText(a.node.element,a.wholeTextOffset);else{var e={node:c};for(a.typer.getNode(c);!Ca(b,e.node)&&mb.has(e.node);e=mb.get(e.node));a.moveTo(e.node,e.offset)}else a.moveTo(b,0);return a}function ba(a,b,c,d,e,f){var g=a.textNode||a.element,h=a.offset;a.node=b,a.element=c,a.textNode=d||null,a.offset=e,a.wholeTextOffset=(d?a.offset:0)+F(b,d||c),a.beforeSoftBreak=!!f;var i=g!==(d||c)||h!==e;return i&&a.selection&&Z(a.selection),i}function ca(b,c,d,e){var f,g;x(c)&&(g=d===c.childNodes.length,c=c.childNodes[d]||c.lastChild||c,d=g?c.length||0:0);var h=b.typer.getNode(c);if(Oa(h,ka|pa))c=h.widget.element,c!==h.element&&(h=b.typer.getNode(c)),Oa(h.parentNode,va)?(f=y(g?c.nextSibling:c.previousSibling)||a(Ha())[g?"insertAfter":"insertBefore"](c)[0],c=f.parentNode,d=g?0:f.length,h=h.parentNode):f=null;else if(Oa(h,va))f=z(c)?y(c.nextSibling)||a(Ha()).insertAfter(c)[0]:y(c);else{var i=Aa(h.childNodes,function(a){return Ba(c,a.element)<0});h=i||h.lastChild||h,f=null,g=!i}if(b.selection&&b===b.selection.extendCaret&&Oa(h.previousSibling,ka)===b.selection.baseCaret.node&&(h=h.previousSibling,f=null,g=!0),!f&&Oa(h,va)){for(var j=new s(new r(h,va),4);j.nextNode()&&g;);f=y(j.currentNode)||a(Ha())[g?"appendTo":"prependTo"](h.element)[0],d=f&&g?f.length:0}if(f&&!e){for(var k=function(c,e,g,h){var i=A(f,d,c)&&x(f[e]);if(i&&!z(i)&&Oa(b.typer.getNode(i),va))return f=y(i[g])||a(Ha())[h](i)[0],d=E(f,0*c),!0};k(-1,"previousSibling","lastChild","appendTo")||k(1,"nextSibling","firstChild","prependTo"););f.length||(f.data=ga,d=1)}return ba(b,D(h,ta),f?f.parentNode:h.element,f,f?d:!g,e)}function da(b,d,e,f){var g=C(b),h=d===b.length||!!e&&d>0,i=!!(2&g),j=b.data.charAt(d-h);if(B(j)!==i&&"override"!==a.css(b.parentNode,"unicode-bidi").slice(-8)){for(var l=b.parentNode;"inline"===a.css(l,"display")&&"isolate"!==a.css(l,"unicode-bidi").slice(0,7);l=l.parentNode);if((i?db:cb).test(l.textContent)){var m=function(b,d,e){var f=c.createTreeWalker(l,5,function(b){if(x(b)&&!z(b)){if("inline"!==a.css(b,"display")||Oa(b,"audio,canvas,embed,iframe,img,input,object,video"))return 2;switch(a.css(b,"unicode-bidi")){case"normal":case"plaintext":return 3;case"isolate":case"isolate-override":return 2}}return 1},!1);for(f.currentNode=b;y(b);){for(;d!==E(b,0*-e);)if(d+=e,/(\S)/.test(b.data.charAt(d)))return B(k.$1,i);b=v(f,e),d=e>0?-1:(b||"").length}return!b||z(b)?i:"rtl"===a.css(b,"direction")},n=m(b,d-h,-1),o=m(b,d-h,1),p=n===o&&/\s/.test(j)?n:B(j,i);h||p===i||n!==i||(h=!0,p=n),g=-3&g|(p?2:0)}}var q=Na(Ga(b,d-h,b,d+!h))[0]||Ya(0,0);return f&&h&&/\s/.test(b.data.charAt(d-h))&&!G(q,g).width&&(q[H(3,g)]+=M(b).wsWidth),q.collapse(H(2|h,g))}function ea(b,c,d,e,f){function h(b){var c=q.indexOf(b);if(c>=0)return t[c];for(var d=ib(b),e=b;"inline"===a.css(e,"display");e=e.parentNode);var f=t[q.push(b)-1]=M(b);return f.lineHeight="px"===d.lineHeight.slice(-2)?l(d.lineHeight):("normal"===d.lineHeight?1.15:d.lineHeight)*f.fontSize,f.verticalAlign=d.verticalAlign,f.baselineOffset=f.baseline-f.height+i(b,e),f}function i(a,b){if(a===b)return 0;if(a.parentNode!==b)return i(a,a.parentNode)+i(a.parentNode,b);var c=h(a);switch(c.verticalAlign){case"baseline":return 0;case"middle":var d=h(a.parentNode);return-c.height/2+(d.baseline-d.middle);case"top":case"bottom":return NaN;case"text-top":return(c.lineHeight-c.height)/2;case"text-bottom":return(c.lineHeight+c.height)/2-h(a.parentNode).height;case"sub":return-.21*c.fontSize;case"super":return.34*c.fontSize}return isNaN(c.verticalAlign)?l(c.verticalAlign)/100*c.lineHeight:+c.verticalAlign||0}function j(a){var b,f;e?(f=e>0?a.right:a.left,b=(f-d.left)*e):(b=g.min(0,a.right-d.left)||g.max(0,a.left-d.left),f=d.left+b),(e?b>u:g.abs(b)<g.abs(u))&&(u=b,c=a.node,n=G(Ya(f,a.centerY),-p))}function m(a,b,c,e,f){var i,k=new s(new r(a,va),4),l=c>0?"bottom":"top",m=d,n=[];if(y(b))k.currentNode=b;else{for(;k.nextNode()&&c<0;);if(b=k.currentNode,!y(b))return m[l]}do{var o=h(b.parentNode),q=Na(b);c<0&&q.reverse();for(var t=0,u=q.length;t<u;t++){var w=G(q[t],p),x=o.lineHeight-w.height>>1,z=Ya(w.left,w.top-x,w.right,w.bottom+x),A=w.bottom+o.baselineOffset,B=!1;if(z.node=b,!(void 0===i&&z[l]*c<m[$a[l]]*c)){if(isNaN(i)||g.abs(A-i)<1||z.top<m.bottom&&z.bottom>m.top)B=!0;else if(isNaN(A))if(o.verticalAlign===$a[l])B=z[$a[l]]*c<=m[l]*c;else{if(!n[0]||z[l]===n[0][l]){n.push(z);continue}var C=n.splice(0,n.length,z);C[0][l]===m[l]&&C.forEach(j)}if(void 0!==i&&isNaN(A)||(i=A),!B&&!--e||i*c>f*c)return m[l];m=ya.mergeRect(m,z),1===e&&(n.splice(0).forEach(j),j(z))}}}while(b=v(k,c));return m[l]}var n,o=D(b.typer.getNode(c),ta),p=C(c),q=[],t=[],u=-1/0;if(d=G(Ya(d.centerX,d.centerY),p),b.softPoint&&(d.left=d.right=G(b.softPoint,p).left),f){var w=m(o,c,f,2);if(!n){var x=new r(b.typer.rootNode,ta);x.currentNode=o;for(var z;o=v(x,f);){var A=G(Ma(o.element),p),B=f>0?"bottom":"top";if(!(A[$a[B]]*f<w*f)){if(A[$a[B]]*f>=z*f)break;m(o,null,f,1,z),z=A[B]}}if(!n&&void 0!==z)return ca(b,x.currentNode.element,0)}}else{var E=!e&&d.top>G(Ma(o.element),p).bottom;m(o,c,(e||1)*(2&p?-1:1)*(E?-1:1),1)}if(n){var F=e>0||u<0,H=function(b,c,d,e){function f(a){var f=G(da(b,a,e),d);return(f.centerY-c.centerY|0)*(1/0)||f.left-c.left|0}var h=0,i=b.length;if("override"!==a.css(b.parentNode,"unicode-bidi").slice(-8)&&(2&d?db:cb).test(b.data)){var j,l=2&d?[db,eb]:[cb,fb],m=0;for(i=-1;!j&&l[1&++m].test(b.data.slice(i+1));)h=g.max(0,i),i=b.data.indexOf(k.$1,i+1),j=Aa(Na(Ga(b,h,b,i)),function(a){return a.top<=c.top&&a.bottom>=c.top&&a.left<=c.left&&a.right>=c.left});d^=1&m?2:0,j||(i=b.length)}for(c=G(c,d);i-h>1;){var n=i+h>>1,o=f(n)<=0;h=o?n:h,i=o?i:n}return g.abs(f(h))<g.abs(f(i))?h:i}(c,n,p,F);return b.softPoint=f?G(Ya(d.left,G(n,p).centerY),-p):null,ca(b,c,H,F)}return!1}var fa="h1,h2,h3,h4,h5,h6,p,q,blockquote,pre,code,li,caption,figcaption,summary,dt,th",ga="​",ha="&#8203;",ia="__root__",ja="__unknown__",ka=1,la=2,ma=32,na=4,oa=16,pa=64,qa=128,ra=8192,sa=la|ma,ta=ka|na|sa,ua=oa|pa|qa,va=na|ma|oa|qa,wa=o.WeakMap,xa=o.Set,ya=f.helper,za=f.dom,Aa=ya.any,Ba=ya.comparePosition,Ca=ya.containsOrEquals,Da=ya.createDocumentFragment,Ea=ya.createElement,Fa=ya.createNodeIterator,Ga=ya.createRange,Ha=ya.createTextNode,Ia=ya.defineHiddenProperty,Ja=ya.definePrototype,Ka=ya.each,La=ya.extend,Ma=ya.getRect,Na=ya.getRects,Oa=ya.is,Pa=ya.isFunction,Qa=ya.iterate,Ra=ya.iterateToArray,Sa=ya.rangeCovers,Ta=ya.rangeIntersects,Ua=ya.rectEquals,Va=ya.removeNode,Wa=ya.sameElementSpec,Xa=ya.tagName,Ya=ya.toPlainRect,Za=ya.trim,$a={top:"bottom",left:"right",right:"left",bottom:"top"},_a={"horizontal-tb":0,"vertical-rl":5,"vertical-lr":1,"sideways-rl":5,"sideways-lr":11,lr:0,rl:0,tb:5,"lr-tb":0,"lr-bt":4,"rl-tb":0,"rl-bt":4,"tb-rl":5,"bt-rl":5,"tb-lr":1,"bt-lr":1},ab=[240,3276,1450,3840],bb="block-start block-end inline-start inline-end over under line-left line-right".split(" "),cb=new k("([֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),db=new k("([^\\s֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),eb=new k("(\\s|[֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),fb=new k("(\\s|[^֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),gb=/[\u200b\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f\udc00-\udcff\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u08d4-\u08e1\u08e3-\u08ff\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u3099\u309a]/,hb=b.getSelection(),ib=b.getComputedStyle,jb={},kb=null,lb=new wa,mb=new wa,nb=new xa;if(La(O,{NODE_WIDGET:ka,NODE_PARAGRAPH:na,NODE_EDITABLE:la,NODE_EDITABLE_PARAGRAPH:ma,NODE_INLINE:oa,NODE_INLINE_WIDGET:pa,NODE_INLINE_EDITABLE:qa,NODE_ANY_ALLOWTEXT:va,NODE_ANY_BLOCK_EDITABLE:sa,NODE_ANY_INLINE:ua,ZWSP:ga,ZWSP_ENTITIY:ha,defaultOptions:{},widgets:{}}),f.Editor=O,Ja(O,{historyLevel:100,closest:D,getAbstractSide:H,createCaret:function(a,b){var c=new t(this);return a&&c.moveTo(a,b),c},createSelection:function(a,b,c,d){return new i(this,Ga(a,b,c,d))},createTreeWalker:function(a,b,c){return new r(a||this.rootNode,b,c)},nodeFromPoint:function(a,b,c){var d=ya.elementFromPoint(a,b,this.element);if(d){var e=this.getNode(d);if(Oa(e,la)){var f=C(d),g=G(Ya(a,b),f);e=Aa(e.childNodes,function(a){var b=G(Ma(a.element,!0),f);return b.top<=g.top&&b.bottom>=g.top})||e}return D(e,c||-1)}},hasContent:function(){return this===kb||(!!Za(this.element.textContent).length||!!new r(this.rootNode,~na).nextNode())},setValue:function(a){this.selectAll(),this.invoke(function(b){b.insertHtml(a)})},validate:function(){return!0},select:function(a,b,c,d){return this.getSelection().select(a,b,c,d)},selectAll:function(){return this.getSelection().selectAll()},focus:function(){this.getSelection().focus()},focused:function(a){return za.focused(this.element,a)},retainFocus:function(a){za.retainFocus(this.element,a)},releaseFocus:function(a){za.releaseFocus(this.element,a)},support:function(a){return this.hasCommand(a)&&this.invoke.bind(this,a)}}),Ja(p,{get parent(){var a=this.element&&this.typer.getNode(this.element.parentNode);return a&&a.widget}}),Ja(q,{get firstChild(){return this.childNodes[0]||null},get lastChild(){var a=this.childNodes;return a[a.length-1]||null}}),Ja(r,{previousSibling:function(){return T(this,"lastChild","previousSibling")},nextSibling:function(){return T(this,"firstChild","nextSibling")},firstChild:function(){return S(this,"firstChild","nextSibling")},lastChild:function(){return S(this,"lastChild","previousSibling")},parentNode:function(){for(var a=this.currentNode;a&&a!==this.root;a=a.parentNode)if(R(this,a.parentNode,!0))return a.parentNode},previousNode:function(){for(var a=this,b=a.currentNode;b&&b!==a.root;){for(var c=b.previousSibling;c;c=b.previousSibling){b=c;for(var d=Q(a,c);2!==d&&P(a,b.firstChild);)b=b.lastChild,d=Q(a,b,!0);if(1===d)return a.currentNode=b,b}if(!(b=P(a,b.parentNode))||b===a.root)return null;if(R(a,b,!0))return b}},nextNode:function(){
for(var a=this,b=1,c=a.currentNode;c;){for(;2!==b&&c.firstChild;){if(c=c.firstChild,R(a,c,!0))return c;b=Q.returnValue}for(;c&&c!==a.root&&!c.nextSibling;)c=P(a,c.parentNode);if(!c||c===a.root)return null;if(c=c.nextSibling,R(a,c,!0))return c;b=Q.returnValue}}}),Ja(s,{get currentNode(){return this.iterator.currentNode},set currentNode(a){this.iterator.currentNode=a},previousNode:function(){return this.iterator.previousNode()},nextNode:function(){return this.iterator.nextNode()}}),Y.run=function(a){var b=0;return function(c,d,e){try{return b++,c.apply(e||this,d)}finally{0==--b&&a()}}}(function(){Y.executing=!1,nb.forEach(Z),nb.clear()}),Z.NAMES="node element textNode offset startNode startElement startTextNode startOffset endNode endElement endTextNode endOffset".split(" "),Ja(i,{get isSingleEditable(){return this.isCaret||!V(this,sa).nextNode()},getCaret:function(a){var b=this.baseCaret,c=this.extendCaret;switch(a){case"extend":return c;case"start":return this.direction<0?c:b;case"end":return this.direction<0?b:c;default:return b}},getRange:function(a){var b=this.baseCaret,c=this.extendCaret;return void 0!==a||this.isCaret?(!1!==a?b:c).getRange():Ga(b.getRange(),c.getRange())},getWidget:function(a){return Aa(this.getWidgets(),function(b){return b.id===a})},getWidgets:function(){for(var a=[],b=this.focusNode;b.widget.id!==ia;b=b.parentNode)a.unshift(b.widget),b=this.typer.getNode(b.widget.element);return a},getParagraphElements:function(){var a=this;return a.startNode===a.endNode?Oa(a.startNode,na)?[a.startNode.element]:[]:Ra(V(a,na),function(a){return a.element})},getSelectedElements:function(){var b=this;return b.isCaret?[b.startElement]:a(W(b)).parent().get()},getSelectedText:function(){return this.typer.extractText(this)},getSelectedTextNodes:function(){var a=this;return a.isCaret?[]:(X(a),W(a))},createTreeWalker:function(a,b){return V(this,a,b)},collapse:function(a){return a=this.getCaret(a),(a===this.baseCaret?this.extendCaret:this.baseCaret).moveTo(a)},select:function(a,b,c,d){var e,f=this;return Y(function(){if("word"===a)e=f.getCaret("start").moveByWord(-1)+f.getCaret("end").moveByWord(1)>0;else{var g=Ga(a,b,c,d);e=f.baseCaret.moveTo(g,!0)+f.extendCaret.moveTo(g,!1)>0}}),a.acceptNode&&(lb.get(f).d=a),e},selectAll:function(){return this.select(this.typer.element,"contents")},focus:function(){var a=this,b=a.typer.element;Ca(c,b)&&a.typer.enabled()&&kb!==a.typer&&(ya.makeSelection(a.baseCaret.getRange(),a.extendCaret.getRange()),c.activeElement!==b&&b.focus(),za.scrollIntoView(b,a.extendCaret.getRect()))},clone:function(){var a=this,b=new i(a.typer);return Y(function(){b.baseCaret.moveTo(a.baseCaret),b.extendCaret.moveTo(a.extendCaret)}),lb.get(b).d=lb.get(a).d,b},widgetAllowed:function(a){return this.typer.widgetAllowed(a,this.focusNode)}}),Ka("moveTo moveToPoint moveToText moveByLine moveToLineEnd moveByWord moveByCharacter",function(a,b){i.prototype[b]=function(){var a=this;return Y(function(){return t.prototype[b].apply(a.baseCaret,arguments)+a.collapse("base")>0},arguments)}}),Ka("getWidgets getParagraphElements getSelectedElements getSelectedText getSelectedTextNodes",function(a,b){var c=i.prototype[b];i.prototype[b]=function(){var d=lb.get(this);return d.m&1<<a||(d[b]=d.d&&d.d[b]?d.d[b](this):c.apply(this),d.m|=1<<a),d[b]}}),Ja(t,{getRect:function(){var a=aa(this);if(!a.textNode){return Ma(a.element).collapse(H(2|!a.offset,C(a.element)))}return da(a.textNode,a.offset,a.beforeSoftBreak,!0)},getRange:function(){var a=aa(this),b=a.textNode||a.element,c=a.offset;return b===a.typer.element?Ga(b,c?0:-0):c%b.length==0?Ga(b,!c):Ga(b,c)},clone:function(){var a=aa(this);return La(new t(a.typer),a)},moveTo:function(a,b){if(Oa(a,t))return ba(this,a.node,a.element,a.textNode,a.offset,a.beforeSoftBreak);var c=Ga(a,b);return!(!c||!Ca(this.typer.element,c.startContainer))&&ca(this,c.startContainer,c.startOffset)},moveToPoint:function(a,b){var c=this;return ea(c,(c.typer.nodeFromPoint(a,b)||c.typer.rootNode).element,Ya(a,b))},moveToText:function(a,b){if(3!==a.nodeType){var c=new s(new r(this.typer.getNode(a),va),4);if(1/b>0)for(;b>=0&&c.nextNode();b-=c.currentNode.length);else for(;c.nextNode(););a=c.currentNode,b=a&&g.min(b+a.length,a.length)}return!!a&&ca(this,a,E(a,b))},moveToLineEnd:function(a){var b=aa(this);return ea(b,b.textNode||b.element,b.getRect(),a,0)},moveByLine:function(a){var b=this;return ea(b,b.textNode||b.element,b.getRect(),0,a)||b.moveToLineEnd(a)},moveByWord:function(a){var b,c=this,d=c.textNode,e=a<0?/\b(\S*\s+|\S+)$/:/^(\s+\S*|\S+)\b/,f="";if(d&&(f=a<0?d.data.substr(0,c.offset):d.data.slice(c.offset),(b=e.test(f))&&k.$1.length!==f.length))return c.moveToText(d,c.offset+a*k.$1.length);for(var g=$(c,c.node),h=g.currentNode,i=b&&k.$1.length;d=v(g,a);){if(f=a<0?d.data+f:f+d.data,(b=e.test(f))&&k.$1.length!==f.length)return k.$1.length===i?c.moveToText(h,0*-a):c.moveToText(d,a*(k.$1.length-(f.length-d.length)));h=d,i=k.$1.length}return!(!b||!d&&!i)&&c.moveToText(d||h,0*-a)},moveByCharacter:function(a){for(var b=this,c=C(b.element),d=G(Ma(b),c),e=$(b,null,5),f=y(e.currentNode),g=b.offset,h=!1;;){if(!f||g===E(f,0*-a)){for(;!(f=v(e,a))||!f.length;){if(!f)return!1;if(Oa(b.typer.getNode(f),ka|pa)&&!Ca(f,b.element))return b.moveToText(f,0*a)||b.moveTo(f,a<0);h|=!!z(f)}g=(a<0?f.length:0)+((h||!Ca(b.node.element,f))&&-a)}if(g+=a,!gb.test(f.data.charAt(g))){var i=G(da(f,g),c);if(!Ua(d,i))return ca(b,f,g,a>0&&d.centerY!==i.centerY)}}}}),Ka("moveByLine moveByWord moveByCharacter",function(a,b){var c=t.prototype[b];t.prototype[b]=function(a){var b=aa(this);return _(b,function(){for(var d=a;d&&c.call(b,a/g.abs(a));d+=d>0?-1:1);return!a||d!==a})}}),!f.IS_IE){try{c.designMode="on",c.execCommand("enableObjectResizing",!1,!1),c.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}c.designMode="off"}setInterval(function(){var a=Oa(za.getContext(),O);if(a&&!kb&&za.focused(b)){var c=a.getSelection(),d=I(a.element);d&&!ya.rangeEquals(d,Ga(c))&&(c.select(d),c.focus())}},100)}(a,zeta),function(a,g){function i(a,b){return Va(b,function(b,c){a[b]=c}),a}function j(a){return Ka.eval('"'+a+'"')}function l(a,b){Va(a.attributes,function(a,c){b(c.nodeName,c.value,c)})}function n(a,b,c){return a[b]||(a[b]=new c)}function p(a,b,c,e){if($a(c))return Va(c,p.bind(null,a,b));n(a,c,d)[b||"default"]=e}function q(a,b){return a=a.templates||sb,b=b.templates,b&&b!==sb?Xa(a,b):a}function r(a,b,c,d){var e=_a("globals",c);return d?Ka.eval(a.slice(2,-2),b,e):Ka(a,b,e)}function s(a,b){for(;a;a=a.parent){var c=ub(a).values;if(b in c)return c[b]}return tb[b]}function t(a,b,c){c&&!L(a)||(b(a),Va(a.controls,function(a,d){t(d,b,c)}))}function u(a,b,c,d){return ub(a).container.emit(b,a.element||a,c,d)}function v(a,b,c,d,e){return ub(a).container.emitAsync(b,a.element||a,c,d,e)}function w(a,b){if(v(a,"stateChange"),b)for(var c=a.parent;c&&c.requireChildControls;c=c.parent)I(c),v(c,"stateChange")}function x(a,b,c,d){v(a,"propertyChange",{oldValues:_a(b,c),newValues:_a(b,d)},!1,function(a,b){return b.oldValues=i(b.oldValues,a.oldValues),b.newValues=i(a.newValues,b.newValues),b}),Va(ub(a).values,function(c,d){c!==b&&Ya(d,z)&&d.needEvaluate&&d.getValue(a,c,!0)}),I(a),w(a,!0)}function y(a,b){var c=Ia(a),d={};if(b){var e=ub(a);Ja(a).forEach(function(b){d[b]=a[b]}),Wa(d,e.values),d.value=e.value}else Wa(d,a);return Va(d,function(b,e){b in c||cb(b,Ba)||Sa(d,b,function(){return C(c,b),a[b]})}),d}function z(a,b,c,d,e,f){var g=this;g.rawValue=c,g.displayValue=d,g.lastValue=d,g.needEvaluate=e,g.getValue(a,b,f)}function A(a,b){var c=a.toolset.labels;if(b in c)return A.value=e(c[b][vb.language]||c[b].default||""),!0}function B(a,b,c,d){if("string"==typeof c){var e=ub(a),f="icon"!==b&&(A(e.container,c)||A(e,c))?A.value:c,g=Da.test(f);if(f!==c||g)return new z(a,b,c,f,g,d)}return c}function C(a,b){b in a||cb(b,Ba)||(Sa(a,b,function(){var a=this,c=Ha.call(tb,b)?s(a,b):ub(a).values[b];return Ya(c,z)?c.lastValue:c},function(a){var c=this,d=ub(c).values,e=Ya(d[b],z);if(a!==d[b]&&(!e||a!==e.rawValue)){var f=Ha.call(tb,b),g=e?e.lastValue:d[b];!f||null!==a&&void 0!==a?d[b]=B(c,b,a):delete d[b];var h=c[b];if(ub(c).inited&&(x(c,b,g,h),f)){var i=function(a){Va(a.controls,function(a,c){b in ub(c).values||(x(c,b,g,h),i(c))})};i(c)}}}),Va(bb(mb,a),function(a,c){ub(c).values[b]=B(c,b,c[b]),delete c[b];var d=ub(c).initialValues;d[b]=b in d?B(c,b,d[b],!1):void 0}))}function D(a,b,c){var d=ub(a);if(!d.inited)return d.value=b,!0;var e=d.value;if(e===b)return!1;var f=d.container.event;return f&&"setValue"===f.eventName&&f.context===a||!u(a,"setValue",{oldValue:e,newValue:b})?(d.value=b,c||(x(a,"value",e,b),(a.errors||a.validateOnSetValue)&&E(a)),!0):d.value!==e}function E(a){var b;if(L(a)&&(b=a.required&&!a.value?gb("required"):u(a,"validate")),b)return b.then(function(){a.errors=null},function(b){if($a(b))a.errors=b;else{var c={};Va(ab(b),function(a,b){c[b]=b}),a.errors=c}}),b;a.errors=null}function F(a){var b="script"!==Ma.getEventSource(a.element),c=[],d=[];if(ub(a).container.flushEvents(),t(a,function(a){var b=E(a);b&&(b.catch(function(){d.push(a.element)}),c.push(b))},!0),c[0]){var e=La.waitAll(c);return e.catch(function(){b&&Ma.focus(d)}),e}}function G(a){var b=ub(a),c=b.initialValues;Va(Ja(a),function(b,d){cb(d,Ba)||(c[d]=a[d])}),i(c,b.values),Ta(c,"value",b.value)}function H(a){var b=ub(a),c=b.initialValues;a.errors=null,b.flag=1,c&&(Va(c,function(c,d){(c in b.values?b.values:a)[c]=d}),D(a,c.value,!0)),u(a,"reset"),w(a)}function I(a,b){ub(a).flag&=255,b&&[L,M,N].forEach(function(c,d){return b&1<<d&&c(a)})}function J(a,b,c){var d=ub(a),e=d.flag,f=(e&b)>0;return(d.flag|=b<<8)!==e&&f^!!c(d)?(d.flag^=b,w(a,!0),!f):f}function K(a,b,c){ub(a)[Ca[b>>1]]=c,I(a,b)}function L(a){return J(a,1,function(b){return!(O(a)||b.position&&!b.position.enabled)&&(!(a.requireChildControls&&(!a.controls.some(L)||a.controls.every(N)))&&(!1!==b.enabled&&!1!==(b.options.enabled||db).call(a,a)))})}function M(a){return J(a,2,function(b){return b.active||(b.options.active||db).call(a,a)})}function N(a){return J(a,4,function(b){var c=a.hiddenWhenDisabled;return O(a)||!L(a)&&(c||!1!==c&&a.parent&&a.parent.hideDisabledChild)||!1===b.visible||!1===(b.options.visible||db).call(a,a)})}function O(a){return J(a,8,function(b){return b.toolsetState&&(!1===L(b.toolsetState)||a.realm&&!b.toolsetState[a.realm])})}function P(b,e,g,h){function i(a,b,c,d){n(s,a,f).push({type:d||"text",name:c||"",expression:b})}function m(a){var b;return a.value=a.value.replace(/([\w-]+)\:(\{\{(?:[^\}]|\}(?!\}))+\}\})/g,function(c,d,e){return b=!0,i(r,e,d,a.nodeName),""}),b}function o(a,b){return La.single(b,function(b,c){return Ha.call(a,c)&&c})}function p(b,c){var f=h===b?Ia(e):e,g=f[b]||"<div><children controls/></div>",i=a.parseHTML(g)[0];a("children",i).each(function(b,d){var e=Ra(d.attributes.controls&&!c.childNodes[0]?[La.createElement("controls")]:c.cloneNode(!0).childNodes),f=a("controls",e);l(d,function(a,b){f.attr(a,b)}),a(d).replaceWith(e)}),g=i.outerHTML;for(var n=e,p=e;p;p=Ia(p)){var q=bb(nb,p,d)[g];if(q){n=o(e,q.roles)?e:p;break}}var u=P(g,e,n,V.prototype[b]?b:h),v=u.dom.cloneNode(!0),w=a("controls",v),x={};return l(c,function(b,c,d){if("class"===b)m(d),a(v).addClass(d.value);else{var e=Da.test(c)&&k.$1;x[Pa(b)]=e?{expression:c,evalAsObject:e.length===c.length-4}:j(c),e||w.attr(b,c)}}),Va(u.binds,function(a,b){var c=+a+r;s[c]=b.concat(s[c]||[]),s[c].context=Wa({},b.context,x)}),Va(u.roles,function(a,b){t[a]=+b+r}),t[b]=r,r+=u.nodeCount,v}var q=bb(nb,g||e,d)[b];if(q)return q;var r=0,s={},t={};s[0]=[];var u={dom:function(b){var d=new Fa,e=c.createTreeWalker(b,5,function(a){return/z\:([\w-]+)/.test(kb(a))?(d.set(a,p(Pa(k.$1),a)),2):1},!1);return La.iterate(e,function(b){1===b.nodeType?("controls"!==kb(b)||a(b).attr("layout")||b.setAttribute("layout",h),l(b,function(a,c,d){!Da.test(c)||cb(a,"class style")&&m(d)||(i(r,c,a,cb(a,Aa)&&a in b?"prop":"attr"),d.value="")}),r++):Da.test(b.data)&&(b.previousSibling||b.nextSibling?(i(r,b.data),d.set(b,c.createElement("span")),r++):i(r-1,b.data),b.data="")}),d.forEach(function(b,c){a(c).replaceWith(b)}),b.childNodes[0]}(Ra(a.parseHTML(b)[0])),roles:Ka.eval("sortby [ . ]",t),binds:s,nodeCount:r};g=g||e;do{bb(nb,g,d)[b]=u}while(g!==sb&&!o(g,t)&&(g=Ia(g)));return u}function Q(b){var c=b.element,d=ub(b).position;1===d.count?d.start=d.end=a(d.placeholder).insertBefore(c)[0]:d.start===c?d.start=c.nextSibling:d.end===c&&(d.end=c.previousSibling),d.count--,hb(c)}function R(b,c,d){var e,f=ub(b),g=ub(c).dom.positions,h=f.position,i=f.dom;if(g[0]){var j=y(b);e=Na(g,function(a){return!a.condition||Ka.eval(a.condition,j)}),I(b)}else e=new aa(c),e.layoutType=c.type,a(e.placeholder).appendTo(c.element),g[0]=e;if(h!==e){var k=i;if(i&&Q(b),!i||e&&(i||"").layoutType!==e.layoutType){var l=e.layoutType,m=f.allDOM||(f.allDOM={});k=m[l]||(m[l]=new ba(b,l)),b.element=k.element}var n=b.element;e.count?(a(n).insertAfter(e.end),e.end=n):(a(e.start).replaceWith(n),e.start=e.end=n),e.count++,f.position=e,f.dom=k,c&&!d&&k!==i&&k.update()}}function S(a,b,c,d,e){if(Va(c,function(c,f){var g=ub(f);if("import"===g.type)S(a,b,rb[g.name]||[],!0,g.options);else{var h=new g.ctor(a,f,b,d,e);R(h,b||a,!0),S(a,h,ab(g.options.controls)),u(h,"init"),G(h),w(h),b||(a.control=h)}}),b&&c[0]){if(b.controls[1]){var f=new Fa;Va(b.controls,function(a,b){f.set(b,a)}),b.controls.sort(function(a,b){function c(a,b,c,d){return a[c]?"*"===a[c]||cb(b.name,a[c])?d:-d:0}var d=c(a,b,"after",1),e=c(a,b,"before",-1),g=c(b,a,"after",-1),h=c(b,a,"before",1);return(!d&&!e)^(!g&&!h)?d||e||g||h:d+e+g+h||f.get(a)-f.get(b)})}w(b)}}function T(a,b,c){var d=Ma.getContext(),e=null,f=Na(ob,function(a){return Ma.focused(a.element)});if(f)d=f.context,e=f.element;else if(Ya(d,U)){var h=ub(d).container;e=h.event&&h.event.context.element}var i=new g.Container(a);return i.context=new U(i,c),i.toolset=ub(b).toolset,i.parentContext=d,i.parentElement=e,ub(i,{dom:{positions:[]}}),i.tap(function(b){var c=i.getContext(b.target)||i.control;L(c)&&(i.emit(b,b.target===a?c.element:b.target),cb(b.eventName,"focusin focusout")?(c.focusBy=b.source,w(c)):cb(b.eventName,"asyncStart asyncEnd")&&t(c,function(a){w(a)}))}),S(i,null,[b],!0),i.flushEvents(),i}function U(a,b){var c=Wa(this,b);ub(c,{container:a,toolsets:new Fa})}function V(a,b){var c=this;c.name=a||"",c.labels=a?n(qb,a,d):{},c.options=b||{}}function W(a,b,c){var d=this;d.name=b.name,d.context=c,d.all={},ub(d,{container:a,options:b.options,control:d,flag:1}),a.add(d,b.options),a.emit("contextChange",d)}function X(a,b){for(var c=0;a[b+(c||"")];c++);return b+(c||"")}function Y(a){var b=ub(a);if(!Ya(b.childContext,U)){var c=new U(b.container);"value"in b.options||(b.value=c,Sa(a.context,a.name,function(){return c},function(b){var d=Wa({},c);x(a,"value",d,Wa(c,b))})),b.childContext=c}return b.childContext}function Z(a,b,c,d){var e=a.name+(d?"":La.ucfirst(c));Za(a[c])?Ta(b,e,a[c].bind(a)):(Ha.call(b,e)&&(a[c]=b[e]),Sa(b,e,function(){return a[c]},function(b){a[c]=b})),ub(a).exports.push(e)}function $(a,b,c,d,e){var f=this,g=ub(b),h=!d&&c&&ub(c).toolset!==g.toolset,i=h?Y(c):c&&ub(c).childContext||(c||a).context,j=bb(ub(i).toolsets,g.toolset,function(){return new W(a,g.toolset,i)}),k=fb(),l=X(j.all,g.name),m={control:f,species:b,container:a,toolset:g.toolset,options:g.options,templates:q(ub(c)||{},g),flag:1,values:{},initialValues:{},exports:[],toolsetState:j,toolsetEventHandle:k};ub(f,m),bb(mb,Ia(f),Ga).add(f),a.add(j,k,{stateChange:function(){I(f,5)}}),f.name=l,f.type=g.type,f.required=!1,Va(g.options,function(a,b){Za(b)||Za(f[a])||(f[a]=b)}),Va(e,function(a,b){Za(b)||Za(f[a])||(f[a]=b)}),void 0===f.label&&(f.label=g.name),"string"==typeof g.options.execute&&(f.shortcut=Ma.getShortcut(g.options.execute)[0]),f.icon=f.icon||"",f.parent=c||null,f.state=j,f.context=i,f.parentContext=a.parentContext||null,f.parentElement=a.parentElement||null,f.controls=[],f.errors=null,f.id=fb(),f.all=j.all,f.all[l]=f,c&&(c.controls.push(f),d&&c.all!==f.all&&(c.all[l]=f)),g.defaultExport&&Z(f,i,g.defaultExport,!0),Va(g.options.exports,function(a,b){Z(f,i,b)}),m.inited=!0}function _(a,b,c,d){function e(){$.apply(this,arguments)}e.prototype=Xa($);var f=this;f.name=c,f.type=b,ub(f,{toolset:a,type:b,name:c||d.name||b,options:d,defaultExport:d.defaultExport||"value"in d&&"value",templates:q(pb[b]||{},d),ctor:e})}function aa(a,b){b=b||c.createElement("controls"),b.style.display="none!important";var d={};l(b,function(a,b){d[Pa(a)]=j(b)});var e=this;e.control=a,e.context=d,e.placeholder=b,e.condition=d.of||"",e.layoutType=d.layout||a.type||"default",e.start=b,e.end=b,e.count=0}function ba(b,c){var d=this,e=ub(b),f=e.container,g=P(e.options.template||"<z:"+La.hyphenate(b.type)+"/>",(pb[c]||"").templates||sb),h=g.dom.cloneNode(!0),i=La.iterateToArray(La.createNodeIterator(h,1)),j=i.filter(function(a,b){return g.binds[b]}),k=Ka.eval("sortby [ ! condition ]",a("controls",h).map(function(a,c){return new aa(b,c)}).get());f.setContext(h,b),Va(pb[b.type].handlers,function(a,b){f.add(h,b)}),f.add(h,e.options),Va(g.roles,function(a,c){pb[a]&&a!==b.type&&f.add(i[c],a,pb[a])}),f.add(h,{stateChange:function(){d.update()}}),Wa(d,{control:b,element:h,roles:g.roles,binds:g.binds,bindedNode:j,positions:k,layoutType:c}),b.cssClass&&a(h).addClass(b.cssClass)}function ca(a){this.args=a,this.done=!1}function da(a,b,c){b=Wa({},b),b.templates=q({},b),b.handlers=[b],sb[a]=b.template||"",pb[a]=b;var d={};Va(b,function(a,c){Za(c)||cb(a,"templates template handlers")||(d[a]=c,delete b[a])}),b.defaultOptions=d,c||Ua(V,_a(a,function(){for(var c=0,e=arguments.length,g=new f(e);c<e;c++)g[c]=arguments[c];var h=new ca(g),i=h.string(),j={};return b.parseOptions&&b.parseOptions(j,h),Wa(j,h.next("object")&&h.value),new _(this,a,i,Wa({},d,j))}))}function ea(a,b){a.execute=b.fn()}function fa(a,b){a.controls=b.nextAll(_),ea(a,b)}function ga(a,b){a.icon=b.string(),ea(a,b)}function ha(a,b){if("button"===b.type||"submit"===b.type)return b.execute()}function ia(a,b){return b.value=!b.value,"checkbox"===b.type?b.execute():void 0}function ja(a,b,c){var d,e=ub(a).ddToolset.all(a),f=Na(e,function(a){return d=d||a,a.value===b});f||a.allowEmpty||(f=d),(a.setValue(f?f.value:"")||c)&&(a.hintValue=b,a.selectedText=(f&&a.valueAsLabel?f:a).label,Va(a.controls,function(a,b){b.selected=b===f}))}function ka(a){var b=La.isArray(a.choices),c=[];Va(a.choices,function(a,d){c[c.length]=b&&$a(d)?d:{value:b?d:j(a),label:d}});for(var e=ub(a).ddToolset,f=[],g=0,h=c.length-d.keys(e.all(a)).length;g<h;g++)f[g]=e.choiceButton;a.append(f),Va(e.all(a),function(a,b){b.enabled=b.visible=!!c[0],Wa(b,c.shift())}),ja(a,a.hintValue,!0)}function la(b){var d=a(":file",b.target)[0],e=d.parentNode,f=c.createElement("form");f.appendChild(d),f.reset(),a(d).prependTo(e)}function ma(a,b){var c={},d=(b||"").init;return b=Wa({inline:!0,defaultOptions:!1,disallowedElement:"*"},_a(zb,Wa({},b))),Va(a,function(a,d){(Za(d)||"options"===a||"commands"===a?c:b)[a]=d}),Va(b[zb],function(a,d){c.options&&a in c.options||(b[a]=d,delete b[zb][a])}),b.widgets=Wa(b.widgets,_a(zb,c)),b.init=function(c){var e=c.typer.getStaticWidget(zb);Va(a.overrides,function(a,b){c.typer[a]=function(a){return b.call(this,e,a)}}),Za(d)&&d.call(b,c)},b}function na(a,b){var c=a.editor;c.focused(!0)||b===c.getValue()||c.setValue(b),a.setValue(c.getValue())}function oa(a){var b=pa(a,"deferred");Ta(a.context,a.name,b.promise()),qa(a,"guard",!0)}function pa(b,c){return b[c]||(b[c]=a.Deferred())}function qa(a,b,c,d){a[b]&&(a[b][c?"resolve":"reject"](d),delete a[b])}function ra(a){a.value=a.optional?!!a.value:void 0,a.enableChildren=!a.optional||a.value}function sa(a,b,c){var d=[];!function a(b){Va(b.controls,function(b,c){c.hasRole("buttonlist")&&!c.hasRole("menu")?a(c):c.hasRole("button")&&c.enabled&&(d[d.length]=c)})}(a);var e=d.indexOf(b);return d[e<0?0:e+c]}function ta(a,b,c,d){var e=a.callout;a.parent&&Qa(a.element,e)?(jb(e,"hidden",!1),eb(e,a.element,"right top inset-y")):(a.calloutParent?Ma.snap(e,a.calloutParent):Ya(b,h)?Ma.snap(e,b,c):b&&eb(e,b,c,d),Ma.focus(e),jb(e,"open",!1),jb(e,"closing",!1),ib(e,"open"))}function ua(a){var b=a.callout;a.parent&&Qa(a.element,b)?jb(b,"hidden",!0):ib(b,"closing").then(function(){hb(b)}),a.activeButton=null}function va(a,b){b.destroy()}function wa(a,b,c,d,e){return a.import("dialog.prompt").render({value:c,valueEnabled:"prompt"===b,valueLabel:d,cancelVisible:"alert"!==b,action:e.string(),dialogTitle:e.string(),dialogDescription:"prompt"===b?e.string():d,callback:e.fn()}).dialog}function xa(a){return Ka.string(a).replace(/ctrl|alt|shift/gi,function(a){return La.ucfirst(a)+"+"})}function ya(a){var b={},c=Ka.string(a).replace(/ctrl|alt|shift/gi,function(a){return a=La.lcfirst(a),b[a]=za[a],""});return(b.alt||"")+(b.shift||"")+(b.ctrl||"")+(za[La.lcfirst(c)]||c)}var za=JSON.parse('{"ctrl":"⌘","alt":"⌥","shift":"⇧","enter":"↩","tab":"ℵ","pageUp":"⇞","pageDown":"⇟","backspace":"⌫","escape":"⎋","leftArrow":"⭠","upArrow":"⭡","rightArrow":"⭢","downArrow":"⭣","home":"⭦","end":"⭨"}'),Aa="checked selected disabled readonly multiple ismap",Ba="element name type parent all controls context previousSibling nextSibling",Ca="enabled active visible".split(" "),Da=/\{\{((?:[^\}]|\}(?!\}))+)\}\}/,Ea=o.WeakMap,Fa=o.Map,Ga=o.Set,Ha=d.hasOwnProperty,Ia=d.getPrototypeOf,Ja=d.getOwnPropertyNames,Ka=b.waterpipe,La=g.helper,Ma=g.dom,Na=La.any,Oa=La.bind,Pa=La.camel,Qa=La.containsOrEquals,Ra=La.createDocumentFragment,Sa=La.defineGetterProperty,Ta=La.defineHiddenProperty,Ua=La.definePrototype,Va=La.each,Wa=La.extend,Xa=La.inherit,Ya=La.is,Za=La.isFunction,$a=La.isPlainObject,_a=La.kv,ab=La.makeArray,bb=La.mapGet,cb=La.matchWord,db=La.noop,eb=La.position,fb=La.randomId,gb=La.reject,hb=La.removeNode,ib=La.runCSSTransition,jb=La.setState,kb=La.tagName,lb=La.when,mb=new Ea,nb=new Ea,ob=new Ga,pb={},qb={},rb={},sb={},tb={},ub=La.createPrivateStore(),vb={language:"en"};Ua(z,{getValue:function(a,b,c){var d=this;if(d.needEvaluate){var e=Ka(d.displayValue,y(a,!0));return!1!==c&&e!==d.lastValue&&x(a,b,d.lastValue,e),d.lastValue=e,e}return d.displayValue}}),Ua(U,{toJSON:function(){return Wa({},this)},update:function(a){var b=ub(this),c=b.container;Wa(this,a),Va(c.components,function(a,b){Ya(b.context,W)&&u(b.context,"contextChange"),I(b.context,1)}),Va(c.components,function(a,b){var c=Ya(b.context,$);c&&(I(c,7),O(c)||u(c,"contextChange"))}),c.flushEvents()},validate:function(){return ub(this).container.control.validate()},reset:function(){Va(ub(this).container.components,function(a,b){H(b.context)})}}),Ua(V,{i18n:function(a,b,c){p(this.labels,a,b,c)},alert:function(a,b,c,d){return wa(this,"alert",!0,a,new ca([b,c,d]))},confirm:function(a,b,c,d){return wa(this,"confirm",!0,a,new ca([b,c,d]))},prompt:function(a,b,c,d,e,f){return wa(this,"prompt",b,a,new ca([c,d,e,f]))},notify:function(a,b,c,d){var e=new ca([b,c,d]);return this.import("dialog.notify").render({label:a,kind:e.string()||!0,timeout:e.next("number")&&e.value,within:e.next(h)&&e.value}).dialog},import:function(a,b){return new _(this,"import",a,b||{})},export:function(a){for(var b=n(rb,a,f),c=1,d=arguments.length;c<d;c++)b[b.length]=arguments[c]},all:function(a){if(Ya(a,h))a=Ya(Ma.getContext(a),U);else if(Ya(a,$)){if(ub(a).toolset===this)return a.all;a=ub(a).childContext}var b=a&&ub(a).toolsets.get(this);return b?b.all:{}}}),Ua(W,{get enabled(){return L(this)},set enabled(a){K(this,1,a)}}),Ua($,{get previousSibling(){var a=Ya(ub(this).position,aa);return a&&a.start!==this?ub(this).container.getContext(this.element.previousSibling):null},get nextSibling(){var a=Ya(ub(this).position,aa);return a&&a.end!==this?ub(this).container.getContext(this.element.nextSibling):null},get focused(){return Ma.focused(this.element)},get pending(){return Ma.locked(this.element)},get enabled(){return L(this)},set enabled(a){K(this,1,a)},get active(){return M(this)},set active(a){K(this,2,a)},get visible(){return!N(this)},set visible(a){K(this,4,a)},get value(){return ub(this).value},set value(a){D(this,a)},setValue:function(a){return D(this,a)},contains:function(a){for(var b=a;b&&b!==this;b=b.parent);return!!b},hasRole:function(a){var b=ub(this).dom.roles;return Na(a,function(a){return a in b})},getRoleContext:function(a){var b=ub(this).dom;return b.binds[b.roles[a]].context},on:function(a,b){ub(this).container.add(this.element,$a(a)||_a(a,b))},watch:function(a,b){C(Ia(this),a),Za(b)&&this.on("propertyChange",function(c,d){a in c.oldValues&&b.call(d,d,a,c.oldValues[a],d[a])})},focus:function(){L(this)&&Ma.focus(this.element)},validate:function(){return lb(F(this))},execute:function(a){var b=this;if(!L(b)||N(b)||ob.has(b))return gb();void 0!==a&&(b.value=a);var c=function(a,c){ob.delete(b),a&&(u(b,"executed",{data:c}),b.parent&&u(b.parent,"childExecuted",{control:b},!0)),u(b,"afterExecute",a)},d=function(){var a;u(b,"beforeExecute"),ob.add(b);try{var d=ub(b).options.execute;"string"==typeof d?a=(Ma.support(d,b.focused)||db)(b.value):Za(d)&&(a=d.call(b,b))}catch(b){console.error(b),a=gb(b)}return b.waitForExecution&&a&&Za(a.then)?(a=Ma.lock(b.element,a,function(){return u(b,"cancel")||gb()}),La.always(Ma.prepEventSource(a),c),a):(c(!0),lb())},e=F(b);return e?Ma.prepEventSource(e).then(d):d()},reset:function(){t(this,H)},append:function(a,b){var c=this;b&&Va(c.controls.slice(0),function(a,b){b.destroy()}),S(ub(c).container,c,ab(a))},destroy:function(){var a=this;a.pending&&Ma.cancel(a.element,!0),lb(u(a,"beforeDestroy")).then(function(){var b=ub(a).container;if(t(a,function(a){var c=ub(a);Va(c.allDOM,function(a,c){b.delete(c.element)}),b.delete(a.state,c.toolsetEventHandle),bb(mb,Ia(a)).delete(a),delete a.all[a.name],a.parent&&a.parent.all[a.name]===a&&delete a.parent.all[a.name],Va(c.exports,function(b,c){delete a.context[c]})}),a.parent){var c=a.parent.controls;c.splice(c.indexOf(a),1),Q(a),I(a.parent),w(a.parent)}else m(function(){b.destroy()}),La.removeNode(b.autoDestroy?b.element:a.element)})}}),Va("icon label errors placeholder description",function(a,b){C($.prototype,b)}),function(a,b){Va($a(a)||_a(a,b),function(a,b){tb[a]=b,C($.prototype,a)})}({showIcon:"auto",showText:!0,hideDisabledChild:!1,hideCalloutOnBlur:!0,hideCalloutOnExecute:!0,waitForExecution:!0,enableChildren:!0}),Ua(_,{clone:function(a){var b=Xa(_,this),c=Wa({},ub(this));return c.options=Wa({},c.options,a),ub(b,c),b},render:function(b,d){Ya(b,h)||(d=b,b=c.createElement("div"));var e=T(b,this,d);return a(b).addClass("zeta-ui"),e.context}}),Ua(aa,{get enabled(){return!1!==this.control.enableChildren}}),Ua(ba,{update:function(){var b=this,c=b.control,d=c.element;c.parent&&R(c,c.parent);var e=ub(c).position;if(e){var f=/\*\*(([^*]|\*(?!\*))+)\*\*/g,g=/\*([^*]+)\*/g,h=y(c),i=0;if(Va(b.binds,function(c,d){var j=b.bindedNode[i++],k=Wa({},e.context);Va(d.context,function(a,b){k[a]=b.expression?r(b.expression,h,null,b.evalAsObject):b}),Va(d,function(b,c){var d=r(c.expression,h,k,"class"===c.type||"prop"===c.type);switch(c.type){case"class":return jb(j,c.name,d);case"style":return a(j).css(c.name,d);case"prop":return void(j[c.name]=!!d);case"attr":return d=d.replace(f,"$1").replace(g,"$1"),a(j).attr(c.name,d||null)}(d=d.replace(f,"<b>$1</b>").replace(g,"<i>$1</i>").replace(/\n/g,"<br>"))!==j.innerHTML&&(j.innerHTML=d)})}),jb(d,{active:h.active,loading:h.pending,error:h.errors,disabled:!h.enabled,hidden:!h.visible,focused:h.focused&&h.focusBy}),d.disabled=!h.enabled,c.controls[1]){var j=new Fa;Va(c.controls,function(a,b){j.set(b.element,a)}),Va(b.positions,function(b,c){for(var d=c.count-1;d>0;d--)for(var e=0,f=c.start;e<d;e++,f=f.nextSibling)j.get(f)>j.get(f.nextSibling)&&(a(f.nextSibling).insertBefore(f),f=f.previousSibling,0===e?c.start=f:e===c.count-1&&(c.end=f.nextSibling))})}Va(c.controls,function(a,b){R(b,c)})}}}),Ua(ca,{next:function(a){var b=this.args;if("object"===a?$a(b[0]):"string"==typeof a?typeof b[0]===a:Ya(b[0],a))return this.value=b.shift(),this.done=!b.length,!0},nextAll:function(a){for(var b=[];this.next(a)&&b.push(this.value););return b},fn:function(){return this.next("function")&&this.value},string:function(){return this.next("string")&&this.value}}),Wa(V,{define:da,on:function(a,b,c){pb[a].handlers.push($a(b)||_a(b,c))},i18n:function(a,b,c,e){p(n(qb,a,d),b,c,e)},hasRole:function(a,b){var c=Ya(Ma.getContext(a),U);return c&&ub(c).container.getContext(a).hasRole(b)}}),g.UI=V,da("button",{template:'<button class="danger:{{danger}}"><z:label/><children/></button>',danger:!1,defaultExport:"execute",parseOptions:ga,enter:ha,click:ha}),da("submit",{template:'<z:button class="zeta-submit"/>',defaultExport:"execute",parseOptions:function(a,b){a.icon=b.string(),a.execute=function(a){for(var b=a;b&&!b.hasRole("form");b=b.parent);return b&&b.execute()}},enter:ha,click:ha});var wb="[ @global.showIcon ?? showIcon ]",xb="[ @global.showText ?? showText ]",yb="[ @global.icon ?? icon ]";da("label",{template:'<span class="zeta-label hidden:{{[ ! '+wb+" || ! "+yb+" ] && ! "+xb+'}}" title="{{tooltip || label}}"><i class="material-icons hidden:{{[ ! '+yb+" && "+wb+" != true ] || ! "+wb+'}}">{{'+yb+"}}</i>{{? "+xb+' [ @global.label ?? label ] ""}}</span>',showIcon:"auto",showText:!0,defaultExport:"label"}),da("checkbox",{template:'<z:button class="zeta-checkbox checked:{{value}}" show-icon="false" show-text="true"/>',value:!1,preventLeave:!0,parseOptions:ea,click:ia,enter:ia,space:ia}),da("dropdown",{template:'<label class="zeta-dropdown"><z:button label="{{selectedText}}" show-text="true"/><z:menu/></label>',requireChildControls:!0,hideCalloutOnBlur:!0,hideCalloutOnExecute:!0,preventLeave:!0,allowEmpty:!0,valueAsLabel:!0,value:"",parseOptions:function(a,b){a.icon=b.string(),(b.next(f)||b.next(Fa))&&(a.choices=b.value,a.value=b.next("string")||b.next("number")?b.value:""),fa(a,b)},init:function(a,b){var c=new V(ub(b).toolset.name);c.choiceButton=c.button({template:'<z:button class="selected:{{selected}}" show-icon="true" show-text="true"/>',execute:function(a){ja(b,a.value),b.execute()}}),ub(b).ddToolset=c,b.hintValue=b.value,b.selectedText=b.label,b.watch("choices",ka),ka(b)},setValue:function(a,b){ka(b),ja(b,a.newValue),a.handled()}}),da("callout",{template:'<label class="zeta-callout"><controls of="not parent.alwaysShowCallout && parent.controls where enabled as _enabled && _enabled.length == 1 && _enabled.0.id == id"/><z:button class="hidden:{{[ not alwaysShowCallout ] && controls where enabled length == 1}}"/><z:menu/></button>',requireChildControls:!0,hideCalloutOnExecute:!0,hideCalloutOnBlur:!0,alwaysShowCallout:!0,parseOptions:function(a,b){a.icon=b.string(),a.controls=b.nextAll(_)}}),da("buttonlike",{template:'<label class="has-clickeffect"><children/></label>'},!0),da("link",{template:'<z:buttonlike><a href="{{value}}" target="{{target}}"><z:label show-icon="auto"/></a></z:buttonlike>',parseOptions:function(a,b){a.icon=b.string(),a.value=b.string(),a.target=b.string()}}),da("file",{template:'<z:buttonlike><z:label show-icon="auto"/><input type="file" multiple="{{multiple}}"/></z:buttonlike>',autoReset:!0,multiple:!1,parseOptions:ga,init:function(b,c){a(":file",b.target).change(function(a){c.execute(ab(a.target.files))})},afterExecute:function(a,b){b.autoReset&&la(a)},reset:function(a,b){la(a)}});var zb="__preset__",Ab={overrides:{getValue:function(){return this.extractText()}}};da("textbox",{template:'<z:textboxlike><z:contenteditable spellcheck="false"/></z:textboxlike>',hideCalloutOnExecute:!1,preventLeave:!0,value:"",placeholder:"",parseOptions:ea,init:function(a,b){b.editorOptions=ma(b.preset||Ab,b.options),b.watch("editor",function(a,c,d,e){b.options=e.getStaticWidget(zb).options,b.editorOptions.options=Wa({},b.options)})},reset:function(a,b){b.options=b.editor.getStaticWidget(zb).options,Wa(b.options,b.editorOptions.options)}}),da("textboxlike",{
template:'<label class="zeta-textbox keep-placeholder:{{showPlaceholder == always && ! $placeholder}}"><z:label show-text="false" show-icon="auto"/><div class="zeta-textbox-wrapper" data-label="{{? $placeholder label}}"><div class="zeta-textbox-inner"><children/><div class="zeta-textbox-placeholder">{{placeholder || label}}</div></div><div class="zeta-textbox-error"></div><div class="zeta-textbox-clear"></div></div></label>',click:function(a,b){Ya(a.target,".zeta-textbox-clear")&&(b.execute(""),b.editor.focus())}},!0),da("richtext",{template:'<div class="zeta-richtext"><div class="zeta-richtext-toolbar"></div><label class="zeta-textbox"><z:contenteditable/><div class="zeta-textbox-placeholder"><p>{{label}}</p></div></label></div>',hideCalloutOnExecute:!1,preventLeave:!0,value:"",parseOptions:ea,init:function(b,c){c.editorOptions=c.options||{},c.editorOptions.toolbar={container:a(".zeta-richtext-toolbar",b.target)[0]}}}),da("contenteditable",{template:'<div class="zeta-editable" contenteditable spellcheck="{{spellcheck}}"></div>',init:function(a,b){b.editor=new g.Editor(a.target,b.editorOptions),b.editor.enable("stateclass",{target:b.element,focused:""}),b.editor.on("contentChange",function(){b.setValue(b.editor.getValue())&&b.execute()}),na(b,b.value)},stateChange:function(a,b){b.editor.enabled()^b.enabled&&b.editor[b.enabled?"enable":"disable"]()},focusin:function(a,b){b.editor.focused()||b.editor.focus()},setValue:function(a,b){na(b,a.newValue),a.handled()},validate:function(a,b){return b.editor.validate()}},!0),da("form",{template:'<div class="zeta-form"><children controls/></div>',templates:{buttonset:'<z:buttonset><children controls show-text="true"/></z:buttonset>',textbox:'<z:textbox show-placeholder="always"/>'},parseOptions:fa,preventLeave:!0,init:function(a,b){oa(b)},childExecuted:function(a,b){"script"!==a.source&&a.control.preventLeave&&!b.guard&&Ma.lock(b.element,pa(b,"guard"),function(){return b.preventLeave?ub(b).toolset.confirm("leaveForm"):lb()})},beforeExecute:function(a,b){qa(b,"guard",!0)},executed:function(a,b){qa(b,"deferred",!0,null!==a.data?a.data:void 0!==b.value?b.value:b.context.toJSON()),b.reset()},cancelled:function(a,b){qa(b,"deferred",!1)},destroy:function(a,b){qa(b,"deferred",!1)},reset:function(a,b){b.deferred||oa(b)}}),da("fieldset",{template:'<div class="zeta-fieldset optional:{{optional && [ ? value checked [ ! value ] ]}}"><div class="zeta-fieldset-title"><z:checkbox/><p>{{description}}</p></div><div class="zeta-form hidden:{{not enableChildren}}"><children controls/></div></div>',templates:{textbox:'<z:textbox show-placeholder="always"/>'},value:!1,optional:!1,parseOptions:fa,init:function(a,b){ra(b)},propertyChange:function(a,b){("optional"in a.newValues||"value"in a.newValues)&&ra(b)}}),da("buttonset",{template:'<div class="zeta-buttonset"><children controls/></div>',templates:{textbox:'<z:textbox show-placeholder="auto"/>'},requireChildControls:!0,hiddenWhenDisabled:!0,parseOptions:fa}),da("buttonlist",{template:'<div class="zeta-buttonlist"><children show-text="true" show-icon="true" controls/></div>',templates:{button:'<z:button><span class="zeta-label zeta-label-description">{{description ?? [ shortcut :zeta-shortcut ]}}</span></z:button>'},showIcon:!0,showText:!0,requireChildControls:!0,hiddenWhenDisabled:!0,parseOptions:fa,stateChange:function(a,b){Va(b.controls,function(a,b){if("buttonlist"===b.type){var c=function(a){for(var c=b[a];c&&!c.visible;c=c[a]);return c},d=c("previousSibling"),e=c("nextSibling");jb(b.element,"sep",{before:d,after:e&&"buttonlist"!==e.type})}})}}),da("menu",{template:'<div class="zeta-ui zeta-menu zeta-float"><z:buttonlist/></div>',waitForExecution:!1,parseOptions:fa,init:function(a,b){for(var c=a.target,d=b.parent;d&&d.hasRole("menu buttonlist");d=d.parent);b.parent&&!d?(Oa(b.element,"mouseenter",ta.bind(null,b)),Oa(b.element,"mouseleave",ua.bind(null,b))):b.parent||c!==b.element?(b.calloutParent=c.parentNode,Ma.retainFocus(b.element,c),hb(c)):(Ta(b.context,"showMenu",ta.bind(null,b)),Ta(b.context,"hideMenu",ua.bind(null,b)),Ta(b.context,"element",c)),Oa(b.element,"mousemove",function(){b.activeButton=null}),jb(a.target,"is-"+b.type,!0),b.callout=c,b.activeButton=null,b.watch("activeButton",function(a,c,d,e){(d||{}).active=!1,(e||{}).active=!0,(e||b).focus()}),ua(b)},focusin:function(a,b){"keyboard"!==a.source||b.parent||(ta(b),b.activeButton=sa(b,b,1))},focusout:function(a,b){b.activeButton=null,b.hideCalloutOnBlur&&ua(b)},keystroke:function(a,b){var c=b.activeButton,d=/^(up|down|left|right)Arrow$/.test(a.data)&&k.$1[0];"l"===d?b.parent?c&&(ua(b),a.handled()):a.handled():"r"===d?(ta(b),b.activeButton=c||sa(b,b,1),a.handled()):b.parent&&!c||(b.activeButton=sa(b,c,"u"===d?-1:1)||c,a.handled())},click:function(a,b){Qa(b.callout,a.target)||ta(b)},childExecuted:function(a,b){b.activeButton=null;for(var c=a.control;c&&c!==b.parent;c=c.parent)if(!c.hideCalloutOnExecute)return;ua(b)},beforeDestroy:function(a,b){ua(b)}}),da("dialog",{template:'<div class="zeta-ui zeta-dialog"><z:anim class="zeta-float zeta-dialog-inner"><div class="zeta-dialog-content"><h2>{{title}}</h2><z:form><p>{{description}}</p><controls/></z:form></div><div class="zeta-dialog-error error hidden:{{not errorMessage}}">{{errorMessage}}</div><controls of="type == buttonset"/></z:anim></div>',templates:{buttonset:'<z:buttonset class="zeta-dialog-buttonset"><controls of="danger" show-text="true"/><div class="zeta-buttonset-pad"></div><controls show-text="true"/></z:buttonset>'},pinnable:!0,modal:!0,title:"",description:"",errorMessage:"",parseOptions:fa,init:function(d,e){var f=e.element,g=e.parentElement,h=g&&e.pinnable&&screen.availWidth>=600&&screen.availHeight>=600&&V.hasRole(g,"button buttonlike")?g:b;a(f).appendTo(c.body),g&&Ma.retainFocus(g,f),e.modal&&Ma.setModal(f),Ma.snap(f,h,"auto"),La.setZIndexOver(f,g||c.activeElement),m(function(){Ma.focus(f,!0)})},error:function(a,b){b.errorMessage=(a.error||"").message||a.error||"",a.handled()},focusout:va,escape:va,afterExecute:function(a,b){a.data&&va(a,b)},enter:function(a,b){return b.execute()}}),da("anim",{template:"<div><children controls/></div>",init:function(a,b){ib(a.target,"open")},focusreturn:function(b,c){ib(b.target,"pop").then(function(){a(b.target).removeClass("pop")})},beforeDestroy:function(a,b){return ib(a.target,"closing")}},!0),da("generic",{parseOptions:fa});var Bb=new V("dialog");Bb.i18n("en",{action:"OK",cancel:"Cancel",leaveForm:"There are unsubmitted information on the page. Are you sure to leave?"}),Bb.export("dialog.prompt",Bb.dialog({preventLeave:!1,exports:"title description errorMessage",controls:[Bb.textbox("value",{hiddenWhenDisabled:!0,exports:"enabled label"}),Bb.buttonset(Bb.submit("action","done",{defaultExport:"label",exports:"icon"}),Bb.button("cancel","close",{exports:"visible",execute:function(a){return a.all.dialog.destroy()}}))],execute:function(a){return(Za(a.context.callback)||lb)(a.context.value)}}));var Cb;Bb.export("dialog.notify",Bb.generic({template:'<z:anim class="zeta-ui zeta-snackbar notify:{{kind}}"><div class="zeta-float"><z:buttonset><z:label/><z:button icon="close" show-text="false" show-icon="true"/></z:buttonset></div></z:anim>',init:function(a,b){Cb&&Cb.destroy(),Wa(b,b.context),Ma.snap(a.target,b.within||c.body,"top center inset"),b.timeout&&m(function(){b.destroy()},b.timeout),Cb=b},click:function(a,b){b.destroy()}})),Va("alert confirm prompt notify",function(a,b){V[b]=Bb[b].bind(Bb)}),Ka.pipes[":zeta-shortcut"]=g.IS_MAC?ya:xa}(a,zeta),function(a,d){function e(){O.timestamp=s.getSelection().timestamp,O.rect=E(s).translate(K.scrollLeft,K.scrollTop),D(this,{typer:s,pointerX:O.x||0,pointerY:O.y||0,mousedown:Q,hoverNode:u||null,activeHandle:t||null,editorReflow:!P.rect||!z.rectEquals(P.rect,O.rect),pointerMoved:P.x!=O.x||P.y!=O.y,selectionChanged:P.timestamp!==O.timestamp}),D(P,O)}function f(a,b){this.cursor=a||"pointer",this.done=b}function i(){var e={N:"typer-visualizer",G:"background",S:"selection",X:"transparent"};a(c.body).append("<style>.has-N{caret-color:X;}.has-N:focus{outline:none;}.has-N::S,.has-N ::S{G:X;}.has-N::-moz-S,.has-N ::-moz-S{G:X;}@keyframes caret{0%{opacity:1;}100%{opacity:0;}}</style>".replace(/\b[A-Z]/g,function(a){return e[a]||a})).append(J),A(J,"mousedown",function(a){1&a.buttons&&(t=L.get(a.target),z.always(d.dom.drag(a,s.element),function(){(t.done||z.noop).call(t),t=null}),a.preventDefault())}),A(b,"mousedown mousemove mouseup",function(a){O.x=a.clientX,O.y=a.clientY,u=s&&s.nodeFromPoint(O.x,O.y),n(x),"mousemove"===a.type?x=m(q,0):(Q=1&a.buttons,x=m(q,0,!0))}),A(b,"scroll resize orientationchange focus",q)}function j(a){var b=s.getAbstractSide("inline-start",a.startContainer),c=s.getAbstractSide("inline-end",a.startContainer),d=[];return C(z.getRects(a),function(a,e){g.abs(e[b]-e[c])<=1&&(e[c]+=5),d.forEach(function(a){g.abs(e.left-a.right)<=1&&(a.right=e.left),g.abs(e.top-a.bottom)<=1&&(a.bottom=e.top)}),d.unshift(e)}),d}function k(a,b){M[a]=[b,[],{},!0]}function p(a,b,c,d,e){for(var f=0,g=v.length;f<g;f++)if(v[f].state===b&&v[f].kind===a)return void(w[w.length]=v.splice(f,1)[0]);w[w.length]={kind:a,state:b,rect:c||("top"in b?b:E),css:d,handle:e}}function q(b){if(b=!0===b,n(x),s&&(b||s.focused())){var d=new e;(b||d.editorReflow||d.selectionChanged||d.pointerMoved)&&C(M,function(e,f){w=f[1],v=w.splice(0),!1!==f[3]&&f[0].call(null,d,f[2]),v.forEach(function(b){N[N.length]=a(b.dom).detach().removeAttr("style")[0],L.delete(b.dom)}),w.forEach(function(e){if(b||!e.dom||d.editorReflow||G(e.rect)){var f=e.dom||(e.dom=a(N.pop()||c.createElement("div"))[0]);a(f).appendTo(J).css(D({position:"absolute",cursor:(e.handle||"").cursor,pointerEvents:e.handle?"all":"none"},e.css,z.cssFromRect("top"in e.rect?e.rect:e.rect(e.state),J))),L.set(f,e.handle)}})})}}function r(b){s=b,b?(z.setZIndexOver(J,b.element),b.retainFocus(J),q(!0)):a(J).children().detach()}var s,t,u,v,w,x,y=d.Editor,z=d.helper,A=z.bind,B=z.createRange,C=z.each,D=z.extend,E=z.getRect,F=z.is,G=z.isFunction,H=z.matchWord,I=z.toPlainRect,J=a('<div style="position:absolute;top:0;left:0;">')[0],K=c.documentElement,L=new o.WeakMap,M={},N=[],O={},P={},Q=!1;D(e.prototype,{refresh:function(){m(q,0,!0)},toggleLayer:function(a,b){var c=!1;a.split(" ").forEach(function(a){c|=b^(M[a]||"")[3],(M[a]||{})[3]=b}),c&&m(q,0,!0)},fill:function(a,b,c){var d={};if(d.background=b||"rgba(0,31,81,0.2)",a instanceof h||"top"in a)p("f",a,null,d,c);else{var e=[];z.iterate(s.createSelection(a).createTreeWalker(-1,function(b){return z.rangeCovers(a,b.element)?(e[e.length]=E(b),2):F(b,y.NODE_ANY_ALLOWTEXT)?(e.push.apply(e,j(B(a,B(b.element,"content")))),2):1})),e.forEach(function(a){p("f",a,null,d,c)})}},drawCaret:function(a){p("k",a,null,{animation:"caret 0.5s infinite alternate ease-in",outline:"1px solid rgba(0,31,81,0.8)"})},drawBorder:function(a,b,c,d,e){var f={};f.border=l(b)+"px "+(d||"solid")+" "+(c||"black"),f.margin=e?"0px":-l(b)+"px",f.boxSizing=e?"border-box":"auto",p("b",a,null,f)},drawLine:function(a,b,c,d,e,f,h,i){var j=c-a,k=d-b,m={};m.borderTop=l(e)+"px "+(h||"solid")+" "+(f||"black"),m.transformOrigin="0% 50%",m.transform="translateY(-50%) rotate("+g.atan2(k,j)+"rad)",p("l",I(a,b,a+g.sqrt(k*k+j*j),b),null,m,i)},drawHandle:function(a,b,c,d,e){var f={};f.border="1px solid #999",f.background="white"+(d?' url("'+d+'")':""),c=c||8,p("c",a,function(){var d=E(a),e=H(b,"left right")||"centerX",f=H(b,"top bottom")||"centerY";return d.left-=c,d.top-=c,I(d[e],d[f],d[e]+c,d[f]+c)},f,e)}}),k("selection",function(a){var b=a.typer.getSelection(),c=b.startNode;b.isCaret?"caretColor"in K.style&&a.drawCaret(b.baseCaret):F(c,y.NODE_WIDGET)===b.focusNode?a.fill(c.element):a.fill(b.getRange())}),y.widgets.visualizer={init:function(b){a(b.typer.element).addClass("has-typer-visualizer"),i.init||(i(),i.init=!0)},focusin:function(a){r(a.typer)},focusout:function(a){r(null)},contentChange:function(a){q(!0)},stateChange:function(a){a.typer.enabled()?s===a.typer?q():a.typer.focused()&&r(a.typer):r(null)}},y.defaultOptions.visualizer=!0,D(y,{addLayer:k,handle:function(a,b){return new f(a,b)}})}(a,zeta),function(a,b){var c,d,e=b.helper.getRect,f=b.helper.containsOrEquals,g=b.Editor.prototype.closest,h=b.Editor.handle("move",function(){c&&d&&c.typer.invoke(function(a){a.selection.select(d),a.insertHtml(c.element)})});b.Editor.addLayer("dragWidget",function(a){var i=a.hoverNode;if(a.activeHandle===h){var j=g(i,b.Editor.NODE_PARAGRAPH|b.Editor.NODE_WIDGET);if(d=null,j&&!f(c,j)){var k=e(j),l=e(g(j,b.Editor.NODE_EDITABLE)),m=a.pointerY<k.centerY,n=m?j.previousSibling:j.nextSibling;if(n!==c&&a.typer.widgetAllowed(c.widget.id,j)){var o;if(n){var p=e(n);o=(k.bottom<=p.top?k.bottom+p.top:p.bottom+k.top)/2}else o=e(j,!0)[m?"top":"bottom"];a.drawLine(l.left,o,l.right,o,1,"red","dashed"),d=a.typer.createCaret(j.element,m)}}a.fill(c.element)}else!i||c&&!f(c,i)&&b.helper.pointInRect(a.pointerX,a.pointerY,e(c),10)||(c=g(i,b.Editor.NODE_WIDGET));c&&a.drawHandle(c,"top left",11,"data:image/gif;base64,R0lGODlhCwALAKEBAE1PUP///////////yH5BAEKAAIALAAAAAALAAsAAAIUjI8ZoAffDFOzuoexk5zGBUXTlxQAOw==",h)})}(0,zeta),function(a,c){function d(a){return a.filter(function(b){return!a.some(function(a){return a!==b&&a.contains(b)})})}function e(b){var c=a(b).css("text-align"),d=a(b).css("direction");switch(c){case"-webkit-left":case"-webkit-right":case"-webkit-center":return c.slice(8);case"start":return"ltr"===d?"left":"right";case"end":return"ltr"===d?"right":"left";default:return c}}function f(b,c){var d;return a(b).each(function(b,f){var g;g="textAlign"===c?e(f):"inlineClass"===c?a(f).attr("class")||"":a(f).css(c),d=""===d||d&&d!==g?"":g}),d||""}function g(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),a===b||H.test(a)&&H.test(b)}function i(a,b){var c=B.createElement(a);return b&&(c.className=b),c}function j(b,c){return c=B.is(c,h)||i(c),a(c).append(b.childNodes).replaceAll(b)[0]}function l(c,d,e,f,g){var h=c.selection,i=h.getParagraphElements();if(h.isCaret&&!f)c.insertHtml(d),d.appendChild(B.createTextNode()),h.moveToText(d,-0);else{var j=h.getSelectedTextNodes();i.forEach(function(c){if(!g||!B.matchWord(b.getComputedStyle(c)[g[0]],g[1]))if(f){var h=a(j,c).parentsUntil(c).filter(e),i=h.contents().filter(function(a,b){return j.every(function(a){return!B.containsOrEquals(b,a)})});h.contents().unwrap(),i.wrap(d)}else a(c).find(j).wrap(d)}),h.select(j[0],0,j[j.length-1],-0)}a(i).find(e).filter(":has("+e+")").each(function(b,c){a(c).contents().unwrap().filter(function(a,b){return 3===b.nodeType}).wrap(c)}),a(i).find('span[class=""],span:not([class])').contents().unwrap(),a(i).find(e).each(function(b,c){B.sameElementSpec(c.previousSibling,c)&&(a(c.childNodes).appendTo(c.previousSibling),F(c))})}function m(b){a(b.selection.getParagraphElements()).attr("align",w[b.commandName])}function n(a){var b=a.commandName;l(a,i(x[b].split(",")[0]),x[b],a.widget[b],y[b])}function o(b,c){var d="insertOrderedList"===b.commandName||c?"ol":"ul",e="<"+d+(c||"").replace(/^.+/,' type="$&"')+">",f=function(b,e){return B.is(e,d)&&(a(e).attr("type")||"")===(c||"")},g=[];E(b.selection.getParagraphElements(),function(c,d){if(a(d).is("ol>li,ul>li"))a(d.parentNode).filter(f)[0]?a(d).is("li")&&a.inArray(d.parentNode,g)<0&&q(b,[d]):(j(d.parentNode,a(e)[0]),g.push(d.parentNode));else{var h=a(d).prev().filter(f)[0]||a(d).next().filter(f)[0]||a(e).insertAfter(d)[0];a(d)[B.comparePosition(d,h)<0?"prependTo":"appendTo"](h),j(d,"li"),g.push(h)}})}function p(b,c){c=a.makeArray(c||d(b.selection.getParagraphElements())),E(c,function(b,c){var d=a(c).parent("ul,ol")[0]||a(c).prev("ul,ol")[0]||a("<ul>").insertBefore(c)[0],e=d;if(e===c.parentNode){var f=a(c).prev("li")[0]||a("<li>").insertBefore(c)[0];e=a(f).children("ul,ol")[0]||a(d.cloneNode(!1)).appendTo(f)[0]}a(j(c,"li")).appendTo(e),a(e).parent("li")[0]&&a(B.createTextNode(" ")).insertBefore(e),d.children[0]||F(d)})}function q(b,c){c=a.makeArray(c||d(b.selection.getParagraphElements())),E(c,function(c,d){var e=a(d).parent("ul,ol")[0],f=a(e).parent("li")[0];a(d).next("li")[0]&&(f?a(e.cloneNode(!1)).append(a(d).nextAll()).appendTo(d):(a(e.cloneNode(!1)).append(a(d).nextAll()).insertAfter(e),a(d).children("ul,ol").insertAfter(e))),f?(a(d).insertAfter(f),B.trim(b.typer.extractText(f))||F(f)):a(j(d,"p")).insertAfter(e),e.children[0]||F(e)})}function r(b){var c=b.typer.getSelection().getSelectedElements();b.widget.inlineClass=f(a(c).filter("span"),"inlineClass"),E(y,function(a,d){b.widget[a]=!!B.matchWord(f(c,d[0]),d[1])})}function s(b){var c=b.typer.getSelection(),d=c.getParagraphElements().slice(-1)[0];a(d).is("li")&&(d=a(d).closest("ol, ul")[0]||d);var e=d&&d.tagName.toLowerCase(),g=e+(a(d).attr("class")||"").replace(/^(.)/,".$1"),h=f(c.getSelectedElements(),"textAlign");D(b.widget,{justifyLeft:"left"===h,justifyCenter:"center"===h,justifyRight:"right"===h,justifyFull:"justify"===h,formatting:e,formattingWithClassName:g})}function t(a,b){var c=a.context.typer.getSelection();return!!("inlineStyle"===b?c.startNode.nodeType&(A.NODE_PARAGRAPH|A.NODE_EDITABLE_PARAGRAPH|A.NODE_INLINE):c.getParagraphElements()[0])}function u(a,b){return I.button(a,J[a],{realm:b,execute:a,active:function(c){var d=c.context.typer.getStaticWidget(b);return d&&d[a]},enabled:function(a){return t(a,b)}})}function v(b,c){return I.button(B.camel(z[b]),{description:c,execute:function(a){a.context.typer.invoke(function(a){a.insertWidget("list",b)})},active:function(c){var d=c.context.typer.getSelection().getWidget("list");return d&&a(d.element).attr("type")===b}})}var w={justifyLeft:"left",justifyRight:"right",justifyCenter:"center",justifyFull:"justify"},x={bold:"b,strong",italic:"i,em",underline:"u",strikeThrough:"strike"},y={bold:["fontWeight","bold 700"],italic:["fontStyle","italic"],underline:["textDecoration","underline"],strikeThrough:["textDecoration","line-through"]},z={1:"decimal",A:"upper-alpha",a:"lower-alpha",I:"upper-roman",i:"lower-roman"},A=c.Editor,B=c.helper,C=c.dom,D=B.extend,E=B.each,F=B.removeNode,G=/^([a-z\d]*)(?:\.(.+))?/i,H=/^(p|h[1-6])(?:\.(.+))?$/i;A.widgets.inlineStyle={stateChange:r,contentChange:r,commands:{bold:n,italic:n,underline:n,strikeThrough:n,superscript:n,subscript:n,applyClass:function(a,b){l(a,i("span",b),"span")}}},A.widgets.formatting={stateChange:s,contentChange:s,enter:function(a){a.typer.widgetEnabled("lineBreak")&&B.is(a.typer.getSelection().startNode,A.NODE_EDITABLE_PARAGRAPH)?a.typer.invoke("insertLineBreak"):a.typer.invoke("insertLine"),a.handled()},commands:{justifyCenter:m,justifyFull:m,justifyLeft:m,justifyRight:m,formatting:function(b,c){var d=/^([a-z\d]*)(?:\.(.+))?/i.exec(c)||[];"ol"===d[1]||"ul"===d[1]?b.insertWidget("list","ol"===d[1]&&"1"):a(b.selection.getParagraphElements()).not("li").each(function(a,b){d[1]&&!B.is(b,d[1])&&g(d[1],b.tagName)?j(b,i(d[1]||"p",d[2])):b.className=d[2]||""})},insertLine:function(a){a.insertText("\n\n")},insertLineBefore:function(a){var b=a.selection.focusNode.widget;"__root__"!==b.id&&(a.selection.select(b.element,!0),a.insertText("\n\n"))}}},A.widgets.lineBreak={enter:function(a){a.typer.invoke("insertLineBreak"),a.handled()},shiftEnter:function(a){a.typer.invoke("insertLineBreak"),a.handled()},commands:{insertLineBreak:function(a){a.insertHtml("<br>")}}},A.widgets.list={element:"ul,ol",editable:"ul,ol",textFlow:!0,create:o,remove:function(a){q(a,a.widget.element.children)},extract:function(a){},receive:function(a){B.sameElementSpec(a.widget.element,a.receivedNode)&&(a.handled(),a.typer.invoke(function(b){b.insertHtml(a.receivedNode.childNodes)}))},tab:function(a){a.typer.invoke("indent")},shiftTab:function(a){a.typer.invoke("outdent")},init:function(b){a(b.widget.element).filter("ol").attr("type-css-value",z[a(b.widget.element).attr("type")]||"decimal"),a(b.widget.element).parent("li")[0]&&!b.widget.element.previousSibling&&a(B.createTextNode()).insertBefore(b.widget.element)},contentChange:function(b){a(b.widget.element).children("li")[0]||b.typer.invoke(function(a){F(b.widget.element)})},setup:function(a){a.typer.on("tab",function(a){a.typer.invoke(p),a.handled()})},commands:{indent:p,outdent:q}},D(A.defaultOptions,{lineBreak:!0,formatting:!0,inlineStyle:!0,list:!0}),C.setShortcut({bold:"ctrlB",italic:"ctrlI",underline:"ctrlU",justifyLeft:"ctrlShiftL",justifyCenter:"ctrlShiftE",justifyRight:"ctrlShiftR",insertLineBefore:"ctrlEnter"});var I=new c.UI("zeta.editor.formatting",{contextChange:function(a,b){E("formatting inlineStyle list",function(a,c){b[c]=b.context.typer.widgetEnabled(c)})}}),J={bold:"",italic:"",underline:"",strikeThrough:"",unorderedList:"",orderedList:"",indent:"",outdent:"",justifyLeft:"",justifyCenter:"",justifyRight:"",justifyFull:""},K=I.buttonlist(I.button("inlineStyleClear",function(a){a.context.typer.invoke("applyClass","")}),{after:"*"});I.export("zeta.editor.toolbar",I.buttonset(I.dropdown("paragraph",{realm:"formatting",execute:"formatting",visible:function(a){return t(a,"formatting")&&a.controls.length>0},contextChange:function(a,b){var c=b.context.typer.getSelection(),d=b.context.typer.getStaticWidget("formatting"),e=(c.startNode===c.endNode?c.startNode:c.focusNode).element,f=B.any(b.controls,function(a){return a.value===d.formattingWithClassName});b.choices=B.map(b.context.options.formattings,function(a,b){return!G.test(b)||g(e.tagName,k.$1)?{value:b,label:a}:null}),b.value=f?f.value:d.formatting}}),I.dropdown("inlineStyle",{realm:"inlineStyle",execute:"applyClass",init:function(a,b){b.choices=b.context.options.inlineClass,b.append(K)},visible:function(a){return t(a,"inlineStyle")&&a.controls.length>1},contextChange:function(a,b){var c=b.context.typer.getStaticWidget("inlineStyle");b.value=c.inlineClass}}),u("bold","inlineStyle"),u("italic","inlineStyle"),u("underline","inlineStyle"),u("strikeThrough","inlineStyle"),I.button("unorderedList",J.unorderedList,{realm:"list",execute:function(a){a.context.typer.invoke(function(a){a.insertWidget("list")})},active:function(a){var b=a.context.typer.getSelection().getWidget("list");return b&&B.is(b.element,"ul")},enabled:function(a){return t(a,"list")&&a.context.typer.getSelection().widgetAllowed("list")}}),I.callout("orderedList",J.orderedList,v("1","1, 2, 3, 4"),v("a","a, b, c, d"),v("A","A, B, C, D"),v("i","i, ii, iii, iv"),v("I","I, II, III, IV"),{realm:"list",active:function(a){var b=a.context.typer.getSelection().getWidget("list");return b&&B.is(b.element,"ol")},enabled:function(a){return t(a,"list")&&a.context.typer.getSelection().widgetAllowed("list")}}),u("indent","list"),u("outdent","list"),u("justifyLeft","formatting"),u("justifyCenter","formatting"),u("justifyRight","formatting"),u("justifyFull","formatting"),{visible:function(a){return t(a,"inlineStyle")}})),I.i18n("en",{bold:"Bold",italic:"Italic",underline:"Underlined",strikeThrough:"Strikethrough",unorderedList:"Bullet list",orderedList:"Numbered list",indent:"Indent",outdent:"Outdent",justifyLeft:"Align left",justifyCenter:"Align center",justifyRight:"Align right",justifyFull:"Align justified",paragraph:"Formatting",inlineStyle:"Text style",inlineStyleClear:"Clear style",decimal:"Decimal numbers",lowerAlpha:"Alphabetically ordered list, lowercase",upperAlpha:"Alphabetically ordered list, uppercase",lowerRoman:"Roman numbers, lowercase",upperRoman:"Roman numbers, uppercase",format_p:"Paragraph",format_h1:"Header 1",format_h2:"Header 2",format_h3:"Header 3",format_h4:"Header 4",format_h5:"Header 5",format_h6:"Header 6",format_table:"Table",format_td:"Table cell",format_th:"Table header",format_ul:"Unordered list",format_ol:"Ordered list",format_li:"List item",format_blockquote:"Blockquote"})}(a,zeta),function(a,d){function e(a){var b=c.createElement("a");return b.href=a||"",location.protocol===b.protocol&&location.hostname===b.hostname&&(location.port===b.port||""===location.port&&b.port===("https:"===location.protocol?"443":"80"))?b.pathname.replace(/^(?!\/)/,"/")+b.search+b.hash:a}function f(b){var c,d=b.context.typer,e=(b.state.widget||"").element;if(e)c={href:e.getAttribute("href"),text:e.textContent,blank:"_blank"===e.getAttribute("target")};else{var f=d.getSelection().getSelectedText();c={href:/^[a-z]+:\/\//g.test(f)?f:"",text:f,blank:!1}}var g,i=b.context.options.selectLink;return g="function"==typeof i?i(c):h.render(c).dialog,g.then(function(b){if(!b)return null;var c=b.href||b,f=b.text||c;d.invoke(function(g){e||(e=a('<a href="">').text(f)[0],g.insertHtml(e),g.selection.select(e,"contents")),a(e).text(f),a(e).attr("target",b.blank?"_blank":null),d.invoke("setURL",c)})})}d.Editor.widgets.link={element:"a[href]",inline:!0,create:function(b,c){c=e(c),"link"===b.selection.focusNode.widget.id?b.invoke("setURL",c):b.insertHtml(a("<a>").text(b.selection.getSelectedText()||c).attr("href",c)[0])},remove:"keepText",setup:function(a){a.typer.on("contentChange",function(a){var b=a.sourceKeyName;if("enter"===b||"space"===b){var c=a.typer.getSelection().clone();if(c.moveByCharacter(-1),c.getCaret("start").moveByWord(-1)&&"link"!==c.focusNode.widget.id&&/^([a-z]+:\/\/\S+)|(\S+@\S+\.\S+)/g.test(c.getSelectedText())){var d=k.$1||"mailto:"+k.$2;a.typer.invoke(function(b){var e=b.selection.clone();a.typer.snapshot(!0),a.typer.select(c),b.insertWidget("link",d),a.typer.select(e)})}}})},init:function(a){a.widget.element.style.cursor="text"},ctrlClick:function(a){b.open(a.widget.element.href)},commands:{setURL:function(a,b){a.widget.element.href=e(b)},unlink:function(a){a.removeWidget(a.widget)}}},d.Editor.defaultOptions.link=!0;var g=new d.UI("zeta.editor.link",{contextChange:function(a,b){var c=b.context.typer;if(c){var d=c.getSelection();b.widget=d.getWidget("link"),b.widgetAllowed=d.widgetAllowed("link")}}}),h=g.dialog(g.textbox("text",!0),g.textbox("href",!0),g.checkbox("blank"),g.buttonset(g.button("remove","delete",{danger:!0,execute:function(a){a.parentContext.typer.invoke("unlink")},visible:function(a){return a.parentContext.typer.hasCommand("unlink")}}),g.submit("ok","done"),g.button("cancel","close",function(a){return a.all.dialog.destroy()})));g.export("zeta.editor.toolbar",g.button("insertLink","insert_link",{realm:"widgetAllowed",after:"insertWidgets",execute:f,active:function(a){return a.state.widget},contextChange:function(a,b){b.label=b.state.widget?"editLink":"insertLink"}})),g.export("zeta.editor.contextmenu",g.buttonlist(g.button("open",{realm:"widget",shortcut:"ctrlClick",execute:function(a){b.open(a.state.widget.element.href)}}),g.button("editLink",{realm:"widget",execute:f}),g.button("removeLink",{realm:"widget",execute:"unlink"}))),g.i18n("en",{insertLink:"Insert hyperlink",editLink:"Edit hyperlink",removeLink:"Remove hyperlink",remove:"Remove",text:"Text",href:"Link URL",blank:"Open in new window",open:"Open hyperlink",cancel:"Cancel",ok:"OK"})}(a,zeta),function(a,b){function c(a,b){var c,d=a.context.options.selectMedia;if(f.isFunction(d)){c=d(e.exec(a.label)&&(k.$1?"image":k.$2?"video":"audio"),a.value)}else c=g.prompt("imageURL",a.value);return c.then(b)}function d(a,b){return g.button(a,b,{realm:"widgetAllowed",execute:function(a){return c(a,function(){a.context.typer.invoke(function(b){b.insertWidget("media",a.value)})})}})}var e=/\.(?:(jpg|jpeg|png|gif|webp)|(mp4|ogg|webm)|(mp3))(?:\?.*)?$/i,f=b.helper;b.Editor.widgets.media={element:"img,audio,video,a:has(>img)",text:function(a){return a.element.src},create:function(b,c){var d=f.createElement(e.test(c.src||c)?k.$2?"video":k.$3?"audio":"img":"img");d.src=c.src||c,f.is(d,"video")&&a(d).attr("controls",""),b.insertHtml(d)}},b.Editor.defaultOptions.media=!0;var g=new b.UI("zeta.editor.media",{contextChange:function(a,b){var c=b.context.typer.getSelection();b.widget=c.getWidget("media"),b.widgetAllowed=c.widgetAllowed("media")}});g.export("zeta.editor.insertMenu",d("image","insert_photo"),d("video","videocam")),g.export("zeta.editor.toolbar",g.buttonset(g.button("filePicker",{realm:"widget",showText:!0,showIcon:!1,contextChange:function(b,c){c.value=a(c.state.widget.element).attr("src"),c.label=(/(?:^|\/)([^\/?#]+)(?:\?.+)?$/.exec(c.value)||[])[1]||""},execute:function(b){return c(b,function(c){a(b.state.widget.element).attr("src",c.src||c)})}}),g.textbox("altText",{realm:"widget",icon:"comment",contextChange:function(b,c){c.value=a(c.state.widget.element).attr("alt")},execute:function(b){a(b.state.widget.element).attr("alt",b.value).attr("title",b.value)}}))),g.i18n("en",{insertImage:"Image",insertVideo:"Video",altText:"Alternate text",imageURL:"Image URL"})}(a,zeta),function(a,b){function c(b,c,e){var f=b.options;f[c]&&d.setState(d.is(f.target,h)||a(b.typer.element).parents(f.target).addBack()[0],f[c],e)}var d=b.helper;b.Editor.widgets.stateclass={options:{target:null,disabled:"disabled",focused:"focused",empty:"empty"},focusin:function(a){c(a.widget,"focused",!0)},focusout:function(a){c(a.widget,"focused",!1)},stateChange:function(a){c(a.widget,"disabled",!a.typer.enabled()),c(a.widget,"empty",!a.typer.hasContent())},contentChange:function(a){c(a.widget,"empty",!a.typer.hasContent())},init:function(a){c(a.widget,"empty",!a.typer.hasContent())}}}(a,zeta),function(a,b){function c(a,b,c,d,e){var f=this;f.widget=a,f.element=a.element,f.minCol=c,f.minRow=b,f.maxCol=e,f.maxRow=d}function d(b){var d=b.focusNode.widget;if("table"===d.id){var e=a(b.startElement).parentsUntil(d.element).addBack(),f=a(b.endElement).parentsUntil(d.element).addBack();return new c(d,e.eq(1).index(),e.eq(2).index(),f.eq(1).index(),f.eq(2).index())}}function e(b,c){return a(v,b.element||b)[c]}function f(a,b,c){return"string"==typeof b?f(a,g.min(a[b+"Row"],h(a)-1),g.min(a[b+"Col"],i(a)-1)):e(a,b).children[c]}function h(b){return a(v,b.element||b).length}function i(a){return e(a,0).childElementCount}function j(a){return!!w.is(f(a,0,0),"th")}function k(b,c,d){if(b.isSingleEditable){var e=a(b.focusNode.element)[c]()[0]||a(b.focusNode.element).parent()[c]().children(d)[0];e&&b.moveToText(e,-0)}}function l(b){a("td,th",b.element||b).css({outline:"1px dotted rgba(0,0,0,0.3)",minWidth:"3em"})}function m(a,b,d,e,f){a.typer.select(new c(a,b,d,b+e-1,d+f-1))}function n(b,c,d,e){var f="string"==typeof c?c+"-child":"nth-child("+(c+1)+")",g=e?"before":"after";a(b.element||b).find(v+">th:"+f)[g](y(t,d)),a(b.element||b).find(v+">td:"+f)[g](y(s,d)),l(b)}function o(b,c,d,f,g){a(e(b,"last"===c?h(b)-1:c))[g?"before":"after"](y(u.replace("%",y(f,i(b))),d)),l(b)}function p(b,c){var d=j(b);d&&!c?(a(">th",e(b,0)).wrapInner("<p>").each(function(b,c){a(c).replaceWith(a(s).append(c.childNodes))}),l(b)):d||!c&&void 0!==c||o(b,0,1,t,!0)}function q(b,c,d){for(var e=a(c?v+":first>*":v,b.element),f=e.length-1;f>=0;f--){var g=w.getRect(e[f]);if((c?g.left:g.top)<d)return f}return 0}var r,s="<td></td>",t="<th></th>",u="<tr>%</tr>",v=">tbody>tr",w=b.helper,x=w.removeNode,y=w.repeat;c.prototype={get numCol(){return g.abs(this.maxCol-this.minCol)+1},get numRow(){return g.abs(this.maxRow-this.minRow)+1},get mode(){return(this.numCol===i(this))+2*(this.numRow===h(this))},rows:function(b){a(v,this.element).splice(this.minRow,this.numRow).forEach(b)},cells:function(b){var c=this;c.rows(function(d,e){a(d.children).splice(c.minCol,c.numCol).forEach(function(a,c){b(a,e,c)})})},getRange:function(){return w.createRange(f(this,"min"),0,f(this,"max"),-0)},acceptNode:function(a){var b=!1;return a.element===this.element?1:(this.cells(function(c){b|=w.containsOrEquals(c,a.element)}),b||2)},remove:function(a){var b=this;1===a?b.rows(x):2===a&&b.cells(x),b.widget.typer.select(f(b,"min"),-0)}},b.Editor.widgets.table={element:"table",editable:"th,td",create:function(a,b){b=b||{},a.insertHtml("<table>"+y(u.replace("%",y(s,b.columns||2)),b.rows||2)+"</table>")},init:function(b){a(b.widget.element).removeAttr("x-table-copymode"),l(b.widget)},extract:function(b){var c=b.widget.element,d=b.extractedNode;if(r&&r.widget===b.widget){var e=r.mode;1!==e&&2!==e||(a(d).attr("x-table-copymode",e),"paste"!==b.source&&"cut"!==b.source||r.remove(e))}else if(h(d)>1){var f=i(c);a(v,d).each(function(b,c){
c.childElementCount<f&&a(y(a(">th",c)[0]?t:s,f-c.childElementCount))[b?"appendTo":"prependTo"](c)})}},receive:function(b){var c=+a(b.receivedNode).attr("x-table-copymode");if(c||"paste"===b.source){var k=b.typer.getSelection(),q=r&&r.widget===b.widget?r:d(k),t=b.widget.element,u=b.receivedNode,w=j(t);p(u,1!==c&&(2===c?w:0===q.minRow&&w));var x=h(u),y=i(u),z=h(t),A=i(t),B=1===c?q.minRow===z:q.minCol===A;2===c?(o(x>z?t:u,"last",g.abs(x-z),s,!1),a(v,u).each(function(b,c){a(c.children)[B?"insertAfter":"insertBefore"](f(t,b,q.minCol-B))}),m(b.widget,0,q.minCol,h(t),y)):1===c?(0===q.minRow&&w&&q.minRow++,n(y>A?t:u,"last",g.abs(y-A),!1),a(v,u)[B?"insertAfter":"insertBefore"](e(t,q.minRow-B)),m(b.widget,q.minRow,0,x,i(t))):(1===q.numRow&&1===q.numCol&&(q.maxCol=q.minCol+y-1,q.maxRow=q.minRow+x-1,q.maxRow>z-1&&o(t,"last",q.maxRow-z+1,s,!1),q.maxCol>A-1&&n(t,"last",q.maxCol-A+1,!1)),q.cells(function(b,c,d){a(b).replaceWith(f(u,c%x,d%y).cloneNode(!0))}),k.select(q)),l(t),b.preventDefault()}},tab:function(a){k(a.typer.getSelection(),"next",":first-child"),a.handled()},shiftTab:function(a){k(a.typer.getSelection(),"prev",":last-child"),a.handled()},keystroke:function(a){if(r&&r.widget===a.widget&&("backspace"===a.data||"delete"===a.data)){var b=r.mode;1!==b&&2!==b||(r.remove(b),a.handled())}},commands:{addColumnBefore:function(a){var b=d(a.selection);n(a.widget,b.minCol,b.numCol,!0)},addColumnAfter:function(a){var b=d(a.selection);n(a.widget,b.maxCol,b.numCol,!1)},addRowAbove:function(a){var b=d(a.selection);o(a.widget,b.minRow,b.numRow,s,!0)},addRowBelow:function(a){var b=d(a.selection);o(a.widget,b.maxRow,b.numRow,s,!1)},removeColumn:function(a){d(a.selection).remove(2)},removeRow:function(a){d(a.selection).remove(1)},toggleTableHeader:function(b){p(b.widget),a(">th",e(b.widget,0)).text(function(a,b){return b||"Column "+(a+1)})}}},b.UI.define("tableGrid",{template:'<div class="zeta-grid"><div class="zeta-grid-wrapper"></div><z:label/></div>',init:function(b,c){var d=a(c.element);d.find(".zeta-grid-wrapper").append(y('<div class="zeta-grid-row">'+y('<div class="zeta-grid-cell"></div>',7)+"</div>",7)),d.find(".zeta-grid-cell").mouseover(function(){c.value.rows=a(this).parent().index()+1,c.value.columns=a(this).index()+1,c.label=c.value.rows+" × "+c.value.columns,d.find(".zeta-grid-cell").removeClass("active"),d.find(".zeta-grid-row:lt("+c.value.rows+")").find(".zeta-grid-cell:nth-child("+c.value.columns+")").prevAll().addBack().addClass("active")}),c.label="0 × 0",c.value={}},click:function(a,b){return b.execute()}});var z=new b.UI("zeta.editor.table",{contextChange:function(a,b){var c=b.context.typer.getSelection();b.widget=c.getWidget("table"),b.widgetAllowed=c.widgetAllowed("table")}});z.export("zeta.editor.insertMenu",z.callout("insertTable",z.tableGrid({realm:"widgetAllowed",execute:function(a){a.context.typer.invoke(function(b){b.insertWidget("table",a.value)})}}))),z.export("zeta.editor.contextmenu",z.callout("modifyTable",z.checkbox("showHeader",{realm:"widget",execute:"toggleTableHeader",contextChange:function(a,b){b.value=j(b.state.widget)}}),z.dropdown("style",{realm:"widget",valueAsLabel:!1,init:function(a,b){b.choices=b.context.options.tableStyles,b.append(z.button("styleDefault",{after:"*"}))},execute:function(a){a.state.widget.element.className=a.value||""},contextChange:function(a,b){b.value=b.state.widget.element.className||""}}),z.dropdown("tableWidth",{realm:"widget",valueAsLabel:!1,choices:{"":"fitContent","100%":"fullWidth"},execute:function(b){a(b.state.widget.element).attr("width",b.value||null)},contextChange:function(b,c){c.value=a(c.state.widget.element).attr("width")||""}}),z.buttonlist("addRemoveCell",z.button("addColumnBefore",{realm:"widget",execute:"addColumnBefore"}),z.button("addColumnAfter",{realm:"widget",execute:"addColumnAfter"}),z.button("addRowAbove",{realm:"widget",execute:"addRowAbove",enabled:function(a){return!j(a.state.widget)||d(a.context.typer.getSelection()).minRow>0}}),z.button("addRowBelow",{realm:"widget",execute:"addRowBelow"}),z.button("removeColumn",{realm:"widget",execute:"removeColumn"}),z.button("removeRow",{realm:"widget",execute:"removeRow"})),{hiddenWhenDisabled:!0})),z.i18n("en",{insertTable:"Table",modifyTable:"Modify table",showHeader:"Show header",style:"Table style",styleDefault:"Default",addColumnBefore:"Add column before",addColumnAfter:"Add column after",addRowAbove:"Add row above",addRowBelow:"Add row below",removeColumn:"Remove column",removeRow:"Remove row",tableWidth:"Table width",fitContent:"Fit to content",fullWidth:"Full width"});var A,B=b.Editor.handle("cell"),C=b.Editor.handle("cell");b.Editor.addLayer("table",function(a){var b=a.hoverNode&&a.hoverNode.widget;if(b&&"table"===b.id){var e=w.getRect(b);a.drawLine(e.left,e.top,e.right,e.top,10,"transparent","solid",B),a.drawLine(e.left,e.top,e.left,e.bottom,10,"transparent","solid",C)}var j=a.typer.getSelection(),k=a.activeHandle;if(k===B||k===C){var l=k===B,n=q(A?r:b,l,l?a.pointerX:a.pointerY);A||(r=new c(b,0,0,h(b)-1,i(b)-1),r[l?"minCol":"minRow"]=n),r[l?"maxCol":"maxRow"]=n,A=!0}else a.selectionChanged&&(r=d(j),!r||1===r.numRow&&1===r.numCol?(r=null,A=!1):A=!0);if(A&&!a.mousedown&&(A=!1,3===r.mode?(j.select(r.element),r=null):m(r.widget,g.min(r.minRow,r.maxRow),g.min(r.minCol,r.maxCol),r.numRow,r.numCol)),r){var o=f(r,"min"),p=f(r,"max");a.fill(w.mergeRect(w.getRect(o),w.getRect(p)))}a.toggleLayer("selection",!r)})}(a,zeta),function(a,d){function e(a){if(!1===p)a();else if(!p){var b=q.bind(c,"paste",function(){p=!0});m(function(){b(),p||(p=!1,a())})}}function f(b){var c=a(b.element).height(),d=q.getRect(b.widget||b.typer);if(0!==d.left||0!==d.top||0!==d.width||0!==d.height){var e={position:"fixed",left:d.left,top:g.max(0,d.top-c-10)},f=b.typer.getSelection().extendCaret.getRect();f.top>=e.top&&f.top<=e.top+c&&(e.top=f.bottom+10),a(b.element).css(e)}}function h(b){o!==b&&(i(),o=b,a(b.element).appendTo(c.body),q.setZIndexOver(b.element,b.typer.element)),f(b)}function i(b){o&&(b||o)===o&&(a(o.element).detach(),o.position="",o=null)}function j(b,d,e){var f=c.createElement("div"),g=e.render(f,{typer:b,options:d});return g.element||(g.element=f),b.retainFocus(g.element),d.container&&e!==n?a(f).appendTo(d.container):a(f).addClass("zeta-float"),g}function k(a,b){"mouse"===a.source&&b.context.typer.focus()}var l,n,o,p,q=d.helper;d.Editor.widgets.toolbar={options:{container:"",formattings:{p:"Paragraph",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4"},inlineClasses:{}},init:function(a){a.widget.toolbar=j(a.typer,a.widget.options,l)},focusin:function(a){var b=a.widget.toolbar;b.update(),b.options.container||h(b)},focusout:function(a){i(a.widget.toolbar)},rightClick:function(a){var b=a.widget.contextmenu||(a.widget.contextmenu=j(a.typer,a.widget.options,n));b.update(),m(function(){d.dom.focus(b.element),b.showMenu({x:a.clientX,y:a.clientY})}),a.preventDefault()},stateChange:function(a){var b=a.widget.toolbar;b.update(),o===b&&(a.typer.enabled()?f(b):i(b))}},q.bind(b,"scroll",function(){o&&f(o)});var r=new d.UI("zeta.editor");l=r.buttonset(r.callout("insertWidgets","widgets",r.import("zeta.editor.insertMenu")),r.import("zeta.editor.toolbar"),{showText:!1,childExecuted:k}),n=r.menu(r.buttonlist(r.button("undo","",{execute:"undo",enabled:function(a){return a.context.typer.canUndo()}}),r.button("redo","",{execute:"redo",enabled:function(a){return a.context.typer.canRedo()}}),{hiddenWhenDisabled:!1}),r.buttonlist(r.button("selectAll","select_all",{execute:"selectAll"}),r.button("selectParagraph",{hiddenWhenDisabled:!0,execute:function(a){var b=a.context.typer.getSelection();b.select(b.startNode.element,"contents"),b.focus()},enabled:function(a){return a.context.typer.getSelection().isCaret}})),r.buttonlist(r.button("cut","content_cut",{shortcut:"ctrlX",execute:function(a){a.context.typer.focus(),c.execCommand("cut")}}),r.button("copy","content_copy",{shortcut:"ctrlC",execute:function(a){a.context.typer.focus(),c.execCommand("copy")}}),r.button("paste","content_paste",{shortcut:"ctrlV",execute:function(a){a.context.typer.focus(),c.execCommand("paste"),e(function(){r.alert("clipboardError")})}})),r.import("zeta.editor.contextmenu"),{childExecuted:k}),r.i18n("en",{undo:"Undo",redo:"Redo",cut:"Cut",copy:"Copy",paste:"Paste",selectAll:"Select all",selectParagraph:"Select paragraph",insertWidgets:"Insert",clipboardError:"Unable to access clipboard due to browser security. Please use Ctrl+V or [Paste] from browser's menu."})}(a,zeta),function(a,b){function c(a,b,c){return b.invalidCharsRegex&&(a=a.replace(b.invalidCharsRegex,"")),b.maxlength&&(a=a.substr(0,b.maxlength-c)),a}b.Editor.widgets.validation={options:{invalidChars:"",allowChars:"",maxlength:0},init:function(a){var b=a.widget.options;b.invalidChars&&(b.invalidCharsRegex=new k("["+b.invalidChars.replace(/[\[\]\\^]/g,"\\$&")+"]","g")),b.allowChars&&(b.invalidCharsRegex=new k("[^"+b.allowChars.replace(/[\[\]\\^]/g,"\\$&")+"]","g"))},contentChange:function(a){if("script"===a.source){var b=a.typer.extractText(),d=c(b,a.widget.options,0);d!==b&&a.typer.setValue(d)}},textInput:function(a){var b=c(a.data,a.widget.options,a.typer.extractText().length-a.typer.getSelection().getSelectedText().length);b!==a.data&&(a.handled(),b&&a.typer.invoke(function(a){a.insertText(b)}))}}}(0,zeta),function(a,c){function d(b,c,d,f){var h=e.getRect(b),i=g.pow(d-h.top,2)+g.pow(c-h.left,2),j=g.pow(d-h.top,2)+g.pow(c-h.right,2),k=g.pow(d-h.bottom,2)+g.pow(c-h.left,2),n=g.pow(d-h.bottom,2)+g.pow(c-h.right,2),o=.5+2*g.sqrt(g.max(i,j,k,n))/l(a.css(b,"font-size")),p=a('<div class="zeta-clickeffect"><i></i></div>').appendTo(b),q=p.children().css({top:d-h.top,left:c-h.left});m(function(){q.css("transform",q.css("transform")+" scale("+o+")").addClass("animate-in")}),p.css("border-radius",a.css(b,"border-radius")),e.always(f,function(){e.runCSSTransition(p.children()[0],"animate-out").then(function(){p.remove()})})}var e=c.helper;e.bind(b,c.IS_TOUCH?"touchstart":"mousedown",function(a){for(var b=(a.touches||[a])[0],f=a.target;f;f=f.parentNode)if(e.is(f,".zeta-ui button, .zeta-ui .has-clickeffect"))return void d(f,b.clientX,b.clientY,c.dom.drag(a))})}(a,zeta),function(a,b,d){function e(a,b){for(var c=[],d=0;d<a;d++)c[d]=b(d);return c}function f(a){return a.getFullYear()}function h(a){return a.getMonth()}function i(a){return a.getDate()}function j(a){return a.getHours()}function l(a){return a.getMinutes()}function n(a,b){return f(a)===f(b)&&h(a)===h(b)}function p(a){return"string"==typeof a&&/^today|([+-]\d+)(day|week|month|year)?$/g.test(a)?k.$1?u(k.$2||"day",new d,+k.$1):new d:(a=null===a?void 0:a instanceof d?a:new d(a),isNaN(a)?void 0:a)}function q(a,b){var c=new d;return c.setHours(a,b,0,0),c}function r(a,b){switch(a){case"datetime":return+b-F;case"month":return 12*(f(b)-1970)+h(b)}return+b+F}function s(a,b){switch(a){case"datetime":return new d(b+F);case"month":return new d(1970,b)}return new d(b-F)}function t(a,b){var c=p(a.min),e=p(a.max);switch(b=new d(+(b<c?c:b>e?e:b)),a.mode||a){case"week":b.setDate(i(b)-b.getDay());break;case"month":b.setDate(1)}return"datetime"!==(a.mode||a)?b.setHours(0,0,0,0):b.setSeconds(0,0),b}function u(a,b,c,e){switch(a){case"minute":var j=c/g.abs(c);return new d(+b+6e4*(((j>0?e:0)-l(b)%e||e*j)+e*(c-j)));case"day":return new d(+b+E*c);case"week":return new d(+b+7*E*c);case"month":return new d(f(b),h(b)+c,i(b));case"year":return new d(f(b)+c,h(b),i(b))}}function v(a,b){switch(a){case"month":return C[h(b)]+" "+f(b);case"week":var c=u("day",b,6);return C[h(b)]+" "+i(b)+" - "+(h(c)!==h(b)?C[h(c)]+" ":"")+i(c)+", "+f(b)}var d=C[h(b)]+" "+i(b)+", "+f(b);return"datetime"===a?d+" "+(j(b)||12)+":"+("0"+l(b)).slice(-2)+" "+(j(b)>=12?"PM":"AM"):d}function w(b,c){if(!isNaN(+c)){"number"==typeof c&&(c=u("month",b.currentMonth,c));var g=p(b.min),j=p(b.max),k=t({mode:"month",min:g,max:j},c),l=f(k),m=h(k),o=K.all(b),q=k.getDay(),r=a("td",b.element).removeClass("selected disabled");if(!b.currentMonth||!n(k,b.currentMonth)){var s=new d(l,m+1,0).getDate(),v=new d(l,m,0).getDate();r.removeClass("prev cur next today"),r.each(function(b,c){b<q?a(c).children().text(b+1-q+v).end().addClass("prev"):b>=s+q?a(c).children().text(b+1-q-s).end().addClass("next"):a(c).children().text(b+1-q).end().addClass("cur")});var w=new d;n(k,w)&&r.eq(i(w)+q-1).addClass("today"),a("tr:last",b.element).toggle(q+s>35),o.year.choices=e(11,function(a){return l+a-5}),b.currentMonth=k}o.year.value=l,o.month.value=m;var x=g&&n(k,g),y=j&&n(k,j);o.prevMonth.enabled=!x,o.nextMonth.enabled=!y,x&&r.slice(0,i(g)+q-1).addClass("disabled"),y&&r.slice(i(j)+q).addClass("disabled");var z=n(k,b.value);if(z||"week"===b.mode&&n(k,u("day",b.value,6)))switch(b.mode){case"day":r.eq(i(b.value)+q-1).addClass("selected");break;case"week":r.slice(z?i(b.value)+q-1:0).slice(0,7).addClass("selected");break;case"month":r.filter("td.cur").addClass("selected")}a(b.element).toggleClass("select-range","day"!==b.mode)}}function x(){var a={template:'<z:callout label="{{selectedText}}" show-text="true"/>'},b=new o.Map;e(12,function(a){b.set(a,C[a].toLowerCase())}),z={year:K.dropdown("year",function(a){return w(a.parent,new d(a.value,h(a.parent.currentMonth)))},a),month:K.dropdown("month",b,function(a){return w(a.parent,new d(f(a.parent.currentMonth),a.value))},a),prev:K.button("prevMonth","",function(a){return w(a.parent,-1)}),setToday:K.button("setToday","",function(a){return a.parent.execute(new d)}),next:K.button("nextMonth","",function(a){return w(a.parent,1)}),hour:K.number("hour",{options:{min:0,max:23,loop:!0},execute:function(a){a.parent.execute(q(a.value,a.all.minute.value))}}),timeSeperator:K.label("timeSeperator"),minute:K.number("minute",{options:{min:0,max:59,digits:"fixed",loop:!0},execute:function(a){a.parent.execute(q(a.all.hour.value,a.value))}}),meridiem:K.button("meridiem",{value:!1,label:"am",showText:!0,propertyChange:function(a,b){b.label=b.value?"pm":"am"},execute:function(a){a.value=!a.value,a.parent.execute(q(a.all.hour.value%12+(a.value?12:0),a.all.minute.value))}})}}function y(){var b=function(a,b){var c=new d(+b.all.calendar.value);c.setHours(j(b.all.clock.value),l(b.all.clock.value)),A.setValue(c)},c=K.calendar({executed:b,contextChange:function(a,b){b.min=B.min,b.max=B.max,b.mode="datetime"===B.mode?"day":B.mode}}),e=K.clock({hiddenWhenDisabled:!0,executed:b,contextChange:function(a,b){b.step=B.minuteStep,b.enabled="datetime"===B.mode}}),f=K.submit("done","done",{execute:function(b){a(B.element).detach()}});B=K.menu(K.buttonset(c,e),K.generic({controls:[K.buttonset(f)],template:'<z:generic><controls layout="dialog"/></z:generic>'}),{hideCalloutOnBlur:!1}).render()}var z,A,B,C="January February March April May June July August September October November December".split(" "),D="Su Mo Tu We Th Fr Sa".split(" "),E=864e5,F=6e4*(new d).getTimezoneOffset(),G={datetime:"datetime-local",day:"date",week:"week",month:"month"},H=b.helper,I=b.dom,J=H.repeat,K=new b.UI("zeta.ui.datepicker");b.UI.define("calendar",{template:'<div class="zeta-calendar"><div class="zeta-calendar-header"><z:buttonset show-text="false"/></div><div class="zeta-calendar-body"><table></table></div></div>',hideCalloutOnExecute:!1,value:null,mode:"day",min:null,max:null,setValue:function(a,b){var c=t(this,a.newValue);b.selectedDate=c,b.value=c,w(b,c)},init:function(b,c){z||x(),c.append([z.year,z.month,z.prev,z.setToday,z.next]);var e=function(){c.value=t(c,c.selectedDate)};c.watch("mode",e),c.watch("min",e),c.watch("max",e);var g=a("table",c.element);a(J("<tr></tr>",7)).appendTo(g),a(J("<th></th>",7)).appendTo(g.find("tr:first")),a(J("<td></td>",7)).appendTo(g.find("tr+tr")),a("<button>").appendTo(g.find("td")),g.find("th").text(function(a){return D[a]}),g.find("td").click(function(){var b=a(this).hasClass("prev")?-1:a(this).hasClass("next")?1:0;c.execute(new d(f(c.currentMonth),h(c.currentMonth)+b,+this.textContent))}),c.value?w(c,0):c.value=new d},mousewheel:function(a,b){b.context===B&&(w(b,a.data),a.handled())},contextChange:function(a,b){w(b,b.currentMonth||b.value||new d)}}),b.UI.define("clock",{template:'<div class="zeta-clock"><div class="zeta-clock-face"><s hand="h"></s><s hand="m"></s></div><z:buttonset/></div>',hideCalloutOnExecute:!1,step:1,value:null,init:function(b,c){z||x(),c.append([z.hour,z.timeSeperator,z.minute,z.meridiem]),c.value||(c.value=new d),c.watch("step",function(){K.all(c).minute.options.step=c.step}),60%c.step>0&&(c.step=1);var e=a(".zeta-clock-face",c.element);a(J("<i></i>",12)).appendTo(e).each(function(b,c){a(c).css("transform","rotate("+30*b+"deg)")}),H.bind(c.element,"mousedown touchstart",function(a){var b=a.target;if("s"===H.tagName(b)&&(1===a.which||1===(a.touches||"").length)){var d=H.getRect(b.parentNode);I.drag(a,function(a,e){var f=g.atan2(e-d.centerY,a-d.centerX)/g.PI,h=l(c.value),i=j(c.value);if("m"===b.getAttribute("hand")){var k=g.round((30*f+75)/c.step)*c.step%60;if(k!==h){var m=g.floor(g.abs(h-k)/30)*(k>h?-1:1);c.setValue(q(i+m,k))}}else{var n=g.round(6*f+15)%12+(K.all(c).meridiem.value?12:0);n!==i&&c.setValue(q(n,h))}}).then(function(){c.execute()})}}),c.setValue(new d)},setValue:function(b,c){var d=b.newValue,e=K.all(c);e.hour.value=j(d)||12,e.minute.value=l(d),e.meridiem.value=j(d)>=12,a('s[hand="h"]',c.element).css("transform","rotate("+(30*j(d)+.5*l(d)-90)+"deg)"),a('s[hand="m"]',c.element).css("transform","rotate("+(6*l(d)-90)+"deg)")},mousewheel:function(a,b){b.setValue(u("minute",b.value,a.data,b.step)),b.mousewheelTimeout=b.mousewheelTimeout||m(function(){b.mousewheelTimeout=null,b.execute()}),a.preventDefault(),a.handled()}});var L={options:{mode:"day",minuteStep:1,min:null,max:null,required:!1,formatDate:null},overrides:{getValue:function(a){return a.selectedDate?t(a.options,a.selectedDate):null},setValue:function(a,b){b=b?t(a.options,b):null,a.selectedDate=b,a.softSelectedDate=null;var c="";if(b&&!isNaN(+b)){var e=function(c){return H.isFunction(c)&&c(a.options.mode,b)};c=e(a.options.formatDate)||e(v)}c!==this.extractText()&&(this.invoke(function(a){a.selection.selectAll(),a.insertText(c)}),this===A&&(B.calendar=B.clock=a.selectedDate||new d))},validate:function(a){if(a.options.required&&a.selectedDate)return H.reject("required")}},commands:{step:function(a,b){var c=a.widget.options,e=u("datetime"===c.mode?"minute":c.mode,a.typer.getValue()||new d,b,c.minuteStep);a.typer.setValue(e)}},contentChange:function(a){if(a.typer===A&&"script"!==a.source){var b=new d(a.typer.extractText());isNaN(+b)||(B.calendar=B.clock=t(a.widget.options,b)),a.widget.softSelectedDate=b}},click:function(a){a.typer===A&&B.showMenu(a.typer.element)},mousewheel:function(a){a.typer.invoke("step",a.data),a.preventDefault()},upArrow:function(a){a.typer.invoke("step",-1)},downArrow:function(a){a.typer.invoke("step",1)},escape:function(b){H.containsOrEquals(c,B.element)&&(a(B.element).detach(),b.handled())},focusin:function(a){B||y(),I.retainFocus(a.typer.element,B.element),A=a.typer;var b=a.widget.options,c=a.typer.getValue()||new d;H.extend(B,{mode:b.mode,minuteStep:b.minuteStep,min:b.min,max:b.max,calendar:c,clock:c}),B.update(),B.showMenu(a.typer.element)},focusout:function(a){if(a.typer===A){var b=a.widget.softSelectedDate;a.typer.setValue(!b||isNaN(+b)?a.widget.selectedDate:b),A=null,B.hideMenu()}}};b.UI.define("datepicker",{template:"<z:textbox/>",preventLeave:!0,value:"",preset:L,options:{},init:function(c,d){if(b.IS_TOUCH){var e=d.options.mode||d.preset.options.mode;d.nativeInput=a('<input type="'+G[e]+'">').appendTo(d.element)[0],H.bind(d.nativeInput,"change",function(a){d.setValue(s(e,d.nativeInput.valueAsNumber))})}},focusin:function(a,c){if(b.IS_TOUCH){var e=c.options.mode||c.preset.options.mode;c.value||(c.value=new d),c.nativeInput.valueAsNumber=r(e,c.value),c.nativeInput.focus(),a.handled()}}});var M={setToday:"Today",prevMonth:"Previous month",nextMonth:"Next month",timeSeperator:":",am:"AM",pm:"PM",done:"Done"};e(12,function(a){M[C[a].toLowerCase()]=C[a]}),K.i18n("en",M)}(a,zeta,Date),function(a,b){function d(){t=x.menu(x.dropdown({template:"<z:buttonlist/>",execute:function(a){r(t.preset,a.value),t.preset.typer.focus()},contextChange:function(a,b){b.choices=b.context.suggestions}}),{hideCalloutOnBlur:!1,hideCalloutOnExecute:!1}).render()}function f(a,b){var d=c.createTextNode(b?a:a.replace(/\s/g," ")),e=c.createElement("div");return e.appendChild(d),e.innerHTML}function h(a){return a.value}function i(a){return"object"!=typeof a?{value:a,label:a}:a}function j(a,b){return a.value.localeCompare(b.value)}function l(a,b){return a.length!==b.length||a.some(function(a){return b.indexOf(a)<0})}function m(a,b){a=e(a||"");for(var c=[],d=a.toLowerCase(),f=0,g=-1,h=0;h<b.length;h++){var i=b.charAt(h).toLowerCase();if(" "!=i){if(-1==(f=d.indexOf(i,f)))return{firstIndex:1/0,consecutiveMatches:-1,formattedText:a};c[c.length]=f-g-1,g=f++}}var j=c[0],l=/^(0+)/.test(c.slice(0).sort().join(""))&&k.$1.length,m="";for(f=0,h=0;h<c.length;h++)m+=a.substr(f,c[h])+"**"+a[f+c[h]]+"**",f+=c[h]+1;return m+=a.slice(f),{firstIndex:j,consecutiveMatches:l,formattedText:m.replace(/\*\*(\ *)\*\*/g,"$1")}}function n(a,b,c){var d=a.options.suggestions||a.options.allowedValues||[];return v.isFunction(d)&&(d=d(b)),v.when(d).then(function(b){return b=b.map(i),b.forEach(function(b){a.knownValues[b.value]=b.label}),c&&(b=b.filter(function(a){return c.indexOf(a.value)<0})),b})}function o(a,b,c){return a=a.filter(function(a){return v.extend(a,m(a.label,b)),[a.value].concat(a.matches||[]).forEach(function(c){var d=m(c,b);a.firstIndex=g.min(a.firstIndex,d.firstIndex),a.consecutiveMatches=g.max(a.consecutiveMatches,d.consecutiveMatches)}),a.firstIndex!==1/0}),a.sort(function(a,b){return b.consecutiveMatches-a.consecutiveMatches+(a.firstIndex-b.firstIndex)||j(a,b)}),a.slice(0,c)}function p(a){var b=a.typer.extractText();n(a,b,a.typer.getValue()).then(function(c){a.typer.focused()&&(c=o(c,b,a.options.suggestionCount),b&&a.options.allowFreeInput&&!c.some(function(a){return a.label===b})&&c.push({value:b,label:b,formattedText:"*"+b+"*"}),t||d(),t.preset=a,t.suggestions=c.map(function(a){return{value:a.value,label:a.formattedText,icon:a.icon||""}}),t.update(),w.retainFocus(a.typer.element,t.element),t.showMenu(a.typer.element),a.typer.focus())})}function q(a,b){var c=n(a);x.dialog({title:b.label,description:b.placeholder,controls:[x.textbox("newValue",{enter:function(a,b){return b.all.list.append(x.checkbox({label:b.value,entry:b.value,value:!0,description:"new value",before:"*"})),b.execute()},visible:function(){return a.options.allowFreeInput}}),x.buttonlist("list",{templates:{checkbox:'<z:checkbox show-icon="true"/>'}}),x.buttonset(x.submit("done","done"),x.button("cancel","close",function(a){a.all.dialog.destroy()}))],childExecuted:function(a,b){b.value=b.all.list.controls.filter(function(a){return a.value}).map(function(a){return a.entry})},init:function(b,d){var e=a.typer.getValue();d.all.dialog.value=e.slice(0),c.then(function(a){var b=a.map(h);a=a.concat(e.filter(function(a){return b.indexOf(a)<0}).map(i)),a.sort(j),d.all.list.append(a.map(function(a){var b=e.indexOf(a.value)>=0;return x.checkbox({label:a.label,icon:a.icon,entry:a.value,value:b,before:b?"*":""})}))})}}).render().dialog.then(function(b){a.typer.setValue(b)})}function r(b,c){if(c&&!(b.typer.getValue().indexOf(c.value||c)>=0)){"object"!=typeof c&&(c={value:c,label:b.knownValues[c]||c});var d=a('<span class="zeta-keyword" data-value="'+f(c.value,!0)+'">'+f(c.label)+"<i>delete</i></span>")[0],e=b.typer.rootNode.lastChild;b.typer.invoke(function(a){a.selection.selectAll(),e&&a.selection.baseCaret.moveTo(e.element,!1),a.insertHtml(d)}),b.options.allowFreeInput||n(b,c.value).then(function(){b.knownValues[c.value]||a(d).addClass("invalid")})}}var s,t,u=b.IS_TOUCH,v=b.helper,w=b.dom,x=new b.UI("zeta.ui.keyword"),y={options:{required:!1,allowFreeInput:!0,allowedValues:null,suggestionCount:5,suggestions:!1},overrides:{getValue:function(b){return a("span",this.element).map(function(b,c){return e(a(c).data("value"))}).get()},setValue:function(a,b){b=(v.isArray(b)||e(b).split(/\s+/)).filter(function(a){return a}),l(b,this.getValue())&&this.invoke(function(c){c.selection.selectAll(),c.insertText(""),b.forEach(function(b){r(a,b)})})},validate:function(b){return b.options.required&&!this.getValue().length?v.reject("required"):a(".invalid",this.element)[0]?v.reject("invalid-value"):void 0}},widgets:{tag:{element:"span",inline:!0,editable:"none",click:function(b){b.target!==b.widget.element&&a(b.widget.element).detach()}}},init:function(a){a.typer.select(a.typer.element,-0),a.widget.knownValues={}},focusin:function(a){u?"touch"===a.source&&q(a.widget,s):p(a.widget)},focusout:function(a){u||(t.hideMenu(),r(a.widget,a.typer.extractText()))},click:function(a){u&&q(a.widget,s)},upArrow:function(a){w.focus(t.element),a.handled()},downArrow:function(a){w.focus(t.element),a.handled()},textInput:function(a){var b=a.typer.rootNode.lastChild;b&&v.compareRangePosition(a.typer.getSelection(),b.element)<0&&a.typer.select(a.typer.element,-0)},enter:function(a){var b=t.suggestions;r(a.widget,1===b.length||b[0]&&b[0].label==="**"+a.widget.knownValues[b[0].value]+"**"?b[0].value:a.typer.extractText()),a.handled()},escape:function(a){v.containsOrEquals(c,t.element)&&(t.hideMenu(),a.handled())},contentChange:function(a){u||"script"===a.source||p(a.widget)}};b.UI.define("keyword",{template:"<z:textbox/>",preventLeave:!0,options:{},value:[],preset:y,init:function(a,b){b.options.required=b.required,b.watch("required",function(a,c,d,e){b.options.required=e})},focusin:function(a,b){s=b},setValue:function(a,b){var c=a.newValue||[];l(a.oldValue,c)&&(b.setValue(c),b.editor.setValue(c)),a.handled()}}),x.i18n("en",{newValue:"Enter new value",done:"Done",cancel:"Cancel"})}(a,zeta),function(a,b){function c(a,b){if(null===b||""===b||isNaN(b))b=b?"0":"";else{var c=a.options.min,d=a.options.max,g=a.options.loop&&null!==c&&null!==d;g&&b<c||!g&&null!==d&&b>d?b=d:(g&&b>d||!g&&null!==c&&b<c)&&(b=c),b=e(0|+b)}if("fixed"===a.options.digits){var h=e(+a.options.max||0).length;b=(new f(h+1).join("0")+b).substr(-h)}b!==a.typer.extractText()&&a.typer.invoke(function(a){a.selection.selectAll(),a.insertText(b)})}function d(a,b){c(a,(a.typer.getValue()||0)+b*a.options.step)}var g={validation:{allowChars:"0-9"},options:{max:null,min:null,digits:"auto",step:1,loop:!1},overrides:{getValue:function(a){var b=parseInt(this.extractText());return isNaN(b)?null:b},setValue:function(a,b){c(a,b)}},mousewheel:function(a){d(a.widget,-a.data),a.handled()},upArrow:function(a){d(a.widget,1),a.handled()},downArrow:function(a){d(a.widget,-1),a.handled()},contentChange:function(a){"keyboard"!==a.source&&c(a.widget,a.typer.getValue())}};b.UI.define("number",{template:"<z:textbox/>",preventLeave:!0,value:null,preset:g})}(0,zeta)}(jQuery,window,document,Object,String,Array,Math,Node,Range,DocumentFragment,RegExp,parseFloat,setTimeout,clearTimeout,new function(){this.Map=window.Map||function(a){function b(a,b){return a.items.indexOf(b)}function c(){var b=this;b.items=[],b.values=[],b._keys=a.Set.prototype._keys}return c.prototype={get size(){return this.items.length},has:function(a){return b(this,a)>=0},get:function(a){var c=b(this,a);return c>=0?this.values[c]:void 0},set:function(a,c){var d=this,e=b(d,a);return d.values[e>=0?e:d.items.push(a)-1]=c,d},delete:function(a){var c=this,d=b(c,a);return d>=0&&(c.items.splice(d,1),c.values.splice(d,1)),d>=0},keys:function(){return this._keys()},values:function(){var a=this;return a._keys(function(b){return a.get(b)})},entries:function(){var a=this;return a._keys(function(b){return[b,a.get(b)]})},forEach:function(a,b){var c=this;c.items.forEach(function(d,e){a.call(b,c.values[e],d,c)})},clear:function(){this.items.splice(0),this.values.splice(0)}},c}(this),this.MutationObserver=window.MutationObserver||function(){function a(a){this.records=[],this.handler=a}return a.prototype={observe:function(a,b){var c=zeta.helper,d=this;c.bind(a,"DOMNodeInserted DOMNodeRemoved DOMAttrModified DOMCharacterDataModified",function(e){var f=e.type.charAt(7),g=e.prevValue,h={};h.addedNodes=[],h.removedNodes=[],"M"===f?(h.type="attributes",h.target=e.target,h.attributeName=e.attrName,b.attributeOldValue&&(h.oldValue=g)):"a"===f?(h.type="characterData",h.target=e.target,b.characterDataOldValue&&(h.oldValue=g)):(h.type="childList",h.target=e.target.parentNode,h["I"===f?"addedNodes":"removedNodes"][0]=e.target);var i=!1;c.each(d.records,function(a,b){return!(i|="childList"===b.type&&b.addedNodes.some(function(a){return c.containsOrEquals(a,h.target)}))}),i||!b[h.type]||!b.subtree&&h.target!==a||(d.records[d.records.length]=h,clearTimeout(d.timeout),d.timeout=setTimeout(function(){d.handler(d.takeRecords(),d)}))})},takeRecords:function(){return this.records.splice(0)}},a}(),this.Set=window.Set||function(){function a(a,b){var c=this;c.items=a,c.index=-1,c.callback=b||function(a){return a}}function b(){this.items=[]}return a.prototype={next:function(){var a=this;return++a.index<a.items.length?{value:a.callback(a.items[a.index],a.index),done:!1}:{value:void 0,done:!0}}},b.prototype={get size(){return this.items.length},has:function(a){return this.items.indexOf(a)>=0},add:function(a){var b=this.items;return b.indexOf(a)<0&&b.push(a),this},delete:function(a){var b=this.items.indexOf(a);return b>=0&&this.items.splice(b,1),b>=0},keys:function(){return this._keys()},values:function(){return this._keys()},entries:function(){return this._keys(function(a){return[a,a]})},forEach:function(a,b){var c=this;c.items.forEach(function(d){a.call(b,d,d,c)})},clear:function(){this.items.splice(0)},_keys:function(b){return new a(this.items,b)}},b}(),this.WeakMap=window.WeakMap||function(){function a(){this.key="__WeakMap"+ ++c}var b,c=0,d=0;return a.prototype={get:function(a){if(this.has(a))try{if(d=1,a[this.key](),2!==d)throw new Error("Invalid operation");var c=b;return b=null,c}finally{d=0}},set:function(a,c){return Object.defineProperty(a,this.key,{configurable:!0,value:function(){1===d&&(b=c,d=2)}}),this},has:function(a){return a&&Object.hasOwnProperty.call(a,this.key)},delete:function(a){var b=this.has(a);return b&&delete a[this.key],b}},a}()});
//# sourceMappingURL=zeta-ui.min.js.map
