/*! zeta UI v1.0.0-beta | https://github.com/misonou/zeta-ui | The MIT License (MIT) */

!function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";!function(){function m(){}function n(a){return f.isArray(a)&&a}function p(a){return"function"==typeof a&&a}function q(a){var b="object"==typeof a&&null!==a&&d.getPrototypeOf(a);return(b===d.prototype||null===b)&&a}function r(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||p(g)||(g={});h<i;h++)if(null!==(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(q(d)||(e=n(d)))?(e?(e=!1,f=c&&n(c)?c:[]):f=c&&q(c)?c:{},g[b]=r(j,f,d)):void 0!==d&&(g[b]=d));return g}function s(a){if(p(a)||a===b)return!1;var c=!!a&&"length"in a&&a.length;return n(a)||0===c||"number"==typeof c&&c>0&&c-1 in a}function t(a,b){if(a){var c,d=0;if("string"==typeof a?a=a.split(" "):a instanceof o.Set&&(a=p(a.values)?a.values():function(a,b){return a.forEach(function(a){b[b.length]=a}),b}(a,[])),s(a))for(var e=a.length;d<e&&!1!==b(d,a[d++]););else if(p(a.entries))for(a=a.entries();!(c=a.next()).done&&!1!==b(c.value[0],c.value[1]););else if(p(a.forEach)){var f;a.forEach(function(a,c){f=!1===f||b(c,a)})}else if(p(a.next))for(;!(c=a.next()).done&&!1!==b(d++,c.value););else if(p(a.nextNode))for(;(c=a.nextNode())&&!1!==b(d++,c););else for(d in a)if(!1===b(d,a[d]))return}}function u(a,b){var c=[];return t(a,function(a,d){var e=b.call(this,d,a);null!==e&&void 0!==e&&(n(e)?c.push.apply(c,e):c[c.length]=e)}),c}function v(a,b){var c;return t(a,function(a,d){return!(c=b.call(this,d,a)&&d)}),c}function w(a,b){var c;return t(a,function(a,d){return!(c=b.call(this,d,a))}),c}function x(a,b){var c={};return c[a]=b,c}function y(a){if(n(a))return a.slice(0);if("string"==typeof a)return[a];if(a&&(s(a)||p(a.forEach))){var b=[];return t(a,function(a,c){b[b.length]=c}),b}return null!==a&&void 0!==a?[a]:[]}function z(a){if(!a[0])return Ta();var b,c=$.Deferred(),d=a.length;return t(a,function(a,e){B(e,function(a){b|=!a,0==--d&&c[b?"reject":"resolve"]()})}),c.promise()}function A(a){return $.Deferred().reject(a).promise()}function B(a,b){a.then(function(a){b(!0,a)},function(a){b(!1,a)})}function C(a,b){return b=b||a.currentNode,b&&a.whatToShow&(V(b,h)?1<<b.nodeType-1:b.nodeType)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b):1:3}function D(a,b,c,d){var e=0;switch(a.currentNode=c=c||a.currentNode,b=b||m,C(a)){case 2:return;case 1:b(c,e++)}for(var f;(f=a.nextNode())&&(!d||(p(d)?d(f):f!==d||void b(f,e++)));b(f,e++));}function E(a,b,c,d){var e=[];return D(a,function(a){e[e.length]=a},c,d),b?u(e,b):e}function F(){var a=new o.WeakMap;return function(b,c){return c&&a.set(b,c),c||a.get(b)}}function G(a,b,c){return a.get(b)||c&&(a.set(b,new c),a.get(b))}function H(a){var b={};return t(d.getOwnPropertyNames(a||{}),function(c,e){b[e]=d.getOwnPropertyDescriptor(a,e)}),b}function I(a,b,c,d){Qa(a,b,{configurable:!0,enumerable:!0,get:c,set:d})}function J(a,b,c){Qa(a,b,{configurable:!0,enumerable:!1,writable:!0,value:c})}function K(a,b){t(H(b),function(b,c){c.enumerable=!p(c.value),Qa(a.prototype,b,c)})}function L(a,b){var c=d.create(p(a)?a.prototype:a||d.prototype);return t(H(b),function(a,b){Qa(c,a,b)}),c}function M(){return g.random().toString(36).substr(2,8)}function N(a,b){return new f(b+1).join(a)}function O(a){return e(a).replace(/-([a-z])/g,function(a,b){return b.toUpperCase()})}function P(a){return e(a).replace(/[A-Z](?![A-Z])|[A-Z]{2,}(?=[A-Z])/g,function(a,b){return(b?"-":"")+a.toLowerCase()})}function Q(a){return a=e(a||""),a.charAt(0).toUpperCase()+a.slice(1)}function R(a){return a=e(a||""),a.charAt(0).toLowerCase()+a.slice(1)}function S(a){return e(a||"").replace(/^(?:\u200b|[^\S\u00a0])+|(?:\u200b|[^\S\u00a0])+$/g,"")}function T(a,b){return(Wa[b]||(Wa[b]=new k("(?:^|\\s)("+b.replace(/\s+/g,"|")+")(?=$|\\s)"))).test(e(a||""))&&k.$1}function U(a){return a&&a.tagName&&a.tagName.toLowerCase()}function V(a,b){return!(!a||!b)&&(b.prototype?a instanceof b&&a:b.toFixed?a.nodeType&b&&a:("*"===b||U(a)===b||$(a).is(b))&&a)}function W(a,b){if(U(a)!==U(b))return!1;var c=a.attributes,d=b.attributes;return c.length===d.length&&!v(c,function(a){return!d[a.nodeName]||a.value!==d[a.nodeName].value})}function X(a,b,c){if(a===b)return 0;var d=a&&b&&Oa.call(a,b);return 2&d?c&&8&d||1&d?NaN:1:4&d?c&&16&d||1&d?NaN:-1:NaN}function Y(a,b){return a&&b&&!(1&Oa.call(a.commonAncestorContainer||a,b.commonAncestorContainer||b))}function Z(a,b){return a=(a||"").element||a,b=(b||"").element||b,a===b||$.contains(a,b)}function _(a,b){for(b=b||a;a&&a!==b&&20!==Oa.call(a,b);a=a.parentNode);return a}function aa(a,b){var c=a.length||a.childNodes.length;return 1/b<0?g.max(0,c+b):g.min(c,b)}function ba(a,b,d,e){if(a&&p(a.getRange))return a.getRange();var f;if(V(a,h)?(f=c.createRange(),+b!==b?(f["contents"!==b&&a.parentNode?"selectNode":"selectNodeContents"](a),"boolean"==typeof b&&f.collapse(b)):f.setStart(a,aa(a,b)),V(d,h)&&Y(a,d)&&f.setEnd(d,aa(d,e))):V(a,i)&&(f=a.cloneRange(),f.collapsed||"boolean"!=typeof b||f.collapse(b)),V(b,i)&&Y(f,b)){var g=f.collapsed&&b.collapsed?-1:1;Pa.call(f,0,b)*g<0&&f.setStart(b.startContainer,b.startOffset),Pa.call(f,2,b)*g>0&&f.setEnd(b.endContainer,b.endOffset)}return f}function ca(a,b){return a=V(a,i)||ba(a),b=V(b,i)||ba(b),Y(a,b)&&Pa.call(a,3,b)<=0&&Pa.call(a,1,b)>=0}function da(a,b){return a=V(a,i)||ba(a),b=V(b,i)||ba(b),Y(a,b)&&Pa.call(a,0,b)<=0&&Pa.call(a,2,b)>=0}function ea(a,b){return a=V(a,i)||ba(a),b=V(b,i)||ba(b),Y(a,b)&&0===Pa.call(a,0,b)&&0===Pa.call(a,2,b)}function fa(a,b,c){a=V(a,i)||ba(a),b=V(b,i)||ba(b);var d=Y(a,b)?Pa.call(a,0,b)+Pa.call(a,2,b):NaN;return c&&(0!==d&&ca(a,b)||0===d&&!ea(a,b))?NaN:d&&d/g.abs(d)}function ga(a,b){if(Va.setBaseAndExtent&&V(b,i))return void Va.setBaseAndExtent(a.startContainer,a.startOffset,b.startContainer,b.startOffset);var d=ba(a,b);try{Va.removeAllRanges()}catch(b){var e=c.body.createTextRange();e.collapse(),e.select(),Va.removeAllRanges()}try{Va.addRange(d)}catch(b){Va.rangeCount||(Va.addRange(ba(c.body)),Va.removeAllRanges(),Va.addRange(d))}}function ha(a,d){var e;if(a=a||Ua,a.getRect)return a.getRect();if((a=a.element||a)===Ua||a===b){Z(c.body,Xa)||c.body.appendChild(Xa);var f=ha(Xa);e=ja(0,0,Ua.offsetWidth,Ua.offsetHeight).translate(f.left,f.top)}else if(Z(Ua,a)){if(e=ja(a.getBoundingClientRect()),d){var h=Sa(a);e.top-=g.max(0,l(h.marginTop)),e.left-=g.max(0,l(h.marginLeft)),e.right+=g.max(0,l(h.marginRight)),e.bottom+=g.max(0,l(h.marginBottom))}}else e=ja(0,0,0,0);return e}function ia(a){return u((V(a,i)||ba(a,"contents")).getClientRects(),ja)}function ja(a,b,c,d){function e(a){return g.round(1e3*a)/1e3}return void 0!==a.top?new Ka(e(a.left),e(a.top),e(a.right),e(a.bottom)):void 0===c?new Ka(a,b,a,b):new Ka(a,b,c,d)}function ka(a,b){function c(c){return g.abs(a[c]-b[c])<1}return c("left")&&c("top")&&c("bottom")&&c("right")}function la(a,b){return b.left>=a.left&&b.right<=a.right&&b.top>=a.top&&b.bottom<=a.bottom}function ma(a,b,c,d){return d=d||0,c.width&&c.height&&a-c.left>=-d&&a-c.right<=d&&b-c.top>=-d&&b-c.bottom<=d}function na(a,b){return ja(g.min(a.left,b.left),g.min(a.top,b.top),g.max(a.right,b.right),g.max(a.bottom,b.bottom))}function oa(a,b,d){if(d=d||c.body,Na)return v(Na.call(c,a,b),function(a){return Z(d,a)&&"none"!==Sa(a).pointerEvents})||null;var e=c.elementFromPoint(a,b);if(!Z(d,e)&&ma(a,b,ha(d))){var f=[];try{for(;X(d,e,!0);){var g=$(e).parentsUntil(_(d,e)).slice(-1)[0]||e;if(g===f[f.length-1])return null;g.style.pointerEvents="none",f[f.length]=g,e=c.elementFromPoint(a,b)}}finally{$(f).css("pointer-events","")}}return Z(d,e)?e:null}function pa(a){return V(a,j)||$(c.createDocumentFragment()).append(a)[0]}function qa(a){return c.createTextNode(a||"​")}function ra(a){return c.createElement(a)}function sa(a,b,d){return c.createNodeIterator(a,b,p(d)||null,!1)}function ta(a,b,c,d,e){q(c)?t(c,function(c,e){b[a](c,e,d)}):t(c.split(" "),function(c,f){b[a](f,d,e)})}function ua(a,b,c,d){return ta("addEventListener",a,b,c,d),function(){va(a,b,c)}}function va(a,b,c){ta("removeEventListener",a,b,c)}function wa(a){a.parentNode&&a.parentNode.removeChild(a)}function xa(a,b){var c=new k("(?:^|\\s+)"+b+"(?:-(\\S+)|\\b)","ig"),d=[!1];return(a.className||"").replace(c,function(a,b){d[b?d.length:0]=b||!0}),d[1]?d.slice(1):d[0]}function ya(a,b,c){var d=a.className||"";t(q(b)||x(b,c),function(a,b){var c=new k("(^|\\s)\\s*"+a+"(?:-(\\S+)|\\b)|\\s*$","ig"),e=0;q(b)&&(b=u(b,function(a,b){return a?b:null})),d=d.replace(c,function(){return e++||!b||0===b.length?"":" "+a+(b[0]?[""].concat(b).join(" "+a+"-"):"")})}),a.className=d}function za(a){if(!Y(Ua,a))return!1;var b=ha(a);if(!(b.top||b.left||b.width||b.height))for(var c=a;c;c=c.parentNode)if("none"===Sa(c).display)return!1;return!0}function Aa(a,b){var c=Sa(a,b||null);return T(c.position,"absolute fixed relative")&&"auto"!==c.zIndex?parseInt(c.zIndex):-1}function Ba(a){var b=-1;return D(c.createTreeWalker(c.body,1,function(c){if(X(c,a,!0))return 2;var d=Aa(c);return d>=0?(b=g.max(b,d),2):(b=g.max(b,Aa(c,"::before"),Aa(c,"::after")),1)},!1)),b+1}function Ca(a,b){a.style.zIndex=Ba(b),"static"===Sa(a).position&&(a.style.position="relative")}function Da(a,c,d,e){var f=ha(V(e||d,h)||b),g=T(d||c,"left right")||"left",i=T(d||c,"top bottom")||"top",j={};return c=(0|(a.top||a.clientY||a.y||c))-f.top,a=(0|(a.left||a.clientX||a.x||a))-f.left,j[g]=("left"===g?a:f.width-a)+"px",j[i]=("top"===i?c:f.height-c)+"px",j[La[g]]="auto",j[La[i]]="auto",j}function Ea(a,b){var c=Da(a,null,b);return c.width=(0|a.width)+"px",c.height=(0|a.height)+"px",c}function Fa(a,b,d,e){Z(Ua,a)||c.body.appendChild(a),$(a).css({position:"fixed",maxWidth:"",maxHeight:""});var f=q(b)||!b?{}:ha(b);"left"in f||(f.left=f.right=0|(b.left||b.clientX||b.x),f.top=f.bottom=0|(b.right||b.clientY||b.y));var h=T(d,"inset-x inset-y inset")||"inset-x",i="inset"===h?f:ha(e),j=ha(a,!0),k={},l={},m={transform:""},n=function(a,b,c,d,e,h){if(m[e]=i[d]+k[c]-k[La[c]],!La[a]){var n=(f[La[c]]+f[c])/2;return a=n-i[c]<j[d]/2?c:i[La[c]]-n<j[d]/2?La[c]:"",a||(m.transform+=" "+h),l[c]=a?i[a]:n+k[c],a}var o=b?La[a]:a;if(f[a]*Ma[o]+j[d]<=i[o]*Ma[o])l[c]=f[a]+k[La[o]];else{if(!(f[La[a]]*Ma[o]-j[d]>i[La[o]]*Ma[o]))return l[c]=i[a],m[e]=b?m[e]:g.abs(f[a]-l[c])-Ma[a]*k[a],a;a=La[a],l[c]=f[a]+k[o]}return b||(a=La[a]),m[e]=g.abs(i[La[a]]-l[c]),a},o=ha(a);Ra(La).forEach(function(a){k[a]=j[a]-o[a]});var p=T(d,"left right center")||"left",s=T(d,"top bottom center")||"bottom",t=n(p,La[s]&&"inset-x"===h,"left","width","maxWidth","translateX(-50%)"),u=n(s,La[p]&&"inset-y"===h,"top","height","maxHeight","translateY(-50%)");$(a).css(r(m,Da(l,t+" "+u)))}function Ga(a){var b={};return t(a,function(c,d){b[d]=a[d]}),b}function Ha(a,b){return/\b(?:[+-]?(\d+(?:\.\d+)?)(px|%)?|#[0-9a-f]{3,}|(rgba?|hsla?|matrix|calc)\(.+\))\b/.test(a)&&(b||!k.$1||k.$2)}function Ia(a){return a.replace(/^-(webkit|moz|ms|o)-/,"")}function Ja(a,b,c){if(xa(a,b))return A();c=c||m,!0===c&&(c=ya.bind(null,a,b,!1)),ya(a,b,!0);var d=E(sa(a,1,function(a){var b=Sa(a);return"0s"!==b.transitionDuration||"none"!=b.animationName}));if(!d[0])return c(),Ta();ya(a,b,!1),$(d).css("transition","none"),ya(a,b,!0);var e=d.map(function(a){return Ga(Sa(a))});ya(a,b,!1);var f=new o.Map;if(t(d,function(a,b){var c=Sa(b),d={};t(c,function(b,f){var g=c[f],h=e[a][f];if(g!==h){var i=Ia(f),j=T(f,"opacity line-height");if("animation-name"===i){var k=g.replace(/,/g,"");t(h.split(/,\s*/),function(a,b){"none"===b||T(k,b)||(d["@"+b]=!0)})}else Ha(g,j)&&Ha(h,j)&&!/^scroll-limit/.test(i)&&(d[i]=!0)}}),Ra(d)[0]&&f.set(b,d)}),$(d).css("transition",""),ya(a,b,!0),!f.size)return c(),Ta();var g=$.Deferred(),h=ua(a,"animationend transitionend",function(d){var e=f.get(d.target)||{};if(delete e[d.propertyName?Ia(d.propertyName):"@"+d.animationName],!Ra(e)[0]&&f.delete(d.target)&&!f.size){var i=xa(a,b);h(),i&&c(),g[i?"resolve":"reject"](a)}});return g.promise()}function Ka(a,b,c,d){var e=this;e.left=a,e.top=b,e.right=c,e.bottom=d}var La={top:"bottom",left:"right",right:"left",bottom:"top"},Ma={top:-1,left:-1,right:1,bottom:1},Na=c.msElementsFromPoint||c.elementsFromPoint,Oa=c.compareDocumentPosition,Pa=i.prototype.compareBoundaryPoints,Qa=d.defineProperty,Ra=d.keys,Sa=b.getComputedStyle,Ta=a.when,Ua=c.documentElement,Va=b.getSelection(),Wa={},Xa=$('<div style="position:fixed; top:0; left:0;">')[0];K(Ka,{get width(){return this.right-this.left},get height(){return this.bottom-this.top},get centerX(){return(this.left+this.right)/2},get centerY(){return(this.top+this.bottom)/2},collapse:function(a,b){var c=this,d=c[a]+(b||0);return"left"===a||"right"===a?ja(d,c.top,d,c.bottom):ja(c.left,d,c.right,d)},translate:function(a,b){var c=this;return ja(c.left+a,c.top+b,c.right+a,c.bottom+b)}});var Ya={IS_IOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!b.MSStream,IS_IE10:!!b.ActiveXObject,IS_IE:!!b.ActiveXObject||void 0!==Ua.style.msTouchAction||void 0!==Ua.style.msUserSelect,IS_MAC:navigator.userAgent.indexOf("Macintosh")>=0,IS_TOUCH:"ontouchstart"in b};Ya.shim={MutationObserver:o.MutationObserver,WeakMap:o.WeakMap,Map:o.Map,Set:o.Set},Ya.helper={extend:r,noop:m,isArray:n,isFunction:p,isPlainObject:q,each:t,map:u,any:v,single:w,kv:x,makeArray:y,iterate:D,iterateToArray:E,mapGet:G,createPrivateStore:F,getOwnPropertyDescriptors:H,defineGetterProperty:I,defineHiddenProperty:J,definePrototype:K,inherit:L,randomId:M,repeat:N,camel:O,hyphenate:P,ucfirst:Q,lcfirst:R,trim:S,matchWord:T,tagName:U,is:V,isVisible:za,sameElementSpec:W,comparePosition:X,connected:Y,containsOrEquals:Z,getCommonAncestor:_,createRange:ba,rangeCovers:da,rangeEquals:ea,rangeIntersects:ca,compareRangePosition:fa,makeSelection:ga,getRect:ha,getRects:ia,toPlainRect:ja,rectEquals:ka,rectCovers:la,pointInRect:ma,mergeRect:na,elementFromPoint:oa,createDocumentFragment:pa,createTextNode:qa,createElement:ra,createNodeIterator:sa,getState:xa,setState:ya,getZIndex:Aa,getZIndexOver:Ba,setZIndexOver:Ca,cssFromPoint:Da,cssFromRect:Ea,runCSSTransition:Ja,position:Fa,removeNode:wa,bind:ua,unbind:va,when:Ta,waitAll:z,reject:A,always:B},b.zeta=Ya}(),function(a,i){function j(a,b){return g.abs(g.round(a/b)-a/b)<.2}function k(a){return a.isContentEditable||va(a,"input,textarea,select")}function l(a){if(!qa(c,a))return!1;for(;a!==c&&"none"!==na(a).display;a=a.parentNode);return a===c}function p(a){for(var b=[];a&&a!==c&&b.push(a);a=a.parentNode||a.parent);return b}function q(){var a=(ca||b.event||"").type||"";return"k"===a[0]||"com"===a.substr(0,3)?"keyboard":"t"===a[0]?"touch":"m"===a[0]||Da(a,"wheel click dblclick contextmenu")?"mouse":Da(a,"drop cut copy paste")||"script"}function r(a){var b=aa||new J(Ka[0]),c=function(a){return function(){var c=aa;try{return aa=b,a.apply(this,arguments)}finally{aa=c}}};return{then:function(b,d){return a.then(b&&c(b),d&&c(d))},catch:function(b){return a.catch(b&&c(b))}}}function s(a){for(var b=a;b&&!Ia.has(b);b=b.parentNode);return Ca(Ia,b)||$}function t(a,d){return a===b?!ba:La.has(a)&&(!d||qa(a,c.activeElement))}function u(a){var b=Ba(p(a),function(a){return Ja.get(a)});return oa(Ka,function(c){return qa(c,a)||b.indexOf(c)>=0})}function v(b){return Fa(Ma,function(c,d){return a(c).find(b)[0]&&d})}function w(a,b,c,d,e,f){var g=new M(a,$,c,d,b,e,f);return g.emit(Z,"tap",s(c).element,!1)||g.emit()}function x(a,b,c,d,e){var f=null;return oa(Aa(c),function(c){var g=s(c);if(f!==g){if(f=g,w(a,b,c,d,e))return!0;if(d.char&&k(c))return w("textInput",b,c,d.char,!0)}})}function y(a,b,c,d){sa(b,function(b,e){Ia.has(e)&&w(a,null,e,{relatedTarget:c},!1,d)})}function z(b,d,e,f){if(d&&!va(b,fa)&&(b=a(fa,b).filter(":visible:not(:disabled,.disabled)")[0]||b),f=f||Ka,f[0]){var g=f!==Ka?b:u(b);if(!g){var h=v(b);b=t(h)?f[0]:h,g=u(b)}if(!g)return!1;var i=f.splice(0,f.indexOf(g));sa(i,function(a,b){La.delete(b)}),y("focusout",i,b,e)}if(qa(Ha,b)){var j=p(b).filter(function(a){return!La.has(a)}),k=Ba(j,function(a){return Ja.get(a)})[0];if(k&&!t(k)){var l=z(k);if(void 0!==l)return l&&z(b)}j[0]&&(f.unshift.apply(f,j),sa(j,function(a,b){La.add(b)}),y("focusin",j,null,e||new J(j[0],f)));var m=c.activeElement;return f[0]!==m&&(new F(f[0]).focus(),c.activeElement===m&&m.blur()),!0}}function A(a){for(var b;a!==Ha&&(b=na(a))&&"visible"===b.overflow&&Da(b.position,"static relative");a=a.parentNode);return a}function B(a,b){var c=A(a),d=new F(c),e=d.getUnobscuredRect(a);b=b||ua(a);var f=g.max(0,b.right-e.right)||g.min(b.left-e.left,0),h=g.max(0,b.bottom-e.bottom)||g.min(b.top-e.top,0),i=f||h?d.scrollBy(f,h):ha;if(c!==Ha){var j=B(c.parentNode,b.translate(i.x,i.y));j&&(i={x:i.x+j.x,y:i.y+j.y})}return!(!i.x&&!i.y)&&i}function C(a,c){if(ya(a)&&(c.to===b||ya(c.to))){var d=c.dir;if("auto"===d)if(c.to===b)d="center inset";else{var e=ua(),f=ua(A(c.to)),h=[e.height*(f.left-e.left),e.height*(e.right-f.right),e.width*(f.top-e.top),e.width*(e.bottom-f.bottom)];d="left right top bottom".split(" ")[h.indexOf(g.max.apply(null,h))]+" center"}ma.position(a,c.to,d)}}function D(a,b){var c=a.clientX-b.clientX,d=a.clientY-b.clientY;return{dx:c,dy:d,deg:g.atan2(d,c)/g.PI*180,length:g.sqrt(c*c+d*d)}}function E(c,d,e){function f(a){clearInterval(g),i(),j(),k[a?"resolve":"reject"]()}var g,i,j,k=a.Deferred(),l=c.touches||[c],m=l[0].clientX,n=l[0].clientY,o=l[1]&&D(l[0],l[1]),p=wa(e||d)||ma.noop,q=A(va(d,h)||c.target),s={mouseup:f,touchend:f,keydown:function(a){27===a.which&&f(!1)},mousemove:function(a){a.preventDefault(),a.which||c.touches?a.clientX===m&&a.clientY===n||(m=a.clientX,n=a.clientY,p(m,n)):f(!0)},touchmove:function(a){var b=a.touches;if(o){var c=D(b[0],b[1]);p((c.deg-o.deg+540)%360-180,c.length/o.length,b[0].clientX-m+(o.dx-c.dx)/2,b[0].clientY-n+(o.dy-c.dy)/2)}else p(b[0].clientX,b[0].clientY)}},t={mouseout:function(a){g||qa(q,a.relatedTarget)&&(q!==Ha||a.relatedTarget!==Ha)||(g=setInterval(function(){B(q,ma.toPlainRect(m-50,n-50,m+50,n+50))?p(m,n):(clearInterval(g),g=null)},20))},mouseover:function(a){a.target!==Ha&&(clearInterval(g),g=null)}};return i=pa(b,s),j=pa(q,t),r(k)}function F(a){this.element=a}function G(a){(new F)[a]||(F.prototype[a]=function(){var b=this.support(a);return b?b.apply(null,arguments):console.warn("Method "+a+" not handled",this.element)})}function H(a){Pa.push(a),sa(a,function(a,b){wa(b)&&"canHandle"!==a&&"support"!==a&&G(a)})}function I(a,b){var c=(Ca(Ia,a)||"").context,d=c&&(wa(c[b])||wa(c.support)&&wa(c.support(b)));return d?d.bind(c):!!(d=Ca(Qa,a,function(){var b={};return sa(Pa,function(c,d){d.element&&!va(a,d.element)||d.canHandle&&!d.canHandle(a)||ta(b,d)}),b})[b])&&d.bind(a,a)}function J(a,b){var c=this;b=b||(aa?aa.path:Ka.slice(0)),c.path=b,c.source="script",(qa(b[0]||Ha,a)||b.indexOf(a)>=0)&&(c.source=aa?aa.source:q()),c.sourceKeyName="keyboard"!==c.source?null:(aa||_||"").sourceKeyName}function K(a,b,c,d){var e=ta(this,a.properties);e.eventName=b,e.type=b,e.context=c.context,e.target=qa(a.target,c.element)?c.element:a.target,e.data=null,e.context.typer&&(e.typer=e.context.typer,e.widget=e.context),xa(d)?ta(e,d):void 0!==d&&(e.data=d),Ua(e,a)}function L(a,b,c){var d=this,e={};sa(c,function(a,b){wa(b)&&(e[a]=b)}),d.element=a,d.context=b,d.handlers=e}function M(a,b,c,d,e,f,g){c=c||b.element,g=g||new J(c);var h={source:g.source,sourceKeyName:g.sourceKeyName,timestamp:performance.now(),originalEvent:e||null};ta(this,{container:b,eventName:a,target:c,data:d,bubbles:f,properties:h,sourceObj:g},h)}function N(){this.states={}}function O(a,b){var c=this;a&&Ia.set(a,c),c.element=a||Ha,c.context=b||null,c.components=new ka,c.asyncEvents=new ka,c.autoDestroy=qa(Ha,a),a&&Ia.set(a,c)}function P(a){for(a.timeout=null;a.asyncEvents.size;){var b=a.asyncEvents;a.asyncEvents=new ka,sa(b,function(a,b){sa(b,function(b,c){xa(a)&&!a.handlers[b]||c.emit(null,null,a)})}),sa(b,function(b,c){var d=Ca(a.components,b.element||b);d&&!d.attached&&a.components.delete(b.element||b)})}}function Q(a,b,c){var d=Ca(a.asyncEvents,c);if(d&&d[b]){var e=d[b].data;return delete d[b],e||{data:e}}}function R(a,b,c,e,f,g){var h=Ca(a.asyncEvents,c,d);h[b]=new M(b,a,c.element||c,g&&h[b]?g(h[b].data,e):e,null,f),a.timeout=a.timeout||m(P,null,a)}function S(a,b,c){var d=["destroy","init"];b.attached^c&&!Q(a,d[+!c],b)&&R(a,d[+c],b),b.attached=c}function T(a,b){return a===Z||(Ia.get(b)||a)===a}function U(a,b,c){function d(d){var e=[],g=new ka;sa(d,function(b,c){("id"!==c.attributeName||"sizzle"!==(c.oldValue||"").slice(0,6)&&c.target.id!==(c.oldValue||""))&&(qa(a.element,c.target)?T(a,c.target)&&(sa(c.removedNodes,function(a,b){g.has(b)&&e.push.apply(e,g.get(b))}),e.push(c)):Ca(g,c.target,f).push(c))}),e=e.filter(function(a){return c[a.type]}),e[0]&&b(e)}var e=ta({},c);e.subtree=!0,e.childList=!0,e.attributeOldValue|=c.attributes;var g=new ia(d);return g.observe(a.element,e),function(){d(g.takeRecords())}}function V(a,b){for(var c,d=b;d&&!c;d=d.parentNode)c=a.components.get(d);return c||null}function W(a,b,c){var d=Ca(a.components,b,N);if((d.context||c)!==c)throw new Error("Element has already been set to another context");return d.element=b,d.context=c,d}function X(a){this.element=a,Na.set(a,this),Ua(this,{promises:new ka})}function Y(a,b){var c;return function(){return c||(c=Ga(a()).then(b,function(){return c=null,Ea("user_cancelled")}))}}var Z,$,_,aa,ba,ca,da,ea=JSON.parse('{"8":"backspace","9":"tab","13":"enter","16":"shift","17":"ctrl","18":"alt","19":"pause","20":"capsLock","27":"escape","32":"space","33":"pageUp","34":"pageDown","35":"end","36":"home","37":"leftArrow","38":"upArrow","39":"rightArrow","40":"downArrow","45":"insert","46":"delete","48":"0","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","55":"7","56":"8","57":"9","65":"a","66":"b","67":"c","68":"d","69":"e","70":"f","71":"g","72":"h","73":"i","74":"j","75":"k","76":"l","77":"m","78":"n","79":"o","80":"p","81":"q","82":"r","83":"s","84":"t","85":"u","86":"v","87":"w","88":"x","89":"y","90":"z","91":"leftWindow","92":"rightWindowKey","93":"select","96":"numpad0","97":"numpad1","98":"numpad2","99":"numpad3","100":"numpad4","101":"numpad5","102":"numpad6","103":"numpad7","104":"numpad8","105":"numpad9","106":"multiply","107":"add","109":"subtract","110":"decimalPoint","111":"divide","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numLock","145":"scrollLock","186":"semiColon","187":"equalSign","188":"comma","189":"dash","190":"period","191":"forwardSlash","192":"backtick","219":"openBracket","220":"backSlash","221":"closeBracket","222":"singleQuote"}'),fa=":input, [contenteditable], a[href], area[href], iframe",ga=[16,17,18,91,93],ha={x:0,y:0},ia=o.MutationObserver,ja=o.WeakMap,ka=o.Map,la=o.Set,ma=i.helper,na=b.getComputedStyle,oa=ma.any,pa=ma.bind,qa=ma.containsOrEquals,ra=ma.definePrototype,sa=ma.each,ta=ma.extend,ua=ma.getRect,va=ma.is,wa=ma.isFunction,xa=ma.isPlainObject,ya=ma.isVisible,za=ma.kv,Aa=ma.makeArray,Ba=ma.map,Ca=ma.mapGet,Da=ma.matchWord,Ea=ma.reject,Fa=ma.single,Ga=ma.when,Ha=c.documentElement,Ia=new ja,Ja=new ja,Ka=[],La=new la,Ma=new ka,Na=new ja,Oa=new ka,Pa=[],Qa=new ja,Ra=new ja,Sa={},Ta={},Ua=ma.createPrivateStore();ra(F,{support:function(a){return I(this.element,a)}}),ra(K,{handled:function(a){var b=Ua(this);b.handled||(b.handled=Ga(a))},isHandled:function(){return!!Ua(this).handled},preventDefault:function(){var a=this.originalEvent;a?a.preventDefault():Ua(this).defaultPrevented=!0},isDefaultPrevented:function(){return!!(this.originalEvent||Ua(this)).defaultPrevented}}),ra(M,{emit:function(a,b,c,d){var e=this;a=a||e.container,d=void 0===d?e.bubbles:d;var f=function(b,c,d,g){if("init"===c||"destroy"===c){if(b.lastEvent===c)return!1;b.lastEvent=c}if(Da(c||d,"keystroke gesture")&&f(b,null,g.data,null))return e.handled;var h=b.handlers[c||d];if(!h)return!1;var i=va(b.context,O)||a,j=new K(e,d,b,void 0===g?Q(a,d,b):g),k=aa,l=i.event;i.event=j,aa=e.sourceObj;try{var m=h.call(j.context,j,j.context);void 0!==m&&(e.handled=Ga(m))}catch(a){console.error(a),e.handled=Ea(a)}return aa=k,i.event=l,e.handled};if(va(c,L))return f(c,b,e.eventName,e.data);var g=a.getContext(c||e.target);return Fa((d?p:Aa)(g),function(c){var d=a.components.get(c.element||c);return d&&Fa(d.states,function(a){return f(a,b,e.eventName,e.data)})})}}),ra(O,{event:null,tap:function(a){Z.setContext(this.element,this),Z.add(this.element,{tap:a})},getContext:function(a){return(V(this,a)||"").context},setContext:function(a,b){W(this,a,b),this!==Z&&va(a,h)&&Ia.set(a,this)},add:function(a,b,c){"string"!=typeof b&&(c=b,b=ma.randomId());var d=this,e=va(a,h)||a.element||a,f=va(e,h)?V(d,e):W(d,a,a);if(f){var g=f.states[b]||new L(e,va(a,h)?f.context:a,c);f.attached=!0,f.states[b]=g,S(d,g,!0)}},delete:function(a,b){var c=this,d=Ca(c.components,a);if(d)if(b){var e=d.states[b];e&&(delete d.states[b],S(c,e,!1))}else d.attached=!1,sa(d.states,function(a,b){S(c,b,!1)})},observe:function(a,b){return U(this,a,b)},emit:function(a,b,c,d){return(va(a,K)?Ua(a):new M(a,this,b,c,null,d)).emit(this,null,b,d)},emitAsync:function(a,b,c,d,e){R(this,a,b||this.element,c,d,e)},flushEvents:function(){P(this)},destroy:function(){var a=this;Z.delete(a.element),Ia.delete(a.element),sa(a.components,function(b,c){Ia.delete(b),a.emit("destroy",b)})}}),ra(X,{get locked(){return Ua(this).promises.size>0},cancel:function(a){var b=this,c=Ua(b),d=c.promises;return a||!d.size?(d.size&&w("cancelled",null,b.element),d.clear(),c.handler=null,c.deferred&&c.deferred.resolve(),Ga()):(c.handler||(c.handler=Y(function(){return Aa(d).reduce(function(a,b){return a.then(b)},Ga()).then(function(){b.cancel(!0)})})))()},wait:function(b,c){var d=this,e=Ua(d),f=e.promises,g=function(){f.delete(b)&&!f.size&&(w("asyncEnd",null,d.element),d.cancel(!0))};if(f.set(b,Y(!0===c?Ga:c||Ea,g)),1===f.size){e.deferred=a.Deferred();for(var h=d.element.parentNode;h&&!Na.has(h);h=h.parentNode);h&&Na.get(h).wait(e.deferred,d.cancel.bind(d)),w("asyncStart",null,d.element)}return b.catch(function(a){a&&!Ra.has(a)&&(w("error",null,d.element,{error:a},!0),"object"==typeof a&&Ra.set(a,!0)),g()}),b.then(function(a){var c=!f.has(b);return g(),c?Ea("user_cancelled"):a})}}),Z=new O,$=new O;var Va={drag:E,prepEventSource:r,scrollIntoView:B,focused:t,get event(){return ca},get activeElement(){return Ka[0]},get eventSource(){return q()},getEventSource:function(a){return new J(a).source},getContext:function(a){return s(a||Ka[0]).context},focus:function(a){z(a,!0)},setModal:function(a,b){var d=va(b,h)||Ha;t(d)||z(d),Ma.set(a,Ka.splice(0,d===Ha||c.body?Ka.length:Ka.indexOf(d))),z(a)},lock:function(a,b,c){var d=Na.get(a)||new X(a);return b?d.wait(b,c):Ga()},locked:function(a,b){return!!oa(b?p(a):[a],function(a){return(Na.get(a)||"").locked})},cancel:function(a,b){var c=Na.get(a);return c?c.cancel(b):Ga()},emit:function(a,b,c,d){return w(a,null,b,c,d)},on:function(a,b,c){va(a,h)||(c=b,b=a,a=Ha),$.setContext(a,a),$.add(a,xa(b)||za(b,c))},retainFocus:function(a,b){Ja.set(b,a)},releaseFocus:function(a,b){Ja.delete(b)},mixin:function(a){return va(a,h)?new F(a):H(a)},support:function(a,b){var c=s(Ka[0]);return Fa(Ka,function(d){return(!b||s(d)!==c)&&I(d,a)})},snap:function(a,d,e){d=d||Ha;var f={to:d,dir:e||"left bottom"};Oa.set(a,f),qa(Ha,a)||c.body.appendChild(a),ma.setZIndexOver(a,d===b?c.body:d),C(a,f)},unsnap:function(a){Oa.delete(a)},getShortcut:function(a){return Ta[a]?Ta[a].slice(0):[]},setShortcut:function(a,b){if(xa(a))return void sa(a,Va.setShortcut);var c=Ta[a]||(Ta[a]=[]),d=c.slice(0);sa(b,function(b,e){var f=d.indexOf(e);f>=0?d.splice(f,1):(c[c.length]=e,(Sa[e]||(Sa[e]={}))[a]=!0)}),sa(d,function(b,d){c.splice(c.indexOf(d),1),delete Sa[d][a]})}};i.Container=O,i.dom=Va,Va.setShortcut({undo:"ctrlZ",redo:"ctrlY ctrlShiftZ",selectAll:"ctrlA"}),Va.on("keystroke",function(a){var b=Fa(Sa[a.data],function(a,b){return Va.support(b)});return b&&a.handled(b())}),Va.on("escape",function(a){z(c.body)}),Va.lock(c),b.onbeforeunload=function(a){Va.locked(c)&&(a.returnValue="",a.preventDefault())},a(function(){function d(a,b){var c=(a.ctrlKey||a.metaKey?"Ctrl":"")+(a.altKey?"Alt":"")+(a.shiftKey?"Shift":"");return c?ma.lcfirst(c+ma.ucfirst(b)):b}function f(){var a=c.activeElement;if("selectionEnd"in a)G=a,H=a.selectionEnd;else if(G=K.anchorNode,H=K.anchorOffset,1===G.nodeType){var b=G.childNodes[H-1];b&&3===b.nodeType?(G=b,H=b.length):(G=G.childNodes[H],H=0)}}function h(a,b,c){var d={data:a,char:b};if(_.sourceKeyName=a,x("keystroke",c,Ka,d,!0))return c.preventDefault(),!0}function o(a,b){var c=B||b;return w(a,b,b.target,{target:b.target,clientX:c.clientX,clientY:c.clientY,metakey:d(b)})}function p(a,b){return B=null,x("gesture",b,Ka.slice(-1),a)}function q(a,b,d){var e=c.createEvent("MouseEvent");return e.initMouseEvent(a,d.bubbles,d.cancelable,d.view,d.detail,b.screenX,b.screenY,b.clientX,b.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,d.button,d.relatedTarget),ma.elementFromPoint(b.clientX,b.clientY).dispatchEvent(e)}function r(a){var b=function(a,b){var c=a.get(b);return a.delete(b),c};sa(a,function(a,c){sa(c.removedNodes,function(a,c){if(1===c.nodeType&&!qa(Ha,c)){var d=Ia.get(c);d&&d.autoDestroy&&d.element===c&&d.destroy();var e=b(Na,c);e&&e.cancel(!0);var f=b(Ma,c);if(f&&t(c)){var g=oa(Ma,function(a){return a.indexOf(c)>=0})||Ka;g.push.apply(g,f),z(f[0],!1,null,g)}var h=Ka.indexOf(c);h>=0&&z(Ka[h+1]||L),sa(Oa,function(a,b){(qa(c,a)||qa(c,b.to))&&Oa.delete(a)})}})}),v()}function v(){N=N||m(function(){N=null,sa(Oa,C)})}var y,A,B,E,F,G,H,I,K=b.getSelection(),L=c.body;i.IS_IE10&&pa(L,"mousedown mouseup mousemove mouseenter mouseleave click dblclick contextmenu wheel",function(a){"none"===na(a.target).pointerEvents&&(a.stopPropagation(),a.stopImmediatePropagation(),a.bubbles&&q(a.type,a,a)||a.preventDefault())},!0),pa(b,"mousedown mouseup wheel compositionstart compositionend beforeinput textInput keydown keyup keypress touchstart touchend cut copy paste drop click dblclick contextmenu",function(a){ca=a,m(function(){ca=null}),_=null,u(a.target)||(a.stopImmediatePropagation(),a.preventDefault(),Da(a.type,"touchstart mousedown keydown")&&w("focusreturn",null,Ka.slice(-1)[0])),_=new J(a.target)},!0),pa(Ha,{compositionstart:function(a){f(),I=""},compositionupdate:function(a){I=a.data},compositionend:function(a){var b="selectionEnd"in G,c=I,d=H;f();var e=G.value||G.data||"";(I=a.data)&&!/^\u3000+$/.test(I)||(I=e.slice(d,H));var g=H-I.length,h=H-c.length,i=H;e.slice(g,H)===I?i=g:e.slice(h,H)===c?i=h:e.substr(H,I.length)===I&&(H+=I.length);var j=e.substr(0,i)+e.slice(H);b?(G.value=j,G.setSelectionRange(i,i)):(G.data=j,ma.makeSelection(G,i)),x("textInput",a,Ka[0],I)||(b?(G.value=e,G.setSelectionRange(H,H)):(G.data=e,ma.makeSelection(G,H))),G=null,m(function(){I=null})},textInput:function(a){G||a.data!==I&&!x("textInput",a,Ka[0],a.data)||a.preventDefault()},keydown:function(a){if(!G){var b=a.keyCode,c=ga.indexOf(b)>=0;c&&b!==A&&x("metakeychange",a,Ka,d(a),!0);var e=!c&&(ea[b]||"").length>1&&!(b>=186||b>=96&&b<=111);y=a.ctrlKey+a.shiftKey+a.altKey+a.metaKey+!c,y*=e||(y>2||y>1&&!a.shiftKey)&&!c,A=b,y&&h(d(a,ea[b]||a.key),32===b?" ":"",a)}},keyup:function(a){var b=ga.indexOf(a.keyCode)>=0;G||!b&&A!==a.keyCode||(A=null,y--,b&&x("metakeychange",a,Ka,d(a)||"",!0))},keypress:function(a){var b=a.char||a.key||e.fromCharCode(a.charCode);G||y||!a.synthetic&&"onbeforeinput"in a.target||h(d(a,ea[A]||b),b,a)},beforeinput:function(a){if(!G&&a.cancelable)switch(a.inputType){case"insertText":return x("textInput",a,Ka[0],a.data);case"deleteContent":case"deleteContentBackward":return h("backspace","",a);case"deleteContentForward":return h("delete","",a)}},touchstart:function(a){B=ta({},a.touches[0]),a.touches[1]||(t(s(a.target).element)&&o("mousedown",a),F=m(function(){B&&(o("longPress",a),B=null)},1e3))},touchmove:function(a){if(n(F),F=null,B)if(a.touches[1])a.touches[2]||p("pinchZoom",a);else{var b=D(a.touches[0],B);b.length>50&&j(b.deg,90)&&p("swipe"+(j(b.deg,180)?b.dx>0?"Right":"Left":b.dy>0?"Bottom":"Top"),a)}},touchend:function(a){n(F),B&&F&&(z(a.target),o("click",a),q("click",B,a),a.preventDefault())},mousedown:function(a){z(a.target),1===(a.buttons||a.which)&&o("mousedown",a),B=a,E=c.activeElement},
mousemove:function(a){B&&D(a,B).length>5&&(B=null)},mouseup:function(a){E&&c.activeElement!==E&&E.focus()},wheel:function(a){if(qa(a.target,Ka[0])||!k(a.target)){var b=a.deltaY||a.detail;b&&x("mousewheel",a,a.target,b/g.abs(b)*(i.IS_MAC?-1:1),!0)&&a.preventDefault()}},click:function(a){!i.IS_TOUCH&&B&&o("click",a)},contextmenu:function(a){o("rightClick",a)},dblclick:function(a){o("dblclick",a)},focusin:function(a){ba=!1,u(a.target)?z(a.target,!1,_):a.target.blur()},focusout:function(a){if(!a.relatedTarget&&!l(a.target)){var b=oa(Ka.slice(Ka.indexOf(a.target)+1),l);b&&z(b,!1,_)}}},!0),pa(b,{wheel:function(a){for(var b=-a.deltaX,c=-a.deltaY,d=a.target;d!==L;d=d.parentNode){var e=na(d);if(d.scrollWidth>d.offsetWidth&&Da(e.overflowX,"auto scroll")&&(b>0&&d.scrollLeft>0||b<0&&d.scrollLeft+d.offsetWidth<d.scrollWidth))break;if(d.scrollHeight>d.offsetHeight&&Da(e.overflowY,"auto scroll")&&(c>0&&d.scrollTop>0||c<0&&d.scrollTop+d.offsetHeight<d.scrollHeight))break}u(d)||a.preventDefault()},blur:function(a){a.target===b&&(ba=!0)}}),new ia(r).observe(Ha,{subtree:!0,childList:!0}),z(c.activeElement);var M=a('<div style="overflow:scroll;height:80px"><div style="height:100px"></div></div>').appendTo(L);da=M.outerWidth()-M.children().width(),M.remove();var N;pa(b,"resize scroll orientationchange mousemove wheel keyup touchend transitionend",v,{passive:!0})}),"undo redo canUndo canRedo enable disable enabled".split(" ").forEach(G),H({focus:function(a){a.focus()},scrollBy:function(d,e,f){var g=d===Ha||d===c.body?b:d,h=a(g).scrollLeft(),i=a(g).scrollTop();return g.scrollBy?g.scrollBy(e,f):(g.scrollLeft=h+e,g.scrollTop=i+f),{x:a(g).scrollLeft()-h,y:a(g).scrollTop()-i}},getUnobscuredRect:function(a){var b=na(a),d=a.offsetWidth<a.scrollWidth,e=a.offsetHeight<a.scrollHeight,f=ua(a===c.body?Ha:a);return"visible"===b.overflow&&a!==c.body||!d&&!e||(("scroll"===b.overflowY||("hidden"!==b.overflowY||a===c.body)&&e)&&(f.right-=da),("scroll"===b.overflowX||("hidden"!==b.overflowX||a===c.body)&&d)&&(f.bottom-=da)),f}}),H({element:":input",getValue:function(a){return a.value},setValue:function(a,b){a.value=b}})}(a,zeta),function(a,f){function i(a,b){var c=this;qb(c,{}),c.typer=a,c.baseCaret=new t(a,c),c.extendCaret=new t(a,c),b&&c.select(b)}function p(a,b,c,d){var e=this;e.id=b,e.typer=a,e.element=c||a.element,e.options=d}function q(a,b,c,d){var e=this;e.typer=a,e.childNodes=[],e.nodeType=b,e.element=c,e.widget=d}function r(a,b,c){var d=this;d.whatToShow=b,d.filter=c||null,d.currentNode=a,d.root=a}function s(a,b,c){var d=this;d.whatToShow=b,d.filter=c||null,W(d,a)}function t(a,b){this.typer=a,this.selection=b||null}function u(a,b){return b=b||a.currentNode,b&&a.whatToShow&(Qa(a,r)?b.nodeType:1<<b.nodeType-1)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b):1:3}function v(a,b){return a[b<0?"previousNode":"nextNode"]()}function w(a){return e(a||"").replace(/[^\S\u00a0]+/g," ").replace(/\u200b/g,"")}function x(a){return a&&1===a.nodeType&&a}function y(a){return a&&3===a.nodeType&&a}function z(a){return"br"===$a(a)&&a}function A(a){return/^inline-?/.test(lb(a).display)&&a}function B(a,b){if(/[\S\u00a0]/.test(a.data))return!0;var c=function(a,b){for(;!a[b];)if(!(a=a.parentNode)||!A(a))return!1;return y(a[b])?B(a[b],b):A(a[b])};return c(a,b||"previousSibling")&&!b&&c(a,"nextSibling")}function C(a,b,c){var d=a.data;return!B(a)||(c>=0&&(b===a.length||d.slice(b)===ia)?1:c<=0&&(!b||d.slice(0,b)===ia)?-1:0)}function D(a,b){return!!fb.test(a)||!/[^\s!-\/:-@\[\]^_`{|}~]/.test(a)&&b}function E(a){var b=lb(x(a)||a.parentNode);return cb[b.getPropertyValue("writing-mode")]^("rtl"===b.direction?2:0)}function F(a,b){for(;a&&!Qa(a,b);a=a.parentNode);return Qa(a,ma)?a.typer.getNode(a.widget.element):a}function G(a,b){var c=a.length||a.childNodes.length;return 1/b<0?g.max(0,c+b):g.min(c,b)}function H(a,b){for(var c,d=new s(new r(a,xa),5),e=0;(c=d.nextNode())&&c!==b;e+=c.length||0);return e}function I(a,b){var c=b/g.abs(b);b/=c;var d=2&b?-1:1,e=4&b?-1:1;c>0&&1&b&&(d^=e,e^=d,d^=e);var f=d<0?"right":"left",h=e<0?"bottom":"top";return a=1&b?_a(a[h]*e,a[f]*d,a[bb[h]]*e,a[bb[f]]*d):_a(a[f]*d,a[h]*e,a[bb[f]]*d,a[bb[h]]*e)}function J(a,b){b=+b===b?b:E(b),a=+a===a?a:eb.indexOf(a);var c=a>>1&1^1&b?"left":"top";return!!(db[a>>1]&1<<b)^1&a?bb[c]:c}function K(a){if(kb.rangeCount){var b=kb.getRangeAt(0);return Ea(a,b.commonAncestorContainer)&&b}}function L(a,b){switch(b){case"uppercase":return a.toUpperCase();case"lowercase":return a.toLowerCase();case"capitalize":return a.replace(/\b(.)/g,function(a){return a.toUpperCase()})}return a}function M(a,b){a.data!==b&&(a.data=b)}function N(b,c){return Ma(c,function(c,d){b=a(d.cloneNode(!1)).append(b)[0]}),Qa(b,h)||Fa(b)}function O(b){var d=O.cache||(O.cache={}),e=lb(x(b)||b.parentNode),f=[e.fontFamily,e.fontWeight,e.fontStyle].join("|");if(!d[f]){var g=a('<div style="position:fixed;font-size:1000px;"><span style="display:inline-block;width:0;height:0;"></span>&nbsp;</div>').css({fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontStyle:e.fontStyle}).appendTo(c.body),h=g.children(),i=Oa(g[0]).top;d[f]={baseline:(Oa(h.css("vertical-align","baseline")[0]).top-i)/1e3,height:(Oa(h.css("vertical-align","text-bottom")[0]).top-i)/1e3,middle:(Oa(h.css("vertical-align","middle")[0]).top-i)/1e3,wsWidth:g.width()/1e3},g.remove()}var j=l(e.fontSize);return{fontSize:j,baseline:d[f].baseline*j,height:d[f].height*j,middle:d[f].middle*j,wsWidth:d[f].wsWidth*j}}function P(){var b=a.grep(arguments,Ra);return function(a){for(var c=1,d=0,e=b.length;d<e;d++){var f=b[d](a);if(2===f)return 2;c|=f}return c}}function Q(k,l){function o(a){this.widget=a||null}function u(){Z.emit("stateChange",U.focusNode.widget.element,null,!0)}function A(a,b,c){var d=_[a];return!(b in d)||"*"===d[b]||(" "+d[b]+" ").indexOf(" "+c+" ")>=0}function C(a,b){return b=F(b,ua),_[a]&&_[a].element&&(_[a].inline||!Qa(b,oa))&&A(a,"allowedIn",b.widget.id)&&A(b.widget.id,"allow",a)}function D(){return U.getWidgets().reverse().concat(aa)}function E(a){return Ca(D(),function(b){return _[b.id]&&Ra((_[b.id].commands||{})[a])})}function G(b,e){function g(){u=null,da&&I(),ba.snapshot()}function h(a,b){var c=new p(w,b,a,Na({},_[b].options));return a!==k&&Z.getContext(a)&&Z.delete(a),e&&(Z.setContext(a,c),Z.add(a,c.id,_[c.id])),c}function i(a,b){for(var c=a.childNodes,d=c.length;d&&Da(b.element,c[d-1].element)<=0;d--);if(c[d]!==b)return b.parentNode?l(b):Sa(new r(b,-1),function(a){var b=a.widget;ob.delete(a.element),b.element===a.element&&Z.add(a.element,b.id,_[b.id])}),c.splice(d,0,b),b.parentNode=a,b.previousSibling=c[d-1]||null,b.nextSibling=c[d+1]||null,(b.previousSibling||{}).nextSibling=b,(b.nextSibling||{}).previousSibling=b,!0}function l(a,b){var c=a.parentNode,d=a.previousSibling,e=a.nextSibling;c.childNodes.splice(c.childNodes.indexOf(a),1),(d||{}).nextSibling=e,(e||{}).previousSibling=d,a.parentNode=null,a.nextSibling=null,a.previousSibling=null,b&&Sa(new r(a,-1),function(a){ob.set(a.element,{node:(d||e||c).element,offset:!d&&(!!e||0)}),a.widget.element===a.element&&Z.delete(a.element)})}function n(a){var b=a.widget,c=a.parentNode,e=function(b){return Qa(a.element,_[b].element)&&b};if(a.widget=(b||"").element!==a.element?c.widget:b,!Qa(c,ma|ra)){var f=Ca(d.keys(_),e)||e(la);!f||a.widget!==c.widget&&a.widget.id===f||(a.widget=h(a.element,f))}b&&b!==a.widget&&Z.delete(a.element,b.id);var g=_[a.widget.id];a.widget!==c.widget||Qa(c,ma|ra)?Qa(a.element,g.editable)||g.inline&&!g.editable?a.nodeType=g.inline?sa:Qa(a.element,ha)?oa:na:a.nodeType=g.inline&&a.widget!==c.widget&&Qa(c,xa)?ra:ma:a.nodeType=Qa(a.element,ha)?pa:qa}function o(b,c){Ma(b.childNodes.slice(0),function(a,c){Ea(b,c)||l(c,!0)}),a(b.element).children().not("br").each(function(a,d){var e=A.get(d)||new q(w,0,d);A.set(d,e),(i(b,e)||c)&&(n(e),o(e,!0))})}function s(a){var c=U&&!ca,d=new za;Ma(a,function(a,e){var f=A.get(x(e.target)||e.target.parentNode);if(f){var g=Ea(b,e.target);!e.addedNodes[0]&&!e.removedNodes[0]||d.has(f)||(d.add(f),g&&o(f)),!c||!g||"style"===e.attributeName||e.attributeName&&e.target===b||(f.widget.id!==ka&&Z.emitAsync("contentChange",f.widget.element),Z.emitAsync("contentChange",k),da=!0)}}),d.size&&U&&$(function(){var a,b=U.getRange();d.forEach(function(c){a|=Wa(b,c.element)}),a&&U.select(U)}),da&&!ca&&(u=u||m(g))}function t(a){if(f.IS_IE10&&!Ea(c,b)?o(B,!0):V(),(y(a)||z(a))&&(a=a.parentNode||a),Ea(b,a)){var d=A.get(a);return Qa(d,ma)?A.get(d.widget.element):d}}var u,v={},w=Ea(k,b)?X:v,A=new ya;e&&(V=Z.observe(s,{childList:!0,attributes:!0,characterData:!0})),b.parentNode||(b=Qa(b,j)||Fa(b));var B=new q(w,Y,b,h(b,ka));return A.set(b,B),o(B),Na(v,{rootNode:B,getNode:t})}function H(a){for(var b=Ta(Ha(a,4));b[0];){for(var c="",d=[],e=0;++e<b.length&&b[e].previousSibling===b[e-1];);Ma(b.slice(0,e),function(a,b){B(b)&&(c+=b.data),d[a]=c.length}),c=c.replace(/(\s+)(\S?)/g,function(a,b,c,d){var e=c?b[2]?"  ":"":" ";return Aa.repeat(d?"  ":"  ",b.length).slice(0,b.length-e.length)+e+c}),Ma(b.splice(0,e),function(a,b){M(b,c.slice(d[a-1]||0,d[a]))})}}function I(){V(),da&&(ca=!0,Sa(new r(X.rootNode,xa|na|ta),function(b){var c=b.element;if(Qa(b,na))return b.firstChild?void a(c).contents().each(function(b,d){if(d.parentNode===c){for(var e=[];d&&(y(d)||z(d)||Qa(X.getNode(d),wa));d=d.nextSibling)(e.length||x(d)||ab(d.data))&&e.push(d);e.length&&a(e).wrap("<p>")}}):void a(c).html("<p>"+(ab(c.textContent)||ja)+"</p>");if(Qa(b,pa|oa)){if(!c.firstChild)return void a(Ja()).appendTo(c);var d=a(">br:last-child",c)[0];d&&!d.nextSibling&&(a(Ja()).insertBefore(d),Ya(d));var e=a(">br:first-child",c)[0];e&&!e.previousSibling&&Ya(e),(!U||U.startNode!==b&&U.endNode!==b)&&Ma(Ta(Ha(c,4)),function(a,b){M(b,w(b.data)||ia),y(b.nextSibling)&&(b.nextSibling.data=w(b.data+b.nextSibling.data),Ya(b))})}!Qa(b,qa)||U&&(U.startElement===c||U.endElement===c)||ab(c.textContent)||Ya(c),a(">br",c).each(function(b,c){y(c.nextSibling)||a(Ja()).insertAfter(c)})}),a('br[type="_moz"]',k).remove(),V(),ca=!1,da=!1,U&&U.select(U))}function J(b,c,d){var e="cut"===c?"extractContents":"paste"===c?"deleteContents":"cloneContents",f="paste"!==c,g="copy"!==c,h=Fa(),l=Qa(b,i)?b.clone():new i(X,b),m=U.timestamp;if(b=l.getRange(),!l.isCaret){var n=[[k,h]],o=function(){var a=n.shift();a[2]&&a[2].element===a[0]&&Z.emit("extract",a[2].element,{extractedNode:a[1]})};for(Sa(l.createTreeWalker(-1,function(c){var d=c.element,h=Qa(c,ma|na|oa)&&_[c.widget.id].extract,i=c.widget.element===d;if((!h||c===l.focusNode)&&!i&&Qa(c,na))return 3;for(;!Ea(n[0][0],d);)o();if(!h||i&&Va(b,d)||(i?a(d):a(d).parentsUntil(n[0][0]).addBack()).each(function(a,b){n.unshift([b,b.cloneNode(!1),c.widget]),n[1][1].appendChild(n[0][1])}),Va(b,d)){var k=d===n[0][0],m=g?d:d.cloneNode(!0);return g&&!k&&Qa(c,oa)&&(m=a(d.cloneNode(!1)).append(d.childNodes[0])),a(n[0][1]).append(k?m.childNodes:m),2}if(Qa(c,xa)){var p=Ia(d,b)[e](),q=Qa(p,j)?p.firstChild:p,r=Qa(q,$a(d)),s=!h;return f&&q&&(!r&&s?p=N(p,[Qa(c,oa)?Ga("p"):d]):r&&!s&&(p=Fa(q.childNodes)),a(n[0][1]).append(p)),2}return 1}));n[0];o());}if(g){if(U.timestamp!==m?l=U:l.direction>0?l.select(b):(l.select(Ia(b,!1)),l.extendCaret.moveTo(Ia(b,!0))),!l.isSingleEditable){var p=l.createTreeWalker(ua,function(a){return _[a.widget.id].textFlow?1:3}),q=F(l.baseCaret.node,ua),r=F(l.extendCaret.node,ua);for(p.currentNode=q;v(p,l.direction););p.currentNode!==r&&(p.currentNode!==q?l.extendCaret.moveTo(p.currentNode.element,0*-l.direction):l.collapse())}U.select(l)}return Ra(d)&&d(l),a(h).find("[style]").removeAttr("style"),I(),h}function O(b,c){var d;Qa(c,h)?(Ea(k,c)&&Ya(c),c=Aa.makeArray(Fa(c).childNodes),d=1===c.length&&!!Qa(c[0],"p:not([class])")):(c=a(e(c||"").replace(/\u000d/g,"").replace(/</g,"&lt;").replace(/\n{2,}/g,"</p><p>").replace(/\n/g,"<br>").replace(/.*/,"<p>$&</p>").replace(/\s/g," ")).get(),d=!0),J(b,"paste",function(b){var e,f=b.startNode,g=b.endNode,h=b.getCaret("start").clone(),i=Ia(F(f,ua).element,0),j=!!Qa(f,oa),k=!!Qa(f,xa),l=!0,m=[],n=X.getNode(b.startElement);if(Qa(n,wa)){for(;n!==f;n=n.parentNode)Qa(n,qa)&&m.push(n.element);m.push(f.element)}else Qa(n,pa)?m[0]=f.element:Qa(n,oa)||(m[0]=Ga("p"));if(Ma(c,function(b,g){var n,o=X.getNode(h.element),p=new q(X,d?pa:qa,g),r=!!z(g),s=!1,t=!1;if(!r&&x(g)&&(i.insertNode(g),p=X.getNode(g),Ya(g),p.widget!==o.widget))for(var u=o;Qa(u,wa|pa)||Qa(u,oa)&&u===o;u=u.parentNode){if(1===c.length&&p.widget.id===u.widget.id){var v={receivedNode:g,caret:h.clone()};if(Z.emit("receive",u.widget.element,v))return h=U.clone(),void(e=!0)}if(!C(p.widget.id,u)){var y=p.widget.id===la?w(ab(g.textContent)):P(g);if(!y)return;g=Ja(y),p=new q(X,qa,g);break}}if(!Qa(o,ua)){if(r){for(s=!Qa(o,pa);Qa(o.parentNode,wa);o=o.parentNode);n=Ia(o.element,!1)}else Qa(p,wa)||(o=F(o,pa)||o,n=Ia(o.element,!1),Qa(p,pa)?(t=!d&&!j&&Qa(o,pa)&&!Za(p.element,o.element)&&!!ab(g.textContent),s=!l||t&&!!ab(Ia(Ia(o.element,!0),Ia(h))),l=!t,k=k&&l):ab(Ia(Ia(o.element,!0),Ia(h)))&&((s=ab(Ia(n,Ia(h))))||(o=o.nextSibling||o.parentNode,h.moveTo(n))));if(s){var A=Ia(Ia(h),n).extractContents();ab(A.textContent)||(A=Fa(N(Ja(),m)));var B=A.firstChild;n.insertNode(A);for(var D=X.getNode(B);D&&!ab(D.element.textContent);D=D.firstChild)if(Qa(D,ra|sa)){a(D.element.childNodes).insertBefore(D.element),Ya(D.element);break}if(Qa(o,xa)&&!(o.element.firstChild||"").length&&a(Ja()).appendTo(o.element),ab(o.element.textContent)&&" "===o.element.textContent.slice(-1)&&H(o.element),ab(B.textContent)&&" "===B.textContent.charAt(0)&&H(B),r)return Ia(B,!0).insertNode(g),void h.moveTo(B,0);o=X.getNode(B),h.moveTo(B,0),e=!0}}if(k=k&&!!Qa(p,xa|wa)){var E=Aa.makeArray(l&&!Qa(p,wa)?g.childNodes:g);E[0]&&(h.getRange().insertNode(Fa(E)),H(o.element),h.moveTo(E[E.length-1],-0)),l=j}else Qa(p,wa)&&(g=N(g,m)),(e||!Qa(f,ma)||ab(g.textContent))&&(Qa(o,ua)&&!Qa(o.parentNode,ua)?a(g).appendTo(o.element):a(g).insertBefore(o.element),k=!!Qa(p,xa|wa),l=t||!k,h.moveTo(g,!l&&-0)),e=!0}),!e&&f!==g)if(P(f.element)){if(Qa(f,pa)&&Qa(g,pa)){var o=Fa(Ia(g.element,"contents").extractContents()),p=o.firstChild;for(h.moveTo(f.element,-0),Ia(f.element,-0).insertNode(o),Ya(g.element);x(p)&&Za(p,p.previousSibling);){var r=p;p=a(p.childNodes).appendTo(p.previousSibling)[0],Ya(r)}H(f.element)}}else h.moveTo(g.element,!Qa(g,xa)||0),Ya(f.element);U.select(h)})}function P(b){var c,d,e=Ia(b||k,"contents");Qa(b,h)&&!Aa.connected(k,b)?(d=G(b),c=new s(new r(d.rootNode,-1),5)):c=new s((Qa(b,i)||new i(X,e)).createTreeWalker(-1),5,function(a){return Wa(e,Ia(a,"contents"))?1:2});var f,g,j,l="",m="";return Sa(c,function(b){var c=(d||X).getNode(b);if(j=_[c.widget.id].text,c!==f&&(f&&(l+=L(m,g),m="",Qa(f,va)&&Qa(c,va)&&"\n\n"!==l.slice(-2)&&(l+="\n\n"),c.widget!==f.widget&&j&&(l+=j(c.widget))),f=c,g=a.css(c.element,"text-transform")),Qa(c,xa)&&!j)if(y(b)){var h=b.data;b===e.endContainer&&(h=h.slice(0,e.endOffset)),b===e.startContainer&&(h=h.slice(e.startOffset)),m+=h.replace(/\u200b/g,"").replace(" "," ")}else z(b)&&(m+="\n")}),l+=j?j(f.widget):L(m,g),ab(l).replace(/\u00a0/g," ")}function R(a){W=a,ea.attr("contenteditable",a?"true":null),!a&&K(k)&&k.blur()}function S(a,b,c){_[a]=Na({},b),_[a].options=!c||Aa.isPlainObject(c)?Na({},b.options,c):c}function T(a){var b=new p(X,a,k,_[a].options);Z.add(b,a,_[a]),aa.push(b)}Qa(k,h)||(l=k,k=k.element),l=Na(!0,{},(!l||!1!==l.defaultOptions)&&Q.defaultOptions,l);var U,V,W,X=this,Y=l.inline||Qa(k,ha)?oa:na,Z=new f.Container(k,X),_={},aa=[],ba={},ca=!0,da=!0,ea=a(k);!function(){function a(a){for(var b=[],c=a.node;c.parentNode;c=c.parentNode)b.unshift(c.parentNode.childNodes.indexOf(c));return b[b.length]=a.textNode?a.wholeTextOffset:a.offset,b.join(" ")}function b(a,b){var c=b.split(" "),d=k,e=c.splice(-1)[0];c.forEach(function(a){d=d.children[+a]}),isNaN(e)?a.moveTo(d,"true"===e):a.moveToText(d,+e)}function c(){var b=ba.getValue();f[0]&&b===f[h].value||(f.splice(0,h,{value:b}),f.splice(X.historyLevel),h=0),f[h].basePos=a(U.baseCaret),f[h].extendPos=a(U.extendCaret),f[h].html=k.innerHTML,u(),n(e)}function d(a){ea.html(a.html),b(U,a.basePos),b(U.extendCaret,a.extendPos),u(),n(e)}var e,f=[],h=0,i=0;Na(ba,{getValue:function(){return ab(k.innerHTML.replace(/\s+style(?:="[^"]*")?|\u200b+(?!<\/)|(^|[^>])\u200b+/g,"$1"))},canUndo:function(){return h<f.length-1},canRedo:function(){return h>0},undo:function(){ba.canUndo()&&d(f[++h])},redo:function(){ba.canRedo()&&d(f[--h])},snapshot:function(a){var b=+new Date;n(e),!0===a?c():(i=g.max(i,b+(a||0)),e=m(c,i-b))}})}(),function(){Ma(l.widgets,function(a,b){S(a,b,l[a])}),Ma(Q.widgets,function(a,b){l[a]&&S(a,b,l[a])}),Ka(_,ka,l),Ka(_,la,{element:l.disallowedElement||":not("+ha+",br,b,em,i,u,strike,small,strong,sub,sup,ins,del,mark,span)",allowedIn:""}),l.textFlow=!0,Na(X,G(k,!0)),Ma(_,function(a,b){b.element&&b.element!==k?Ra(b.setup)&&Z.add(new p(X,a,k),a,{init:b.setup}):T(a)})}(),function(){function c(a){return U.isCaret?U.extendCaret.moveByCharacter("backspace"===a.data?-1:1)?(O(U,""),!0):void 0:(O(U,""),!0)}function d(a){if(U.startTextNode&&U.isCaret){if(a){var b=U.startTextNode,c=U.startOffset;b.data=b.data.substr(0,c)+a+b.data.slice(c),H(U.startNode.element),U.moveToText(b,c+a.length),ba.snapshot(200)}}else O(U,a)}function e(b){var c=U.focusNode.widget,d="*"!==_[c.id].disallowedElement,e=b.getData(f.IS_IE?"Text":i);if(d&&a.inArray(h,b.types)>=0){var g=Fa(a(b.getData(j)).filter("#Typer").contents());O(U,g)}else d&&e===mb.textContent?O(U,mb.htmlContent.cloneNode(!0)):Ba.emit("textInput",c.element,e,!1)}function g(c){var d=c.clipboardData||b.clipboardData,e=P(U),g=J(U,c.type);f.IS_IE?d.setData("Text",e):(d.setData(i,e),d.setData(j,a('<div id="Typer">').append(g.cloneNode(!0))[0].outerHTML),d.setData(h,"true")),mb.textContent=e,mb.htmlContent=g,c.preventDefault()}var h="application/x-typer",i="text/plain",j="text/html",l={compositionstart:function(){ca=!0,nb=X,Z.emitAsync("stateChange")},compositionend:function(){ca=!1,nb=!1,U.focus(),Z.emitAsync("stateChange")},cut:g,copy:g,paste:function(a){if(e(a.clipboardData||b.clipboardData),a.preventDefault(),f.IS_IE){var c=U.clone();m(function(){U.select(c)})}},drop:function(a){U.moveToPoint(a.clientX,a.clientY)&&e(a.dataTransfer),U.focus(),a.preventDefault()},dragstart:function(a){a.preventDefault()}};Z.add(k,{destroy:Aa.bind(k,l)});var n={backspace:c,delete:c,enter:function(){return Qa(U.startNode,oa)?X.invoke("insertLineBreak"):(X.invoke("insertLine")||O(U,"\n\n"),!0)},upArrow:function(){return X.invoke("stepUp")},downArrow:function(){return X.invoke("stepDown")},mousewheel:function(a){return X.invoke(a.data<0?"stepUp":"stepDown")},textInput:function(a){return d(a.data),!0}};Ma({moveByLine:"upArrow downArrow shiftUpArrow shiftDownArrow",moveByWord:"ctrlLeftArrow ctrlRightArrow ctrlShiftLeftArrow ctrlShiftRightArrow",moveToLineEnd:"home end shiftHome shiftEnd",moveByCharacter:"leftArrow rightArrow shiftLeftArrow shiftRightArrow"},function(a,b){Ma(b,function(b,c){var d=1&b?1:-1,e=!!(2&b),f=n[c];n[c]=function(){if(f&&f())return!0;e||U.isCaret?(e?U.extendCaret:U)[a](d):U.collapse(d<0?"start":"end")}})});var o={keystroke:function(a){/ctrl(?=[acfnprstvwx]|f5|shift[nt]$)|^((shift)?tab|f5|f12)$/i.test(a.data)||a.preventDefault()},textInput:function(a){ca=!1},mousedown:function(a){("shift"===a.metakey?U.extendCaret:U).moveToPoint(a.clientX,a.clientY),U.focus(),Ba.drag(a,function(a,b){ba.snapshot(200),U.extendCaret.moveToPoint(a,b)}),m(function(){U.focus()})},click:function(a){var b=X.getNode(a.target);Qa(b,ma|ra)&&U.select(b.widget.element),U.focus()},dblclick:function(a){U.select("word")},rightClick:function(a){var b=new t(X);b.moveToPoint(a.clientX,a.clientY),!U.isCaret&&Wa(U,b)||U.select(b)}};Z.tap(function(a){var b=a.eventName,c=U.focusNode.element;if(W){if(Aa.matchWord(b,"focusin focusout focusreturn")){if(a.target!==k)return;c=k}else"rightClick"===b?c=k:"click"===b&&(c=a.target);(o[b]||Ua)(a),(Z.emit(a,c)||(n["keystroke"===b?a.data:b]||Ua)(a))&&a.handled(),a.originalEvent&&a.isHandled()&&a.preventDefault()}})}(),R(!0),f.IS_IOS&&ea.css("-webkit-user-modify","read-write-plaintext-only"),Na(X,ba,{element:k,on:function(a,b){Z.add(k,Aa.isPlainObject(a)||Aa.kv(a,b))},enabled:function(){return W},enable:function(a,b){a?_[a]||!Q.widgets[a]||Q.widgets[a].element||(S(a,Q.widgets[a],b),T(a)):(R(!0),Z.emitAsync("stateChange"))},disable:function(){R(!1),Z.emitAsync("stateChange")},destroy:function(){R(!1),Z.destroy()},hasCommand:function(a){return!!E(a)},widgetEnabled:function(a){return!!_[a]},widgetAllowed:function(a,b){return b=Qa(b,q)||X.getNode(b||k),!!C(a,b)},getWidgetOption:function(a,b){return _[a]&&_[a][b]},getStaticWidget:function(a){return Ca(aa,function(b){return b.id===a})},getStaticWidgets:function(){return aa.slice(0)},getSelection:function(){return U},extractText:function(a){return P(a)},invoke:function(a,b){var c=new o;return"string"==typeof a&&(c.commandName=a,c.widget=E(a),a=c.widget&&_[c.widget.id].commands[a]),!!Ra(a)&&(a.call(X,c,b),I(),ba.snapshot(),X.focused(!0)&&U.focus(),!0)}}),La(o,{typer:X,get selection(){return U},insertText:function(a){O(U,a)},insertHtml:function(a){O(U,Qa(a,h)||Fa(a))},insertWidget:function(a,b){var c=(_[a]||"").create;Ra(c)&&c.call(X,this,b)},removeWidget:function(a){var b=_[a.id].remove;if(Ra(b))b.call(X,new o(a));else if("keepText"===b){var c=P(a.element);O(Ia(a.element,!0),c),Ya(a.element)}else O(Ia(a.element),"")}}),I(),U=new i(X,Ia(k,0)),Z.emit("init")}function R(a,b){return b&&(a.whatToShow&ta||b.element.offsetWidth>0||b.element.offsetHeight>0)&&b}function S(a,b,c){return c&&b!==a.root&&!R(a,b)?2:Qa(b,ma)&&Qa(b.parentNode,ma)?3:u(a,b)}function T(a,b,c){if(S.returnValue=S(a,b,c),1===S.returnValue)return a.currentNode=b,!0}function U(a,b,c){for(var d=a.currentNode[b];d;){if(T(a,d,!0))return d;if(3===S.returnValue&&d[b])d=d[b];else{for(;!d[c];)if(!(d=R(a,d.parentNode))||d===a.root||d===a.currentNode)return null;d=d[c]}}}function V(a,b,c){for(var d=a.currentNode;d&&d!==a.root;){for(var e=d[c];e;){if(T(a,e))return e;e=2!==S.returnValue&&e[b]?e[b]:e[c]}if(!(d=R(a,d.parentNode))||d===a.root||1===S(a,d,!0))return null}}function W(a,b){var d=b.currentNode.typer,e=c.createTreeWalker(b.root.element,1|a.whatToShow,function(c){var e=d.getNode(c);return e.element===c||Qa(e,xa)?T(b,e,!0)?1|u(a,c):S.returnValue:3},!1);Ka(a,"iterator",e)}function X(a,b,c){var d=Ia(a),e=qb(a).proxy,f=function(a){return Wa(a.element,d)?1:2};return new r(a.focusNode,b&~ta,P(f,e&&e.acceptNode&&e.acceptNode.bind(e),c))}function Y(a){var b=new s(X(a,xa),4);return b.currentNode=a.startTextNode||a.startElement,a.startOffset===(a.startTextNode||"").length&&b.nextNode(),Ta(b,null,null,function(b){return Da(b,a.endTextNode||a.endElement)<=(0!==a.endOffset?0:-1)})}function Z(a){var b=a.getCaret("start"),c=a.getCaret("end");c.textNode&&!C(c.textNode,c.offset,1)&&c.textNode.splitText(c.offset),b.textNode&&!C(b.textNode,b.offset,-1)&&da(b,b.node,b.element,b.textNode.splitText(b.offset),0)}function $(a,b,c){return $.executing=!0,$.run(a,b,c)}function _(a){if($.executing)return void pb.add(a);var b=qb(a);b.m=0,b.proxy=null,a.timestamp=performance.now(),a.direction=Aa.compareRangePosition(a.extendCaret,a.baseCaret)||0,a.isCaret=!a.direction;for(var c=0,d=a.getCaret("start"),e=a.getCaret("end");c<4;c++)a[_.NAMES[c+4]]=d[_.NAMES[c]],a[_.NAMES[c+8]]=e[_.NAMES[c]];var f=a.typer.getNode(Aa.getCommonAncestor(a.baseCaret.element,a.extendCaret.element));a.focusNode=F(f,ma|ra|ua|sa),a===a.typer.getSelection()&&(a.typer.focused(!0)&&a.focus(),a.typer.snapshot())}function aa(a,b,c){var d=new s(new r(b||a.typer.rootNode,xa|ma|ra),4|c);return d.currentNode=a.textNode||a.element,d}function ba(a,b){return a.selection?$(b,null,a):b.call(a)}function ca(a){var b=a.typer.element,c=a.element,d=a.textNode;if(!Ea(b,d||c)||d&&(d.parentNode!==c||a.offset>d.length)){var e;if(d&&Ea(b,d)&&a.offset<=d.length)e=a.moveTo(d,a.offset);else if(Ea(b,a.node.element))e=a.moveToText(a.node.element,a.wholeTextOffset)||a.moveTo(a.node.element,0);else{var f={node:c};for(a.typer.getNode(c);!Ea(b,f.node)&&ob.has(f.node);f=ob.get(f.node));e=a.moveTo(f.node,f.offset)}e||a.moveTo(b,0)}return a}function da(a,b,c,d,e,f){var g=[a.node,a.element,a.textNode,a.offset],h=g[0]!==b||g[1]!==c||g[2]!==d||g[3]!==e;return a.node=b,a.element=c,a.textNode=d||null,a.offset=e,a.wholeTextOffset=(d?a.offset:0)+H(b,d||c),a.beforeSoftBreak=!!f,h&&a.selection&&_(a.selection),h}function ea(b,c,d,e){for(var f,g;x(c)&&c.lastChild;)g=d===c.childNodes.length,c=c.childNodes[d-g],d=g?(c.data||c.childNodes).length||0:0;var h=b.typer.getNode(c);if(Qa(h,ma|ra))c=h.widget.element,c!==h.element&&(h=b.typer.getNode(c)),Qa(h.parentNode,xa)?(f=y(g?c.nextSibling:c.previousSibling)||a(Ja())[g?"insertAfter":"insertBefore"](c)[0],c=f.parentNode,d=g?0:f.length,h=h.parentNode):f=null;else if(Qa(h,xa))f=z(c)?y(c.nextSibling)||a(Ja()).insertAfter(c)[0]:y(c);else{var i=Ca(h.childNodes,function(a){return Da(c,a.element)<0});h=i||h.lastChild||h,f=null,g=!i}if(b.selection&&b===b.selection.extendCaret&&Qa(h.previousSibling,ma)===b.selection.baseCaret.node&&(h=h.previousSibling,f=null,g=!0),!f&&Qa(h,xa)){for(var j=new s(new r(h,xa),4);j.nextNode()&&g;);f=y(j.currentNode)||a(Ja())[g?"appendTo":"prependTo"](h.element)[0],d=f&&g?f.length:0}if(f&&!e){for(var k=function(c,e,g,h){var i=C(f,d,c)&&x(f[e]);if(i&&!z(i)&&Qa(b.typer.getNode(i),xa))return f=y(i[g])||a(Ja())[h](i)[0],d=G(f,0*c),!0};k(-1,"previousSibling","lastChild","appendTo")||k(1,"nextSibling","firstChild","prependTo"););f.length||(f.data=ia,d=1)}return da(b,F(h,va),f?f.parentNode:h.element,f,f?d:!g,e)}function fa(b,d,e,f){var g=E(b),h=d===b.length||!!e&&d>0,i=!!(2&g),j=b.data.charAt(d-h);if(D(j)!==i&&"override"!==a.css(b.parentNode,"unicode-bidi").slice(-8)){for(var l=b.parentNode;"inline"===a.css(l,"display")&&"isolate"!==a.css(l,"unicode-bidi").slice(0,7);l=l.parentNode);if((i?gb:fb).test(l.textContent)){var m=function(b,d,e){var f=c.createTreeWalker(l,5,function(b){if(x(b)&&!z(b)){if("inline"!==a.css(b,"display")||Qa(b,"audio,canvas,embed,iframe,img,input,object,video"))return 2;switch(a.css(b,"unicode-bidi")){case"normal":case"plaintext":return 3;case"isolate":case"isolate-override":return 2}}return 1},!1);for(f.currentNode=b;y(b);){for(;d!==G(b,0*-e);)if(d+=e,/(\S)/.test(b.data.charAt(d)))return D(k.$1,i);b=v(f,e),d=e>0?-1:(b||"").length}return!b||z(b)?i:"rtl"===a.css(b,"direction")},n=m(b,d-h,-1),o=m(b,d-h,1),p=n===o&&/\s/.test(j)?n:D(j,i);h||p===i||n!==i||(h=!0,p=n),g=-3&g|(p?2:0)}}var q=Pa(Ia(b,d-h,b,d+!h))[0]||_a(0,0);return f&&h&&/\s/.test(b.data.charAt(d-h))&&!I(q,g).width&&(q[J(3,g)]+=O(b).wsWidth),q.collapse(J(2|h,g))}function ga(b,c,d,e,f){function h(b){var c=q.indexOf(b);if(c>=0)return t[c];for(var d=lb(b),e=b;"inline"===a.css(e,"display");e=e.parentNode);var f=t[q.push(b)-1]=O(b);return f.lineHeight="px"===d.lineHeight.slice(-2)?l(d.lineHeight):("normal"===d.lineHeight?1.15:d.lineHeight)*f.fontSize,f.verticalAlign=d.verticalAlign,f.baselineOffset=f.baseline-f.height+i(b,e),f}function i(a,b){if(a===b)return 0;if(a.parentNode!==b)return i(a,a.parentNode)+i(a.parentNode,b);var c=h(a);switch(c.verticalAlign){case"baseline":return 0;case"middle":var d=h(a.parentNode);return-c.height/2+(d.baseline-d.middle);case"top":case"bottom":return NaN;case"text-top":return(c.lineHeight-c.height)/2;case"text-bottom":return(c.lineHeight+c.height)/2-h(a.parentNode).height;case"sub":return-.21*c.fontSize;case"super":return.34*c.fontSize}return isNaN(c.verticalAlign)?l(c.verticalAlign)/100*c.lineHeight:+c.verticalAlign||0}function j(a){var b,f;e?(f=e>0?a.right:a.left,b=(f-d.left)*e):(b=g.min(0,a.right-d.left)||g.max(0,a.left-d.left),f=d.left+b),(e?b>u:g.abs(b)<g.abs(u))&&(u=b,c=a.node,n=I(_a(f,a.centerY),-p))}function m(a,b,c,e,f){var i,k=new s(new r(a,xa),4),l=c>0?"bottom":"top",m=d,n=[];if(y(b))k.currentNode=b;else{for(;k.nextNode()&&c<0;);if(b=k.currentNode,!y(b))return m[l]}do{var o=h(b.parentNode),q=Pa(b);c<0&&q.reverse();for(var t=0,u=q.length;t<u;t++){var w=I(q[t],p),x=o.lineHeight-w.height>>1,z=_a(w.left,w.top-x,w.right,w.bottom+x),A=w.bottom+o.baselineOffset,B=!1;if(z.node=b,!(void 0===i&&z[l]*c<m[bb[l]]*c)){if(isNaN(i)||g.abs(A-i)<1||z.top<m.bottom&&z.bottom>m.top)B=!0;else if(isNaN(A))if(o.verticalAlign===bb[l])B=z[bb[l]]*c<=m[l]*c;else{if(!n[0]||z[l]===n[0][l]){n.push(z);continue}var C=n.splice(0,n.length,z);C[0][l]===m[l]&&C.forEach(j)}if(void 0!==i&&isNaN(A)||(i=A),!B&&!--e||i*c>f*c)return m[l];m=Aa.mergeRect(m,z),1===e&&(n.splice(0).forEach(j),j(z))}}}while(b=v(k,c));return m[l]}var n,o=F(b.typer.getNode(c),va),p=E(c),q=[],t=[],u=-1/0;if(d=I(_a(d.centerX,d.centerY),p),b.softPoint&&(d.left=d.right=I(b.softPoint,p).left),f){var w=m(b.typer.rootNode,c,f,2),x=f>0?"bottom":"top",z=new r(b.typer.rootNode,va);for(z.currentNode=o;o=v(z,f);){var A=I(Oa(o.element),p);if(!(Ea(o.element,c)||A[bb[x]]*f<=d[x]*f)&&(!n||A[x]*f<w*f))return ea(b,o.element,0)}}else{var B=!e&&d.top>I(Oa(o.element),p).bottom;m(o,c,(e||1)*(2&p?-1:1)*(B?-1:1),1)}if(n){var C=e>0||u<0,D=function(b,c,d,e){function f(a){var f=I(fa(b,a,e),d);return(f.centerY-c.centerY|0)*(1/0)||f.left-c.left|0}var h=0,i=b.length;if("override"!==a.css(b.parentNode,"unicode-bidi").slice(-8)&&(2&d?gb:fb).test(b.data)){var j,l=2&d?[gb,hb]:[fb,ib],m=0;for(i=-1;!j&&l[1&++m].test(b.data.slice(i+1));)h=g.max(0,i),i=b.data.indexOf(k.$1,i+1),j=Ca(Pa(Ia(b,h,b,i)),function(a){return a.top<=c.top&&a.bottom>=c.top&&a.left<=c.left&&a.right>=c.left});d^=1&m?2:0,j||(i=b.length)}for(c=I(c,d);i-h>1;){var n=i+h>>1,o=f(n)<=0;h=o?n:h,i=o?i:n}return g.abs(f(h))<g.abs(f(i))?h:i}(c,n,p,C);return b.softPoint=f?I(_a(d.left,I(n,p).centerY),-p):null,ea(b,c,D,C)}return!1}var ha="h1,h2,h3,h4,h5,h6,p,q,blockquote,pre,code,li,caption,figcaption,summary,dt,th",ia="​",ja="&#8203;",ka="__root__",la="__unknown__",ma=1,na=2,oa=32,pa=4,qa=16,ra=64,sa=128,ta=8192,ua=na|oa,va=ma|pa|ua,wa=qa|ra|sa,xa=pa|oa|qa|sa,ya=o.WeakMap,za=o.Set,Aa=f.helper,Ba=f.dom,Ca=Aa.any,Da=Aa.comparePosition,Ea=Aa.containsOrEquals,Fa=Aa.createDocumentFragment,Ga=Aa.createElement,Ha=Aa.createNodeIterator,Ia=Aa.createRange,Ja=Aa.createTextNode,Ka=Aa.defineHiddenProperty,La=Aa.definePrototype,Ma=Aa.each,Na=Aa.extend,Oa=Aa.getRect,Pa=Aa.getRects,Qa=Aa.is,Ra=Aa.isFunction,Sa=Aa.iterate,Ta=Aa.iterateToArray,Ua=Aa.noop,Va=Aa.rangeCovers,Wa=Aa.rangeIntersects,Xa=Aa.rectEquals,Ya=Aa.removeNode,Za=Aa.sameElementSpec,$a=Aa.tagName,_a=Aa.toPlainRect,ab=Aa.trim,bb={top:"bottom",left:"right",right:"left",bottom:"top"},cb={"horizontal-tb":0,"vertical-rl":5,"vertical-lr":1,"sideways-rl":5,"sideways-lr":11,lr:0,rl:0,tb:5,"lr-tb":0,"lr-bt":4,"rl-tb":0,"rl-bt":4,"tb-rl":5,"bt-rl":5,"tb-lr":1,"bt-lr":1},db=[240,3276,1450,3840],eb="block-start block-end inline-start inline-end over under line-left line-right".split(" "),fb=new k("([֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),gb=new k("([^\\s֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),hb=new k("(\\s|[֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),ib=new k("(\\s|[^֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),jb=/[\u200b\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f\udc00-\udcff\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u08d4-\u08e1\u08e3-\u08ff\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u3099\u309a]/,kb=b.getSelection(),lb=b.getComputedStyle,mb={},nb=null,ob=new ya,pb=new za,qb=Aa.createPrivateStore();if(Na(Q,{NODE_WIDGET:ma,NODE_PARAGRAPH:pa,NODE_EDITABLE:na,NODE_EDITABLE_PARAGRAPH:oa,NODE_INLINE:qa,NODE_INLINE_WIDGET:ra,NODE_INLINE_EDITABLE:sa,NODE_ANY_ALLOWTEXT:xa,NODE_ANY_BLOCK_EDITABLE:ua,NODE_ANY_INLINE:wa,ZWSP:ia,ZWSP_ENTITIY:ja,defaultOptions:{},widgets:{}}),f.Editor=Q,La(Q,{historyLevel:100,closest:F,getAbstractSide:J,createCaret:function(a,b){var c=new t(this);return a&&c.moveTo(a,b),c},createSelection:function(a,b,c,d){return new i(this,Ia(a,b,c,d))},createTreeWalker:function(a,b,c){return new r(a||this.rootNode,b,c)},nodeFromPoint:function(a,b,c){var d=Aa.elementFromPoint(a,b,this.element);if(d){var e=this.getNode(d);if(Qa(e,na)){var f=E(d),g=I(_a(a,b),f);e=Ca(e.childNodes,function(a){var b=I(Oa(a.element,!0),f);return b.top<=g.top&&b.bottom>=g.top})||e}return F(e,c||-1)}},
hasContent:function(){return this===nb||(!!ab(this.element.textContent).length||!!new r(this.rootNode,~(pa|qa)).nextNode())},setValue:function(a){this.invoke(function(b){Fa(b.typer.element.childNodes),b.insertHtml(a)})},validate:function(){return!0},select:function(a,b,c,d){return this.getSelection().select(a,b,c,d)},selectAll:function(){return this.getSelection().selectAll()},focus:function(){this.getSelection().focus()},focused:function(a){return Ba.focused(this.element,a)},retainFocus:function(a){Ba.retainFocus(this.element,a)},releaseFocus:function(a){Ba.releaseFocus(this.element,a)},support:function(a){return this.hasCommand(a)&&this.invoke.bind(this,a)}}),La(p,{get parent(){var a=this.element&&this.typer.getNode(this.element.parentNode);return a&&a.widget}}),La(q,{get firstChild(){return this.childNodes[0]||null},get lastChild(){var a=this.childNodes;return a[a.length-1]||null}}),La(r,{previousSibling:function(){return V(this,"lastChild","previousSibling")},nextSibling:function(){return V(this,"firstChild","nextSibling")},firstChild:function(){return U(this,"firstChild","nextSibling")},lastChild:function(){return U(this,"lastChild","previousSibling")},parentNode:function(){for(var a=this.currentNode;a&&a!==this.root;a=a.parentNode)if(T(this,a.parentNode,!0))return a.parentNode},previousNode:function(){for(var a=this,b=a.currentNode;b&&b!==a.root;){for(var c=b.previousSibling;c;c=b.previousSibling){b=c;for(var d=S(a,c);2!==d&&R(a,b.firstChild);)b=b.lastChild,d=S(a,b,!0);if(1===d)return a.currentNode=b,b}if(!(b=R(a,b.parentNode))||b===a.root)return null;if(T(a,b,!0))return b}},nextNode:function(){for(var a=this,b=1,c=a.currentNode;c;){for(;2!==b&&c.firstChild;){if(c=c.firstChild,T(a,c,!0))return c;b=S.returnValue}for(;c&&c!==a.root&&!c.nextSibling;)c=R(a,c.parentNode);if(!c||c===a.root)return null;if(c=c.nextSibling,T(a,c,!0))return c;b=S.returnValue}}}),La(s,{get currentNode(){return this.iterator.currentNode},set currentNode(a){this.iterator.currentNode=a},previousNode:function(){return this.iterator.previousNode()},nextNode:function(){return this.iterator.nextNode()}}),$.run=function(a){var b=0;return function(c,d,e){try{return b++,c.apply(e||this,d)}finally{0==--b&&a()}}}(function(){$.executing=!1,pb.forEach(_),pb.clear()}),_.NAMES="node element textNode offset startNode startElement startTextNode startOffset endNode endElement endTextNode endOffset".split(" "),La(i,{get isSingleEditable(){return this.isCaret||!X(this,ua).nextNode()},getCaret:function(a){var b=this.baseCaret,c=this.extendCaret;switch(a){case"extend":return c;case"start":return this.direction<0?c:b;case"end":return this.direction<0?b:c;default:return b}},getRange:function(a){var b=this.baseCaret,c=this.extendCaret;return void 0!==a||this.isCaret?(!1!==a?b:c).getRange():Ia(b.getRange(),c.getRange())},getRects:function(){var a=this,b=qb(a).proxy;if(b&&b.getRects)return b.getRects();if(a.isCaret)return[Oa(a.baseCaret)];if(Qa(a.startNode,ma)===a.focusNode)return[Oa(a.startNode)];var c=a.getRange(),d=[];return Sa(X(a,-1,function(a){if(Va(c,a.element))return d[d.length]=Oa(a),2;if(Qa(a,xa)){var b=J("inline-start",a.element),e=[];return Ma(Pa(Ia(c,Ia(a.element,"contents"))),function(a,c){g.abs(c[b]-c[bb[b]])<=1&&(c[bb[b]]+=5),Ma(e,function(a,b){g.abs(c.left-b.right)<=1&&(b.right=c.left),g.abs(c.top-b.bottom)<=1&&(b.bottom=c.top)}),e[e.length]=c}),d.push.apply(d,e),2}return 1})),d},getWidget:function(a){return Ca(this.getWidgets(),function(b){return b.id===a})},getWidgets:function(){for(var a=[],b=this.focusNode;b.widget.id!==ka;b=b.parentNode)a.unshift(b.widget),b=this.typer.getNode(b.widget.element);return a},getParagraphElements:function(){var a=this;return a.startNode===a.endNode?Qa(a.startNode,pa)?[a.startNode.element]:[]:Ta(X(a,pa),function(a){return a.element})},getSelectedElements:function(){var b=this;return b.isCaret?[b.startElement]:a(Y(b)).parent().get()},getSelectedText:function(){return this.typer.extractText(this)},getSelectedTextNodes:function(){var a=this;return a.isCaret?[]:(Z(a),Y(a))},createTreeWalker:function(a,b){return X(this,a,b)},collapse:function(a){return a=this.getCaret(a),(a===this.baseCaret?this.extendCaret:this.baseCaret).moveTo(a)},select:function(a,b,c,d){var e,f=this;return $(function(){if("word"===a)e=f.getCaret("start").moveByWord(-1)+f.getCaret("end").moveByWord(1)>0;else{var g=Ia(a,b,c,d);e=f.baseCaret.moveTo(g,!0)+f.extendCaret.moveTo(g,!1)>0}}),a.acceptNode&&(qb(f).proxy=a),e},selectAll:function(){return this.select(this.typer.element,"contents")},focus:function(){var a=this,b=a.typer.element;f.IS_TOUCH&&c.activeElement!==b&&!(Ba.event||"").isTrusted||Ea(c,b)&&a.typer.enabled()&&nb!==a.typer&&(Aa.makeSelection(a.baseCaret.getRange(),a.extendCaret.getRange()),c.activeElement!==b&&b.focus(),Ba.scrollIntoView(b,a.extendCaret.getRect()))},clone:function(){var a=this,b=new i(a.typer);return $(function(){b.baseCaret.moveTo(a.baseCaret),b.extendCaret.moveTo(a.extendCaret)}),qb(b).proxy=qb(a).proxy,b},widgetAllowed:function(a){return this.typer.widgetAllowed(a,this.focusNode)}}),Ma("moveTo moveToPoint moveToText moveByLine moveToLineEnd moveByWord moveByCharacter",function(a,b){Ka(i.prototype,b,function(){var a=this;return $(function(){return t.prototype[b].apply(a.baseCaret,arguments)+a.collapse("base")>0},arguments)})}),Ma("getWidgets getParagraphElements getSelectedElements getSelectedText getSelectedTextNodes",function(a,b){var c=i.prototype[b];i.prototype[b]=function(){var d=qb(this);return d.m&1<<a||(d[b]=c.apply(this),d.m|=1<<a),Aa.isArray(d[b])?d[b].slice(0):d[b]}}),La(t,{getRect:function(){var a=ca(this);if(!a.textNode){return Oa(a.element).collapse(J(2|!a.offset,E(a.element)))}return fa(a.textNode,a.offset,a.beforeSoftBreak,!0)},getRange:function(){var a=ca(this),b=a.textNode||a.element,c=a.offset;return b===a.typer.element?Ia(b,c?0:-0):Ia(b,c)},clone:function(){var a=ca(this);return Na(new t(a.typer),a)},moveTo:function(a,b){if(Qa(a,t))return ca(a),da(this,a.node,a.element,a.textNode,a.offset,a.beforeSoftBreak);var c=Ia(a,b);return!(!c||!Ea(this.typer.element,c.startContainer))&&ea(this,c.startContainer,c.startOffset)},moveToPoint:function(a,b){var c=this;return ga(c,(c.typer.nodeFromPoint(a,b)||c.typer.rootNode).element,_a(a,b))},moveToText:function(a,b){if(3!==a.nodeType){var c=new s(new r(this.typer.getNode(a),xa),4);if(1/b>0)for(;b>=0&&c.nextNode();b-=c.currentNode.length);else for(;c.nextNode(););a=c.currentNode,b=a&&g.min(b+a.length,a.length)}return!!y(a)&&ea(this,a,G(a,b))},moveToLineEnd:function(a){var b=ca(this);return ga(b,b.textNode||b.element,b.getRect(),a,0)},moveByLine:function(a){var b=this;return ga(b,b.textNode||b.element,b.getRect(),0,a)||b.moveToLineEnd(a)},moveByWord:function(a){var b,c=this,d=c.textNode,e=a<0?/\b(\S*\s+|\S+)$/:/^(\s+\S*|\S+)\b/,f="";if(d&&(f=a<0?d.data.substr(0,c.offset):d.data.slice(c.offset),(b=e.test(f))&&k.$1.length!==f.length))return c.moveToText(d,c.offset+a*k.$1.length);for(var g=aa(c,c.node),h=g.currentNode,i=b&&k.$1.length;d=v(g,a);){if(f=a<0?d.data+f:f+d.data,(b=e.test(f))&&k.$1.length!==f.length)return k.$1.length===i?c.moveToText(h,0*-a):c.moveToText(d,a*(k.$1.length-(f.length-d.length)));h=d,i=k.$1.length}return!(!b||!d&&!i)&&c.moveToText(d||h,0*-a)},moveByCharacter:function(a){for(var b=this,c=E(b.element),d=I(Oa(b),c),e=aa(b,null,5),f=y(e.currentNode),g=b.offset,h=!1;;){if(!f||g===G(f,0*-a)){for(;!(f=v(e,a))||!f.length||!B(f);){if(!f)return!1;if(Qa(b.typer.getNode(f),ma|ra)&&!Ea(f,b.element))return b.moveToText(f,0*a)||b.moveTo(f,a<0);h|=!!z(f)}g=(a<0?f.length:0)+((h||!Ea(b.node.element,f))&&-a)}if(g+=a,!jb.test(f.data.charAt(g))){var i=I(fa(f,g),c);if(!Xa(d,i))return ea(b,f,g,a>0&&d.centerY!==i.centerY)}}}}),Ma("moveByLine moveByWord moveByCharacter",function(a,b){var c=t.prototype[b];t.prototype[b]=function(a){var b=ca(this);return ba(b,function(){for(var d=a;d&&c.call(b,a/g.abs(a));d+=d>0?-1:1);return!a||d!==a})}}),!f.IS_IE){try{c.designMode="on",c.execCommand("enableObjectResizing",!1,!1),c.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}c.designMode="off"}setInterval(function(){var a=Qa(Ba.getContext(),Q);if(a&&!nb&&Ba.focused(b)){var c=a.getSelection(),d=K(a.element);d&&!Aa.rangeEquals(d,Ia(c))&&(c.select(d),c.focus())}},100)}(a,zeta),function(a,g){function i(a,b){return Xa(b,function(b,c){a[b]=c}),a}function j(a){return Ma.eval('"'+a+'"')}function l(a,b){Xa(a.attributes,function(a,c){b(c.nodeName,c.value,c)})}function n(a,b,c){return a[b]||(a[b]=new c)}function p(a,b,c,e){if(ab(c))return Xa(c,p.bind(null,a,b));n(a,c,d)[b||"default"]=e}function q(a,b){return a=a.templates||ub,b=b.templates,b&&b!==ub?Za(a,b):a}function r(a,b,c,d){var e=bb("globals",c);return d?Ma.eval(a.slice(2,-2),b,e):Ma(a,b,e)}function s(a,b){for(;a;a=a.parent){var c=wb(a).values;if(b in c)return c[b]}return vb[b]}function t(a,b,c){c&&!L(a)||(b(a),Xa(a.controls,function(a,d){t(d,b,c)}))}function u(a,b,c,d){return wb(a).container.emit(b,a.element||a,c,d)}function v(a,b,c,d,e){return wb(a).container.emitAsync(b,a.element||a,c,d,e)}function w(a,b){if(v(a,"stateChange"),b)for(var c=a.parent;c&&c.requireChildControls;c=c.parent)I(c),v(c,"stateChange")}function x(a,b,c,d){v(a,"propertyChange",{oldValues:bb(b,c),newValues:bb(b,d)},!1,function(a,b){return b.oldValues=i(b.oldValues,a.oldValues),b.newValues=i(a.newValues,b.newValues),b}),Xa(wb(a).values,function(c,d){c!==b&&$a(d,z)&&d.needEvaluate&&d.getValue(a,c,!0)}),I(a),w(a,!0)}function y(a,b){var c=Ka(a),d={};if(b){var e=function(b){d[b]=a[b]},f=wb(a);La(a).forEach(e),La(f.options).forEach(e),Ya(d,f.values),d.value=f.value}else Ya(d,a);return Xa(d,function(b,e){b in c||eb(b,Da)||Ua(d,b,function(){return C(c,b),a[b]})}),d}function z(a,b,c,d,e,f){var g=this;g.rawValue=c,g.displayValue=d,g.lastValue=d,g.needEvaluate=e,g.getValue(a,b,f)}function A(a,b){var c=a.toolset.labels;if(b in c)return A.value=e(c[b][xb.language]||c[b].default||""),!0}function B(a,b,c,d){if("string"==typeof c){var e=wb(a),f="icon"!==b&&(A(e.container,c)||A(e,c))?A.value:c,g=Fa.test(f);if(f!==c||g)return new z(a,b,c,f,g,d)}return c}function C(a,b){b in a||eb(b,Da)||(Ua(a,b,function(){var a=this,c=Ja.call(vb,b)?s(a,b):wb(a).values[b];return $a(c,z)?c.lastValue:c},function(a){var c=this,d=wb(c).values,e=$a(d[b],z);if(a!==d[b]&&(!e||a!==e.rawValue)){var f=Ja.call(vb,b),g=e?e.lastValue:d[b];!f||null!==a&&void 0!==a?d[b]=B(c,b,a):delete d[b];var h=c[b];if(wb(c).inited&&(x(c,b,g,h),f)){var i=function(a){Xa(a.controls,function(a,c){b in wb(c).values||(x(c,b,g,h),i(c))})};i(c)}}}),Xa(db(ob,a),function(a,c){wb(c).values[b]=B(c,b,c[b]),delete c[b];var d=wb(c).initialValues;d[b]=b in d?B(c,b,d[b],!1):void 0}))}function D(a,b,c){var d=wb(a);if(!d.inited)return d.value=b,!0;var e=d.value;if(e===b)return!1;var f=d.container.event;return f&&"setValue"===f.type&&f.context===a||!u(a,"setValue",{oldValue:e,newValue:b})?(d.value=b,c||(x(a,"value",e,b),(a.errors||a.validateOnSetValue)&&E(a)),!0):d.value!==e}function E(a){var b;if(L(a)&&(b=a.required&&!a.value?ib("required"):u(a,"validate")),b)return b.then(function(){a.errors=null},function(b){if(ab(b))a.errors=b;else{var c={};Xa(cb(b),function(a,b){c[b]=b}),a.errors=c}}),b;a.errors=null}function F(a){var b=!Aa&&!eb(Oa.getEventSource(a.element),"script touch"),c=Aa||b&&(Aa=[]),d=[];if(wb(a).container.flushEvents(),t(a,function(a){var b=E(a);b&&(b.catch(function(){c&&!Pa(c,function(b){return Sa(a.element,b)})&&c.push(a.element)}),d.push(b))},!0),b&&(Aa=null),d[0]){var e=Na.waitAll(d);return e.catch(function(){b&&!Pa(c,function(a){return Oa.focused(a)})&&(c.sort(Na.comparePosition),Oa.focus(c[0]))}),e}}function G(a){var b=wb(a),c=b.initialValues;Xa(La(a),function(b,d){eb(d,Da)||(c[d]=a[d])}),i(c,b.values),Va(c,"value",b.value)}function H(a){var b=wb(a),c=b.initialValues;a.errors=null,b.flag=1,c&&(Xa(c,function(c,d){(c in b.values?b.values:a)[c]=d}),D(a,c.value,!0)),u(a,"reset"),w(a)}function I(a,b){wb(a).flag&=255,b&&[L,M,N].forEach(function(c,d){return b&1<<d&&c(a)})}function J(a,b,c){var d=wb(a),e=d.flag,f=(e&b)>0;return(d.flag|=b<<8)!==e&&f^!!c(d)?(d.flag^=b,w(a,!0),!f):f}function K(a,b,c){wb(a)[Ea[b>>1]]=c,I(a,b)}function L(a){return J(a,1,function(b){return!(O(a)||b.position&&!b.position.enabled)&&(!(a.requireChildControls&&(!a.controls.some(L)||a.controls.every(N)))&&(!1!==b.enabled&&!1!==(b.options.enabled||fb).call(a,a)))})}function M(a){return J(a,2,function(b){return b.active||(b.options.active||fb).call(a,a)})}function N(a){return J(a,4,function(b){var c=a.hiddenWhenDisabled;return O(a)||!L(a)&&(c||!1!==c&&a.parent&&a.parent.hideDisabledChild)||!1===b.visible||!1===(b.options.visible||fb).call(a,a)})}function O(a){return J(a,8,function(b){return b.toolsetState&&(!1===L(b.toolsetState)||a.realm&&!b.toolsetState[a.realm])})}function P(b,e,g,h){function i(a,b,c,d){n(s,a,f).push({type:d||"text",name:c||"",expression:b})}function m(a){var b;return a.value=a.value.replace(/([\w-]+)\:(\{\{(?:[^\}]|\}(?!\}))+\}\})/g,function(c,d,e){return b=!0,i(r,e,d,a.nodeName),""}),b}function o(a,b){return Na.single(b,function(b,c){return Ja.call(a,c)&&c})}function p(b,c){var f=h===b?Ka(e):e,g=f[b]||"<div><children controls/></div>",i=a.parseHTML(g)[0];a("children",i).each(function(b,d){var e=Ta(d.attributes.controls&&!c.childNodes[0]?[Na.createElement("controls")]:c.cloneNode(!0).childNodes),f=a("controls",e);l(d,function(a,b){f.attr(a,b)}),a(d).replaceWith(e)}),g=i.outerHTML;for(var n=e,p=e;p;p=Ka(p)){var q=db(pb,p,d)[g];if(q){n=o(e,q.roles)?e:p;break}}var u=P(g,e,n,V.prototype[b]?b:h),v=u.dom.cloneNode(!0),w=a("controls",v),x={};return l(c,function(b,c,d){if("class"===b)m(d),a(v).addClass(d.value);else{var e=Fa.test(c)&&k.$1;x[Ra(b)]=e?{expression:c,evalAsObject:e.length===c.length-4}:j(c),e||w.attr(b,c)}}),Xa(u.binds,function(a,b){var c=+a+r;s[c]=b.concat(s[c]||[]),s[c].context=Ya({},b.context,x)}),t[b]=r,Xa(u.roles,function(a,b){t[a]=+b+r}),r+=u.nodeCount,v}var q=db(pb,g||e,d)[b];if(q)return q;var r=0,s={},t={};s[0]=[];var u={dom:function(b){var d=new Ha,e=c.createTreeWalker(b,5,function(a){return/z\:([\w-]+)/.test(mb(a))?(d.set(a,p(Ra(k.$1),a)),2):1},!1);return Na.iterate(e,function(b){1===b.nodeType?("controls"!==mb(b)||a(b).attr("layout")||b.setAttribute("layout",h),l(b,function(a,c,d){!Fa.test(c)||eb(a,"class style")&&m(d)||(i(r,c,a,eb(a,Ca)&&a in b?"prop":"attr"),d.value="")}),r++):Fa.test(b.data)&&(b.previousSibling||b.nextSibling?(i(r,b.data),d.set(b,c.createElement("span")),r++):i(r-1,b.data),b.data="")}),d.forEach(function(b,c){a(c).replaceWith(b)}),b.childNodes[0]}(Ta(a.parseHTML(b)[0])),roles:Ma.eval("sortby [ . ]",t),binds:s,nodeCount:r};g=g||e;do{db(pb,g,d)[b]=u}while(g!==ub&&!o(g,t)&&(g=Ka(g)));return u}function Q(b){var c=b.element,d=wb(b).position;1===d.count?d.start=d.end=a(d.placeholder).insertBefore(c)[0]:d.start===c?d.start=c.nextSibling:d.end===c&&(d.end=c.previousSibling),d.count--,jb(c)}function R(b,c,d){var e,f=wb(b),g=wb(c).dom.positions,h=f.position,i=f.dom;if(g[0]){var j=y(b);e=Pa(g,function(a){return!a.condition||Ma.eval(a.condition,j)}),I(b)}else e=new aa(c),e.layoutType=c.type,a(e.placeholder).appendTo(c.element),g[0]=e;if(h!==e){var k=i;if(i&&Q(b),!i||e&&(i||"").layoutType!==e.layoutType){var l=e.layoutType,m=f.allDOM||(f.allDOM={});k=m[l]||(m[l]=new ba(b,l)),b.element=k.element}var n=b.element;e.count?(a(n).insertAfter(e.end),e.end=n):(a(e.start).replaceWith(n),e.start=e.end=n),e.count++,f.position=e,f.dom=k,c&&!d&&k!==i&&k.update()}}function S(a,b,c,d,e){if(Xa(c,function(c,f){var g=wb(f);if("import"===g.type)S(a,b,tb[g.name]||[],!0,g.options);else{var h=new g.ctor(a,f,b,d,e);R(h,b||a,!0),S(a,h,cb(g.options.controls)),u(h,"init"),G(h),w(h),b||(a.control=h)}}),b&&c[0]){if(b.controls[1]){var f=new Ha;Xa(b.controls,function(a,b){f.set(b,a)}),b.controls.sort(function(a,b){function c(a,b,c,d){return a[c]?"*"===a[c]||eb(b.name,a[c])?d:-d:0}var d=c(a,b,"after",1),e=c(a,b,"before",-1),g=c(b,a,"after",-1),h=c(b,a,"before",1);return(!d&&!e)^(!g&&!h)?d||e||g||h:d+e+g+h||f.get(a)-f.get(b)})}w(b)}}function T(a,b,c){var d=Oa.getContext(),e=null,f=Pa(qb,function(a){return Oa.focused(a.element)});if(f)d=f.context,e=f.element;else if($a(d,U)){var h=wb(d).container;e=h.event&&h.event.context.element}var i=new g.Container(a);return i.context=new U(i,c),i.toolset=wb(b).toolset,i.parentContext=d,i.parentElement=e,wb(i,{dom:{positions:[]}}),i.tap(function(b){var c=i.getContext(b.target)||i.control;L(c)&&(i.emit(b,b.target===a?c.element:b.target),eb(b.type,"focusin focusout")?(c.focusBy=b.source,w(c)):eb(b.type,"asyncStart asyncEnd")&&t(c,function(a){w(a)}))}),S(i,null,[b],!0),i.flushEvents(),i}function U(a,b){var c=Ya(this,b);wb(c,{container:a,toolsets:new Ha})}function V(a,b){var c=this;c.name=a||"",c.labels=a?n(sb,a,d):{},c.options=b||{}}function W(a,b,c){var d=this;d.name=b.name,d.context=c,d.all={},wb(d,{container:a,options:b.options,control:d,flag:1}),a.add(d,b.options),a.emit("contextChange",d)}function X(a,b){for(var c=0;a[b+(c||"")];c++);return b+(c||"")}function Y(a){var b=wb(a);if(!$a(b.childContext,U)){var c=new U(b.container);"value"in b.options||(b.value=c,Ua(a.context,a.name,function(){return c},function(b){var d=Ya({},c);x(a,"value",d,Ya(c,b))})),b.childContext=c}return b.childContext}function Z(a,b,c,d){var e=a.name+(d?"":Na.ucfirst(c));_a(a[c])?Va(b,e,a[c].bind(a)):(Ja.call(b,e)&&(a[c]=b[e]),Ua(b,e,function(){return a[c]},function(b){a[c]=b})),wb(a).exports.push(e)}function $(a,b,c,d,e){var f=this,g=wb(b),h=!d&&c&&wb(c).toolset!==g.toolset,i=h?Y(c):c&&wb(c).childContext||(c||a).context,j=db(wb(i).toolsets,g.toolset,function(){return new W(a,g.toolset,i)}),k=hb(),l=X(j.all,g.name),m={control:f,species:b,container:a,toolset:g.toolset,options:g.options,templates:q(wb(c)||{},g),flag:1,values:{},initialValues:{},exports:[],toolsetState:j,toolsetEventHandle:k};wb(f,m),db(ob,Ka(f),Ia).add(f),a.add(j,k,{stateChange:function(){I(f,5)}}),f.name=l,f.type=g.type,f.required=!1,Xa(g.options,function(a,b){_a(b)||_a(f[a])||(f[a]=b)}),Xa(e,function(a,b){_a(b)||_a(f[a])||(f[a]=b)}),void 0===f.label&&(f.label=g.name),"string"==typeof g.options.execute&&(f.shortcut=Oa.getShortcut(g.options.execute)[0]),f.icon=f.icon||"",f.parent=c||null,f.state=j,f.context=i,f.parentContext=a.parentContext||null,f.parentElement=a.parentElement||null,f.controls=[],f.errors=null,f.id=hb(),f.all=j.all,f.all[l]=f,c&&(c.controls.push(f),d&&c.all!==f.all&&(c.all[l]=f)),g.defaultExport&&Z(f,i,g.defaultExport,!0),Xa(g.options.exports,function(a,b){Z(f,i,b)}),m.inited=!0}function _(a,b,c,d){function e(){$.apply(this,arguments)}e.prototype=Za($);var f=this;f.name=c,f.type=b,wb(f,{toolset:a,type:b,name:c||d.name||b,options:d,defaultExport:d.defaultExport||"value"in d&&"value",templates:q(rb[b]||{},d),ctor:e})}function aa(a,b){b=b||c.createElement("controls"),b.style.display="none!important";var d={};l(b,function(a,b){d[Ra(a)]=j(b)});var e=this;e.control=a,e.context=d,e.placeholder=b,e.condition=d.of||"",e.layoutType=d.layout||a.type||"default",e.start=b,e.end=b,e.count=0}function ba(b,c){var d=this,e=wb(b),f=e.container,g=P(e.options.template||"<z:"+Na.hyphenate(b.type)+"/>",(rb[c]||"").templates||ub),h=g.dom.cloneNode(!0),i=Na.iterateToArray(Na.createNodeIterator(h,1)),j=i.filter(function(a,b){return g.binds[b]}),k=Ma.eval("sortby [ ! condition ]",a("controls",h).map(function(a,c){return new aa(b,c)}).get());f.setContext(h,b),Xa(rb[b.type].handlers,function(a,b){f.add(h,b)}),f.add(h,e.options),Xa(g.roles,function(a,c){rb[a]&&a!==b.type&&f.add(i[c],a,rb[a])}),f.add(h,{stateChange:function(){d.update()}}),Ya(d,{control:b,element:h,roles:g.roles,binds:g.binds,bindedNode:j,positions:k,layoutType:c}),b.cssClass&&a(h).addClass(b.cssClass)}function ca(a){this.args=a,this.done=!1}function da(a,b,c){b=Ya({},b),b.templates=q({},b),b.handlers=[b],ub[a]=b.template||"",rb[a]=b;var d={};Xa(b,function(a,c){_a(c)||eb(a,"templates template handlers")||(d[a]=c,delete b[a])}),b.defaultOptions=d,c||Wa(V,bb(a,function(){for(var c=0,e=arguments.length,g=new f(e);c<e;c++)g[c]=arguments[c];var h=new ca(g),i=h.string(),j={};return b.parseOptions&&b.parseOptions(j,h),Ya(j,h.next("object")&&h.value),new _(this,a,i,Ya({},d,j))}))}function ea(a,b){a.execute=b.fn()}function fa(a,b){a.controls=b.nextAll(_),ea(a,b)}function ga(a,b){a.icon=b.string(),ea(a,b)}function ha(a,b){var c=wb(a.context).dom,f=c.bindedNode[d.keys(c.binds).indexOf(e(c.roles[b]))];return f&&Sa(f,a.target)}function ia(a,b){if("click"!==a.type||ha(a,"button"))return b.execute()}function ja(a,b){if("click"!==a.type||ha(a,"checkbox"))return b.value=!b.value,"checkbox"===b.type?b.execute():a.handled()}function ka(a,b,c){var d,e=wb(a).ddToolset.all(a),f=Pa(e,function(a){return d=d||a,a.value===b});f||a.allowEmpty||(f=d),(a.setValue(f?f.value:"")||c)&&(a.hintValue=b,a.selectedText=(f&&a.valueAsLabel?f:a).label,Xa(a.controls,function(a,b){b.selected=b===f}))}function la(a,b){var c=Na.isArray(b),e=[];Xa(b,function(a,b){e[e.length]=c&&ab(b)?b:{value:c?b:j(a),label:b}});for(var f=wb(a).ddToolset,g=[],h=0,i=e.length-d.keys(f.all(a)).length;h<i;h++)g[h]=f.choiceButton;a.append(g),Xa(f.all(a),function(a,b){b.enabled=b.visible=!!e[0],Ya(b,e.shift())}),ka(a,a.hintValue,!0)}function ma(b){var d=a(":file",b.target)[0],e=d.parentNode,f=c.createElement("form");f.appendChild(d),f.reset(),a(d).prependTo(e)}function na(a,b){var c={},d=(b||"").init;return b=Ya({inline:!0,defaultOptions:!1,disallowedElement:"*"},bb(Bb,Ya({},b))),Xa(a,function(a,d){(_a(d)||"options"===a||"commands"===a?c:b)[a]=d}),Xa(b[Bb],function(a,d){c.options&&a in c.options||(b[a]=d,delete b[Bb][a])}),b.widgets=Ya(b.widgets,bb(Bb,c)),b.init=function(c){var e=c.typer.getStaticWidget(Bb);Xa(a.overrides,function(a,b){c.typer[a]=function(a){return b.call(this,e,a)}}),_a(d)&&d.call(b,c)},b}function oa(a,b){var c=a.editor;c.focused(!0)||b===c.getValue()||c.setValue(b),a.setValue(c.getValue())}function pa(a){var b=qa(a,"deferred");Va(a.context,a.name,b.promise()),ra(a,"guard",!0)}function qa(b,c){return b[c]||(b[c]=a.Deferred())}function ra(a,b,c,d){a[b]&&(a[b][c?"resolve":"reject"](d),delete a[b])}function sa(a){a.value=a.optional?!!a.value:void 0,a.enableChildren=!a.optional||a.value}function ta(a,b,c){var d=[];!function a(b){Xa(b.controls,function(b,c){c.hasRole("buttonlist")&&!c.hasRole("menu")?a(c):c.hasRole("button")&&c.enabled&&c.visible&&(d[d.length]=c)})}(a);var e=d.indexOf(b);return d[e<0?0:e+c]}function ua(a,b,c,d){var e=a.callout;a.parent&&Sa(a.element,e)?(lb(e,"hidden",!1),gb(e,a.element,"right top inset-y")):(a.calloutParent?Oa.snap(e,a.calloutParent):$a(b,h)?Oa.snap(e,b,c):b&&gb(e,b,c,d),Oa.focus(e),Na.getState(e,"closing")&&(lb(e,"open",!1),lb(e,"closing",!1)),kb(e,"open"))}function va(a){var b=a.callout;a.parent&&Sa(a.element,b)?lb(b,"hidden",!0):kb(b,"closing",function(){jb(b)}),a.activeButton=null}function wa(a,b){b.destroy()}function xa(a,b,c,d,e){return a.import("dialog.prompt").render({value:c,valueEnabled:"prompt"===b,valueLabel:d,cancelVisible:"alert"!==b,action:e.string(),dialogTitle:e.string(),dialogDescription:"prompt"===b?e.string():d,dialogData:e.next("object")&&e.value,callback:e.fn()}).dialog}function ya(a){return Ma.string(a).replace(/ctrl|alt|shift/gi,function(a){return Na.ucfirst(a)+"+"})}function za(a){var b={},c=Ma.string(a).replace(/ctrl|alt|shift/gi,function(a){return a=Na.lcfirst(a),b[a]=Ba[a],""});return(b.alt||"")+(b.shift||"")+(b.ctrl||"")+(Ba[Na.lcfirst(c)]||c)}var Aa,Ba=JSON.parse('{"ctrl":"⌘","alt":"⌥","shift":"⇧","enter":"↩","tab":"ℵ","pageUp":"⇞","pageDown":"⇟","backspace":"⌫","escape":"⎋","leftArrow":"⭠","upArrow":"⭡","rightArrow":"⭢","downArrow":"⭣","home":"⭦","end":"⭨"}'),Ca="checked selected disabled readonly multiple ismap",Da="element name type parent all controls context previousSibling nextSibling",Ea="enabled active visible".split(" "),Fa=/\{\{((?:[^\}]|\}(?!\}))+)\}\}/,Ga=o.WeakMap,Ha=o.Map,Ia=o.Set,Ja=d.hasOwnProperty,Ka=d.getPrototypeOf,La=d.getOwnPropertyNames,Ma=b.waterpipe,Na=g.helper,Oa=g.dom,Pa=Na.any,Qa=Na.bind,Ra=Na.camel,Sa=Na.containsOrEquals,Ta=Na.createDocumentFragment,Ua=Na.defineGetterProperty,Va=Na.defineHiddenProperty,Wa=Na.definePrototype,Xa=Na.each,Ya=Na.extend,Za=Na.inherit,$a=Na.is,_a=Na.isFunction,ab=Na.isPlainObject,bb=Na.kv,cb=Na.makeArray,db=Na.mapGet,eb=Na.matchWord,fb=Na.noop,gb=Na.position,hb=Na.randomId,ib=Na.reject,jb=Na.removeNode,kb=Na.runCSSTransition,lb=Na.setState,mb=Na.tagName,nb=Na.when,ob=new Ga,pb=new Ga,qb=new Ia,rb={},sb={},tb={},ub={},vb={},wb=Na.createPrivateStore(),xb={language:"en"};Wa(z,{getValue:function(a,b,c){var d=this;if(d.needEvaluate){var e=Ma(d.displayValue,y(a,!0));return!1!==c&&e!==d.lastValue&&x(a,b,d.lastValue,e),d.lastValue=e,e}return d.displayValue}}),Wa(U,{toJSON:function(){return Ya({},this)},update:function(a){var b=wb(this),c=b.container;Ya(this,a),Xa(c.components,function(a,b){$a(b.context,W)&&u(b.context,"contextChange"),I(b.context,1)}),Xa(c.components,function(a,b){var c=$a(b.context,$);c&&(I(c,7),O(c)||u(c,"contextChange"))}),c.flushEvents()},validate:function(){return wb(this).container.control.validate()},reset:function(){Xa(wb(this).container.components,function(a,b){H(b.context)})}}),Wa(V,{i18n:function(a,b,c){p(this.labels,a,b,c)},alert:function(a,b,c,d,e){return xa(this,"alert",!0,a,new ca([b,c,d,e]))},confirm:function(a,b,c,d,e){return xa(this,"confirm",!0,a,new ca([b,c,d,e]))},prompt:function(a,b,c,d,e,f,g){return xa(this,"prompt",b,a,new ca([c,d,e,f,g]))},notify:function(a,b,c,d,e){var f=new ca([b,c,d,e]);return this.import("dialog.notify").render({label:a,kind:f.string()||!0,timeout:f.next("number")&&f.value,within:f.next(h)&&f.value,data:f.next("object")&&f.value}).dialog},import:function(a,b){return new _(this,"import",a,b||{})},export:function(a){for(var b=n(tb,a,f),c=1,d=arguments.length;c<d;c++)b[b.length]=arguments[c]},all:function(a){if($a(a,h))a=$a(Oa.getContext(a),U);else if($a(a,$)){if(wb(a).toolset===this)return a.all;a=wb(a).childContext}var b=a&&wb(a).toolsets.get(this);return b?b.all:{}}}),Wa(W,{get enabled(){return L(this)},set enabled(a){K(this,1,a)}}),Wa($,{get previousSibling(){var a=$a(wb(this).position,aa);return a&&a.start!==this?wb(this).container.getContext(this.element.previousSibling):null},get nextSibling(){var a=$a(wb(this).position,aa);return a&&a.end!==this?wb(this).container.getContext(this.element.nextSibling):null},get focused(){return Oa.focused(this.element)},get pending(){return Oa.locked(this.element)},get enabled(){return L(this)},set enabled(a){K(this,1,a)},get active(){return M(this)},set active(a){K(this,2,a)},get visible(){return!N(this)},set visible(a){K(this,4,a)},get value(){return wb(this).value},set value(a){D(this,a)},setValue:function(a){return D(this,a)},contains:function(a){for(var b=a;b&&b!==this;b=b.parent);return!!b},hasRole:function(a){var b=wb(this).dom.roles;return Pa(a,function(a){return a in b})},on:function(a,b){wb(this).container.add(this.element,ab(a)||bb(a,b))},watch:function(a,b,c){var d=this;C(Ka(d),a),_a(b)&&(d.on("propertyChange",function(c){a in c.oldValues&&b.call(d,c.newValues[a],c.oldValues[a],a,d)}),c&&b.call(d,d[a],null,a,d))},focus:function(){L(this)&&Oa.focus(this.element)},validate:function(){return nb(F(this))},execute:function(a){var b=this;if(!L(b)||N(b)||qb.has(b))return ib();void 0!==a&&(b.value=a);var c=function(a,c){qb.delete(b),a&&(u(b,"executed",{data:c}),b.parent&&u(b.parent,"childExecuted",{control:b},!0)),u(b,"afterExecute",a)},d=function(){var a;u(b,"beforeExecute"),qb.add(b);try{var d=wb(b).options.execute;"string"==typeof d?a=(Oa.support(d,b.focused)||fb)(b.value):_a(d)&&(a=d.call(b,b))}catch(b){console.error(b),a=ib(b)}return b.waitForExecution&&a&&_a(a.then)?(a=Oa.lock(b.element,a,function(){return u(b,"cancel")||ib()}),Na.always(Oa.prepEventSource(a),c),a):(c(!0),nb())},e=F(b);return e?Oa.prepEventSource(e).then(d):d()},reset:function(){t(this,H)},append:function(a,b){var c=this;b&&Xa(c.controls.slice(0),function(a,b){b.destroy()}),S(wb(c).container,c,cb(a))},destroy:function(){var a=this;a.pending&&Oa.cancel(a.element,!0),nb(u(a,"beforeDestroy")).then(function(){var b=wb(a).container;if(t(a,function(a){var c=wb(a);Xa(c.allDOM,function(a,c){b.delete(c.element)}),b.delete(a.state,c.toolsetEventHandle),db(ob,Ka(a)).delete(a),delete a.all[a.name],a.parent&&a.parent.all[a.name]===a&&delete a.parent.all[a.name],Xa(c.exports,function(b,c){delete a.context[c]})}),a.parent){var c=a.parent.controls;c.splice(c.indexOf(a),1),Q(a),I(a.parent),w(a.parent)}else m(function(){b.destroy()}),Na.removeNode(b.autoDestroy?b.element:a.element)})}}),Xa("icon label errors placeholder description",function(a,b){C($.prototype,b)}),function(a,b){Xa(ab(a)||bb(a,b),function(a,b){vb[a]=b,C($.prototype,a)})}({showIcon:"auto",showText:!0,hideDisabledChild:!1,hideCalloutOnBlur:!0,hideCalloutOnExecute:!0,waitForExecution:!0,enableChildren:!0}),Wa(_,{clone:function(a){var b=Za(_,this),c=Ya({},wb(this));return c.options=Ya({},c.options,a),wb(b,c),b},render:function(b,d){$a(b,h)||(d=b,b=c.createElement("div"));var e=T(b,this,d);return a(b).addClass("zeta-ui"),e.context}}),Wa(aa,{get enabled(){return!1!==this.control.enableChildren}}),Wa(ba,{update:function(){var b=this,c=b.control,d=c.element;c.parent&&R(c,c.parent);var e=wb(c).position;if(e){var f=/\*\*(([^*]|\*(?!\*))+)\*\*/g,g=/\*([^*]+)\*/g,h=y(c),i=0;if(Xa(b.binds,function(c,d){var j=b.bindedNode[i++],k=Ya({},e.context);Xa(d.context,function(a,b){k[a]=b.expression?r(b.expression,h,null,b.evalAsObject):b}),Xa(d,function(b,c){var d=r(c.expression,h,k,"class"===c.type||"prop"===c.type);switch(c.type){case"class":return lb(j,c.name,d);case"style":return a(j).css(c.name,d);case"prop":return void(j[c.name]=!!d);case"attr":return d=d.replace(f,"$1").replace(g,"$1"),a(j).attr(c.name,d||null)}(d=d.replace(f,"<b>$1</b>").replace(g,"<i>$1</i>").replace(/\n/g,"<br>"))!==j.innerHTML&&(j.innerHTML=d)})}),lb(d,{active:h.active,loading:h.pending,error:h.errors,disabled:!h.enabled,hidden:!h.visible,focused:h.focused&&h.focusBy}),d.disabled=!h.enabled,c.controls[1]){var j=new Ha;Xa(c.controls,function(a,b){j.set(b.element,a)}),Xa(b.positions,function(b,c){for(var d=c.count-1;d>0;d--)for(var e=0,f=c.start;e<d;e++,f=f.nextSibling)j.get(f)>j.get(f.nextSibling)&&(a(f.nextSibling).insertBefore(f),f=f.previousSibling,0===e?c.start=f:e===c.count-1&&(c.end=f.nextSibling))})}Xa(c.controls,function(a,b){R(b,c)})}}}),Wa(ca,{next:function(a){var b=this.args;if("object"===a?ab(b[0]):"string"==typeof a?typeof b[0]===a:$a(b[0],a))return this.value=b.shift(),this.done=!b.length,!0},nextAll:function(a){for(var b=[];this.next(a)&&b.push(this.value););return b},fn:function(){return this.next("function")&&this.value},string:function(){return this.next("string")&&this.value}}),Ya(V,{define:da,on:function(a,b,c){rb[a].handlers.push(ab(b)||bb(b,c))},i18n:function(a,b,c,e){p(n(sb,a,d),b,c,e)},hasRole:function(a,b){var c=$a(Oa.getContext(a),U);return c&&wb(c).container.getContext(a).hasRole(b)}}),g.UI=V,da("button",{template:'<button class="danger:{{danger}}"><z:label/><children/></button>',danger:!1,defaultExport:"execute",parseOptions:ga,enter:ia,click:ia}),da("submit",{template:'<z:button class="zeta-submit"/>',defaultExport:"execute",parseOptions:function(a,b){a.icon=b.string(),a.execute=function(a){for(var b=a;b&&!b.hasRole("form");b=b.parent);return b&&b.execute()}},enter:ia,click:ia});var yb="[ @global.showIcon ?? showIcon ]",zb="[ @global.showText ?? showText ]",Ab="[ @global.icon ?? icon ]";da("label",{template:'<span class="zeta-label hidden:{{[ ! '+yb+" || ! "+Ab+" ] && ! "+zb+'}}" title="{{tooltip || label}}"><i class="material-icons hidden:{{[ ! '+Ab+" && "+yb+" != true ] || ! "+yb+'}}">{{'+Ab+"}}</i>{{? "+zb+' [ @global.label ?? label ] ""}}</span>',showIcon:"auto",showText:!0,defaultExport:"label"}),da("checkbox",{template:'<z:button class="zeta-checkbox checked:{{value}}" show-icon="false" show-text="true"/>',value:!1,preventLeave:!0,parseOptions:ea,click:ja,enter:ja,space:ja}),da("dropdown",{
template:'<label class="zeta-dropdown"><z:button label="{{selectedText}}" show-text="true"/><z:menu/></label>',requireChildControls:!0,hideCalloutOnBlur:!0,hideCalloutOnExecute:!0,preventLeave:!0,allowEmpty:!0,valueAsLabel:!0,value:"",parseOptions:function(a,b){a.icon=b.string(),(b.next(f)||b.next(Ha))&&(a.choices=b.value,a.value=b.next("string")||b.next("number")?b.value:""),fa(a,b)},init:function(a,b){var c=new V(wb(b).toolset.name);c.choiceButton=c.button({template:'<z:button class="selected:{{selected}}" show-icon="true" show-text="true"/>',execute:function(a){ka(b,a.value),b.execute()}}),wb(b).ddToolset=c,b.hintValue=b.value,b.selectedText=b.label,b.watch("choices",function(a){la(b,a)},!0)},click:function(a,b){ua(b),a.handled()},setValue:function(a,b){la(b,b.choices),ka(b,a.newValue),a.handled()}}),da("callout",{template:'<label class="zeta-callout"><controls of="not parent.alwaysShowCallout && parent.controls where enabled as _enabled && _enabled.length == 1 && _enabled.0.id == id"/><z:button class="hidden:{{[ not alwaysShowCallout ] && controls where enabled length == 1}}"/><z:menu/></label>',requireChildControls:!0,hideCalloutOnExecute:!0,hideCalloutOnBlur:!0,alwaysShowCallout:!0,parseOptions:function(a,b){a.icon=b.string(),a.controls=b.nextAll(_)},click:function(a,b){ua(b),a.handled()}}),da("buttonlike",{template:'<label class="has-clickeffect"><children/></label>'},!0),da("link",{template:'<z:buttonlike><a href="{{value}}" target="{{target}}"><z:label show-icon="auto"/></a></z:buttonlike>',parseOptions:function(a,b){a.icon=b.string(),a.value=b.string(),a.target=b.string()}}),da("file",{template:'<z:buttonlike><z:label show-icon="auto"/><input type="file" multiple="{{multiple}}"/></z:buttonlike>',autoReset:!0,multiple:!1,parseOptions:ga,init:function(b,c){a(":file",b.target).change(function(a){c.execute(cb(a.target.files))})},afterExecute:function(a,b){b.autoReset&&ma(a)},reset:function(a,b){ma(a)}});var Bb="__preset__",Cb={overrides:{getValue:function(){return this.extractText()}}};da("textbox",{template:'<z:textboxlike><z:contenteditable spellcheck="false"/></z:textboxlike>',hideCalloutOnExecute:!1,preventLeave:!0,value:"",placeholder:"",parseOptions:ea,init:function(a,b){b.editorOptions=na(b.preset||Cb,b.options),b.watch("editor",function(a){b.options=a.getStaticWidget(Bb).options,b.editorOptions.options=Ya({},b.options)})},reset:function(a,b){b.options=b.editor.getStaticWidget(Bb).options,Ya(b.options,b.editorOptions.options)}}),da("textboxlike",{template:'<label class="zeta-textbox keep-placeholder:{{showPlaceholder == always && ! $placeholder}}"><z:label show-text="false" show-icon="auto"/><div class="zeta-textbox-wrapper" data-label="{{? $placeholder label}}"><div class="zeta-textbox-inner"><children/><div class="zeta-textbox-placeholder">{{placeholder || label}}</div></div><div class="zeta-textbox-error"></div><div class="zeta-textbox-clear"></div></div></label>',click:function(a,b){$a(a.target,".zeta-textbox-clear")&&(b.execute(""),b.editor.focus())}},!0),da("richtext",{template:'<div class="zeta-richtext"><div class="zeta-richtext-toolbar"></div><label class="zeta-textbox"><z:contenteditable/><div class="zeta-textbox-placeholder"><p>{{label}}</p></div></label></div>',hideCalloutOnExecute:!1,preventLeave:!0,value:"",parseOptions:ea,init:function(b,c){c.editorOptions=c.options||{},c.editorOptions.toolbar={container:a(".zeta-richtext-toolbar",b.target)[0]}},validate:function(a,b){if(b.required&&!b.editor.extractText())return ib("required")}}),da("contenteditable",{template:'<div class="zeta-editable" contenteditable spellcheck="{{spellcheck}}"></div>',init:function(a,b){b.editor=new g.Editor(a.target,b.editorOptions),b.editor.enable("stateclass",{target:b.element,focused:""}),b.editor.on("contentChange",function(){b.setValue(b.editor.getValue())&&b.execute()}),oa(b,b.value)},stateChange:function(a,b){b.editor.enabled()^b.enabled&&b.editor[b.enabled?"enable":"disable"]()},focusin:function(a,b){b.editor.focused()||b.editor.focus()},setValue:function(a,b){oa(b,a.newValue),a.handled()},validate:function(a,b){return b.editor.validate()}},!0),da("form",{template:'<div class="zeta-form"><children controls/></div>',templates:{buttonset:'<z:buttonset><children controls show-text="true"/></z:buttonset>',textbox:'<z:textbox show-placeholder="always"/>'},parseOptions:fa,preventLeave:!0,init:function(a,b){pa(b)},childExecuted:function(a,b){"script"!==a.source&&a.control.preventLeave&&!b.guard&&Oa.lock(b.element,qa(b,"guard"),function(){return b.preventLeave?wb(b).toolset.confirm("leaveForm"):nb()})},beforeExecute:function(a,b){ra(b,"guard",!0)},executed:function(a,b){ra(b,"deferred",!0,null!==a.data?a.data:void 0!==b.value?b.value:b.context.toJSON()),b.reset()},cancelled:function(a,b){ra(b,"deferred",!1)},destroy:function(a,b){ra(b,"deferred",!1)},reset:function(a,b){b.deferred||pa(b)}}),da("fieldset",{template:'<div class="zeta-fieldset optional:{{optional && [ ? value checked [ ! value ] ]}}"><div class="zeta-fieldset-title"><z:checkbox/><p>{{description}}</p></div><div class="zeta-form hidden:{{not enableChildren}}"><children controls/></div></div>',templates:{textbox:'<z:textbox show-placeholder="always"/>'},value:!1,optional:!1,parseOptions:fa,init:function(a,b){sa(b)},propertyChange:function(a,b){("optional"in a.newValues||"value"in a.newValues)&&sa(b)}}),da("buttonset",{template:'<div class="zeta-buttonset"><children controls/></div>',templates:{textbox:'<z:textbox show-placeholder="auto"/>'},requireChildControls:!0,hiddenWhenDisabled:!0,parseOptions:fa}),da("buttonlist",{template:'<div class="zeta-buttonlist"><children show-text="true" show-icon="true" controls/></div>',templates:{button:'<z:button><span class="zeta-label zeta-label-description">{{description ?? [ shortcut :zeta-shortcut ]}}</span></z:button>'},showIcon:!0,showText:!0,requireChildControls:!0,hiddenWhenDisabled:!0,parseOptions:fa,stateChange:function(a,b){Xa(b.controls,function(a,b){if("buttonlist"===b.type){var c=function(a){for(var c=b[a];c&&!c.visible;c=c[a]);return c},d=c("previousSibling"),e=c("nextSibling");lb(b.element,"sep",{before:d,after:e&&"buttonlist"!==e.type})}})}}),da("menu",{template:'<div class="zeta-ui zeta-menu zeta-float"><z:buttonlist/></div>',waitForExecution:!1,parseOptions:fa,init:function(a,b){for(var c=a.target,d=b.parent;d&&d.hasRole("buttonlist")&&!d.hasRole("menu");d=d.parent);!b.parent||d&&!d.hasRole("menu")?b.parent||c!==b.element?(b.calloutParent=c.parentNode,Oa.retainFocus(b.element,c),jb(c)):(Va(b.context,"showMenu",ua.bind(null,b)),Va(b.context,"hideMenu",va.bind(null,b)),Va(b.context,"element",c)):(Qa(b.element,"mouseenter",ua.bind(null,b)),Qa(b.element,"mouseleave",va.bind(null,b))),Qa(b.element,"mousemove",function(){b.activeButton=null}),lb(a.target,"is-"+b.type,!0),b.callout=c,b.activeButton=null,b.watch("activeButton",function(a,c){(c||{}).active=!1,(a||{}).active=!0,(a||b).focus()}),va(b)},focusin:function(a,b){"keyboard"!==a.source||b.parent||(ua(b),b.activeButton=ta(b,b,1))},focusout:function(a,b){b.activeButton=null,b.hideCalloutOnBlur&&va(b)},keystroke:function(a,b){var c=b.activeButton,d=/^(up|down|left|right)Arrow$/.test(a.data)&&k.$1[0];"l"===d?b.parent?c&&(va(b),a.handled()):a.handled():"r"===d?(ua(b),b.activeButton=c||ta(b,b,1),a.handled()):d&&(c||!b.parent||b.calloutParent)&&(b.activeButton=ta(b,c,"u"===d?-1:1)||c,a.handled())},childExecuted:function(a,b){b.activeButton=null;for(var c=a.control;c&&c!==b.parent;c=c.parent)if(!c.hideCalloutOnExecute)return;va(b)},beforeDestroy:function(a,b){va(b)}}),da("dialog",{template:'<div class="zeta-ui zeta-dialog"><z:anim class="zeta-float zeta-dialog-inner"><div class="zeta-dialog-content"><h2>{{title}}</h2><z:form><p>{{description}}</p><controls/></z:form></div><div class="zeta-dialog-error error hidden:{{not errorMessage}}">{{errorMessage}}</div><controls of="type == buttonset"/></z:anim></div>',templates:{buttonset:'<z:buttonset class="zeta-dialog-buttonset"><controls of="danger" show-text="true"/><div class="zeta-buttonset-pad"></div><controls show-text="true"/></z:buttonset>'},pinnable:!0,modal:!0,title:"",description:"",errorMessage:"",parseOptions:fa,init:function(d,e){var f=e.element,g=e.parentElement,h=g&&e.pinnable&&screen.availWidth>=600&&screen.availHeight>=600&&V.hasRole(g,"button buttonlike")?g:b;a(f).appendTo(c.body),g&&Oa.retainFocus(g,f),e.modal&&Oa.setModal(f),Oa.snap(f,h,"auto"),Na.setZIndexOver(f,g||c.activeElement),m(function(){Oa.focus(f,!0)})},error:function(a,b){b.errorMessage=(a.error||"").message||a.error||"",a.handled()},focusout:wa,escape:wa,afterExecute:function(a,b){a.data&&wa(a,b)},enter:function(a,b){return b.execute()}}),da("anim",{template:"<div><children controls/></div>",init:function(a,b){kb(a.target,"open")},focusreturn:function(a,b){kb(a.target,"pop",!0)},beforeDestroy:function(a,b){return kb(a.target,"closing")}},!0),da("generic",{parseOptions:fa});var Db=new V("dialog");Db.i18n("en",{action:"OK",cancel:"Cancel",leaveForm:"There are unsubmitted information on the page. Are you sure to leave?"}),Db.export("dialog.prompt",Db.dialog({preventLeave:!1,data:null,exports:"title description errorMessage data",controls:[Db.textbox("value",{hiddenWhenDisabled:!0,exports:"enabled label"}),Db.buttonset(Db.submit("action","done",{defaultExport:"label",exports:"icon"}),Db.button("cancel","close",{exports:"visible",execute:function(a){return a.all.dialog.destroy()}}))],execute:function(a){return(_a(a.context.callback)||nb)(a.context.value)}}));var Eb;Db.export("dialog.notify",Db.generic({template:'<z:anim class="zeta-ui zeta-snackbar notify:{{kind}}"><div class="zeta-float"><z:buttonset><z:label/><z:button icon="close" show-text="false" show-icon="true"/></z:buttonset></div></z:anim>',data:null,init:function(a,b){Eb&&Eb.destroy(),Ya(b,b.context),Oa.snap(a.target,b.within||c.body,"top center inset"),b.timeout&&m(function(){b.destroy()},b.timeout),Eb=b},click:function(a,b){b.destroy()}})),Xa("alert confirm prompt notify",function(a,b){V[b]=Db[b].bind(Db)}),Ma.pipes[":zeta-shortcut"]=g.IS_MAC?za:ya}(a,zeta),function(a,d){function e(){K.timestamp=q.getSelection().timestamp,K.rect=B(q).translate(G.scrollLeft,G.scrollTop),A(this,{typer:q,pointerX:K.x||0,pointerY:K.y||0,mousedown:M,hoverNode:s||null,activeHandle:r||null,editorReflow:!L.rect||!x.rectEquals(L.rect,K.rect),pointerMoved:L.x!=K.x||L.y!=K.y,selectionChanged:L.timestamp!==K.timestamp}),A(L,K)}function f(a,b){this.cursor=a||"pointer",this.done=b,this.active=!1}function h(){var e={N:"typer-visualizer",G:"background",S:"selection",X:"transparent"};a(c.body).append("<style>.has-N{caret-color:X;}.has-N:focus{outline:none;}.has-N::S,.has-N ::S{G:X;}.has-N::-moz-S,.has-N ::-moz-S{G:X;}@keyframes caret{0%{opacity:1;}100%{opacity:0;}}</style>".replace(/\b[A-Z]/g,function(a){return e[a]||a})).append(F),y(F,"mousedown",function(a){1&a.buttons&&((r||{}).active=!1,r=H.get(a.target),r.active=!0,x.always(d.dom.drag(a,q.element),function(){(r.done||x.noop).call(r),r.active=!1,r=null,q.focus(),k(!0)}),a.preventDefault())}),y(b,"mousedown mousemove mouseup",function(a){K.x=a.clientX,K.y=a.clientY,s=q&&q.nodeFromPoint(K.x,K.y),n(v),"mousemove"===a.type?v=m(k,0):(M=1&a.buttons,v=m(k,0,!0))}),y(b,"scroll resize orientationchange focus",k)}function i(a,b){I[a]=[b,[],{},!0]}function j(a,b,c,d,e){for(var f=0,g=t.length;f<g;f++)if(t[f].state===b&&t[f].kind===a)return void(u[u.length]=t.splice(f,1)[0]);u[u.length]={kind:a,state:b,rect:c||("top"in b?b:B),css:d,handle:e}}function k(b){if(b=!0===b,n(v),q&&(b||q.focused())){var d=new e;(b||d.editorReflow||d.selectionChanged||d.pointerMoved)&&z(I,function(e,f){u=f[1],t=u.splice(0),!1!==f[3]&&f[0].call(null,d,f[2]),t.forEach(function(b){J[J.length]=a(b.dom).detach().removeAttr("style")[0],H.delete(b.dom)}),u.forEach(function(e){if(b||!e.dom||d.editorReflow||C(e.rect)){var f=e.dom||(e.dom=a(J.pop()||c.createElement("div"))[0]);a(f).appendTo(F).css(A({position:"absolute",cursor:(e.handle||"").cursor,pointerEvents:e.handle?"all":"none"},e.css,x.cssFromRect("top"in e.rect?e.rect:e.rect(e.state),F))),H.set(f,e.handle)}})})}}function p(b){q=b,b?(x.setZIndexOver(F,b.element),b.retainFocus(F),k(!0)):a(F).children().detach()}var q,r,s,t,u,v,w=d.Editor,x=d.helper,y=x.bind,z=(x.createRange,x.each),A=x.extend,B=x.getRect,C=(x.is,x.isFunction),D=x.matchWord,E=x.toPlainRect,F=a('<div style="position:absolute;top:0;left:0;">')[0],G=c.documentElement,H=new o.WeakMap,I={},J=[],K={},L={},M=!1;x.definePrototype(e,{refresh:function(){m(k,0,!0)},toggleLayer:function(a,b){var c=!1;a.split(" ").forEach(function(a){c|=b^(I[a]||"")[3],(I[a]||{})[3]=b}),c&&m(k,0,!0)},fill:function(a,b,c){var d={};d.background=b||"rgba(0,31,81,0.2)",z(x.makeArray(a),function(a,b){j("f",b,null,d,c)})},drawCaret:function(a){j("k",a,null,{animation:"caret 0.5s infinite alternate ease-in",outline:"1px solid rgba(0,31,81,0.8)"})},drawBorder:function(a,b,c,d,e){var f={};f.border=l(b)+"px "+(d||"solid")+" "+(c||"black"),f.margin=e?"0px":-l(b)+"px",f.boxSizing=e?"border-box":"auto",j("b",a,null,f)},drawLine:function(a,b,c,d,e,f,h,i){if(void 0!==a.left)return a=a.collapse(b),this.drawLine(a.left,a.top,a.right,a.bottom,c,d,e,f);var k=c-a,m=d-b,n={};n.borderTop=l(e)+"px "+(h||"solid")+" "+(f||"black"),n.transformOrigin="0% 50%",n.transform="translateY(-50%) rotate("+g.atan2(m,k)+"rad)",j("l",E(a,b,a+g.sqrt(m*m+k*k),b),null,n,i)},drawHandle:function(a,b,c,d,e){var f={};f.border="1px solid #999",f.background="white"+(d?' url("'+d+'")':""),c=c||8,j("c",a,function(){var d=B(a),e=D(b,"left right")||"centerX",f=D(b,"top bottom")||"centerY";return d.left-=c,d.top-=c,E(d[e],d[f],d[e]+c,d[f]+c)},f,e)}}),i("selection",function(a){var b=a.typer.getSelection();b.isCaret?"caretColor"in G.style&&a.drawCaret(b.baseCaret):a.fill(b.getRects())}),w.widgets.visualizer={init:function(b){a(b.typer.element).addClass("has-typer-visualizer"),h.init||(h(),h.init=!0)},focusin:function(a){p(a.typer)},focusout:function(a){p(null)},contentChange:function(a){k(!0)},stateChange:function(a){a.typer.enabled()?q===a.typer?k():a.typer.focused()&&p(a.typer):p(null)}},w.defaultOptions.visualizer=!0,A(w,{addLayer:i,handle:function(a,b){return new f(a,b)}})}(a,zeta),function(a,b){var c,d,e=b.Editor,f=b.helper,g=f.getRect,h=f.containsOrEquals,i=e.prototype.closest,j=e.handle("move",function(){c&&d&&c.typer.invoke(function(a){a.selection.select(d),a.insertHtml(c.element)})});e.addLayer("dragWidget",function(a){var b=a.hoverNode;if(j.active){var k=i(b,e.NODE_PARAGRAPH|e.NODE_WIDGET);if(d=null,k&&!h(c,k)){var l=g(k),m=g(i(k,e.NODE_EDITABLE)),n=a.pointerY<l.centerY,o=n?k.previousSibling:k.nextSibling;if(o!==c&&a.typer.widgetAllowed(c.widget.id,k)){var p;if(o){var q=g(o);p=(l.bottom<=q.top?l.bottom+q.top:q.bottom+l.top)/2}else p=g(k,!0)[n?"top":"bottom"];a.drawLine(m.left,p,m.right,p,1,"red","dashed"),d=a.typer.createCaret(k.element,n)}}a.fill(c.element)}else!b||c&&!h(c,b)&&f.pointInRect(a.pointerX,a.pointerY,g(c),10)||(c=i(b,e.NODE_WIDGET));c&&a.drawHandle(c,"left top",11,"data:image/gif;base64,R0lGODlhCwALAKEBAE1PUP///////////yH5BAEKAAIALAAAAAALAAsAAAIUjI8ZoAffDFOzuoexk5zGBUXTlxQAOw==",j)})}(0,zeta),function(a,c){function d(a){return a.filter(function(b){return!a.some(function(a){return a!==b&&a.contains(b)})})}function e(b){var c=a(b).css("text-align"),d=a(b).css("direction");switch(c){case"-webkit-left":case"-webkit-right":case"-webkit-center":return c.slice(8);case"start":return"ltr"===d?"left":"right";case"end":return"ltr"===d?"right":"left";default:return c}}function f(b,c){var d;return a(b).each(function(b,f){var g;g="textAlign"===c?e(f):"inlineClass"===c?a(f).attr("class")||"":a(f).css(c),d=""===d||d&&d!==g?"":g}),d||""}function g(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),a===b||K.test(a)&&K.test(b)}function i(a,b){var c=D.createElement(a);return b&&(c.className=b),c}function j(b,c){return c=H(c,h)||i(c),a(c).append(b.childNodes).replaceAll(b)[0]}function l(c,d,e,f,g){var h=c.selection,i=h.getParagraphElements(),j=h.getSelectedTextNodes();h.isCaret&&!f?(c.insertHtml(d),d.appendChild(D.createTextNode()),h.moveToText(d,-0)):j[0]&&(i.forEach(function(c){if(!g||!D.matchWord(b.getComputedStyle(c)[g[0]],g[1]))if(f){var h=a(j,c).parentsUntil(c).filter(e),i=h.contents().filter(function(a,b){return j.every(function(a){return!D.containsOrEquals(b,a)})});h.contents().unwrap(),i.wrap(d)}else a(c).find(j).wrap(d)}),h.select(j[0],0,j[j.length-1],-0)),a(i).find(e).filter(":has("+e+")").each(function(b,c){a(c).contents().unwrap().filter(function(a,b){return 3===b.nodeType}).wrap(c)}),a(i).find('span[class=""],span:not([class])').contents().unwrap(),a(i).find(e).each(function(b,c){D.sameElementSpec(c.previousSibling,c)&&(a(c.childNodes).appendTo(c.previousSibling),I(c))})}function m(b){a(b.selection.getParagraphElements()).attr("align",y[b.commandName])}function n(a){var b=a.commandName;l(a,i(z[b].split(",")[0]),z[b],a.widget[b],A[b])}function o(b,c){var d="insertOrderedList"===b.commandName||c?"ol":"ul",e="<"+d+(c||"").replace(/^.+/,' type="$&"')+">",f=function(b,e){return H(e,d)&&(a(e).attr("type")||"")===(c||"")},g=[];G(b.selection.getParagraphElements(),function(c,d){if(a(d).is("ol>li,ul>li"))a(d.parentNode).filter(f)[0]?a(d).is("li")&&a.inArray(d.parentNode,g)<0&&q(b,[d]):(j(d.parentNode,a(e)[0]),g.push(d.parentNode));else{var h=a(d).prev().filter(f)[0]||a(d).next().filter(f)[0]||a(e).insertAfter(d)[0];a(d)[D.comparePosition(d,h)<0?"prependTo":"appendTo"](h),j(d,"li"),g.push(h)}})}function p(b,c){c=a.makeArray(c||d(b.selection.getParagraphElements())),G(c,function(b,c){var d=a(c).parent("ul,ol")[0]||a(c).prev("ul,ol")[0]||a("<ul>").insertBefore(c)[0],e=d;if(e===c.parentNode){var f=a(c).prev("li")[0]||a("<li>").insertBefore(c)[0];e=a(f).children("ul,ol")[0]||a(d.cloneNode(!1)).appendTo(f)[0]}a(j(c,"li")).appendTo(e),a(e).parent("li")[0]&&a(D.createTextNode(" ")).insertBefore(e),d.children[0]||I(d)})}function q(b,c){c=a.makeArray(c||d(b.selection.getParagraphElements())),G(c,function(c,d){var e=a(d).parent("ul,ol")[0],f=a(e).parent("li")[0];a(d).next("li")[0]&&(f?a(e.cloneNode(!1)).append(a(d).nextAll()).appendTo(d):(a(e.cloneNode(!1)).append(a(d).nextAll()).insertAfter(e),a(d).children("ul,ol").insertAfter(e))),f?(a(d).insertAfter(f),D.trim(b.typer.extractText(f))||I(f)):a(j(d,"p")).insertAfter(e),e.children[0]||I(e)})}function r(b){var c=b.typer.getSelection().getSelectedElements();b.widget.inlineClass=f(a(c).filter("span"),"inlineClass"),G(A,function(a,d){b.widget[a]=!!D.matchWord(f(c,d[0]),d[1])})}function s(b){var c=b.typer.getSelection(),d=c.getParagraphElements().slice(-1)[0];a(d).is("li")&&(d=a(d).closest("ol, ul")[0]||d);var e=d&&d.tagName.toLowerCase(),g=e+(a(d).attr("class")||"").replace(/^(.)/,".$1"),h=f(c.getSelectedElements(),"textAlign");F(b.widget,{justifyLeft:"left"===h,justifyCenter:"center"===h,justifyRight:"right"===h,justifyFull:"justify"===h,formatting:e,formattingWithClassName:g})}function t(a){return a.context.typer.getSelection()}function u(a){return!!t(a).getParagraphElements()[0]}function v(a){var b=t(a);return!!H(b.startNode,C.NODE_PARAGRAPH|C.NODE_EDITABLE_PARAGRAPH|C.NODE_INLINE)}function w(a,b){return L.button(a,M[a],{realm:b,execute:a,enabled:"inlineStyle"===b?v:u,active:function(c){var d=c.context.typer.getStaticWidget(b);return d&&d[a]}})}function x(b,c){return L.button(D.camel(B[b]),{description:c,execute:function(a){a.context.typer.invoke(function(a){a.insertWidget("list",b)})},active:function(c){var d=t(c).getWidget("list");return d&&a(d.element).attr("type")===b}})}var y={justifyLeft:"left",justifyRight:"right",justifyCenter:"center",justifyFull:"justify"},z={bold:"b,strong",italic:"i,em",underline:"u",strikeThrough:"strike"},A={bold:["fontWeight","bold 700"],italic:["fontStyle","italic"],underline:["textDecoration","underline"],strikeThrough:["textDecoration","line-through"]},B={1:"decimal",A:"upper-alpha",a:"lower-alpha",I:"upper-roman",i:"lower-roman"},C=c.Editor,D=c.helper,E=c.dom,F=D.extend,G=D.each,H=D.is,I=D.removeNode,J=/^([a-z\d]*)(?:\.(.+))?/i,K=/^(p|h[1-6])(?:\.(.+))?$/i;C.widgets.inlineStyle={stateChange:r,contentChange:r,commands:{bold:n,italic:n,underline:n,strikeThrough:n,superscript:n,subscript:n,applyClass:function(a,b){l(a,i("span",b),"span")}}},C.widgets.formatting={stateChange:s,contentChange:s,commands:{justifyCenter:m,justifyFull:m,justifyLeft:m,justifyRight:m,formatting:function(b,c){var d=/^([a-z\d]*)(?:\.(.+))?/i.exec(c)||[];"ol"===d[1]||"ul"===d[1]?b.insertWidget("list","ol"===d[1]&&"1"):a(b.selection.getParagraphElements()).not("li").each(function(a,b){d[1]&&!H(b,d[1])&&g(d[1],b.tagName)?j(b,i(d[1]||"p",d[2])):b.className=d[2]||""})},insertLine:function(a){a.insertText("\n\n")},insertLineBefore:function(a){var b=a.selection.focusNode.widget;"__root__"!==b.id&&(a.selection.select(b.element,!0),a.insertText("\n\n"))}}},C.widgets.lineBreak={shiftEnter:function(a){a.typer.invoke("insertLineBreak"),a.handled()},commands:{insertLineBreak:function(a){a.insertHtml("<br>")}}},C.widgets.list={element:"ul,ol",editable:"ul,ol",textFlow:!0,create:o,remove:function(a){q(a,a.widget.element.children)},extract:function(a){},receive:function(a){D.sameElementSpec(a.widget.element,a.receivedNode)&&(a.handled(),a.typer.invoke(function(b){b.insertHtml(a.receivedNode.childNodes)}))},tab:function(a){a.typer.invoke("indent"),a.handled()},shiftTab:function(a){a.typer.invoke("outdent"),a.handled()},init:function(b){a(b.widget.element).filter("ol").attr("type-css-value",B[a(b.widget.element).attr("type")]||"decimal"),a(b.widget.element).parent("li")[0]&&!b.widget.element.previousSibling&&a(D.createTextNode()).insertBefore(b.widget.element)},contentChange:function(b){a(b.widget.element).children("li")[0]||b.typer.invoke(function(a){I(b.widget.element)})},setup:function(a){a.typer.on("tab",function(a){a.typer.invoke(p),a.handled()})},commands:{indent:p,outdent:q}},F(C.defaultOptions,{lineBreak:!0,formatting:!0,inlineStyle:!0,list:!0}),E.setShortcut({bold:"ctrlB",italic:"ctrlI",underline:"ctrlU",justifyLeft:"ctrlShiftL",justifyCenter:"ctrlShiftE",justifyRight:"ctrlShiftR",insertLineBefore:"ctrlEnter"});var L=new c.UI("zeta.editor.formatting",{contextChange:function(a,b){G("formatting inlineStyle list",function(a,c){b[c]=b.context.typer.widgetEnabled(c)})}}),M={bold:"",italic:"",underline:"",strikeThrough:"",unorderedList:"",orderedList:"",indent:"",outdent:"",justifyLeft:"",justifyCenter:"",justifyRight:"",justifyFull:""},N=L.buttonlist(L.button("inlineStyleClear",function(a){a.context.typer.invoke("applyClass","")}),{after:"*"});L.export("zeta.editor.toolbar",L.buttonset(L.dropdown("paragraph",{realm:"formatting",execute:"formatting",visible:function(a){return u(a)&&a.controls.length>0},contextChange:function(a,b){var c=t(b),d=c.typer.getStaticWidget("formatting"),e=(c.startNode===c.endNode?c.startNode:c.focusNode).element,f=D.any(b.controls,function(a){return a.value===d.formattingWithClassName});b.choices=D.map(b.context.options.formattings,function(a,b){return!J.test(b)||g(e.tagName,k.$1)?{value:b,label:a}:null}),b.value=f?f.value:d.formatting}}),L.dropdown("inlineStyle",{realm:"inlineStyle",execute:"applyClass",init:function(a,b){b.choices=b.context.options.inlineClass,b.append(N)},visible:function(a){return v(a)&&a.controls.length>1},contextChange:function(a,b){var c=b.context.typer.getStaticWidget("inlineStyle");b.value=c.inlineClass}}),w("bold","inlineStyle"),w("italic","inlineStyle"),w("underline","inlineStyle"),w("strikeThrough","inlineStyle"),L.button("unorderedList",M.unorderedList,{realm:"list",execute:function(a){a.context.typer.invoke(function(a){a.insertWidget("list")})},active:function(a){var b=t(a).getWidget("list");return b&&H(b.element,"ul")},enabled:function(a){return u(a)&&t(a).widgetAllowed("list")}}),L.callout("orderedList",M.orderedList,L.buttonlist(x("1","1, 2, 3, 4"),x("a","a, b, c, d"),x("A","A, B, C, D"),x("i","i, ii, iii, iv"),x("I","I, II, III, IV")),L.button("clearOrderedList",{execute:"outdent",visible:function(a){return a.parent.active}}),{realm:"list",active:function(a){var b=t(a).getWidget("list");return b&&H(b.element,"ol")},enabled:function(a){return u(a)&&t(a).widgetAllowed("list")}}),w("indent","list"),w("outdent","list"),w("justifyLeft","formatting"),w("justifyCenter","formatting"),w("justifyRight","formatting"),w("justifyFull","formatting"),{visible:v})),L.i18n("en",{bold:"Bold",italic:"Italic",underline:"Underlined",strikeThrough:"Strikethrough",unorderedList:"Bullet list",orderedList:"Numbered list",indent:"Indent",outdent:"Outdent",justifyLeft:"Align left",justifyCenter:"Align center",justifyRight:"Align right",justifyFull:"Align justified",paragraph:"Formatting",inlineStyle:"Text style",inlineStyleClear:"Clear style",decimal:"Decimal numbers",lowerAlpha:"Alphabetically ordered list, lowercase",upperAlpha:"Alphabetically ordered list, uppercase",lowerRoman:"Roman numbers, lowercase",upperRoman:"Roman numbers, uppercase",clearOrderedList:"Remove numbered list",format_p:"Paragraph",format_h1:"Header 1",format_h2:"Header 2",format_h3:"Header 3",format_h4:"Header 4",format_h5:"Header 5",format_h6:"Header 6",format_table:"Table",format_td:"Table cell",format_th:"Table header",format_ul:"Unordered list",format_ol:"Ordered list",format_li:"List item",format_blockquote:"Blockquote"})}(a,zeta),function(a,d){function e(a){var b=c.createElement("a");return b.href=a||"",location.protocol===b.protocol&&location.hostname===b.hostname&&(location.port===b.port||""===location.port&&b.port===("https:"===location.protocol?"443":"80"))?b.pathname.replace(/^(?!\/)/,"/")+b.search+b.hash:a}function f(b){var c,d=b.context.typer,e=(b.state.widget||"").element;if(e)c={href:e.getAttribute("href"),text:e.textContent,blank:"_blank"===e.getAttribute("target")};else{var f=d.getSelection().getSelectedText();c={href:/^[a-z]+:\/\//g.test(f)?f:"",text:f,blank:!1}}var g,i=b.context.options.selectLink;return g="function"==typeof i?i(c):h.render(c).dialog,g.then(function(b){if(!b)return null;var c=b.href||b,f=b.text||c;d.invoke(function(g){e||(e=a('<a href="">').text(f)[0],g.insertHtml(e),g.selection.select(e,"contents")),a(e).text(f),a(e).attr("target",b.blank?"_blank":null),d.invoke("setURL",c)})})}d.Editor.widgets.link={element:"a[href]",inline:!0,create:function(b,c){c=e(c),"link"===b.selection.focusNode.widget.id?b.invoke("setURL",c):b.insertHtml(a("<a>").text(b.selection.getSelectedText()||c).attr("href",c)[0])},remove:"keepText",setup:function(a){a.typer.on("contentChange",function(a){var b=a.sourceKeyName;if("enter"===b||"space"===b){var c=a.typer.getSelection().clone();if(c.moveByCharacter(-1),c.getCaret("start").moveByWord(-1)&&"link"!==c.focusNode.widget.id&&/^([a-z]+:\/\/\S+)|(\S+@\S+\.\S+)/g.test(c.getSelectedText())){var d=k.$1||"mailto:"+k.$2;a.typer.invoke(function(b){var e=b.selection.clone();a.typer.snapshot(!0),a.typer.select(c),b.insertWidget("link",d),a.typer.select(e)})}}})},init:function(a){a.widget.element.style.cursor="text"},ctrlClick:function(a){b.open(a.widget.element.href)},commands:{setURL:function(a,b){a.widget.element.href=e(b)},unlink:function(a){a.removeWidget(a.widget)}}},d.Editor.defaultOptions.link=!0;var g=new d.UI("zeta.editor.link",{contextChange:function(a,b){var c=b.context.typer;if(c){var d=c.getSelection();b.widget=d.getWidget("link"),b.widgetAllowed=d.widgetAllowed("link")}}}),h=g.dialog(g.textbox("text",!0),g.textbox("href",!0),g.checkbox("blank"),g.buttonset(g.button("remove","delete",{danger:!0,execute:function(a){a.parentContext.typer.invoke("unlink")},visible:function(a){return a.parentContext.typer.hasCommand("unlink")}}),g.submit("ok","done"),g.button("cancel","close",function(a){return a.all.dialog.destroy()})));g.export("zeta.editor.toolbar",g.button("insertLink","insert_link",{realm:"widgetAllowed",after:"insertWidgets",execute:f,active:function(a){return a.state.widget},contextChange:function(a,b){b.label=b.state.widget?"editLink":"insertLink"}})),g.export("zeta.editor.contextmenu",g.buttonlist(g.button("open",{realm:"widget",shortcut:"ctrlClick",execute:function(a){b.open(a.state.widget.element.href)}}),g.button("editLink",{realm:"widget",execute:f}),g.button("removeLink",{realm:"widget",execute:"unlink"}))),g.i18n("en",{insertLink:"Insert hyperlink",editLink:"Edit hyperlink",removeLink:"Remove hyperlink",remove:"Remove",text:"Text",href:"Link URL",blank:"Open in new window",open:"Open hyperlink",cancel:"Cancel",ok:"OK"})}(a,zeta),function(a,b){function c(a,b){var c,d=a.context.options.selectMedia;if(f.isFunction(d)){c=d(e.exec(a.label)&&(k.$1?"image":k.$2?"video":"audio"),a.value)}else c=g.prompt("imageURL",a.value);return c.then(b)}function d(a,b){return g.button(a,b,{realm:"widgetAllowed",execute:function(a){return c(a,function(){a.context.typer.invoke(function(b){b.insertWidget("media",a.value)})})}})}var e=/\.(?:(jpg|jpeg|png|gif|webp)|(mp4|ogg|webm)|(mp3))(?:\?.*)?$/i,f=b.helper;b.Editor.widgets.media={element:"img,audio,video,a:has(>img)",text:function(a){return a.element.src},create:function(b,c){var d=f.createElement(e.test(c.src||c)?k.$2?"video":k.$3?"audio":"img":"img");d.src=c.src||c,f.is(d,"video")&&a(d).attr("controls",""),b.insertHtml(d)}},b.Editor.defaultOptions.media=!0;var g=new b.UI("zeta.editor.media",{contextChange:function(a,b){var c=b.context.typer.getSelection();b.widget=c.getWidget("media"),b.widgetAllowed=c.widgetAllowed("media")}});g.export("zeta.editor.insertMenu",d("image","insert_photo"),d("video","videocam")),g.export("zeta.editor.toolbar",g.buttonset(g.button("filePicker",{realm:"widget",showText:!0,showIcon:!1,contextChange:function(b,c){c.value=a(c.state.widget.element).attr("src"),c.label=(/(?:^|\/)([^\/?#]+)(?:\?.+)?$/.exec(c.value)||[])[1]||""},execute:function(b){return c(b,function(c){a(b.state.widget.element).attr("src",c.src||c)})}}),g.textbox("altText",{realm:"widget",icon:"comment",contextChange:function(b,c){c.value=a(c.state.widget.element).attr("alt")},execute:function(b){a(b.state.widget.element).attr("alt",b.value).attr("title",b.value)}}))),g.i18n("en",{insertImage:"Image",insertVideo:"Video",altText:"Alternate text",imageURL:"Image URL"})}(a,zeta),function(a,b){function c(b,c,e){var f=b.options;f[c]&&d.setState(d.is(f.target,h)||a(b.typer.element).parents(f.target).addBack()[0],f[c],e)}var d=b.helper;b.Editor.widgets.stateclass={options:{target:null,disabled:"disabled",focused:"focused",empty:"empty"},focusin:function(a){c(a.widget,"focused",!0)},focusout:function(a){c(a.widget,"focused",!1)},stateChange:function(a){c(a.widget,"disabled",!a.typer.enabled()),c(a.widget,"empty",!a.typer.hasContent())},contentChange:function(a){c(a.widget,"empty",!a.typer.hasContent())},init:function(a){c(a.widget,"empty",!a.typer.hasContent())}}}(a,zeta),function(a,b){function c(a,b,c,d,e){var f=this;f.widget=a,f.element=a.element,f.minCol=c,f.minRow=b,f.maxCol=e,f.maxRow=d}function d(b){var d=b.typer.getSelection(),e=d.focusNode.widget;if("table"===e.id){var f=a(d.startElement).parentsUntil(e.element).addBack(),g=a(d.endElement).parentsUntil(e.element).addBack();return new c(e,f.eq(1).index(),f.eq(2).index(),g.eq(1).index(),g.eq(2).index())}}function e(b,c){return a(w,b.element||b)[c]}function f(a,b,c){return"string"==typeof b?f(a,g.min(a[b+"Row"],h(a)-1),g.min(a[b+"Col"],i(a)-1)):e(a,b).children[c]}function h(b){return a(w,b.element||b).length}function i(a){return e(a,0).childElementCount}function j(a){return!!y.is(f(a,0,0),"th")}function k(b,c,d){if(b.isSingleEditable){var e=a(b.focusNode.element)[c]()[0]||a(b.focusNode.element).parent()[c]().children(d)[0];e&&b.moveToText(e,-0)}}function l(b){a("td,th",b.element||b).css({outline:"1px dotted rgba(0,0,0,0.3)",minWidth:"3em"})}function m(a,b,d,e,f){a.typer.select(new c(a,b,d,b+e-1,d+f-1))}function n(b,c,d,e){var f="string"==typeof c?c+"-child":"nth-child("+(c+1)+")",g=e?"before":"after";a(b.element||b).find(w+">th:"+f)[g](B(u,d)),a(b.element||b).find(w+">td:"+f)[g](B(t,d)),l(b)}function o(b,c,d,f,g){
a(e(b,"last"===c?h(b)-1:c))[f?"before":"after"](B(v.replace("%",B(g||t,i(b))),d)),l(b)}function p(b,c){var d=j(b);d&&!c?(a(">th",e(b,0)).wrapInner("<p>").each(function(b,c){a(c).replaceWith(a(t).append(c.childNodes))}),l(b)):d||!c&&void 0!==c||o(b,0,1,!0,u)}function q(b,c,d){for(var e=a(c?w+":first>*":w,b.element),f=e.length-1;f>=0;f--){var h=z(e[f])[c?"right":"bottom"];if(g.abs(h-d)<5)return{widget:b,isColumn:c,index:f,pos:h}}}function r(b,d,e){for(var f=a(d?w+":first>*":w,b.element),g=f.length-1;g>=1&&z(f[g])[d?"left":"top"]>e;g--);E||(s=new c(b,0,0,h(b)-1,i(b)-1),s[d?"minCol":"minRow"]=g),s[d?"maxCol":"maxRow"]=g,E=!0}var s,t="<td></td>",u="<th></th>",v="<tr>%</tr>",w=">tbody>tr",x=b.Editor,y=b.helper,z=y.getRect,A=y.removeNode,B=y.repeat;c.prototype={get numCol(){return g.abs(this.maxCol-this.minCol)+1},get numRow(){return g.abs(this.maxRow-this.minRow)+1},get mode(){return(this.numCol===i(this))+2*(this.numRow===h(this))},rows:function(b){a(w,this.element).splice(this.minRow,this.numRow).forEach(b)},cells:function(b){var c=this;c.rows(function(d,e){a(d.children).splice(c.minCol,c.numCol).forEach(function(a,c){b(a,e,c)})})},getRange:function(){return y.createRange(f(this,"min"),0,f(this,"max"),-0)},getRects:function(){var a=f(this,"min"),b=f(this,"max");return[y.mergeRect(z(a),z(b))]},acceptNode:function(a){var b=!1;return a.element===this.element?1:(this.cells(function(c){b|=y.containsOrEquals(c,a.element)}),b||2)},remove:function(a){var b=this;1===a?b.rows(A):2===a&&b.cells(A),b.widget.typer.select(f(b,"min"),-0)}},x.widgets.table={element:"table",editable:"th,td",create:function(a,b){b=b||{},a.insertHtml("<table>"+B(v.replace("%",B(t,b.columns||2)),b.rows||2)+"</table>")},init:function(b){a(b.widget.element).removeAttr("x-table-copymode"),l(b.widget)},extract:function(b){var c=b.widget.element,d=b.extractedNode;if(s&&s.widget===b.widget){var e=s.mode;1!==e&&2!==e||(a(d).attr("x-table-copymode",e),"paste"!==b.source&&"cut"!==b.source||s.remove(e))}else if(h(d)>1){var f=i(c);a(w,d).each(function(b,c){c.childElementCount<f&&a(B(a(">th",c)[0]?u:t,f-c.childElementCount))[b?"appendTo":"prependTo"](c)})}},receive:function(b){var c=+a(b.receivedNode).attr("x-table-copymode");if(c||"paste"===b.source){var k=b.typer.getSelection(),q=s&&s.widget===b.widget?s:d(k),r=b.widget.element,t=b.receivedNode,u=j(r);p(t,1!==c&&(2===c?u:0===q.minRow&&u));var v=h(t),x=i(t),y=h(r),z=i(r),A=1===c?q.minRow===y:q.minCol===z;2===c?(o(v>y?r:t,"last",g.abs(v-y),!1),a(w,t).each(function(b,c){a(c.children)[A?"insertAfter":"insertBefore"](f(r,b,q.minCol-A))}),m(b.widget,0,q.minCol,h(r),x)):1===c?(0===q.minRow&&u&&q.minRow++,n(x>z?r:t,"last",g.abs(x-z),!1),a(w,t)[A?"insertAfter":"insertBefore"](e(r,q.minRow-A)),m(b.widget,q.minRow,0,v,i(r))):(1===q.numRow&&1===q.numCol&&(q.maxCol=q.minCol+x-1,q.maxRow=q.minRow+v-1,q.maxRow>y-1&&o(r,"last",q.maxRow-y+1,!1),q.maxCol>z-1&&n(r,"last",q.maxCol-z+1,!1)),q.cells(function(b,c,d){a(b).replaceWith(f(t,c%v,d%x).cloneNode(!0))}),k.select(q)),l(r),b.handled()}},tab:function(a){k(a.typer.getSelection(),"next",":first-child"),a.handled()},shiftTab:function(a){k(a.typer.getSelection(),"prev",":last-child"),a.handled()},keystroke:function(a){if(s&&s.widget===a.widget&&("backspace"===a.data||"delete"===a.data)){var b=s.mode;1!==b&&2!==b||(s.remove(b),a.handled())}},commands:{addColumnBefore:function(a){var b=d(a);n(a.widget,b.minCol,b.numCol,!0)},addColumnAfter:function(a){var b=d(a);n(a.widget,b.maxCol,b.numCol,!1)},addRowAbove:function(a){var b=d(a);o(a.widget,b.minRow,b.numRow,!0)},addRowBelow:function(a){var b=d(a);o(a.widget,b.maxRow,b.numRow,!1)},removeColumn:function(a){d(a).remove(2)},removeRow:function(a){d(a).remove(1)},toggleTableHeader:function(b){p(b.widget),a(">th",e(b.widget,0)).text(function(a,b){return b||"Column "+(a+1)})}}},b.UI.define("tableGrid",{template:'<div class="zeta-grid"><div class="zeta-grid-wrapper">'+B('<div class="zeta-grid-row">'+B('<div class="zeta-grid-cell"></div>',7)+"</div>",7)+'</div><z:label show-icon="false"/></div>',label:"{{rows or 0}} × {{columns or 0}}",rows:0,columns:0,init:function(b,c){var d=a(".zeta-grid-cell",c.element);d.mouseover(function(){var b=d.index(this),e=b%7+1,f=(b-e+1)/7+1;d.each(function(b,c){a(c).toggleClass("active",b%7<e&&b/7<f)}),c.rows=f,c.columns=e})},click:function(a,b){return b.execute()}});var C=new b.UI("zeta.editor.table",{contextChange:function(a,b){var c=b.context.typer.getSelection();b.widget=c.getWidget("table"),b.widgetAllowed=c.widgetAllowed("table")}});C.export("zeta.editor.insertMenu",C.callout("insertTable","table_chart",C.tableGrid({realm:"widgetAllowed",execute:function(a){a.context.typer.invoke(function(b){b.insertWidget("table",a)})}}))),C.export("zeta.editor.contextmenu",C.callout("modifyTable",C.checkbox("showHeader",{realm:"widget",execute:"toggleTableHeader",contextChange:function(a,b){b.value=j(b.state.widget)}}),C.dropdown("style",{realm:"widget",valueAsLabel:!1,init:function(a,b){b.choices=b.context.options.tableStyles,b.append(C.button("styleDefault",{after:"*"}))},execute:function(a){a.state.widget.element.className=a.value||""},contextChange:function(a,b){b.value=b.state.widget.element.className||""}}),C.dropdown("tableWidth",{realm:"widget",valueAsLabel:!1,choices:{"":"fitContent","100%":"fullWidth"},execute:function(b){a(b.state.widget.element).attr("width",b.value||null)},contextChange:function(b,c){c.value=a(c.state.widget.element).attr("width")||""}}),C.buttonlist("addRemoveCell",C.button("addColumnBefore",{realm:"widget",execute:"addColumnBefore"}),C.button("addColumnAfter",{realm:"widget",execute:"addColumnAfter"}),C.button("addRowAbove",{realm:"widget",execute:"addRowAbove",enabled:function(a){return!j(a.state.widget)||d(a.context).minRow>0}}),C.button("addRowBelow",{realm:"widget",execute:"addRowBelow"}),C.button("removeColumn",{realm:"widget",execute:"removeColumn"}),C.button("removeRow",{realm:"widget",execute:"removeRow"})),{hiddenWhenDisabled:!0})),C.i18n("en",{insertTable:"Table",modifyTable:"Modify table",showHeader:"Show header",style:"Table style",styleDefault:"Default",addColumnBefore:"Add column before",addColumnAfter:"Add column after",addRowAbove:"Add row above",addRowBelow:"Add row below",removeColumn:"Remove column",removeRow:"Remove row",tableWidth:"Table width",fitContent:"Fit to content",fullWidth:"Full width"});var D,E,F=x.handle("cell"),G=x.handle("cell"),H=x.handle("pointer",function(){(D.isColumn?n:o)(D.widget,D.index,1,!1)});x.addLayer("table",function(a){var b=a.hoverNode&&a.hoverNode.widget;if(b&&"table"===b.id){var c=z(b);if((!a.mousedown||H.active)&&(D=q(b,!0,a.pointerX)||q(b,!1,a.pointerY))){var e=D.isColumn?"left":"top";a.drawLine(c.collapse(e,D.pos-c[e]),e,5,"transparent","solid",H)}a.drawLine(c,"top",10,"transparent","solid",F),a.drawLine(c,"left",10,"transparent","solid",G)}F.active?r(E?s:b,!0,a.pointerX):G.active?r(E?s:b,!1,a.pointerY):a.selectionChanged&&(s=d(a),!s||1===s.numRow&&1===s.numCol?(s=null,E=!1):E=!0),E&&!a.mousedown&&(E=!1,3===s.mode?(a.typer.select(s.element),s=null):m(s.widget,g.min(s.minRow,s.maxRow),g.min(s.minCol,s.maxCol),s.numRow,s.numCol)),a.toggleLayer("selection",!E),E&&a.fill(s.getRects())})}(a,zeta),function(a,d){function e(a){if(!1===p)a();else if(!p){var b=q.bind(c,"paste",function(){p=!0});m(function(){b(),p||(p=!1,a())})}}function f(b){var c=a(b.element).height(),d=q.getRect(b.widget||b.typer);if(0!==d.left||0!==d.top||0!==d.width||0!==d.height){var e={position:"fixed",left:d.left,top:g.max(0,d.top-c-10)},f=b.typer.getSelection().extendCaret.getRect();f.top>=e.top&&f.top<=e.top+c&&(e.top=f.bottom+10),a(b.element).css(e)}}function h(b){o!==b&&(i(),o=b,a(b.element).appendTo(c.body),q.setZIndexOver(b.element,b.typer.element)),f(b)}function i(b){o&&(b||o)===o&&(a(o.element).detach(),o.position="",o=null)}function j(b,d,e){var f=c.createElement("div"),g=e.render(f,{typer:b,options:d});return g.element||(g.element=f),b.retainFocus(g.element),d.container&&e!==n?a(f).appendTo(d.container):a(f).addClass("zeta-float"),g}function k(a,b){"mouse"===a.source&&b.context.typer.focus()}var l,n,o,p,q=d.helper;d.Editor.widgets.toolbar={options:{container:"",formattings:{p:"Paragraph",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4"},inlineClasses:{}},init:function(a){a.widget.toolbar=j(a.typer,a.widget.options,l)},focusin:function(a){var b=a.widget.toolbar;b.update(),b.options.container||h(b)},focusout:function(a){i(a.widget.toolbar)},rightClick:function(a){var b=a.widget.contextmenu||(a.widget.contextmenu=j(a.typer,a.widget.options,n));m(function(){d.dom.focus(b.element),b.update(),b.showMenu({x:a.clientX,y:a.clientY})}),a.preventDefault()},stateChange:function(a){var b=a.widget.toolbar;m(function(){b.update()}),o===b&&(a.typer.enabled()?f(b):i(b))}},q.bind(b,"scroll",function(){o&&f(o)});var r=new d.UI("zeta.editor");l=r.buttonset(r.callout("insertWidgets","widgets",r.import("zeta.editor.insertMenu")),r.import("zeta.editor.toolbar"),{showText:!1,childExecuted:k}),n=r.menu(r.buttonlist(r.button("undo","",{execute:"undo",enabled:function(a){return a.context.typer.canUndo()}}),r.button("redo","",{execute:"redo",enabled:function(a){return a.context.typer.canRedo()}}),{hiddenWhenDisabled:!1}),r.buttonlist(r.button("selectAll","select_all",{execute:"selectAll"}),r.button("selectParagraph",{hiddenWhenDisabled:!0,execute:function(a){var b=a.context.typer.getSelection();b.select(b.startNode.element,"contents"),b.focus()},enabled:function(a){return a.context.typer.getSelection().isCaret}})),r.buttonlist(r.button("cut","content_cut",{shortcut:"ctrlX",execute:function(a){a.context.typer.focus(),c.execCommand("cut")}}),r.button("copy","content_copy",{shortcut:"ctrlC",execute:function(a){a.context.typer.focus(),c.execCommand("copy")}}),r.button("paste","content_paste",{shortcut:"ctrlV",execute:function(a){a.context.typer.focus(),c.execCommand("paste"),e(function(){r.alert("clipboardError")})}})),r.import("zeta.editor.contextmenu"),{childExecuted:k}),r.i18n("en",{undo:"Undo",redo:"Redo",cut:"Cut",copy:"Copy",paste:"Paste",selectAll:"Select all",selectParagraph:"Select paragraph",insertWidgets:"Insert",clipboardError:"Unable to access clipboard due to browser security. Please use Ctrl+V or [Paste] from browser's menu."})}(a,zeta),function(a,b){function c(a,b,c){return b.invalidCharsRegex&&(a=a.replace(b.invalidCharsRegex,"")),b.maxlength&&(a=a.substr(0,b.maxlength-c)),a}b.Editor.widgets.validation={options:{invalidChars:"",allowChars:"",maxlength:0},init:function(a){var b=a.widget.options;b.invalidChars&&(b.invalidCharsRegex=new k("["+b.invalidChars.replace(/[\[\]\\^]/g,"\\$&")+"]","g")),b.allowChars&&(b.invalidCharsRegex=new k("[^"+b.allowChars.replace(/[\[\]\\^]/g,"\\$&")+"]","g"))},contentChange:function(a){if("script"===a.source){var b=a.typer.extractText(),d=c(b,a.widget.options,0);d!==b&&a.typer.setValue(d)}},textInput:function(a){var b=c(a.data,a.widget.options,a.typer.extractText().length-a.typer.getSelection().getSelectedText().length);b!==a.data&&(a.handled(),b&&a.typer.invoke(function(a){a.insertText(b)}))}}}(0,zeta),function(a,c){function d(b,c,d,f){var h=e.getRect(b),i=g.pow(d-h.top,2)+g.pow(c-h.left,2),j=g.pow(d-h.top,2)+g.pow(c-h.right,2),k=g.pow(d-h.bottom,2)+g.pow(c-h.left,2),n=g.pow(d-h.bottom,2)+g.pow(c-h.right,2),o=.5+2*g.sqrt(g.max(i,j,k,n))/l(a.css(b,"font-size")),p=a('<div class="zeta-clickeffect"><i></i></div>').appendTo(b),q=p.children().css({top:d-h.top,left:c-h.left});m(function(){q.css("transform",q.css("transform")+" scale("+o+")").addClass("animate-in")}),p.css("border-radius",a.css(b,"border-radius")),e.always(f,function(){e.runCSSTransition(p.children()[0],"animate-out",function(){p.remove()})})}var e=c.helper;e.bind(b,c.IS_TOUCH?"touchstart":"mousedown",function(a){for(var b=(a.touches||[a])[0],f=a.target;f;f=f.parentNode)if(e.is(f,".zeta-ui button, .zeta-ui .has-clickeffect"))return void d(f,b.clientX,b.clientY,c.dom.drag(a))})}(a,zeta),function(a,b,d){function e(a,b){for(var c=[],d=0;d<a;d++)c[d]=b(d);return c}function f(a){return a.getFullYear()}function h(a){return a.getMonth()}function i(a){return a.getDate()}function j(a){return a.getHours()}function l(a){return a.getMinutes()}function n(a,b){return f(a)===f(b)&&h(a)===h(b)}function p(a){return"string"==typeof a&&/^today|([+-]\d+)(day|week|month|year)?$/g.test(a)?k.$1?u(k.$2||"day",new d,+k.$1):new d:(a=null===a?void 0:a instanceof d?a:new d(a),isNaN(a)?void 0:a)}function q(a,b){var c=new d;return c.setHours(a,b,0,0),c}function r(a,b){switch(a){case"datetime":return+b-G;case"month":return 12*(f(b)-1970)+h(b)}return+b+G}function s(a,b){switch(a){case"datetime":return new d(b+G);case"month":return new d(1970,b)}return new d(b-G)}function t(a,b){var c=p(a.min),e=p(a.max);switch(b=new d(+(b<c?c:b>e?e:b)),a.mode||a){case"week":b.setDate(i(b)-b.getDay());break;case"month":b.setDate(1)}return"datetime"!==(a.mode||a)?b.setHours(0,0,0,0):b.setSeconds(0,0),b}function u(a,b,c,e){switch(a){case"minute":var j=c/g.abs(c);return new d(+b+6e4*(((j>0?e:0)-l(b)%e||e*j)+e*(c-j)));case"day":return new d(+b+F*c);case"week":return new d(+b+7*F*c);case"month":return new d(f(b),h(b)+c,i(b));case"year":return new d(f(b)+c,h(b),i(b))}}function v(a,b){switch(a){case"month":return D[h(b)]+" "+f(b);case"week":var c=u("day",b,6);return D[h(b)]+" "+i(b)+" - "+(h(c)!==h(b)?D[h(c)]+" ":"")+i(c)+", "+f(b)}var d=D[h(b)]+" "+i(b)+", "+f(b);return"datetime"===a?d+" "+(j(b)||12)+":"+("0"+l(b)).slice(-2)+" "+(j(b)>=12?"PM":"AM"):d}function w(b,c){if(!isNaN(+c)){"number"==typeof c&&(c=u("month",b.currentMonth,c));var g=p(b.min),j=p(b.max),k=t({mode:"month",min:g,max:j},c),l=f(k),m=h(k),o=L.all(b),q=k.getDay(),r=a("td",b.element).removeClass("selected disabled");if(!b.currentMonth||!n(k,b.currentMonth)){var s=new d(l,m+1,0).getDate(),v=new d(l,m,0).getDate();r.removeClass("prev cur next today"),r.each(function(b,c){b<q?a(c).children().text(b+1-q+v).end().addClass("prev"):b>=s+q?a(c).children().text(b+1-q-s).end().addClass("next"):a(c).children().text(b+1-q).end().addClass("cur")});var w=new d;n(k,w)&&r.eq(i(w)+q-1).addClass("today"),a("tr:last",b.element).toggle(q+s>35),o.year.choices=e(11,function(a){return l+a-5}),b.currentMonth=k}o.year.value=l,o.month.value=m;var x=g&&n(k,g),y=j&&n(k,j);o.prevMonth.enabled=!x,o.nextMonth.enabled=!y,x&&r.slice(0,i(g)+q-1).addClass("disabled"),y&&r.slice(i(j)+q).addClass("disabled");var z=n(k,b.value);if(z||"week"===b.mode&&n(k,u("day",b.value,6)))switch(b.mode){case"day":r.eq(i(b.value)+q-1).addClass("selected");break;case"week":r.slice(z?i(b.value)+q-1:0).slice(0,7).addClass("selected");break;case"month":r.filter("td.cur").addClass("selected")}a(b.element).toggleClass("select-range","day"!==b.mode)}}function x(){var a={template:'<z:callout label="{{selectedText}}" show-text="true"/>'},b=new o.Map;e(12,function(a){b.set(a,D[a].toLowerCase())}),A={year:L.dropdown("year",function(a){return w(a.parent,new d(a.value,h(a.parent.currentMonth)))},a),month:L.dropdown("month",b,function(a){return w(a.parent,new d(f(a.parent.currentMonth),a.value))},a),prev:L.button("prevMonth","",function(a){return w(a.parent,-1)}),setToday:L.button("setToday","",function(a){return a.parent.execute(new d)}),next:L.button("nextMonth","",function(a){return w(a.parent,1)}),hour:L.number("hour",{options:{min:0,max:23,loop:!0},execute:function(a){a.parent.execute(q(a.value,a.all.minute.value))}}),timeSeperator:L.label("timeSeperator"),minute:L.number("minute",{options:{min:0,max:59,digits:"fixed",loop:!0},execute:function(a){a.parent.execute(q(a.all.hour.value,a.value))}}),meridiem:L.button("meridiem",{value:!1,label:"am",showText:!0,propertyChange:function(a,b){b.label=b.value?"pm":"am"},execute:function(a){a.value=!a.value,a.parent.execute(q(a.all.hour.value%12+(a.value?12:0),a.all.minute.value))}})}}function y(){var a=function(a,b){var c=new d(+b.all.calendar.value);c.setHours(j(b.all.clock.value),l(b.all.clock.value)),B.setValue(c)},b=L.calendar({executed:a,contextChange:function(a,b){b.min=C.min,b.max=C.max,b.mode="datetime"===C.mode?"day":C.mode}}),c=L.clock({hiddenWhenDisabled:!0,executed:a,contextChange:function(a,b){b.step=C.minuteStep,b.enabled="datetime"===C.mode}}),e=L.submit("done","done",{execute:function(a){C.hideMenu()}});C=L.menu(L.buttonset(b,c),L.generic({controls:[L.buttonset(e)],template:'<z:generic><controls layout="dialog"/></z:generic>'}),{hideCalloutOnBlur:!1}).render()}function z(a){var b=a.widget.options,c=u("datetime"===b.mode?"minute":b.mode,a.typer.getValue()||new d,"stepUp"===a.commandName?-1:1,b.minuteStep);a.typer.setValue(c)}var A,B,C,D="January February March April May June July August September October November December".split(" "),E="Su Mo Tu We Th Fr Sa".split(" "),F=864e5,G=6e4*(new d).getTimezoneOffset(),H={datetime:"datetime-local",day:"date",week:"week",month:"month"},I=b.helper,J=b.dom,K=I.repeat,L=new b.UI("zeta.ui.datepicker");b.UI.define("calendar",{template:'<div class="zeta-calendar"><div class="zeta-calendar-header"><z:buttonset show-text="false"/></div><div class="zeta-calendar-body"><table></table></div></div>',hideCalloutOnExecute:!1,value:null,mode:"day",min:null,max:null,setValue:function(a,b){var c=t(this,a.newValue);b.selectedDate=c,b.value=c,w(b,c)},init:function(b,c){A||x(),c.append([A.year,A.month,A.prev,A.setToday,A.next]);var e=function(){c.value=t(c,c.selectedDate)};c.watch("mode",e),c.watch("min",e),c.watch("max",e);var g=a("table",c.element);a(K("<tr></tr>",7)).appendTo(g),a(K("<th></th>",7)).appendTo(g.find("tr:first")),a(K("<td></td>",7)).appendTo(g.find("tr+tr")),a("<button>").appendTo(g.find("td")),g.find("th").text(function(a){return E[a]}),g.find("td").click(function(){var b=a(this).hasClass("prev")?-1:a(this).hasClass("next")?1:0;c.execute(new d(f(c.currentMonth),h(c.currentMonth)+b,+this.textContent))}),c.value?w(c,0):c.value=new d},mousewheel:function(a,b){b.context===C&&(w(b,a.data),a.handled())},contextChange:function(a,b){w(b,b.currentMonth||b.value||new d)}}),b.UI.define("clock",{template:'<div class="zeta-clock"><div class="zeta-clock-face"><s hand="h"></s><s hand="m"></s><i></i><i></i></div><z:buttonset/></div>',hideCalloutOnExecute:!1,step:1,value:null,init:function(a,b){A||x(),b.append([A.hour,A.timeSeperator,A.minute,A.meridiem]),b.watch("step",function(a){60%a&&(b.step=1),L.all(b).minute.options.step=a},!0),b.setValue(new d)},mousedown:function(a,b){if(I.is(a.target,"s")){var c=I.getRect(a.target.parentNode);J.drag(a,function(d,e){var f=g.atan2(e-c.centerY,d-c.centerX)/g.PI,h=l(b.value),i=j(b.value);if("m"===a.target.getAttribute("hand")){var k=g.round((30*f+75)/b.step)*b.step%60;if(k!==h){var m=g.floor(g.abs(h-k)/30)*(k>h?-1:1);b.setValue(q(i+m,k))}}else{var n=g.round(6*f+15)%12+(L.all(b).meridiem.value?12:0);n!==i&&b.setValue(q(n,h))}}).then(function(){b.execute()})}},setValue:function(b,c){var d=b.newValue,e=L.all(c);e.hour.value=j(d)||12,e.minute.value=l(d),e.meridiem.value=j(d)>=12,a('s[hand="h"]',c.element).css("transform","rotate("+(30*j(d)+.5*l(d)-90)+"deg)"),a('s[hand="m"]',c.element).css("transform","rotate("+(6*l(d)-90)+"deg)")},mousewheel:function(a,b){b.setValue(u("minute",b.value,a.data,b.step)),b.mousewheelTimeout=b.mousewheelTimeout||m(function(){b.mousewheelTimeout=null,b.execute()}),a.preventDefault(),a.handled()}});var M={options:{mode:"day",minuteStep:1,min:null,max:null,required:!1,formatDate:null},overrides:{getValue:function(a){return a.selectedDate?t(a.options,a.selectedDate):null},setValue:function(a,b){b=b?t(a.options,b):null,a.selectedDate=b,a.softSelectedDate=null;var c="";if(b&&!isNaN(+b)){var e=function(c){return I.isFunction(c)&&c(a.options.mode,b)};c=e(a.options.formatDate)||e(v)}c!==this.extractText()&&(this.invoke(function(a){a.selection.selectAll(),a.insertText(c)}),this===B&&(C.calendar=C.clock=a.selectedDate||new d))},validate:function(a){if(a.options.required&&a.selectedDate)return I.reject("required")}},commands:{stepUp:z,stepDown:z},contentChange:function(a){if(a.typer===B&&"script"!==a.source){var b=new d(a.typer.extractText());isNaN(+b)||(C.calendar=C.clock=t(a.widget.options,b)),a.widget.softSelectedDate=b}},click:function(a){a.typer===B&&C.showMenu(a.typer.element)},escape:function(a){I.containsOrEquals(c,C.element)&&(C.hideMenu(),a.handled())},focusin:function(a){C||y(),a.typer.retainFocus(C.element),B=a.typer;var b=a.widget.options,c=a.typer.getValue()||new d;I.extend(C,{mode:b.mode,minuteStep:b.minuteStep,min:b.min,max:b.max,calendar:c,clock:c}),C.update(),"script"!==a.source&&C.showMenu(a.typer.element)},focusout:function(a){if(a.typer===B){var b=a.widget.softSelectedDate;a.typer.setValue(!b||isNaN(+b)?a.widget.selectedDate:b),B=null,C.hideMenu()}}};b.UI.define("datepicker",{template:"<z:textbox/>",preventLeave:!0,value:"",preset:M,options:{},init:function(c,d){if(b.IS_TOUCH){var e=d.options.mode||d.preset.options.mode;d.nativeInput=a('<input type="'+H[e]+'">').appendTo(d.element)[0],I.bind(d.nativeInput,"change",function(a){d.setValue(s(e,d.nativeInput.valueAsNumber))})}},focusin:function(a,c){if(b.IS_TOUCH){var e=c.options.mode||c.preset.options.mode;c.value||(c.value=new d),c.nativeInput.valueAsNumber=r(e,c.value),c.nativeInput.focus(),a.handled()}}});var N={setToday:"Today",prevMonth:"Previous month",nextMonth:"Next month",timeSeperator:":",am:"AM",pm:"PM",done:"Done"};e(12,function(a){N[D[a].toLowerCase()]=D[a]}),L.i18n("en",N)}(a,zeta,Date),function(a,b){function d(){u=y.menu(y.dropdown({template:"<z:buttonlist/>",execute:function(a){r(u.preset,a.value),u.preset.typer.focus()},contextChange:function(a,b){b.choices=b.context.suggestions}}),{hideCalloutOnBlur:!1,hideCalloutOnExecute:!1}).render()}function f(a,b){var d=c.createTextNode(b?a:a.replace(/\s/g," ")),e=c.createElement("div");return e.appendChild(d),e.innerHTML}function h(a){return a.value}function i(a){return"object"!=typeof a?{value:a,label:a}:a}function j(a,b){return a.value.localeCompare(b.value)}function l(a,b){return a.length!==b.length||a.some(function(a){return b.indexOf(a)<0})}function m(a,b){a=e(a||"");for(var c=[],d=a.toLowerCase(),f=0,g=-1,h=0;h<b.length;h++){var i=b.charAt(h).toLowerCase();if(" "!=i){if(-1==(f=d.indexOf(i,f)))return{firstIndex:1/0,consecutiveMatches:-1,formattedText:a};c[c.length]=f-g-1,g=f++}}var j=c[0],l=/^(0+)/.test(c.slice(0).sort().join(""))&&k.$1.length,m="";for(f=0,h=0;h<c.length;h++)m+=a.substr(f,c[h])+"**"+a[f+c[h]]+"**",f+=c[h]+1;return m+=a.slice(f),{firstIndex:j,consecutiveMatches:l,formattedText:m.replace(/\*\*(\ *)\*\*/g,"$1")}}function n(a,b,c){var d=a.options.suggestions||a.options.allowedValues||[];return w.isFunction(d)&&(d=d(b)),w.when(d).then(function(b){return b=b.map(i),b.forEach(function(b){a.knownValues[b.value]=b.label}),c&&(b=b.filter(function(a){return c.indexOf(a.value)<0})),b})}function o(a,b,c){return a=a.filter(function(a){return w.extend(a,m(a.label,b)),[a.value].concat(a.matches||[]).forEach(function(c){var d=m(c,b);a.firstIndex=g.min(a.firstIndex,d.firstIndex),a.consecutiveMatches=g.max(a.consecutiveMatches,d.consecutiveMatches)}),a.firstIndex!==1/0}),a.sort(function(a,b){return b.consecutiveMatches-a.consecutiveMatches+(a.firstIndex-b.firstIndex)||j(a,b)}),a.slice(0,c)}function p(a){var b=a.typer.extractText();n(a,b,a.typer.getValue()).then(function(c){a.typer.focused()&&(c=o(c,b,a.options.suggestionCount),b&&a.options.allowFreeInput&&!c.some(function(a){return a.label===b})&&c.push({value:b,label:b,formattedText:"*"+b+"*"}),u||d(),u.preset=a,u.suggestions=c.map(function(a){return{value:a.value,label:a.formattedText,icon:a.icon||""}}),u.update(),x.retainFocus(a.typer.element,u.element),u.showMenu(a.typer.element),a.typer.focus())})}function q(a,b){var c=n(a);t=!0,y.dialog({title:b.label,description:b.placeholder,controls:[y.textbox("newValue",{enter:function(a,b){return b.all.list.append(y.checkbox({label:b.value,entry:b.value,value:!0,description:"new value",before:"*"})),b.execute()},visible:function(){return a.options.allowFreeInput}}),y.buttonlist("list",{templates:{checkbox:'<z:checkbox show-icon="true"/>'}}),y.buttonset(y.submit("done","done"),y.button("cancel","close",function(a){a.all.dialog.destroy()}))],childExecuted:function(a,b){b.value=b.all.list.controls.filter(function(a){return a.value}).map(function(a){return a.entry})},init:function(b,d){var e=a.typer.getValue();d.all.dialog.value=e.slice(0),c.then(function(a){var b=a.map(h);a=a.concat(e.filter(function(a){return b.indexOf(a)<0}).map(i)),a.sort(j),d.all.list.append(a.map(function(a){var b=e.indexOf(a.value)>=0;return y.checkbox({label:a.label,icon:a.icon,entry:a.value,value:b,before:b?"*":""})}))})},destroy:function(a,b){t=!1}}).render().dialog.then(function(b){a.typer.setValue(b)})}function r(b,c){if(c&&!(b.typer.getValue().indexOf(c.value||c)>=0)){"object"!=typeof c&&(c={value:c,label:b.knownValues[c]||c});var d=a('<span class="zeta-keyword" data-value="'+f(c.value,!0)+'">'+f(c.label)+"<i>delete</i></span>")[0],e=b.typer.rootNode.lastChild;b.typer.invoke(function(a){a.selection.selectAll(),e&&a.selection.baseCaret.moveTo(e.element,!1),a.insertHtml(d)}),b.options.allowFreeInput||n(b,c.value).then(function(){b.knownValues[c.value]||a(d).addClass("invalid")})}}var s,t,u,v=b.IS_TOUCH,w=b.helper,x=b.dom,y=new b.UI("zeta.ui.keyword"),z={options:{required:!1,allowFreeInput:!0,allowedValues:null,suggestionCount:5,suggestions:!1},overrides:{getValue:function(b){return a("span",this.element).map(function(b,c){return e(a(c).data("value"))}).get()},setValue:function(a,b){b=(w.isArray(b)||e(b).split(/\s+/)).filter(function(a){return a}),l(b,this.getValue())&&this.invoke(function(c){c.selection.selectAll(),c.insertText(""),b.forEach(function(b){r(a,b)})})},validate:function(b){return b.options.required&&!this.getValue().length?w.reject("required"):a(".invalid",this.element)[0]?w.reject("invalid-value"):void 0}},widgets:{tag:{element:"span",inline:!0,editable:"none",click:function(b){b.target!==b.widget.element&&a(b.widget.element).detach()}}},init:function(a){a.typer.select(a.typer.element,-0),a.widget.knownValues={}},focusin:function(a){v?q(a.widget,s):p(a.widget)},focusout:function(a){r(a.widget,a.typer.extractText()),v||u.hideMenu()},click:function(a){v&&!t&&q(a.widget,s)},upArrow:function(a){x.focus(u.element),a.handled()},downArrow:function(a){x.focus(u.element),a.handled()},textInput:function(a){var b=a.typer.rootNode.lastChild;b&&w.compareRangePosition(a.typer.getSelection(),b.element)<0&&a.typer.select(a.typer.element,-0)},enter:function(a){var b=u.suggestions;r(a.widget,1===b.length||b[0]&&b[0].label==="**"+a.widget.knownValues[b[0].value]+"**"?b[0].value:a.typer.extractText()),a.handled()},escape:function(a){w.containsOrEquals(c,u.element)&&(u.hideMenu(),a.handled())},contentChange:function(a){v||"script"===a.source||p(a.widget)}};b.UI.define("keyword",{template:"<z:textbox/>",preventLeave:!0,options:{},value:[],preset:z,init:function(a,b){b.watch("required",function(a){b.options.required=a},!0)},focusin:function(a,b){s=b},setValue:function(a,b){var c=a.newValue||[];l(a.oldValue,c)&&(b.setValue(c),b.editor.setValue(c)),a.handled()}}),y.i18n("en",{newValue:"Enter new value",done:"Done",cancel:"Cancel"})}(a,zeta),function(a,b){function c(a,b){if(null===b||""===b||isNaN(b))b=b?"0":"";else{var c=a.options.min,d=a.options.max,g=a.options.loop&&null!==c&&null!==d;g&&b<c||!g&&null!==d&&b>d?b=d:(g&&b>d||!g&&null!==c&&b<c)&&(b=c),b=e(0|+b)}if("fixed"===a.options.digits){var h=e(+a.options.max||0).length;b=(new f(h+1).join("0")+b).substr(-h)}b!==a.typer.extractText()&&a.typer.invoke(function(a){a.selection.selectAll(),a.insertText(b)})}function d(a){c(a.widget,(a.typer.getValue()||0)+("stepUp"===a.commandName?1:-1)*a.widget.options.step)}var g={validation:{allowChars:"0-9"},options:{max:null,min:null,digits:"auto",step:1,loop:!1},overrides:{getValue:function(a){var b=parseInt(this.extractText());return isNaN(b)?null:b},setValue:function(a,b){c(a,b)}},commands:{stepUp:d,stepDown:d},contentChange:function(a){"keyboard"!==a.source&&c(a.widget,a.typer.getValue())}};b.UI.define("number",{template:"<z:textbox/>",preventLeave:!0,value:null,preset:g})}(0,zeta)}(jQuery,window,document,Object,String,Array,Math,Node,Range,DocumentFragment,RegExp,parseFloat,setTimeout,clearTimeout,new function(){this.Map=window.Map||function(a){function b(a,b){return a.items.indexOf(b)}function c(){var b=this;b.items=[],b._values=[],b._keys=a.Set.prototype._keys}return c.prototype={get size(){return this.items.length},has:function(a){return b(this,a)>=0},get:function(a){var c=b(this,a);return c>=0?this._values[c]:void 0},set:function(a,c){var d=this,e=b(d,a);return d._values[e>=0?e:d.items.push(a)-1]=c,d},delete:function(a){var c=this,d=b(c,a);return d>=0&&(c.items.splice(d,1),c._values.splice(d,1)),d>=0},keys:function(){return this._keys()},values:function(){var a=this;return a._keys(function(b){return a.get(b)})},entries:function(){var a=this;return a._keys(function(b){return[b,a.get(b)]})},forEach:function(a,b){var c=this;c.items.forEach(function(d,e){a.call(b,c._values[e],d,c)})},clear:function(){this.items.splice(0),this._values.splice(0)}},c}(this),this.MutationObserver=window.MutationObserver||function(){function a(a){this.records=[],this.handler=a}return a.prototype={observe:function(a,b){var c=zeta.helper,d=this;c.bind(a,"DOMNodeInserted DOMNodeRemoved DOMAttrModified DOMCharacterDataModified",function(e){var f=e.type.charAt(7),g=e.prevValue,h={};h.addedNodes=[],h.removedNodes=[],"M"===f?(h.type="attributes",h.target=e.target,h.attributeName=e.attrName,b.attributeOldValue&&(h.oldValue=g)):"a"===f?(h.type="characterData",h.target=e.target,b.characterDataOldValue&&(h.oldValue=g)):(h.type="childList",h.target=e.target.parentNode,h["I"===f?"addedNodes":"removedNodes"][0]=e.target);var i=!1;c.each(d.records,function(a,b){return!(i|="childList"===b.type&&b.addedNodes.some(function(a){return c.containsOrEquals(a,h.target)}))}),i||!b[h.type]||!b.subtree&&h.target!==a||(d.records[d.records.length]=h,clearTimeout(d.timeout),d.timeout=setTimeout(function(){d.handler(d.takeRecords(),d)}))})},takeRecords:function(){return this.records.splice(0)}},a}(),this.Set=window.Set||function(){function a(a,b){var c=this;c.items=a,c.index=-1,c.callback=b||function(a){return a}}function b(){this.items=[]}return a.prototype={next:function(){var a=this;return++a.index<a.items.length?{value:a.callback(a.items[a.index],a.index),done:!1}:{value:void 0,done:!0}}},b.prototype={get size(){return this.items.length},has:function(a){return this.items.indexOf(a)>=0},add:function(a){var b=this.items;return b.indexOf(a)<0&&b.push(a),this},delete:function(a){var b=this.items.indexOf(a);return b>=0&&this.items.splice(b,1),b>=0},keys:function(){return this._keys()},values:function(){return this._keys()},entries:function(){return this._keys(function(a){return[a,a]})},forEach:function(a,b){var c=this;c.items.forEach(function(d){a.call(b,d,d,c)})},clear:function(){this.items.splice(0)},_keys:function(b){return new a(this.items,b)}},b}(),this.WeakMap=window.WeakMap||function(){function a(){this.key="__WeakMap"+ ++c}var b,c=0,d=0;return a.prototype={get:function(a){if(this.has(a))try{if(d=1,a[this.key](),2!==d)throw new Error("Invalid operation");var c=b;return b=null,c}finally{d=0}},set:function(a,c){return Object.defineProperty(a,this.key,{configurable:!0,value:function(){1===d&&(b=c,d=2)}}),this},has:function(a){return a&&Object.hasOwnProperty.call(a,this.key)},delete:function(a){var b=this.has(a);return b&&delete a[this.key],b}},a}()});
//# sourceMappingURL=zeta-ui.min.js.map